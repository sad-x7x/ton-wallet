{"version":3,"file":"941.2fdddae7403cbdef81d1.js","mappings":"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M,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,EAAM,IAAM,GAAM,IAAM,GAAM,IAAM,EAAM,IAAM,EAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,EAAM,IAAM,GAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,EAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,GAAM,IAAM,EAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GAAM,EAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,EAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,EAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAC//CC,EAAI,CAAC,GAAM,EAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,EAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,EAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,EAAM,IAAM,IAAM,GAAM,EAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,EAAM,IAAM,IAAM,IAAM,EAAM,EAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,EAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,EAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GAAM,GAAM,KAG//CC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,EAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,EAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,SAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,SAAY,WAAY,UAAY,WAAY,UAAY,WAAY,SAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,EAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,SAAY,WAAY,UAAY,WAAY,UAAY,WAAY,SAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,EAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAG1/FC,EAAK,CAAC,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,EAAY,UAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,EAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,SAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,SAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,EAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,WAAY,SAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,EAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,YAG1/FC,EAAK,CAAC,EAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,EAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,SAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,SAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,EAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,UAAY,UAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,UAAY,UAAY,WAAY,UAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,EAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,UAAY,UAAY,SAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,UAAY,UAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAE9/F,SA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","sources":["webpack://mytonwallet/webpack/runtime/chunk loaded","webpack://mytonwallet/webpack/runtime/startup chunk dependencies","webpack://mytonwallet/./src/api/chains/ton/contracts/JettonStaking/imports/constants.ts","webpack://mytonwallet/./src/api/errors.ts","webpack://mytonwallet/./src/lib/big.js/index.js","webpack://mytonwallet/./src/util/decimals.ts","webpack://mytonwallet/./src/util/random.ts","webpack://mytonwallet/./src/util/bigint.ts","webpack://mytonwallet/./src/util/createPostMessageInterface.ts","webpack://mytonwallet/./src/util/bigintPatch.ts","webpack://mytonwallet/./src/util/account.ts","webpack://mytonwallet/./src/util/isMnemonicPrivateKey.ts","webpack://mytonwallet/./src/lib/ed25519-hd-key/index.ts","webpack://mytonwallet/./src/util/dns.ts","webpack://mytonwallet/./src/util/iteratees.ts","webpack://mytonwallet/./src/api/chains/ton/contracts/DnsItem.ts","webpack://mytonwallet/./src/api/common/utils.ts","webpack://mytonwallet/./src/api/environment.ts","webpack://mytonwallet/./src/api/chains/ton/constants.ts","webpack://mytonwallet/./src/api/chains/ton/util/index.ts","webpack://mytonwallet/./src/api/chains/ton/util/tonCore.ts","webpack://mytonwallet/./src/api/storages/types.ts","webpack://mytonwallet/./src/util/windowProvider/connector.ts","webpack://mytonwallet/./src/util/generateUniqueId.ts","webpack://mytonwallet/./src/util/PostMessageConnector.ts","webpack://mytonwallet/./src/api/storages/capacitorStorage.ts","webpack://mytonwallet/./src/api/storages/extension.ts","webpack://mytonwallet/./src/api/storages/idb.ts","webpack://mytonwallet/./src/api/storages/localStorage.ts","webpack://mytonwallet/./src/api/storages/index.ts","webpack://mytonwallet/./src/api/common/accounts.ts","webpack://mytonwallet/./src/api/common/mnemonic.ts","webpack://mytonwallet/./src/util/compareActivities.ts","webpack://mytonwallet/./src/util/activities/index.ts","webpack://mytonwallet/./src/util/shortenAddress.ts","webpack://mytonwallet/./src/util/poisoningHash.ts","webpack://mytonwallet/./src/api/chains/ton/util/tonapiio.ts","webpack://mytonwallet/./src/util/datetime.ts","webpack://mytonwallet/./src/util/metadata.ts","webpack://mytonwallet/./src/util/isEmptyObject.ts","webpack://mytonwallet/./src/lib/confusables/util.ts","webpack://mytonwallet/./src/lib/confusables/characters.ts","webpack://mytonwallet/./src/lib/confusables/index.ts","webpack://mytonwallet/./src/api/common/backend.ts","webpack://mytonwallet/./src/api/common/addresses.ts","webpack://mytonwallet/./src/api/db/repository.ts","webpack://mytonwallet/./src/api/db/index.ts","webpack://mytonwallet/./src/api/common/cache.ts","webpack://mytonwallet/./src/api/common/tokens.ts","webpack://mytonwallet/./src/api/chains/ton/toncenter/other.ts","webpack://mytonwallet/./src/api/chains/ton/util/metadata.ts","webpack://mytonwallet/./src/api/chains/ton/toncenter/actions.ts","webpack://mytonwallet/./src/api/chains/ton/toncenter/transactions.ts","webpack://mytonwallet/./src/api/chains/ton/wallet.ts","webpack://mytonwallet/./src/api/chains/ton/auth.ts","webpack://mytonwallet/./src/util/chain.ts","webpack://mytonwallet/./src/util/fee/transferFee.ts","webpack://mytonwallet/./src/util/tokens.ts","webpack://mytonwallet/./src/api/chains/ton/util/encryption.ts","webpack://mytonwallet/./src/api/chains/ton/util/diesel.ts","webpack://mytonwallet/./src/api/chains/ton/util/w5diesel.ts","webpack://mytonwallet/./src/api/chains/ton/util/sendExternal.ts","webpack://mytonwallet/./src/util/Deferred.ts","webpack://mytonwallet/./src/api/common/pendingTransfers.ts","webpack://mytonwallet/./src/api/constants.ts","webpack://mytonwallet/./src/api/chains/ton/walletV5/walletV5.ts","webpack://mytonwallet/./src/api/chains/ton/walletV5/walletV5Actions.ts","webpack://mytonwallet/./src/util/areDeepEqual.ts","webpack://mytonwallet/./src/api/common/helpers.ts","webpack://mytonwallet/./src/api/chains/ton/activities.ts","webpack://mytonwallet/./src/api/chains/ton/toncenter/traces.ts","webpack://mytonwallet/./src/api/chains/ton/util/dns.ts","webpack://mytonwallet/./src/api/chains/ton/address.ts","webpack://mytonwallet/./src/api/chains/ton/tokens.ts","webpack://mytonwallet/./src/api/chains/ton/transfer.ts","webpack://mytonwallet/./src/api/chains/ton/util/emulation.ts","webpack://mytonwallet/./src/api/chains/ton/toncenter/emulation.ts","webpack://mytonwallet/./src/api/chains/ton/nfts.ts","webpack://mytonwallet/./src/api/chains/ton/contracts/NominatorPool.ts","webpack://mytonwallet/./src/api/common/other.ts","webpack://mytonwallet/./src/api/chains/ton/staking.ts","webpack://mytonwallet/./src/util/ton/calcJettonStakingApr.ts","webpack://mytonwallet/./src/api/chains/ton/other.ts","webpack://mytonwallet/./src/util/ton/transfer.ts","webpack://mytonwallet/./src/api/chains/ton/swap.ts","webpack://mytonwallet/./src/util/pauseOrFocus.ts","webpack://mytonwallet/./src/api/common/nft.ts","webpack://mytonwallet/./src/api/common/swap.ts","webpack://mytonwallet/./src/api/common/txCallbacks.ts","webpack://mytonwallet/./src/util/callbacks.ts","webpack://mytonwallet/./src/api/chains/ton/priceless.ts","webpack://mytonwallet/./src/api/chains/ton/vesting.ts","webpack://mytonwallet/./src/api/chains/ton/polling.ts","webpack://mytonwallet/./src/api/chains/tron/util/tronweb.ts","webpack://mytonwallet/./src/api/chains/tron/transactions.ts","webpack://mytonwallet/./src/api/chains/tron/wallet.ts","webpack://mytonwallet/./src/api/chains/tron/polling.ts","webpack://mytonwallet/./src/api/chains/tron/constants.ts","webpack://mytonwallet/./src/api/chains/tron/transfer.ts","webpack://mytonwallet/./src/util/stringFormat.ts","webpack://mytonwallet/./src/api/chains/tron/index.ts","webpack://mytonwallet/./src/api/chains/index.ts","webpack://mytonwallet/./src/api/hooks.ts","webpack://mytonwallet/./src/api/methods/dapps.ts","webpack://mytonwallet/./src/api/methods/preload.ts","webpack://mytonwallet/./src/api/common/prices.ts","webpack://mytonwallet/./src/api/methods/tokens.ts","webpack://mytonwallet/./src/api/methods/transactions.ts","webpack://mytonwallet/./src/api/methods/staking.ts","webpack://mytonwallet/./src/api/methods/other.ts","webpack://mytonwallet/./src/api/methods/swap.ts","webpack://mytonwallet/./src/api/methods/polling.ts","webpack://mytonwallet/./src/api/methods/accounts.ts","webpack://mytonwallet/./src/api/methods/auth.ts","webpack://mytonwallet/./src/api/common/dappPromises.ts","webpack://mytonwallet/./src/api/methods/wallet.ts","webpack://mytonwallet/./src/api/methods/nfts.ts","webpack://mytonwallet/./src/api/tonConnect/types/index.ts","webpack://mytonwallet/./src/util/tonConnectEnvironment.ts","webpack://mytonwallet/./src/api/tonConnect/errors.ts","webpack://mytonwallet/./src/api/tonConnect/utils.ts","webpack://mytonwallet/./src/api/tonConnect/index.ts","webpack://mytonwallet/./src/api/tonConnect/sse.ts","webpack://mytonwallet/./src/api/methods/prices.ts","webpack://mytonwallet/./src/api/methods/notifications.ts","webpack://mytonwallet/./src/api/methods/init.ts","webpack://mytonwallet/./src/api/migrations/00016.ts","webpack://mytonwallet/./src/api/providers/worker/provider.ts","webpack://mytonwallet/./src/api/types/errors.ts","webpack://mytonwallet/./src/api/types/misc.ts","webpack://mytonwallet/./src/config.ts","webpack://mytonwallet/./src/lib/aes-js/index.js","webpack://mytonwallet/./src/lib/noble-ed25519/index.js","webpack://mytonwallet/./src/util/assert.ts","webpack://mytonwallet/./src/util/dateFormat.ts","webpack://mytonwallet/./src/util/environment.ts","webpack://mytonwallet/./src/util/fetch.ts","webpack://mytonwallet/./src/util/handleError.ts","webpack://mytonwallet/./src/util/logs.ts","webpack://mytonwallet/./src/util/safeExec.ts","webpack://mytonwallet/./src/util/schedulers.ts","webpack://mytonwallet/./src/util/withCache.ts","webpack://mytonwallet/webpack/bootstrap","webpack://mytonwallet/webpack/runtime/compat get default export","webpack://mytonwallet/webpack/runtime/define property getters","webpack://mytonwallet/webpack/runtime/ensure chunk","webpack://mytonwallet/webpack/runtime/get javascript chunk filename","webpack://mytonwallet/webpack/runtime/get mini-css chunk filename","webpack://mytonwallet/webpack/runtime/global","webpack://mytonwallet/webpack/runtime/hasOwnProperty shorthand","webpack://mytonwallet/webpack/runtime/make namespace object","webpack://mytonwallet/webpack/runtime/publicPath","webpack://mytonwallet/webpack/runtime/importScripts chunk loading","webpack://mytonwallet/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn Promise.all([494,362,776].map(__webpack_require__.e, __webpack_require__)).then(next);\n};","import type { Address, Dictionary } from '@ton/core';\n\nexport type AddrList = Dictionary<Address, Boolean>;\n\nexport const JettonStakingOpCodes = {\n  GET_STATIC_DATA: 0X2FCB26A2,\n  REPORT_STATIC_DATA: 0X8B771735,\n  GET_STORAGE_DATA: 0X5B88E5CC,\n  REPORT_STORAGE_DATA: 0XAAB4A8EF,\n  EXCESSES: 0XD53276DB,\n\n  // Jettons,\n  TRANSFER_JETTON: 0X0F8A7EA5,\n  INTERNAL_TRANSFER: 0X178D4519,\n  TRANSFER_NOTIFICATION: 0X7362D09C,\n  PROVIDE_WALLET_ADDRESS: 0X2C76B973,\n  TAKE_WALLET_ADDRESS: 0XD1735400,\n  BURN_JETTON: 0X595F07BC,\n\n  // Staking pool,\n  STAKE_JETTONS: 0XE3A06989,\n  ADD_REWARDS: 0XDB16AC95,\n  SEND_CLAIMED_REWARDS: 0X44BC1FE3,\n  SEND_UNSTAKED_JETTONS: 0XFB232BC3,\n  APPROVE_STAKE: 0X919DE781,\n  CANCEL_STAKE: 0X9EADA1D9,\n  ADD_REWARD_JETTONS: 0X10676AE7,\n  CLAIM_COMMISSIONS: 0XBCA8F067,\n  REQUEST_UPDATE_REWARDS: 0XF5C5BAA3,\n\n  // Staked jetton wallet,\n  CLAIM_REWARDS: 0X78D9F109,\n  RECEIVE_JETTONS: 0XD68A4AC1,\n  UNSTAKE_JETTONS: 0X499A9262,\n  UNSTAKE_REQUEST: 0X0168D4B7,\n  CANCEL_UNSTAKE_REQUEST: 0XA4910F1A,\n  UPDATE_REWARDS: 0XAE9307CE,\n  CONFIRM_TRANSFER: 0XBC85EB11,\n\n  // Pools admin,\n  DEPLOY_NEW_POOL: 0XDA861F17,\n  SEND_COMMISSIONS: 0XB96ADAEA,\n  SET_CODE: 0xe2d2d211,\n  CHANGE_CREATION_FEE: 0x66D5528B,\n  CHANGE_CONTENT: 0x0ec29200,\n  UPDATE_CODES: 0x85c923cf,\n};\n\nexport const JettonStakingGas = {\n  MIN_RESERVE: 20_000_000n,\n  DEPLOY_POOL: 340_000_000n,\n  NOTIFICATION: 340_000_000n,\n  JETTON_TRANSFER: 55_000_000n,\n  BURN_JETTONS: 340_000_000n,\n  STAKE_JETTONS: 300_000_000n, // It was 340000000n\n  UNSTAKE_JETTONS: 340_000_000n,\n  CANCEL_UNSTAKE: 340_000_000n,\n  SEND_COMMISSIONS: 340_000_000n,\n  SIMPLE_UPDATE_REQUEST: 340_000_000n,\n  ADD_REWARDS: 340_000_000n,\n  APPROVE_TRANSFER: 340_000_000n,\n  SAVE_UPDATED_REWARDS: 340_000_000n,\n  MIN_EXCESS: 10_000_000n,\n  SEND_STAKED_JETTONS: 630_000_000n,\n};\n\nexport const Dividers = {\n  COMMISSION_DIVIDER: 10000n,\n  REWARDS_DIVIDER: 1000,\n  DISTRIBUTION_SPEED_DIVIDER: BigInt(24 * 60 * 60),\n  DISTRIBUTED_REWARDS_DIVIDER: 100000000000000000000000000000000000000n,\n};\n","// eslint-disable-next-line max-classes-per-file\nimport type { ApiAnyDisplayError } from './types';\nimport { ApiCommonError, ApiTransactionError } from './types';\n\nexport class ApiBaseError extends Error {\n  constructor(message?: string, public displayError?: ApiAnyDisplayError) {\n    super(message);\n    this.name = this.constructor.name;\n  }\n}\n\nexport class ApiUserRejectsError extends ApiBaseError {\n  constructor(message: string = 'Canceled by the user') {\n    super(message);\n  }\n}\n\nexport class ApiServerError extends ApiBaseError {\n  constructor(message: string, public statusCode?: number) {\n    super(message, ApiCommonError.ServerError);\n  }\n}\n\nexport class ApiUnsupportedVersionError extends ApiBaseError {\n  constructor(message: string) {\n    super(message, ApiCommonError.UnsupportedVersion);\n  }\n}\n\nexport class ApiHardwareBlindSigningNotEnabled extends ApiBaseError {\n  constructor(message: string = 'Blind signing not enabled') {\n    super(message, ApiTransactionError.HardwareBlindSigningNotEnabled);\n  }\n}\n\nexport class AbortOperationError extends ApiBaseError {\n  constructor(message: string = 'Abort operation') {\n    super(message);\n  }\n}\n\nexport class NotImplemented extends ApiBaseError {\n  constructor(message: string = 'Not implemented') {\n    super(message);\n  }\n}\n\nexport function maybeApiErrors(fn: AnyAsyncFunction) {\n  return async (...args: any) => {\n    try {\n      return await fn(...args);\n    } catch (err) {\n      return handleServerError(err);\n    }\n  };\n}\n\nexport function handleServerError(err: any) {\n  if (err instanceof ApiServerError) {\n    return { error: err.displayError! };\n  }\n  throw err;\n}\n","/*\n *  big.js v6.2.1\n *  A small, fast, easy-to-use library for arbitrary-precision decimal arithmetic.\n *  Copyright (c) 2022 Michael Mclaughlin\n *  https://github.com/MikeMcl/big.js/LICENCE.md\n */\n\n\n/************************************** EDITABLE DEFAULTS *****************************************/\n\n\n  // The default values below must be integers within the stated ranges.\n\n  /*\n   * The maximum number of decimal places (DP) of the results of operations involving division:\n   * div and sqrt, and pow with negative exponents.\n   */\nvar DP = 20,          // 0 to MAX_DP\n\n  /*\n   * The rounding mode (RM) used when rounding to the above decimal places.\n   *\n   *  0  Towards zero (i.e. truncate, no rounding).       (ROUND_DOWN)\n   *  1  To nearest neighbour. If equidistant, round up.  (ROUND_HALF_UP)\n   *  2  To nearest neighbour. If equidistant, to even.   (ROUND_HALF_EVEN)\n   *  3  Away from zero.                                  (ROUND_UP)\n   */\n  RM = 1,             // 0, 1, 2 or 3\n\n  // The maximum value of DP and Big.DP.\n  MAX_DP = 1E6,       // 0 to 1000000\n\n  // The maximum magnitude of the exponent argument to the pow method.\n  MAX_POWER = 1E6,    // 1 to 1000000\n\n  /*\n   * The negative exponent (NE) at and beneath which toString returns exponential notation.\n   * (JavaScript numbers: -7)\n   * -1000000 is the minimum recommended exponent value of a Big.\n   */\n  NE = -7,            // 0 to -1000000\n\n  /*\n   * The positive exponent (PE) at and above which toString returns exponential notation.\n   * (JavaScript numbers: 21)\n   * 1000000 is the maximum recommended exponent value of a Big, but this limit is not enforced.\n   */\n  PE = 21,            // 0 to 1000000\n\n  /*\n   * When true, an error will be thrown if a primitive number is passed to the Big constructor,\n   * or if valueOf is called, or if toNumber is called on a Big which cannot be converted to a\n   * primitive number without a loss of precision.\n   */\n  STRICT = false,     // true or false\n\n\n/**************************************************************************************************/\n\n\n  // Error messages.\n  NAME = '[big.js] ',\n  INVALID = NAME + 'Invalid ',\n  INVALID_DP = INVALID + 'decimal places',\n  INVALID_RM = INVALID + 'rounding mode',\n  DIV_BY_ZERO = NAME + 'Division by zero',\n\n  // The shared prototype object.\n  P = {},\n  UNDEFINED = void 0,\n  NUMERIC = /^-?(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?$/i;\n\n\n/*\n * Create and return a Big constructor.\n */\nfunction _Big_() {\n\n  /*\n   * The Big constructor and exported function.\n   * Create and return a new instance of a Big number object.\n   *\n   * n {number|string|Big} A numeric value.\n   */\n  function Big(n) {\n    var x = this;\n\n    // Enable constructor usage without new.\n    if (!(x instanceof Big)) return n === UNDEFINED ? _Big_() : new Big(n);\n\n    // Duplicate.\n    if (n instanceof Big) {\n      x.s = n.s;\n      x.e = n.e;\n      x.c = n.c.slice();\n    } else {\n      if (typeof n !== 'string') {\n        if (Big.strict === true && typeof n !== 'bigint') {\n          throw TypeError(INVALID + 'value');\n        }\n\n        // Minus zero?\n        n = n === 0 && 1 / n < 0 ? '-0' : String(n);\n      }\n\n      parse(x, n);\n    }\n\n    // Retain a reference to this Big constructor.\n    // Shadow Big.prototype.constructor which points to Object.\n    x.constructor = Big;\n  }\n\n  Big.prototype = P;\n  Big.DP = DP;\n  Big.RM = RM;\n  Big.NE = NE;\n  Big.PE = PE;\n  Big.strict = STRICT;\n  Big.roundDown = 0;\n  Big.roundHalfUp = 1;\n  Big.roundHalfEven = 2;\n  Big.roundUp = 3;\n\n  return Big;\n}\n\n\n/*\n * Parse the number or string value passed to a Big constructor.\n *\n * x {Big} A Big number instance.\n * n {number|string} A numeric value.\n */\nfunction parse(x, n) {\n  var e, i, nl;\n\n  if (!NUMERIC.test(n)) {\n    throw Error(INVALID + 'number');\n  }\n\n  // Determine sign.\n  x.s = n.charAt(0) == '-' ? (n = n.slice(1), -1) : 1;\n\n  // Decimal point?\n  if ((e = n.indexOf('.')) > -1) n = n.replace('.', '');\n\n  // Exponential form?\n  if ((i = n.search(/e/i)) > 0) {\n\n    // Determine exponent.\n    if (e < 0) e = i;\n    e += +n.slice(i + 1);\n    n = n.substring(0, i);\n  } else if (e < 0) {\n\n    // Integer.\n    e = n.length;\n  }\n\n  nl = n.length;\n\n  // Determine leading zeros.\n  for (i = 0; i < nl && n.charAt(i) == '0';) ++i;\n\n  if (i == nl) {\n\n    // Zero.\n    x.c = [x.e = 0];\n  } else {\n\n    // Determine trailing zeros.\n    for (; nl > 0 && n.charAt(--nl) == '0';);\n    x.e = e - i - 1;\n    x.c = [];\n\n    // Convert string to array of digits without leading/trailing zeros.\n    for (e = 0; i <= nl;) x.c[e++] = +n.charAt(i++);\n  }\n\n  return x;\n}\n\n\n/*\n * Round Big x to a maximum of sd significant digits using rounding mode rm.\n *\n * x {Big} The Big to round.\n * sd {number} Significant digits: integer, 0 to MAX_DP inclusive.\n * rm {number} Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).\n * [more] {boolean} Whether the result of division was truncated.\n */\nfunction round(x, sd, rm, more) {\n  var xc = x.c;\n\n  if (rm === UNDEFINED) rm = x.constructor.RM;\n  if (rm !== 0 && rm !== 1 && rm !== 2 && rm !== 3) {\n    throw Error(INVALID_RM);\n  }\n\n  if (sd < 1) {\n    more =\n      rm === 3 && (more || !!xc[0]) || sd === 0 && (\n      rm === 1 && xc[0] >= 5 ||\n      rm === 2 && (xc[0] > 5 || xc[0] === 5 && (more || xc[1] !== UNDEFINED))\n    );\n\n    xc.length = 1;\n\n    if (more) {\n\n      // 1, 0.1, 0.01, 0.001, 0.0001 etc.\n      x.e = x.e - sd + 1;\n      xc[0] = 1;\n    } else {\n\n      // Zero.\n      xc[0] = x.e = 0;\n    }\n  } else if (sd < xc.length) {\n\n    // xc[sd] is the digit after the digit that may be rounded up.\n    more =\n      rm === 1 && xc[sd] >= 5 ||\n      rm === 2 && (xc[sd] > 5 || xc[sd] === 5 &&\n        (more || xc[sd + 1] !== UNDEFINED || xc[sd - 1] & 1)) ||\n      rm === 3 && (more || !!xc[0]);\n\n    // Remove any digits after the required precision.\n    xc.length = sd;\n\n    // Round up?\n    if (more) {\n\n      // Rounding up may mean the previous digit has to be rounded up.\n      for (; ++xc[--sd] > 9;) {\n        xc[sd] = 0;\n        if (sd === 0) {\n          ++x.e;\n          xc.unshift(1);\n          break;\n        }\n      }\n    }\n\n    // Remove trailing zeros.\n    for (sd = xc.length; !xc[--sd];) xc.pop();\n  }\n\n  return x;\n}\n\n\n/*\n * Return a string representing the value of Big x in normal or exponential notation.\n * Handles P.toExponential, P.toFixed, P.toJSON, P.toPrecision, P.toString and P.valueOf.\n */\nfunction stringify(x, doExponential, isNonzero) {\n  var e = x.e,\n    s = x.c.join(''),\n    n = s.length;\n\n  // Exponential notation?\n  if (doExponential) {\n    s = s.charAt(0) + (n > 1 ? '.' + s.slice(1) : '') + (e < 0 ? 'e' : 'e+') + e;\n\n  // Normal notation.\n  } else if (e < 0) {\n    for (; ++e;) s = '0' + s;\n    s = '0.' + s;\n  } else if (e > 0) {\n    if (++e > n) {\n      for (e -= n; e--;) s += '0';\n    } else if (e < n) {\n      s = s.slice(0, e) + '.' + s.slice(e);\n    }\n  } else if (n > 1) {\n    s = s.charAt(0) + '.' + s.slice(1);\n  }\n\n  return x.s < 0 && isNonzero ? '-' + s : s;\n}\n\n\n// Prototype/instance methods\n\n\n/*\n * Return a new Big whose value is the absolute value of this Big.\n */\nP.abs = function () {\n  var x = new this.constructor(this);\n  x.s = 1;\n  return x;\n};\n\n\n/*\n * Return 1 if the value of this Big is greater than the value of Big y,\n *       -1 if the value of this Big is less than the value of Big y, or\n *        0 if they have the same value.\n */\nP.cmp = function (y) {\n  var isneg,\n    x = this,\n    xc = x.c,\n    yc = (y = new x.constructor(y)).c,\n    i = x.s,\n    j = y.s,\n    k = x.e,\n    l = y.e;\n\n  // Either zero?\n  if (!xc[0] || !yc[0]) return !xc[0] ? !yc[0] ? 0 : -j : i;\n\n  // Signs differ?\n  if (i != j) return i;\n\n  isneg = i < 0;\n\n  // Compare exponents.\n  if (k != l) return k > l ^ isneg ? 1 : -1;\n\n  j = (k = xc.length) < (l = yc.length) ? k : l;\n\n  // Compare digit by digit.\n  for (i = -1; ++i < j;) {\n    if (xc[i] != yc[i]) return xc[i] > yc[i] ^ isneg ? 1 : -1;\n  }\n\n  // Compare lengths.\n  return k == l ? 0 : k > l ^ isneg ? 1 : -1;\n};\n\n\n/*\n * Return a new Big whose value is the value of this Big divided by the value of Big y, rounded,\n * if necessary, to a maximum of Big.DP decimal places using rounding mode Big.RM.\n */\nP.div = function (y) {\n  var x = this,\n    Big = x.constructor,\n    a = x.c,                  // dividend\n    b = (y = new Big(y)).c,   // divisor\n    k = x.s == y.s ? 1 : -1,\n    dp = Big.DP;\n\n  if (dp !== ~~dp || dp < 0 || dp > MAX_DP) {\n    throw Error(INVALID_DP);\n  }\n\n  // Divisor is zero?\n  if (!b[0]) {\n    throw Error(DIV_BY_ZERO);\n  }\n\n  // Dividend is 0? Return +-0.\n  if (!a[0]) {\n    y.s = k;\n    y.c = [y.e = 0];\n    return y;\n  }\n\n  var bl, bt, n, cmp, ri,\n    bz = b.slice(),\n    ai = bl = b.length,\n    al = a.length,\n    r = a.slice(0, bl),   // remainder\n    rl = r.length,\n    q = y,                // quotient\n    qc = q.c = [],\n    qi = 0,\n    p = dp + (q.e = x.e - y.e) + 1;    // precision of the result\n\n  q.s = k;\n  k = p < 0 ? 0 : p;\n\n  // Create version of divisor with leading zero.\n  bz.unshift(0);\n\n  // Add zeros to make remainder as long as divisor.\n  for (; rl++ < bl;) r.push(0);\n\n  do {\n\n    // n is how many times the divisor goes into current remainder.\n    for (n = 0; n < 10; n++) {\n\n      // Compare divisor and remainder.\n      if (bl != (rl = r.length)) {\n        cmp = bl > rl ? 1 : -1;\n      } else {\n        for (ri = -1, cmp = 0; ++ri < bl;) {\n          if (b[ri] != r[ri]) {\n            cmp = b[ri] > r[ri] ? 1 : -1;\n            break;\n          }\n        }\n      }\n\n      // If divisor < remainder, subtract divisor from remainder.\n      if (cmp < 0) {\n\n        // Remainder can't be more than 1 digit longer than divisor.\n        // Equalise lengths using divisor with extra leading zero?\n        for (bt = rl == bl ? b : bz; rl;) {\n          if (r[--rl] < bt[rl]) {\n            ri = rl;\n            for (; ri && !r[--ri];) r[ri] = 9;\n            --r[ri];\n            r[rl] += 10;\n          }\n          r[rl] -= bt[rl];\n        }\n\n        for (; !r[0];) r.shift();\n      } else {\n        break;\n      }\n    }\n\n    // Add the digit n to the result array.\n    qc[qi++] = cmp ? n : ++n;\n\n    // Update the remainder.\n    if (r[0] && cmp) r[rl] = a[ai] || 0;\n    else r = [a[ai]];\n\n  } while ((ai++ < al || r[0] !== UNDEFINED) && k--);\n\n  // Leading zero? Do not remove if result is simply zero (qi == 1).\n  if (!qc[0] && qi != 1) {\n\n    // There can't be more than one zero.\n    qc.shift();\n    q.e--;\n    p--;\n  }\n\n  // Round?\n  if (qi > p) round(q, p, Big.RM, r[0] !== UNDEFINED);\n\n  return q;\n};\n\n\n/*\n * Return true if the value of this Big is equal to the value of Big y, otherwise return false.\n */\nP.eq = function (y) {\n  return this.cmp(y) === 0;\n};\n\n\n/*\n * Return true if the value of this Big is greater than the value of Big y, otherwise return\n * false.\n */\nP.gt = function (y) {\n  return this.cmp(y) > 0;\n};\n\n\n/*\n * Return true if the value of this Big is greater than or equal to the value of Big y, otherwise\n * return false.\n */\nP.gte = function (y) {\n  return this.cmp(y) > -1;\n};\n\n\n/*\n * Return true if the value of this Big is less than the value of Big y, otherwise return false.\n */\nP.lt = function (y) {\n  return this.cmp(y) < 0;\n};\n\n\n/*\n * Return true if the value of this Big is less than or equal to the value of Big y, otherwise\n * return false.\n */\nP.lte = function (y) {\n  return this.cmp(y) < 1;\n};\n\n\n/*\n * Return a new Big whose value is the value of this Big minus the value of Big y.\n */\nP.minus = P.sub = function (y) {\n  var i, j, t, xlty,\n    x = this,\n    Big = x.constructor,\n    a = x.s,\n    b = (y = new Big(y)).s;\n\n  // Signs differ?\n  if (a != b) {\n    y.s = -b;\n    return x.plus(y);\n  }\n\n  var xc = x.c.slice(),\n    xe = x.e,\n    yc = y.c,\n    ye = y.e;\n\n  // Either zero?\n  if (!xc[0] || !yc[0]) {\n    if (yc[0]) {\n      y.s = -b;\n    } else if (xc[0]) {\n      y = new Big(x);\n    } else {\n      y.s = 1;\n    }\n    return y;\n  }\n\n  // Determine which is the bigger number. Prepend zeros to equalise exponents.\n  if (a = xe - ye) {\n\n    if (xlty = a < 0) {\n      a = -a;\n      t = xc;\n    } else {\n      ye = xe;\n      t = yc;\n    }\n\n    t.reverse();\n    for (b = a; b--;) t.push(0);\n    t.reverse();\n  } else {\n\n    // Exponents equal. Check digit by digit.\n    j = ((xlty = xc.length < yc.length) ? xc : yc).length;\n\n    for (a = b = 0; b < j; b++) {\n      if (xc[b] != yc[b]) {\n        xlty = xc[b] < yc[b];\n        break;\n      }\n    }\n  }\n\n  // x < y? Point xc to the array of the bigger number.\n  if (xlty) {\n    t = xc;\n    xc = yc;\n    yc = t;\n    y.s = -y.s;\n  }\n\n  /*\n   * Append zeros to xc if shorter. No need to add zeros to yc if shorter as subtraction only\n   * needs to start at yc.length.\n   */\n  if ((b = (j = yc.length) - (i = xc.length)) > 0) for (; b--;) xc[i++] = 0;\n\n  // Subtract yc from xc.\n  for (b = i; j > a;) {\n    if (xc[--j] < yc[j]) {\n      for (i = j; i && !xc[--i];) xc[i] = 9;\n      --xc[i];\n      xc[j] += 10;\n    }\n\n    xc[j] -= yc[j];\n  }\n\n  // Remove trailing zeros.\n  for (; xc[--b] === 0;) xc.pop();\n\n  // Remove leading zeros and adjust exponent accordingly.\n  for (; xc[0] === 0;) {\n    xc.shift();\n    --ye;\n  }\n\n  if (!xc[0]) {\n\n    // n - n = +0\n    y.s = 1;\n\n    // Result must be zero.\n    xc = [ye = 0];\n  }\n\n  y.c = xc;\n  y.e = ye;\n\n  return y;\n};\n\n\n/*\n * Return a new Big whose value is the value of this Big modulo the value of Big y.\n */\nP.mod = function (y) {\n  var ygtx,\n    x = this,\n    Big = x.constructor,\n    a = x.s,\n    b = (y = new Big(y)).s;\n\n  if (!y.c[0]) {\n    throw Error(DIV_BY_ZERO);\n  }\n\n  x.s = y.s = 1;\n  ygtx = y.cmp(x) == 1;\n  x.s = a;\n  y.s = b;\n\n  if (ygtx) return new Big(x);\n\n  a = Big.DP;\n  b = Big.RM;\n  Big.DP = Big.RM = 0;\n  x = x.div(y);\n  Big.DP = a;\n  Big.RM = b;\n\n  return this.minus(x.times(y));\n};\n\n\n/*\n * Return a new Big whose value is the value of this Big negated.\n */\nP.neg = function () {\n  var x = new this.constructor(this);\n  x.s = -x.s;\n  return x;\n};\n\n\n/*\n * Return a new Big whose value is the value of this Big plus the value of Big y.\n */\nP.plus = P.add = function (y) {\n  var e, k, t,\n    x = this,\n    Big = x.constructor;\n\n  y = new Big(y);\n\n  // Signs differ?\n  if (x.s != y.s) {\n    y.s = -y.s;\n    return x.minus(y);\n  }\n\n  var xe = x.e,\n    xc = x.c,\n    ye = y.e,\n    yc = y.c;\n\n  // Either zero?\n  if (!xc[0] || !yc[0]) {\n    if (!yc[0]) {\n      if (xc[0]) {\n        y = new Big(x);\n      } else {\n        y.s = x.s;\n      }\n    }\n    return y;\n  }\n\n  xc = xc.slice();\n\n  // Prepend zeros to equalise exponents.\n  // Note: reverse faster than unshifts.\n  if (e = xe - ye) {\n    if (e > 0) {\n      ye = xe;\n      t = yc;\n    } else {\n      e = -e;\n      t = xc;\n    }\n\n    t.reverse();\n    for (; e--;) t.push(0);\n    t.reverse();\n  }\n\n  // Point xc to the longer array.\n  if (xc.length - yc.length < 0) {\n    t = yc;\n    yc = xc;\n    xc = t;\n  }\n\n  e = yc.length;\n\n  // Only start adding at yc.length - 1 as the further digits of xc can be left as they are.\n  for (k = 0; e; xc[e] %= 10) k = (xc[--e] = xc[e] + yc[e] + k) / 10 | 0;\n\n  // No need to check for zero, as +x + +y != 0 && -x + -y != 0\n\n  if (k) {\n    xc.unshift(k);\n    ++ye;\n  }\n\n  // Remove trailing zeros.\n  for (e = xc.length; xc[--e] === 0;) xc.pop();\n\n  y.c = xc;\n  y.e = ye;\n\n  return y;\n};\n\n\n/*\n * Return a Big whose value is the value of this Big raised to the power n.\n * If n is negative, round to a maximum of Big.DP decimal places using rounding\n * mode Big.RM.\n *\n * n {number} Integer, -MAX_POWER to MAX_POWER inclusive.\n */\nP.pow = function (n) {\n  var x = this,\n    one = new x.constructor('1'),\n    y = one,\n    isneg = n < 0;\n\n  if (n !== ~~n || n < -MAX_POWER || n > MAX_POWER) {\n    throw Error(INVALID + 'exponent');\n  }\n\n  if (isneg) n = -n;\n\n  for (;;) {\n    if (n & 1) y = y.times(x);\n    n >>= 1;\n    if (!n) break;\n    x = x.times(x);\n  }\n\n  return isneg ? one.div(y) : y;\n};\n\n\n/*\n * Return a new Big whose value is the value of this Big rounded to a maximum precision of sd\n * significant digits using rounding mode rm, or Big.RM if rm is not specified.\n *\n * sd {number} Significant digits: integer, 1 to MAX_DP inclusive.\n * rm? {number} Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).\n */\nP.prec = function (sd, rm) {\n  if (sd !== ~~sd || sd < 1 || sd > MAX_DP) {\n    throw Error(INVALID + 'precision');\n  }\n  return round(new this.constructor(this), sd, rm);\n};\n\n\n/*\n * Return a new Big whose value is the value of this Big rounded to a maximum of dp decimal places\n * using rounding mode rm, or Big.RM if rm is not specified.\n * If dp is negative, round to an integer which is a multiple of 10**-dp.\n * If dp is not specified, round to 0 decimal places.\n *\n * dp? {number} Integer, -MAX_DP to MAX_DP inclusive.\n * rm? {number} Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).\n */\nP.round = function (dp, rm) {\n  if (dp === UNDEFINED) dp = 0;\n  else if (dp !== ~~dp || dp < -MAX_DP || dp > MAX_DP) {\n    throw Error(INVALID_DP);\n  }\n  return round(new this.constructor(this), dp + this.e + 1, rm);\n};\n\n\n/*\n * Return a new Big whose value is the square root of the value of this Big, rounded, if\n * necessary, to a maximum of Big.DP decimal places using rounding mode Big.RM.\n */\nP.sqrt = function () {\n  var r, c, t,\n    x = this,\n    Big = x.constructor,\n    s = x.s,\n    e = x.e,\n    half = new Big('0.5');\n\n  // Zero?\n  if (!x.c[0]) return new Big(x);\n\n  // Negative?\n  if (s < 0) {\n    throw Error(NAME + 'No square root');\n  }\n\n  // Estimate.\n  s = Math.sqrt(x + '');\n\n  // Math.sqrt underflow/overflow?\n  // Re-estimate: pass x coefficient to Math.sqrt as integer, then adjust the result exponent.\n  if (s === 0 || s === 1 / 0) {\n    c = x.c.join('');\n    if (!(c.length + e & 1)) c += '0';\n    s = Math.sqrt(c);\n    e = ((e + 1) / 2 | 0) - (e < 0 || e & 1);\n    r = new Big((s == 1 / 0 ? '5e' : (s = s.toExponential()).slice(0, s.indexOf('e') + 1)) + e);\n  } else {\n    r = new Big(s + '');\n  }\n\n  e = r.e + (Big.DP += 4);\n\n  // Newton-Raphson iteration.\n  do {\n    t = r;\n    r = half.times(t.plus(x.div(t)));\n  } while (t.c.slice(0, e).join('') !== r.c.slice(0, e).join(''));\n\n  return round(r, (Big.DP -= 4) + r.e + 1, Big.RM);\n};\n\n\n/*\n * Return a new Big whose value is the value of this Big times the value of Big y.\n */\nP.times = P.mul = function (y) {\n  var c,\n    x = this,\n    Big = x.constructor,\n    xc = x.c,\n    yc = (y = new Big(y)).c,\n    a = xc.length,\n    b = yc.length,\n    i = x.e,\n    j = y.e;\n\n  // Determine sign of result.\n  y.s = x.s == y.s ? 1 : -1;\n\n  // Return signed 0 if either 0.\n  if (!xc[0] || !yc[0]) {\n    y.c = [y.e = 0];\n    return y;\n  }\n\n  // Initialise exponent of result as x.e + y.e.\n  y.e = i + j;\n\n  // If array xc has fewer digits than yc, swap xc and yc, and lengths.\n  if (a < b) {\n    c = xc;\n    xc = yc;\n    yc = c;\n    j = a;\n    a = b;\n    b = j;\n  }\n\n  // Initialise coefficient array of result with zeros.\n  for (c = new Array(j = a + b); j--;) c[j] = 0;\n\n  // Multiply.\n\n  // i is initially xc.length.\n  for (i = b; i--;) {\n    b = 0;\n\n    // a is yc.length.\n    for (j = a + i; j > i;) {\n\n      // Current sum of products at this digit position, plus carry.\n      b = c[j] + yc[i] * xc[j - i - 1] + b;\n      c[j--] = b % 10;\n\n      // carry\n      b = b / 10 | 0;\n    }\n\n    c[j] = b;\n  }\n\n  // Increment result exponent if there is a final carry, otherwise remove leading zero.\n  if (b) ++y.e;\n  else c.shift();\n\n  // Remove trailing zeros.\n  for (i = c.length; !c[--i];) c.pop();\n  y.c = c;\n\n  return y;\n};\n\n\n/*\n * Return a string representing the value of this Big in exponential notation rounded to dp fixed\n * decimal places using rounding mode rm, or Big.RM if rm is not specified.\n *\n * dp? {number} Decimal places: integer, 0 to MAX_DP inclusive.\n * rm? {number} Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).\n */\nP.toExponential = function (dp, rm) {\n  var x = this,\n    n = x.c[0];\n\n  if (dp !== UNDEFINED) {\n    if (dp !== ~~dp || dp < 0 || dp > MAX_DP) {\n      throw Error(INVALID_DP);\n    }\n    x = round(new x.constructor(x), ++dp, rm);\n    for (; x.c.length < dp;) x.c.push(0);\n  }\n\n  return stringify(x, true, !!n);\n};\n\n\n/*\n * Return a string representing the value of this Big in normal notation rounded to dp fixed\n * decimal places using rounding mode rm, or Big.RM if rm is not specified.\n *\n * dp? {number} Decimal places: integer, 0 to MAX_DP inclusive.\n * rm? {number} Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).\n *\n * (-0).toFixed(0) is '0', but (-0.1).toFixed(0) is '-0'.\n * (-0).toFixed(1) is '0.0', but (-0.01).toFixed(1) is '-0.0'.\n */\nP.toFixed = function (dp, rm) {\n  var x = this,\n    n = x.c[0];\n\n  if (dp !== UNDEFINED) {\n    if (dp !== ~~dp || dp < 0 || dp > MAX_DP) {\n      throw Error(INVALID_DP);\n    }\n    x = round(new x.constructor(x), dp + x.e + 1, rm);\n\n    // x.e may have changed if the value is rounded up.\n    for (dp = dp + x.e + 1; x.c.length < dp;) x.c.push(0);\n  }\n\n  return stringify(x, false, !!n);\n};\n\n\n/*\n * Return a string representing the value of this Big.\n * Return exponential notation if this Big has a positive exponent equal to or greater than\n * Big.PE, or a negative exponent equal to or less than Big.NE.\n * Omit the sign for negative zero.\n */\nP[Symbol.for('nodejs.util.inspect.custom')] = P.toJSON = P.toString = function () {\n  var x = this,\n    Big = x.constructor;\n  return stringify(x, x.e <= Big.NE || x.e >= Big.PE, !!x.c[0]);\n};\n\n\n/*\n * Return the value of this Big as a primitve number.\n */\nP.toNumber = function () {\n  var n = Number(stringify(this, true, true));\n  if (this.constructor.strict === true && !this.eq(n.toString())) {\n    throw Error(NAME + 'Imprecise conversion');\n  }\n  return n;\n};\n\n\n/*\n * Return a string representing the value of this Big rounded to sd significant digits using\n * rounding mode rm, or Big.RM if rm is not specified.\n * Use exponential notation if sd is less than the number of digits necessary to represent\n * the integer part of the value in normal notation.\n *\n * sd {number} Significant digits: integer, 1 to MAX_DP inclusive.\n * rm? {number} Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).\n */\nP.toPrecision = function (sd, rm) {\n  var x = this,\n    Big = x.constructor,\n    n = x.c[0];\n\n  if (sd !== UNDEFINED) {\n    if (sd !== ~~sd || sd < 1 || sd > MAX_DP) {\n      throw Error(INVALID + 'precision');\n    }\n    x = round(new Big(x), sd, rm);\n    for (; x.c.length < sd;) x.c.push(0);\n  }\n\n  return stringify(x, sd <= x.e || x.e <= Big.NE || x.e >= Big.PE, !!n);\n};\n\n\n/*\n * Return a string representing the value of this Big.\n * Return exponential notation if this Big has a positive exponent equal to or greater than\n * Big.PE, or a negative exponent equal to or less than Big.NE.\n * Include the sign for negative zero.\n */\nP.valueOf = function () {\n  var x = this,\n    Big = x.constructor;\n  if (Big.strict === true) {\n    throw Error(NAME + 'valueOf disallowed');\n  }\n  return stringify(x, x.e <= Big.NE || x.e >= Big.PE, true);\n};\n\n\n// Export\n\n\nexport var Big = _Big_();\n\n/// <reference types=\"https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/big.js/index.d.ts\" />\nexport default Big;\n","import { TONCOIN } from '../config';\nimport { Big } from '../lib/big.js';\n\nBig.RM = 0; // RoundDown\nBig.NE = -100000; // Disable exponential form\nBig.PE = 100000; // Disable exponential form\n\nconst ten = Big(10);\n\nexport function fromDecimal(value: string | number, decimals?: number) {\n  return BigInt(Big(value).mul(ten.pow(decimals ?? TONCOIN.decimals)).round().toString());\n}\n\nexport function toDecimal(value: bigint | number, decimals?: number, noFloor = false) {\n  return toBig(value, decimals ?? TONCOIN.decimals, noFloor).toString();\n}\n\nexport function toBig(value: bigint | number, decimals: number = TONCOIN.decimals, noFloor = false) {\n  return Big(value.toString()).div(ten.pow(decimals)).round(decimals, noFloor ? Big.roundHalfUp : undefined);\n}\n\nexport function roundDecimal(value: string, decimals: number) {\n  return Big(value).round(decimals).toString();\n}\n","export function random(min: number, max: number) {\n  return Math.floor(Math.random() * (max - min + 1) + min);\n}\n\nexport function sample<T extends any>(arr: T[]) {\n  return arr[random(0, arr.length - 1)];\n}\n\nexport function randomBytes(size: number) {\n  // eslint-disable-next-line no-restricted-globals\n  return self.crypto.getRandomValues(new Uint8Array(size));\n}\n","import { ONE_TON } from '../config';\nimport { fromDecimal } from './decimals';\nimport { randomBytes } from './random';\n\nexport const BIGINT_PREFIX = 'bigint:';\n\nexport function bigintReviver(this: any, key: string, value: any) {\n  if (typeof value === 'string' && value.startsWith(BIGINT_PREFIX)) {\n    return BigInt(value.slice(7));\n  }\n  return value;\n}\n\nexport function bigintAbs(value: bigint) {\n  return value === -0n || value < 0n ? -value : value;\n}\n\nexport function bigintSum(values: bigint[]) {\n  let result = 0n;\n  for (const value of values) result += value;\n  return result;\n}\n\nexport function bigintDivideToNumber(value: bigint, num: number) {\n  return (value * ONE_TON) / fromDecimal(num);\n}\n\nexport function bigintMultiplyToNumber(value: bigint, num: number) {\n  return (value * fromDecimal(num)) / ONE_TON;\n}\n\nexport function bigintRandom(bytes: number) {\n  let value = BigInt(0);\n  for (const randomNumber of randomBytes(bytes)) {\n    const randomBigInt = BigInt(randomNumber);\n    // eslint-disable-next-line no-bitwise\n    value = (value << BigInt(8)) + randomBigInt;\n  }\n  return value;\n}\n\nexport function bigintCountBits(value: bigint) {\n  const binaryString = value.toString(2);\n  return binaryString.length;\n}\n\nexport function bigintMax(value0: bigint, value1: bigint) {\n  return value0 > value1 ? value0 : value1;\n}\n\nexport function bigintMin(value0: bigint, value1: bigint) {\n  return value0 < value1 ? value0 : value1;\n}\n\nexport function bigintMultiplePercent(value: bigint, percent: number) {\n  return (value * fromDecimal(percent / 100)) / ONE_TON;\n}\n","import type {\n  ApiUpdate,\n  CancellableCallback, OriginMessageData, OriginMessageEvent, WorkerMessageData,\n} from './PostMessageConnector';\n\nimport { DETACHED_TAB_URL } from './ledger/tab';\nimport { bigintReviver } from './bigint';\nimport { logDebugError } from './logs';\n\ndeclare const self: WorkerGlobalScope;\n\nconst callbackState = new Map<string, CancellableCallback>();\n\ntype ApiConfig =\n  ((name: string, ...args: any[]) => any | [any, ArrayBuffer[]])\n  | Record<string, Function>;\ntype SendToOrigin = (data: WorkerMessageData, transferables?: Transferable[]) => void;\n\nexport function createPostMessageInterface(\n  api: ApiConfig,\n  channel?: string,\n  target: DedicatedWorkerGlobalScope | Worker = self as DedicatedWorkerGlobalScope,\n  shouldIgnoreErrors?: boolean,\n) {\n  function sendToOrigin(data: WorkerMessageData, transferables?: Transferable[]) {\n    data.channel = channel;\n\n    if (transferables) {\n      target.postMessage(data, transferables);\n    } else {\n      target.postMessage(data);\n    }\n  }\n\n  if (!shouldIgnoreErrors) {\n    handleErrors(sendToOrigin);\n  }\n\n  (target as DedicatedWorkerGlobalScope).addEventListener('message', (message: OriginMessageEvent) => {\n    if (message.data?.channel === channel) {\n      void onMessage(api, message.data, sendToOrigin);\n    }\n  });\n}\n\nexport function createExtensionInterface(\n  portName: string,\n  api: ApiConfig,\n  channel?: string,\n  cleanUpdater?: (onUpdate: (update: ApiUpdate) => void) => void,\n  withAutoInit = false,\n) {\n  chrome.runtime.onConnect.addListener((port) => {\n    if (port.name !== portName) {\n      return;\n    }\n\n    /**\n     * If the sender's URL includes the DETACHED_TAB_URL, we skip further processing\n     * This condition ensures that we don't interact with tabs that have already been closed.\n     */\n    const url = port.sender?.url;\n    if (url?.includes(DETACHED_TAB_URL)) {\n      return;\n    }\n\n    const origin = url ? new URL(url).origin : undefined;\n\n    const dAppUpdater = (update: ApiUpdate) => {\n      sendToOrigin({\n        type: 'update',\n        update,\n      });\n    };\n\n    function sendToOrigin(data: WorkerMessageData) {\n      data.channel = channel;\n      const json = JSON.stringify(data);\n      port.postMessage(json);\n    }\n\n    handleErrors(sendToOrigin);\n\n    port.onMessage.addListener((data: OriginMessageData | string) => {\n      if (typeof data === 'string') {\n        data = JSON.parse(data, bigintReviver) as OriginMessageData;\n      }\n      if (data.channel === channel) {\n        void onMessage(api, data, sendToOrigin, dAppUpdater, origin);\n      }\n    });\n\n    port.onDisconnect.addListener(() => {\n      cleanUpdater?.(dAppUpdater);\n    });\n\n    if (withAutoInit) {\n      void onMessage(api, { type: 'init', name: 'init', args: [] }, sendToOrigin, dAppUpdater);\n    }\n  });\n}\n\nasync function onMessage(\n  api: ApiConfig,\n  data: OriginMessageData,\n  sendToOrigin: SendToOrigin,\n  onUpdate?: (update: ApiUpdate) => void,\n  origin?: string,\n) {\n  if (!onUpdate) {\n    onUpdate = (update: ApiUpdate) => {\n      sendToOrigin({\n        type: 'update',\n        update,\n      });\n    };\n  }\n\n  switch (data.type) {\n    case 'init': {\n      const { args } = data;\n      const promise = typeof api === 'function'\n        ? api('init', origin, onUpdate, ...args)\n        : api.init?.(onUpdate, ...args);\n      await promise;\n\n      break;\n    }\n    case 'callMethod': {\n      const {\n        messageId, name, args, withCallback,\n      } = data;\n      try {\n        // This method is probably from another worker\n        if (typeof api !== 'function' && !api[name]) return;\n\n        if (messageId && withCallback) {\n          const callback = (...callbackArgs: any[]) => {\n            const lastArg = callbackArgs[callbackArgs.length - 1];\n\n            sendToOrigin({\n              type: 'methodCallback',\n              messageId,\n              callbackArgs,\n            }, isTransferable(lastArg) ? [lastArg] : undefined);\n          };\n\n          callbackState.set(messageId, callback);\n\n          args.push(callback as never);\n        }\n\n        const response = typeof api === 'function'\n          ? await api(name, origin, ...args)\n          : await api[name](...args);\n        const { arrayBuffer } = (typeof response === 'object' && response && 'arrayBuffer' in response) || {};\n\n        if (messageId) {\n          sendToOrigin(\n            {\n              type: 'methodResponse',\n              messageId,\n              response,\n            },\n            arrayBuffer ? [arrayBuffer] : undefined,\n          );\n        }\n      } catch (err: any) {\n        logDebugError(name, err);\n\n        if (messageId) {\n          sendToOrigin({\n            type: 'methodResponse',\n            messageId,\n            error: { message: err.message },\n          });\n        }\n      }\n\n      if (messageId) {\n        callbackState.delete(messageId);\n      }\n\n      break;\n    }\n    case 'cancelProgress': {\n      const callback = callbackState.get(data.messageId);\n      if (callback) {\n        callback.isCanceled = true;\n      }\n\n      break;\n    }\n  }\n}\n\nfunction isTransferable(obj: any) {\n  return obj instanceof ArrayBuffer || obj instanceof ImageBitmap;\n}\n\nfunction handleErrors(sendToOrigin: SendToOrigin) {\n  self.onerror = (e) => {\n    const message = e.error?.message || 'Uncaught exception in worker';\n    logDebugError(message, e.error);\n\n    sendToOrigin({\n      type: 'unhandledError',\n      error: {\n        message,\n        stack: e.error?.stack,\n      },\n    });\n  };\n\n  self.addEventListener('unhandledrejection', (e) => {\n    const message = e.reason?.message || 'Unhandled rejection in worker';\n    logDebugError(message, e.reason);\n\n    sendToOrigin({\n      type: 'unhandledError',\n      error: {\n        message,\n        stack: e.reason?.stack,\n      },\n    });\n  });\n}\n","import { BIGINT_PREFIX } from './bigint';\n\n// Fixes serialization of objects containing `bigint` values.\n// Extracted to a separate file to avoid leaking into Extension Page Script.\n// @ts-ignore\nBigInt.prototype.toJSON = function toJSON() {\n  return `${BIGINT_PREFIX}${this}`;\n};\n","import type { AccountIdParsed, ApiNetwork } from '../api/types';\n\nexport function parseAccountId(accountId: string): AccountIdParsed {\n  const parts = accountId.split('-');\n  const [id, network = 'mainnet'] = (parts.length === 3 ? [parts[0], parts[2]] : parts) as [string, ApiNetwork];\n  return { id: Number(id), network };\n}\n\nexport function buildAccountId(account: AccountIdParsed) {\n  const { id, network } = account;\n  return `${id}-${network}`;\n}\n","import { PRIVATE_KEY_HEX_LENGTH } from '../config';\n\nexport default function isMnemonicPrivateKey(mnemonic: string[]) {\n  return mnemonic.length === 1 && mnemonic[0].length === PRIVATE_KEY_HEX_LENGTH;\n}\n","import createHmac from 'create-hmac';\nimport * as nacl from 'tweetnacl';\n\ntype Hex = string;\ntype Path = string;\n\ntype Keys = {\n  key: Buffer;\n  chainCode: Buffer;\n};\n\nconst ED25519_CURVE = 'ed25519 seed';\nconst HARDENED_OFFSET = 0x80000000;\n\nconst pathRegex = /^m(\\/[0-9]+')+$/;\nfunction replaceDerive(val: string) {\n  return val.replace(\"'\", '');\n}\n\nexport const getMasterKeyFromSeed = (seed: Hex): Keys => {\n  const hmac = createHmac('sha512', ED25519_CURVE);\n  const I = hmac.update(Buffer.from(seed, 'hex')).digest();\n  const IL = I.slice(0, 32);\n  const IR = I.slice(32);\n  return {\n    key: IL,\n    chainCode: IR,\n  };\n};\n\nexport const CKDPriv = ({ key, chainCode }: Keys, index: number): Keys => {\n  const indexBuffer = Buffer.allocUnsafe(4);\n  indexBuffer.writeUInt32BE(index, 0);\n\n  const data = Buffer.concat([Buffer.alloc(1, 0), key, indexBuffer]);\n\n  const I = createHmac('sha512', chainCode)\n    .update(data)\n    .digest();\n  const IL = I.slice(0, 32);\n  const IR = I.slice(32);\n  return {\n    key: IL,\n    chainCode: IR,\n  };\n};\n\nexport const getPublicKey = (privateKey: Buffer, withZeroByte = true): Buffer => {\n  const keyPair = nacl.sign.keyPair.fromSeed(privateKey);\n  const signPk = keyPair.secretKey.subarray(32);\n  const zero = Buffer.alloc(1, 0);\n  return withZeroByte\n    ? Buffer.concat([zero, Buffer.from(signPk)])\n    : Buffer.from(signPk);\n};\n\nexport const isValidPath = (path: string): boolean => {\n  if (!pathRegex.test(path)) {\n    return false;\n  }\n  return !path\n    .split('/')\n    .slice(1)\n    .map(replaceDerive)\n    // eslint-disable-next-line no-restricted-globals\n    .some(isNaN as any);\n};\n\nexport const derivePath = (path: Path, seed: Hex, offset = HARDENED_OFFSET): Keys => {\n  if (!isValidPath(path)) {\n    throw new Error('Invalid derivation path');\n  }\n\n  const { key, chainCode } = getMasterKeyFromSeed(seed);\n  const segments = path\n    .split('/')\n    .slice(1)\n    .map(replaceDerive)\n    .map((el) => parseInt(el, 10));\n\n  return segments.reduce(\n    (parentKeys, segment) => CKDPriv(parentKeys, segment + offset),\n    { key, chainCode },\n  );\n};\n","import { IS_CORE_WALLET, TON_DNS_ZONES } from '../config';\n\nexport function isDnsDomain(value: string) {\n  return getDnsDomainZone(value) !== undefined;\n}\n\nexport function getDnsDomainZone(domain: string) {\n  for (const zone of TON_DNS_ZONES) {\n    const { suffixes, baseFormat, isUnofficial } = zone;\n\n    if (IS_CORE_WALLET && isUnofficial) {\n      continue;\n    }\n\n    // Iterating the zones in reverse to prioritize longer zones when multiple zones match (assuming the zones go from\n    // the shortest to the longest). For example, `test.ton.vip` matches both `vip` and `ton.vip`, and `ton.vip` must be\n    // used.\n    for (let i = suffixes.length - 1; i >= 0; i--) {\n      const suffix = suffixes[i];\n      if (!domain.endsWith(`.${suffix}`)) {\n        continue;\n      }\n\n      const base = domain.slice(0, -suffix.length - 1);\n      if (!baseFormat.test(base)) {\n        continue;\n      }\n\n      return { base, zone };\n    }\n  }\n\n  return undefined;\n}\n\nexport function getDnsZoneByCollection(collectionAddress: string) {\n  if (IS_CORE_WALLET) {\n    return TON_DNS_ZONES.find((zone) => zone.resolver === collectionAddress && !zone.isUnofficial);\n  }\n  return TON_DNS_ZONES.find((zone) => zone.resolver === collectionAddress);\n}\n","type CollectionByKey<Member> = Record<number | string, Member>;\ntype GroupedByKey<Member> = Record<number | string, Member[]>;\n\ntype OrderDirection =\n  'asc'\n  | 'desc';\n\ninterface OrderCallback<T> {\n  (member: T): any;\n}\n\nexport function buildCollectionByKey<T extends AnyLiteral>(collection: T[], key: keyof T): CollectionByKey<T> {\n  return collection.reduce((byKey: CollectionByKey<T>, member: T) => {\n    byKey[member[key]] = member;\n\n    return byKey;\n  }, {});\n}\n\nexport function groupBy<T extends AnyLiteral>(collection: T[], key: keyof T): GroupedByKey<T> {\n  return collection.reduce((byKey: GroupedByKey<T>, member: T) => {\n    const groupKey = member[key];\n\n    if (!byKey[groupKey]) {\n      byKey[groupKey] = [member];\n    } else {\n      byKey[groupKey]!.push(member);\n    }\n\n    return byKey;\n  }, {});\n}\n\nexport function mapValues<R extends any, M extends any>(\n  byKey: CollectionByKey<M>,\n  callback: (member: M, key: string, index: number, originalByKey: CollectionByKey<M>) => R,\n): CollectionByKey<R> {\n  return Object.keys(byKey).reduce((newByKey: CollectionByKey<R>, key, index) => {\n    newByKey[key] = callback(byKey[key], key, index, byKey);\n    return newByKey;\n  }, {});\n}\n\nexport function pick<T, K extends keyof T>(object: T, keys: K[]) {\n  return keys.reduce((result, key) => {\n    result[key] = object[key];\n    return result;\n  }, {} as Pick<T, K>);\n}\n\nexport function pickTruthy<T, K extends keyof T>(object: T, keys: K[]) {\n  return keys.reduce((result, key) => {\n    if (object[key]) {\n      result[key] = object[key];\n    }\n\n    return result;\n  }, {} as Pick<T, K>);\n}\n\nexport function omit<T extends object, K extends keyof T>(object: T, keys: K[]): Omit<T, K> {\n  const stringKeys = new Set(keys.map(String));\n  const savedKeys = Object.keys(object)\n    .filter((key) => !stringKeys.has(key)) as Array<Exclude<keyof T, K>>;\n\n  return pick(object, savedKeys);\n}\n\nexport function omitUndefined<T extends object>(object: T): T {\n  return Object.keys(object).reduce((result, stringKey) => {\n    const key = stringKey as keyof T;\n    if (object[key] !== undefined) {\n      result[key as keyof T] = object[key];\n    }\n    return result;\n  }, {} as T);\n}\n\nexport function orderBy<T>(\n  collection: T[],\n  orderRule: (keyof T) | OrderCallback<T> | ((keyof T) | OrderCallback<T>)[],\n  mode: OrderDirection | [OrderDirection, OrderDirection] = 'asc',\n): T[] {\n  function compareValues(a: T, b: T, currentOrderRule: (keyof T) | OrderCallback<T>, isAsc: boolean) {\n    const aValue = (typeof currentOrderRule === 'function' ? currentOrderRule(a) : a[currentOrderRule]) || 0;\n    const bValue = (typeof currentOrderRule === 'function' ? currentOrderRule(b) : b[currentOrderRule]) || 0;\n\n    if (aValue === bValue) return 0;\n\n    const condition = isAsc ? aValue > bValue : aValue < bValue;\n    return condition ? 1 : -1;\n  }\n\n  if (Array.isArray(orderRule)) {\n    const [mode1, mode2] = Array.isArray(mode) ? mode : [mode, mode];\n    const [orderRule1, orderRule2] = orderRule;\n    const isAsc1 = mode1 === 'asc';\n    const isAsc2 = mode2 === 'asc';\n\n    return collection.sort((a, b) => {\n      return compareValues(a, b, orderRule1, isAsc1) || compareValues(a, b, orderRule2, isAsc2);\n    });\n  }\n\n  const isAsc = mode === 'asc';\n  return collection.sort((a, b) => {\n    return compareValues(a, b, orderRule, isAsc);\n  });\n}\n\nexport function unique<T extends any>(array: T[]): T[] {\n  return Array.from(new Set(array));\n}\n\nexport function compact<T extends any>(array: T[]) {\n  return array.filter(Boolean);\n}\n\nexport function areSortedArraysEqual(array1: any[], array2: any[]) {\n  if (array1.length !== array2.length) {\n    return false;\n  }\n\n  return array1.every((item, i) => item === array2[i]);\n}\n\nexport function split<T extends any>(array: T[], chunkSize: number) {\n  const result: T[][] = [];\n  for (let i = 0; i < array.length; i += chunkSize) {\n    result.push(array.slice(i, i + chunkSize));\n  }\n\n  return result;\n}\n\nexport function cloneDeep<T>(value: T): T {\n  if (!isObject(value)) {\n    return value;\n  }\n\n  if (Array.isArray(value)) {\n    return value.map(cloneDeep) as typeof value;\n  }\n\n  return Object.keys(value).reduce((acc, key) => {\n    acc[key as keyof T] = cloneDeep(value[key as keyof T]);\n    return acc;\n  }, {} as T);\n}\n\nexport function isLiteralObject(value: any): value is AnyLiteral {\n  return isObject(value) && !Array.isArray(value);\n}\n\nfunction isObject(value: any): value is object {\n  // eslint-disable-next-line no-null/no-null\n  return typeof value === 'object' && value !== null;\n}\n\nexport function findLast<T>(array: Array<T>, predicate: (value: T, index: number, obj: T[]) => boolean): T | undefined {\n  let cursor = array.length;\n\n  while (cursor--) {\n    if (predicate(array[cursor], cursor, array)) {\n      return array[cursor];\n    }\n  }\n\n  return undefined;\n}\n\nexport function range(start: number, end: number) {\n  const arr: number[] = [];\n  for (let i = start; i < end;) {\n    arr.push(i++);\n  }\n  return arr;\n}\n\nexport function fromKeyValueArrays<T>(keys: string[], values: T[] | T) {\n  return keys.reduce((acc, key, index) => {\n    acc[key] = Array.isArray(values) ? values[index] : values;\n    return acc;\n  }, {} as Record<string, T>);\n}\n\nexport function extractKey<T, K extends keyof T>(array: T[], key: K): T[K][] {\n  return array.map((value) => value[key]);\n}\n\nexport function findDifference<T>(array1: T[], array2: T[]): T[] {\n  const set2 = new Set(array2);\n\n  return array1.filter((element) => !set2.has(element));\n}\n\nexport function filterValues<M extends any>(\n  byKey: CollectionByKey<M>,\n  callback: (member: M, key: string, index: number, originalByKey: CollectionByKey<M>) => boolean,\n): CollectionByKey<M> {\n  return Object.keys(byKey).reduce((newByKey: CollectionByKey<M>, key, index) => {\n    if (callback(byKey[key], key, index, byKey)) {\n      newByKey[key] = byKey[key];\n    }\n\n    return newByKey;\n  }, {});\n}\n\nexport function uniqueByKey<T>(array: T[], key: keyof T, shouldKeepFirst?: boolean) {\n  if (shouldKeepFirst) {\n    array = Array.from(array);\n    array.reverse();\n  }\n\n  const result = [...new Map(array.map((item) => [item[key], item])).values()];\n\n  if (shouldKeepFirst) {\n    result.reverse();\n  }\n\n  return result;\n}\n\nexport function difference<T>(x: Set<T>, y: Set<T>): Set<T> {\n  const result = new Set(x);\n  for (const elem of y) {\n    result.delete(elem);\n  }\n  return result;\n}\n\nexport function intersection<T>(x: Set<T>, y: Set<T>): Set<T> {\n  const result = new Set<T>();\n  for (const elem of y) {\n    if (x.has(elem)) {\n      result.add(elem);\n    }\n  }\n  return result;\n}\n","import type {\n  Address, Cell, Contract, ContractProvider,\n} from '@ton/core';\nimport {\n  beginCell, contractAddress,\n} from '@ton/core';\n\nexport type DnsItemConfig = {};\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport function dnsItemConfigToCell(config: DnsItemConfig): Cell {\n  return beginCell().endCell();\n}\n\nexport class DnsItem implements Contract {\n  constructor(\n    readonly address: Address,\n    readonly init?: { code: Cell; data: Cell },\n  ) {}\n\n  static createFromAddress(address: Address) {\n    return new DnsItem(address);\n  }\n\n  static createFromConfig(config: DnsItemConfig, code: Cell, workchain = 0) {\n    const data = dnsItemConfigToCell(config);\n    const init = { code, data };\n    return new DnsItem(contractAddress(workchain, init), init);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async getDomain(provider: ContractProvider) {\n    const res = await provider.get('get_domain', []);\n    const domain = res.stack.readString();\n    return domain;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async getTelemintDomain(provider: ContractProvider) {\n    const res = await provider.get('get_domain_full', []);\n    const domain = res.stack.readString();\n    const parts = domain.replace(/\\\\u0000/g, '.').replace(/\\.$/, '').split('.');\n    parts.reverse();\n    return parts.join('.');\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async getNftData(provider: ContractProvider) {\n    const res = await provider.get('get_nft_data', []);\n    const index = res.stack.readBigNumber();\n    const collectionAddress = res.stack.readAddress();\n    const owner = res.stack.readAddressOpt();\n\n    return {\n      index,\n      collectionAddress,\n      owner,\n    };\n  }\n}\n","import { STAKING_POOLS } from '../../config';\n\nexport function sha256(bytes: Uint8Array) {\n  return crypto.subtle.digest('SHA-256', bytes);\n}\n\nexport function bytesToHex(bytes: Uint8Array) {\n  return Buffer.from(bytes).toString('hex');\n}\n\nexport function hexToBytes(hex: string) {\n  return Uint8Array.from(Buffer.from(hex, 'hex'));\n}\n\nexport function bytesToBase64(bytes: Uint8Array) {\n  return Buffer.from(bytes).toString('base64');\n}\n\nexport function base64ToBytes(base64: string) {\n  return Uint8Array.from(Buffer.from(base64, 'base64'));\n}\n\nexport function base64ToString(base64: string) {\n  return Buffer.from(base64, 'base64').toString('utf-8');\n}\n\nexport function isKnownStakingPool(address: string) {\n  return STAKING_POOLS.some((poolPart) => address.endsWith(poolPart));\n}\n","/*\n * This module is to be used instead of /src/util/environment.ts\n * when `window` is not available (e.g. in a web worker).\n */\nimport type { ApiInitArgs } from './types';\n\nimport {\n  ELECTRON_TONCENTER_MAINNET_KEY,\n  ELECTRON_TONCENTER_TESTNET_KEY,\n  IS_CAPACITOR,\n  IS_EXTENSION,\n  TONCENTER_MAINNET_KEY,\n  TONCENTER_TESTNET_KEY,\n} from '../config';\n\nconst ELECTRON_ORIGIN = 'file://';\n\nlet environment: ApiInitArgs & {\n  isDappSupported: boolean;\n  isSseSupported: boolean;\n  apiHeaders?: AnyLiteral;\n  toncenterMainnetKey?: string;\n  toncenterTestnetKey?: string;\n};\n\nexport function setEnvironment(args: ApiInitArgs) {\n  environment = {\n    ...args,\n    isDappSupported: IS_EXTENSION || IS_CAPACITOR || args.isElectron,\n    isSseSupported: args.isElectron || (IS_CAPACITOR && !args.isNativeBottomSheet),\n    // eslint-disable-next-line no-restricted-globals\n    apiHeaders: { 'X-App-Origin': args.isElectron ? ELECTRON_ORIGIN : self?.origin },\n    toncenterMainnetKey: args.isElectron ? ELECTRON_TONCENTER_MAINNET_KEY : TONCENTER_MAINNET_KEY,\n    toncenterTestnetKey: args.isElectron ? ELECTRON_TONCENTER_TESTNET_KEY : TONCENTER_TESTNET_KEY,\n  };\n  return environment;\n}\n\nexport function getEnvironment() {\n  return environment;\n}\n","import type { ApiTonWalletVersion, ContractInfo, ContractName } from './types';\n\nimport { JettonStakingGas } from './contracts/JettonStaking/imports/constants';\n\nexport const TON_BIP39_PATH = \"m/44'/607'/0'\";\n\nexport const ONE_TON = 1_000_000_000n;\nexport const TOKEN_TRANSFER_AMOUNT = 50000000n; // 0.05 TON\nexport const TINY_TOKEN_TRANSFER_AMOUNT = 18000000n; // 0.018 TON\nexport const TOKEN_TRANSFER_REAL_AMOUNT = 32100000n; // 0.0321 TON\nexport const TINY_TOKEN_TRANSFER_REAL_AMOUNT = 8000000n; // 0.008 TON\nexport const TINIEST_TOKEN_TRANSFER_REAL_AMOUNT = 3000000n; // 0.003 TON\nexport const TOKEN_TRANSFER_FORWARD_AMOUNT = 1n; // 0.000000001 TON\nexport const CLAIM_MINTLESS_AMOUNT = 20000000n; // 0.02 TON\n\n/** The amount that MyTonWallet attaches to NFT transfers */\nexport const NFT_TRANSFER_AMOUNT = 100000000n; // 0.1 TON\nexport const NFT_TRANSFER_REAL_AMOUNT = 5000000n; // 0.005 TON\nexport const NFT_TRANSFER_FORWARD_AMOUNT = 1n; // 0.000000001 TON\n/**\n * When the NFT contract handles the payload we send, it simply adds its data to the payload. If the resulting payload\n * size becomes greater than the cell capacity, the contract fails to send the NFT. To avoid that, we keep some free\n * space in the payload cell we send. This constant is the size of the free space in bits.\n */\nexport const NFT_PAYLOAD_SAFE_MARGIN = 14 * 8;\n\nexport const TON_GAS = {\n  stakeNominators: ONE_TON,\n  unstakeNominators: ONE_TON,\n  stakeLiquid: ONE_TON,\n  unstakeLiquid: ONE_TON,\n  stakeJettonsForward: JettonStakingGas.STAKE_JETTONS,\n  stakeJettons: JettonStakingGas.STAKE_JETTONS + TOKEN_TRANSFER_AMOUNT,\n  unstakeJettons: JettonStakingGas.UNSTAKE_JETTONS,\n  claimJettons: JettonStakingGas.JETTON_TRANSFER + JettonStakingGas.SIMPLE_UPDATE_REQUEST,\n  changeDns: 50_000_000n, // 0.05 TON\n} as const;\n\nexport const TON_GAS_REAL = {\n  stakeNominators: 1_000_052_853n,\n  unstakeNominators: 148_337_433n,\n  stakeLiquid: 20_251_387n,\n  unstakeLiquid: 18_625_604n,\n  stakeJettons: 74_879_996n,\n  unstakeJettons: 59_971_662n,\n  claimJettons: 57_053_859n,\n};\n\nexport const STAKE_COMMENT = 'd';\nexport const UNSTAKE_COMMENT = 'w';\n\nexport const ATTEMPTS = 5;\n\nexport const DEFAULT_DECIMALS = 9;\nexport const DEFAULT_IS_BOUNCEABLE = true;\nexport const WALLET_IS_BOUNCEABLE = false;\n\n// Fee may change, so we add 5% for more reliability. This is only safe for low-fee blockchains such as TON.\nexport const FEE_FACTOR = 1.05;\n\nexport const ALL_WALLET_VERSIONS: ApiTonWalletVersion[] = [\n  'simpleR1', 'simpleR2', 'simpleR3', 'v2R1', 'v2R2', 'v3R1', 'v3R2', 'v4R2', 'W5',\n];\n\nexport const OUR_FEE_PAYLOAD_BOC = 'te6cckEBAQEABgAACE0jhUPUcYAL';\n\nexport enum Workchain {\n  MasterChain = -1,\n  BaseChain = 0,\n}\n\nexport const WORKCHAIN = Workchain.BaseChain;\nexport const TRANSFER_TIMEOUT_SEC = 600; // 10 min.\n\nexport const DEFAULT_MAX_MESSAGES = 4;\nexport const LEDGER_MAX_MESSAGES = 4; // TODO Replace to 1 after DEX support\nexport const W5_MAX_MESSAGES = 255;\n\nexport enum OpCode {\n  Comment = 0,\n  Encrypted = 0x2167da4b,\n  OurFee = 0x4d238543,\n}\n\nexport enum JettonOpCode {\n  Transfer = 0xf8a7ea5,\n  TransferNotification = 0x7362d09c,\n  InternalTransfer = 0x178d4519,\n  Excesses = 0xd53276db,\n  Burn = 0x595f07bc,\n  BurnNotification = 0x7bdd97de,\n}\n\nexport enum NftOpCode {\n  TransferOwnership = 0x5fcc3d14,\n  OwnershipAssigned = 0x05138d91,\n  Excesses = 0xd53276db,\n}\n\nexport enum LiquidStakingOpCode {\n  // Pool\n  RequestLoan = 0xe642c965,\n  LoanRepayment = 0xdfdca27b,\n  Deposit = 0x47d54391,\n  Withdraw = 0x319B0CDC,\n  Withdrawal = 0x0a77535c,\n  DeployController = 0xb27edcad,\n  Touch = 0x4bc7c2df,\n  Donate = 0x73affe21,\n  // NFT\n  DistributedAsset = 0xdb3b8abd,\n  // Jetton\n  Vote = 0x69fb306c,\n}\n\nexport enum JettonStakingOpCode {\n  UnstakeRequest = 0x499a9262,\n  ClaimRewards = 0x78d9f109,\n}\n\nexport enum VestingV1OpCode {\n  AddWhitelist = 0x7258a69b,\n}\n\nexport enum SingleNominatorOpCode {\n  Withdraw = 0x1000,\n  ChangeValidator = 0x1001,\n}\n\nexport enum DnsOpCode {\n  ChangeRecord = 0x4eb1f0f9,\n}\n\nexport enum TeleitemOpCode {\n  Ok = 0xa37a0983,\n}\n\nexport enum OtherOpCode {\n  TokenBridgePaySwap = 0x8,\n}\n\nexport enum ContractType {\n  Wallet = 'wallet',\n  Staking = 'staking',\n}\n\nexport enum DnsCategory {\n  DnsNextResolver = 'dns_next_resolver',\n  Wallet = 'wallet',\n  Site = 'site',\n  BagId = 'storage',\n  Unknown = 'unknown',\n}\n\nexport const EXCESS_OP_CODES = [\n  JettonOpCode.Excesses,\n  TeleitemOpCode.Ok,\n];\n\nexport const DNS_CATEGORY_HASH_MAP = {\n  dns_next_resolver: '19f02441ee588fdb26ee24b2568dd035c3c9206e11ab979be62e55558a1d17ff',\n  wallet: 'e8d44050873dba865aa7c170ab4cce64d90839a34dcfd6cf71d14e0205443b1b',\n  site: 'fbae041b02c41ed0fd8a4efb039bc780dd6af4a1f0c420f42561ae705dda43fe',\n  storage: '49a25f9feefaffecad0fcd30c50dc9331cff8b55ece53def6285c09e17e6f5d7',\n} as const;\n\nexport const KnownContracts: Record<ContractName, ContractInfo> = {\n  simpleR1: {\n    name: 'simpleR1',\n    hash: '3232dc55b02b3d2a9485adc151cf29c50b94c374d3571cb59390d761b87af8bd',\n    type: ContractType.Wallet,\n  },\n  simpleR2: {\n    name: 'simpleR2',\n    hash: '672ce2b01d2fd487a5e0528611e7e4fc11867148cc13ff772bd773b72fb368df',\n    type: ContractType.Wallet,\n  },\n  simpleR3: {\n    name: 'simpleR3',\n    hash: 'd95417233f66ae218317f533630cbbddc677d6d893d5722be6947c8fad8e9d52',\n    type: ContractType.Wallet,\n  },\n  v2R1: {\n    name: 'v2R1',\n    hash: 'fb3bd539b7e50166f1cfdc0bbd298b1c88f6b261fe5ee61343ea47ab4b256029',\n    type: ContractType.Wallet,\n  },\n  v2R2: {\n    name: 'v2R2',\n    hash: 'b584b6106753b7f34709df505be603e463a44ff6a85adf7fec4e26453c325983',\n    type: ContractType.Wallet,\n  },\n  v3R1: {\n    name: 'v3R1',\n    hash: '11d123ed5c2055128e75a9ef4cf1e837e6d14a9c079c39939885c78dc13626e6',\n    type: ContractType.Wallet,\n  },\n  v3R2: {\n    name: 'v3R2',\n    hash: 'df7bf014ee7ac0c38da19ef1b7fa054e2cc7a4513df1f1aa295109cf3606ac14',\n    type: ContractType.Wallet,\n  },\n  v4R1: {\n    name: 'v4R1',\n    hash: '1bc0dfa40956c911616f8a5db09ecc217601bae48d7d3f9311562c5afcb66dcf',\n    type: ContractType.Wallet,\n  },\n  v4R2: {\n    name: 'v4R2',\n    hash: '5659ce2300f4a09a37b0bdee41246ded52474f032c1d6ffce0d7d31b18b7b2b1',\n    type: ContractType.Wallet,\n  },\n  W5: {\n    name: 'W5',\n    hash: '7e94eaaeaaa423b9396e79747038c42edc4fe98dce65094071f0e0ad2df22fd5',\n    type: ContractType.Wallet,\n  },\n  highloadV2: {\n    name: 'highloadV2',\n    hash: 'fcd7d1f3b3847f0b9bd44bc64a2256c03450979dd1646a24fbc874b075392d6e',\n    type: ContractType.Wallet,\n  },\n  nominatorPool: {\n    name: 'nominatorPool',\n    hash: '26faa2d0fd2a8197ea36ded8dc50ad081cce5244207e9b05c08c1bb655527bff',\n    type: ContractType.Staking,\n  },\n  multisig: {\n    name: 'multisig',\n    hash: '45d890485cdd6b152bcbbe3fb2e16d2df82f6da840440a5b9f34ea13cb0b92d2',\n    type: ContractType.Wallet,\n  },\n  multisigV2: {\n    name: 'multisigV2',\n    hash: 'eb1323c5544d5bf26248dc427d108d722d5c2922dd97dd0bdf903c4cea73ca97',\n    type: ContractType.Wallet,\n  },\n  vesting: {\n    name: 'vesting',\n    hash: '69dc931958f7aa203c4a7bfcf263d25d2d828d573184b542a65dd55c8398ad83',\n    type: ContractType.Wallet,\n  },\n  multisigNew: {\n    name: 'multisigNew',\n    hash: '7cb3678880388acff45d74b2e7e7544caa8039d20b49f57c75b53c051b6fa30f',\n    type: ContractType.Wallet,\n  },\n  dedustPool: {\n    name: 'dedustPool',\n    hash: 'f216ded2b43d32e2d487db6fa6e4d2387f0ef1d7b53ec1ad85f0b4feb8e4ed62',\n    isSwapAllowed: true,\n  },\n  dedustVaultNative: {\n    name: 'dedustVaultNative',\n    hash: '64a42ad66688097422901ae6188670f0d6292ad3bdb4139289666f24187e86cb',\n    isSwapAllowed: true,\n  },\n  dedustVaultJetton: {\n    name: 'dedustVaultJetton',\n    hash: '5bc82f0c5972ccc6732e98cbe31ea4795da818f9e06c991331568182a8362307',\n    isSwapAllowed: true,\n  },\n  stonPtonWallet: {\n    name: 'stonPtonWallet',\n    hash: '6ccbf71a3ed9c7355f84a698a44a7406574bfb8aa34d4bbd86ab75ee9c994880',\n    isSwapAllowed: true,\n  },\n  stonRouter: {\n    name: 'stonRouter',\n    hash: '14ce618a0e9a94adc99fa6e975219ddd675425b30dfa9728f98714c8dc55f9da',\n    isSwapAllowed: true,\n  },\n  stonRouterV2_1: {\n    name: 'stonRouterV2_1',\n    hash: 'd61cb7fb7bee0cc414286a482fccdec53c3f8717e4aae4fc362d98ab6254e6cd',\n    isSwapAllowed: true,\n  },\n  stonPoolV2_1: {\n    name: 'stonPoolV2_1',\n    hash: '16cc513c380e329f45d54f294787e2030e289799eca138961c1cd7e26e882c7c',\n    isSwapAllowed: true,\n  },\n  stonRouterV2_2: {\n    name: 'stonRouterV2_2',\n    hash: '094b5084111addda1b6fac7007c8a8f85ff4ccc63475815ab3dfa3b5b4c6b102',\n    isSwapAllowed: true,\n  },\n  stonPoolV2_2: {\n    name: 'stonPoolV2_2',\n    hash: '11eaf6db706e63adf9327897aaa845c77a631856abfc14375837f19b617cacb4',\n    isSwapAllowed: true,\n  },\n  stonPtonWalletV2: {\n    name: 'stonPtonWalletV2',\n    hash: '2761042202032258de9eb1b672e1ec2e4f13b2af00700195801ada33f7ced1b6',\n    isSwapAllowed: true,\n  },\n};\n","import { bigintRandom, bigintReviver } from '../../../../util/bigint';\n\nexport function cloneDeep<T>(value: T): T {\n  return JSON.parse(JSON.stringify(value), bigintReviver);\n}\n\nexport function generateQueryId() {\n  return bigintRandom(8);\n}\n","import type { OpenedContract } from '@ton/core';\nimport {\n  Address, beginCell, Builder, Cell, Dictionary,\n} from '@ton/core';\nimport { WalletContractV1R1 } from '@ton/ton/dist/wallets/WalletContractV1R1';\nimport { WalletContractV1R2 } from '@ton/ton/dist/wallets/WalletContractV1R2';\nimport { WalletContractV1R3 } from '@ton/ton/dist/wallets/WalletContractV1R3';\nimport { WalletContractV2R1 } from '@ton/ton/dist/wallets/WalletContractV2R1';\nimport { WalletContractV2R2 } from '@ton/ton/dist/wallets/WalletContractV2R2';\nimport { WalletContractV3R1 } from '@ton/ton/dist/wallets/WalletContractV3R1';\nimport { WalletContractV3R2 } from '@ton/ton/dist/wallets/WalletContractV3R2';\nimport { WalletContractV4 } from '@ton/ton/dist/wallets/WalletContractV4';\nimport { WalletContractV5R1 } from '@ton/ton/dist/wallets/WalletContractV5R1';\n\nimport type { ApiNetwork } from '../../../types';\nimport type { ApiTonWalletVersion, TokenTransferBodyParams } from '../types';\n\nimport {\n  DEFAULT_TIMEOUT,\n  TONCENTER_MAINNET_KEY,\n  TONCENTER_MAINNET_URL,\n  TONCENTER_TESTNET_KEY,\n  TONCENTER_TESTNET_URL,\n} from '../../../../config';\nimport { getDnsZoneByCollection } from '../../../../util/dns';\nimport { fromKeyValueArrays, mapValues } from '../../../../util/iteratees';\nimport { logDebugError } from '../../../../util/logs';\nimport withCacheAsync from '../../../../util/withCacheAsync';\nimport { DnsItem } from '../contracts/DnsItem';\nimport { JettonMinter } from '../contracts/JettonMaster';\nimport { JettonStakingOpCodes } from '../contracts/JettonStaking/imports/constants';\nimport { StakeWallet } from '../contracts/JettonStaking/StakeWallet';\nimport { StakingPool } from '../contracts/JettonStaking/StakingPool';\nimport { JettonWallet } from '../contracts/JettonWallet';\nimport { hexToBytes } from '../../../common/utils';\nimport { getEnvironment } from '../../../environment';\nimport {\n  DEFAULT_IS_BOUNCEABLE,\n  JettonOpCode,\n  LiquidStakingOpCode,\n  OpCode,\n  WORKCHAIN,\n} from '../constants';\nimport { generateQueryId } from './index';\n\nimport { TonClient } from './TonClient';\n\nexport type TonWalletType = typeof WalletContractV1R1\n| typeof WalletContractV1R2\n| typeof WalletContractV1R3\n| typeof WalletContractV2R1\n| typeof WalletContractV2R2\n| typeof WalletContractV3R1\n| typeof WalletContractV3R2\n| typeof WalletContractV4\n| typeof WalletContractV5R1;\n\nexport type TonWallet = OpenedContract<WalletContractV1R1\n| WalletContractV1R2\n| WalletContractV1R3\n| WalletContractV2R1\n| WalletContractV2R2\n| WalletContractV3R1\n| WalletContractV3R2\n| WalletContractV4\n| WalletContractV5R1>;\n\nconst TON_MAX_COMMENT_BYTES = 127;\n\nlet clientByNetwork: Record<ApiNetwork, TonClient> | undefined;\n\nexport const walletClassMap: Record<ApiTonWalletVersion, TonWalletType> = {\n  simpleR1: WalletContractV1R1,\n  simpleR2: WalletContractV1R2,\n  simpleR3: WalletContractV1R3,\n  v2R1: WalletContractV2R1,\n  v2R2: WalletContractV2R2,\n  v3R1: WalletContractV3R1,\n  v3R2: WalletContractV3R2,\n  v4R2: WalletContractV4,\n  W5: WalletContractV5R1,\n};\n\nexport function getTonClient(network: ApiNetwork = 'mainnet') {\n  if (!clientByNetwork) {\n    clientByNetwork = {\n      mainnet: new TonClient({\n        endpoint: `${TONCENTER_MAINNET_URL}/api/v2/jsonRPC`,\n        timeout: DEFAULT_TIMEOUT,\n        apiKey: TONCENTER_MAINNET_KEY,\n        headers: getEnvironment().apiHeaders,\n      }),\n      testnet: new TonClient({\n        endpoint: `${TONCENTER_TESTNET_URL}/api/v2/jsonRPC`,\n        timeout: DEFAULT_TIMEOUT,\n        apiKey: TONCENTER_TESTNET_KEY,\n        headers: getEnvironment().apiHeaders,\n      }),\n    };\n  }\n\n  return clientByNetwork[network];\n}\n\nexport function getTonWalletContract(publicKeyHex: string, version: ApiTonWalletVersion) {\n  const walletClass = walletClassMap[version];\n  if (!walletClass) {\n    throw new Error('Unsupported wallet contract version');\n  }\n\n  const publicKey = Buffer.from(hexToBytes(publicKeyHex));\n  return walletClass.create({ workchain: WORKCHAIN, publicKey });\n}\n\nexport const resolveTokenWalletAddress = withCacheAsync(\n  async (network: ApiNetwork, address: string, tokenAddress: string) => {\n    const minter = getTonClient(network).open(new JettonMinter(Address.parse(tokenAddress)));\n    const walletAddress = await minter.getWalletAddress(Address.parse(address));\n    return toBase64Address(walletAddress, true, network);\n  },\n);\n\nexport const resolveTokenAddress = withCacheAsync(async (network: ApiNetwork, tokenWalletAddress: string) => {\n  const tokenWallet = getTonClient(network).open(new JettonWallet(Address.parse(tokenWalletAddress)));\n  const data = await tokenWallet.getWalletData();\n  return toBase64Address(data.minter, true, network);\n});\n\nexport const getWalletPublicKey = withCacheAsync(async (network: ApiNetwork, address: string) => {\n  try {\n    const res = await getTonClient(network).callGetMethod(Address.parse(address), 'get_public_key');\n    const bigintKey = res.stack.readBigNumber();\n    const hex = bigintKey.toString(16).padStart(64, '0');\n    return hexToBytes(hex);\n  } catch (err) {\n    logDebugError('getWalletPublicKey', err);\n    return undefined;\n  }\n});\n\nexport const getJettonPoolStakeWallet = withCacheAsync(async (\n  network: ApiNetwork,\n  poolAddress: string,\n  period: number,\n  address: string,\n): Promise<OpenedContract<StakeWallet>> => {\n  const tonClient = getTonClient(network);\n  const pool = tonClient.open(StakingPool.createFromAddress(Address.parse(poolAddress)));\n  const walletAddress = (await pool.getWalletAddress(Address.parse(address), period))!;\n  return tonClient.open(StakeWallet.createFromAddress(walletAddress));\n});\n\nexport function getJettonMinterData(network: ApiNetwork, address: string) {\n  const contract = getTonClient(network).open(new JettonMinter(Address.parse(address)));\n  return contract.getJettonData();\n}\n\nexport function oneCellFromBoc(bytes: Uint8Array) {\n  return Cell.fromBoc(Buffer.from(bytes));\n}\n\nexport function toBase64Address(address: Address | string, isBounceable = DEFAULT_IS_BOUNCEABLE, network?: ApiNetwork) {\n  if (typeof address === 'string') {\n    address = Address.parse(address);\n  }\n  return address.toString({\n    urlSafe: true,\n    bounceable: isBounceable,\n    testOnly: network === 'testnet',\n  });\n}\n\nexport function toRawAddress(address: Address | string) {\n  if (typeof address === 'string') {\n    address = Address.parse(address);\n  }\n  return address.toRawString();\n}\n\nexport function buildTokenTransferBody(params: TokenTransferBodyParams) {\n  const {\n    queryId,\n    tokenAmount,\n    toAddress,\n    responseAddress,\n    forwardAmount,\n    customPayload,\n  } = params;\n  let forwardPayload = params.forwardPayload;\n\n  let builder = new Builder()\n    .storeUint(JettonOpCode.Transfer, 32)\n    .storeUint(queryId || generateQueryId(), 64)\n    .storeCoins(tokenAmount)\n    .storeAddress(Address.parse(toAddress))\n    .storeAddress(Address.parse(responseAddress))\n    .storeMaybeRef(customPayload)\n    .storeCoins(forwardAmount ?? 0n);\n\n  if (forwardPayload instanceof Uint8Array) {\n    const freeBytes = Math.round(builder.availableBits / 8);\n    forwardPayload = packBytesAsSnake(forwardPayload, freeBytes);\n  }\n\n  if (!forwardPayload) {\n    builder.storeBit(false);\n  } else if (typeof forwardPayload === 'string') {\n    builder = builder.storeBit(false)\n      .storeUint(0, 32)\n      .storeBuffer(Buffer.from(forwardPayload));\n  } else if (forwardPayload instanceof Uint8Array) {\n    builder = builder.storeBit(false)\n      .storeBuffer(Buffer.from(forwardPayload));\n  } else {\n    builder = builder.storeBit(true)\n      .storeRef(forwardPayload);\n  }\n\n  return builder.endCell();\n}\n\nexport function parseBase64(base64: string) {\n  try {\n    return Cell.fromBase64(base64);\n  } catch (err) {\n    logDebugError('parseBase64', err);\n    return Uint8Array.from(Buffer.from(base64, 'base64'));\n  }\n}\n\nexport function commentToBytes(comment: string): Uint8Array {\n  const buffer = Buffer.from(comment);\n  const bytes = new Uint8Array(buffer.length + 4);\n\n  const startBuffer = Buffer.alloc(4);\n  startBuffer.writeUInt32BE(OpCode.Comment);\n  bytes.set(startBuffer, 0);\n  bytes.set(buffer, 4);\n\n  return bytes;\n}\n\nexport function packBytesAsSnake(bytes: Uint8Array, maxBytes = TON_MAX_COMMENT_BYTES): Uint8Array | Cell {\n  const buffer = Buffer.from(bytes);\n  if (buffer.length <= maxBytes) {\n    return bytes;\n  }\n\n  return packBytesAsSnakeCell(bytes);\n}\n\nexport function packBytesAsSnakeCell(bytes: Uint8Array): Cell {\n  const bytesPerCell = TON_MAX_COMMENT_BYTES;\n  const cellCount = Math.ceil(bytes.length / bytesPerCell);\n  let headCell: Cell | undefined;\n\n  for (let i = cellCount - 1; i >= 0; i--) {\n    const cellOffset = i * bytesPerCell;\n    const cellLength = Math.min(bytesPerCell, bytes.length - cellOffset);\n    const cellBuffer = Buffer.from(bytes.buffer, bytes.byteOffset + cellOffset, cellLength); // This creates a buffer that references the input bytes instead of copying them\n\n    const nextHeadCell = new Builder().storeBuffer(cellBuffer);\n    if (headCell) {\n      nextHeadCell.storeRef(headCell);\n    }\n    headCell = nextHeadCell.endCell();\n  }\n\n  return headCell ?? Cell.EMPTY;\n}\n\nexport function packBytesAsSnakeForEncryptedData(data: Uint8Array): Uint8Array | Cell {\n  const ROOT_BUILDER_BYTES = 39;\n  const MAX_CELLS_AMOUNT = 16;\n\n  if (data.length > ROOT_BUILDER_BYTES + MAX_CELLS_AMOUNT * TON_MAX_COMMENT_BYTES) {\n    throw new Error('Input text is too long');\n  }\n\n  return new Builder()\n    .storeBuffer(Buffer.from(data.subarray(0, ROOT_BUILDER_BYTES)))\n    .storeRef(packBytesAsSnakeCell(data.subarray(ROOT_BUILDER_BYTES)))\n    .endCell();\n}\n\nexport function buildLiquidStakingDepositBody(queryId?: number) {\n  return new Builder()\n    .storeUint(LiquidStakingOpCode.Deposit, 32)\n    .storeUint(queryId || 0, 64)\n    .asCell();\n}\n\nexport function buildLiquidStakingWithdrawBody(options: {\n  queryId?: number;\n  amount: bigint;\n  responseAddress: string;\n  waitTillRoundEnd?: boolean; // opposite of request_immediate_withdrawal\n  fillOrKill?: boolean;\n}) {\n  const {\n    queryId, amount, responseAddress, waitTillRoundEnd, fillOrKill,\n  } = options;\n\n  const customPayload = buildLiquidStakingWithdrawCustomPayload(waitTillRoundEnd, fillOrKill);\n\n  return new Builder()\n    .storeUint(JettonOpCode.Burn, 32)\n    .storeUint(queryId ?? 0, 64)\n    .storeCoins(amount)\n    .storeAddress(Address.parse(responseAddress))\n    .storeBit(1)\n    .storeRef(customPayload)\n    .asCell();\n}\n\nexport function buildLiquidStakingWithdrawCustomPayload(waitTillRoundEnd?: boolean, fillOrKill?: boolean) {\n  return new Builder()\n    .storeUint(Number(waitTillRoundEnd), 1)\n    .storeUint(Number(fillOrKill), 1)\n    .asCell();\n}\n\nexport function getTokenBalance(network: ApiNetwork, walletAddress: string) {\n  const tokenWallet = getTonClient(network).open(new JettonWallet(Address.parse(walletAddress)));\n  return tokenWallet.getJettonBalance();\n}\n\nexport function parseAddress(address: string): {\n  isValid: boolean;\n  isRaw?: boolean;\n  isUserFriendly?: boolean;\n  isBounceable?: boolean;\n  isTestOnly?: boolean;\n  address?: Address;\n} {\n  try {\n    if (Address.isRaw(address)) {\n      return {\n        address: Address.parseRaw(address),\n        isRaw: true,\n        isValid: true,\n      };\n    } else if (Address.isFriendly(address)) {\n      return {\n        ...Address.parseFriendly(address),\n        isUserFriendly: true,\n        isValid: true,\n      };\n    }\n  } catch (err) {\n    // Do nothing\n  }\n\n  return { isValid: false };\n}\n\nexport function getIsRawAddress(address: string) {\n  return Boolean(parseAddress(address).isRaw);\n}\n\nexport async function getDnsItemDomain(network: ApiNetwork, address: Address | string) {\n  if (typeof address === 'string') address = Address.parse(address);\n\n  const contract = getTonClient(network)\n    .open(new DnsItem(address));\n  const nftData = await contract.getNftData();\n  const collectionAddress = toBase64Address(nftData.collectionAddress, true);\n\n  const zone = getDnsZoneByCollection(collectionAddress);\n\n  const base = zone?.isTelemint\n    ? await contract.getTelemintDomain()\n    : await contract.getDomain();\n\n  return `${base}.${zone?.suffixes[0]}`;\n}\n\nexport function buildJettonUnstakePayload(jettonsToUnstake: bigint, forceUnstake?: boolean, queryId?: bigint) {\n  return beginCell()\n    .storeUint(JettonStakingOpCodes.UNSTAKE_JETTONS, 32)\n    .storeUint(queryId ?? 0, 64)\n    .storeCoins(jettonsToUnstake)\n    .storeBit(forceUnstake ?? false)\n    .endCell();\n}\n\nexport function buildJettonClaimPayload(poolWallets: string[], queryId?: bigint) {\n  const rewardsToClaim = Dictionary.empty(Dictionary.Keys.Address(), Dictionary.Values.Bool());\n\n  for (const poolWallet of poolWallets) {\n    rewardsToClaim.set(Address.parse(poolWallet), true);\n  }\n\n  return beginCell()\n    .storeUint(JettonStakingOpCodes.CLAIM_REWARDS, 32)\n    .storeUint(queryId ?? 0, 64)\n    .storeDict(rewardsToClaim, Dictionary.Keys.Address(), Dictionary.Values.Bool())\n    .endCell();\n}\n\nexport function unpackDicts(obj: Record<string, any | Dictionary<any, any>>): AnyLiteral {\n  if (!isSimpleObject(obj)) {\n    return obj;\n  }\n\n  return mapValues(obj, (value) => {\n    if (value instanceof Dictionary) {\n      return unpackDicts(fromKeyValueArrays(value.keys(), value.values()));\n    }\n    if (isSimpleObject(value)) {\n      return unpackDicts(value);\n    }\n    return value;\n  });\n}\n\nfunction isSimpleObject(obj: any) {\n  // eslint-disable-next-line no-null/no-null\n  return obj !== null\n    && typeof obj === 'object'\n    && Object.getPrototypeOf(obj) === Object.prototype;\n}\n\nexport function getOurFeePayload() {\n  return new Builder()\n    .storeUint(OpCode.OurFee, 32)\n    .endCell();\n}\n","export enum StorageType {\n  IndexedDb,\n  LocalStorage,\n  ExtensionLocal,\n  CapacitorStorage,\n}\n\nexport interface Storage {\n  getItem(name: StorageKey, force?: boolean): Promise<any>;\n\n  setItem(name: StorageKey, value: any): Promise<void>;\n\n  removeItem(name: StorageKey): Promise<void>;\n\n  clear(): Promise<void>;\n\n  getAll?(): Promise<AnyLiteral>;\n\n  setMany?(items: AnyLiteral): Promise<void>;\n\n  getMany?(keys: string[]): Promise<AnyLiteral>;\n}\n\nexport type StorageKey = 'accounts'\n| 'stateVersion'\n| 'currentAccountId'\n| 'clientId'\n| 'baseCurrency'\n| 'referrer'\n// For extension\n| 'dapps'\n| 'dappMethods:lastAccountId'\n| 'windowId'\n| 'windowState'\n| 'isTonMagicEnabled'\n| 'isTonProxyEnabled'\n| 'isDeeplinkHookEnabled'\n// For TonConnect SSE\n| 'sseLastEventId';\n","import type { Connector } from '../PostMessageConnector';\nimport type { WindowMethodArgs, WindowMethodResponse, WindowMethods } from './types';\n\nimport { WINDOW_PROVIDER_CHANNEL } from '../../config';\n\nimport { createConnector } from '../PostMessageConnector';\n\nlet connector: Connector;\n\nexport function initWindowConnector() {\n  if (!connector) {\n    // eslint-disable-next-line no-restricted-globals\n    connector = createConnector(self as DedicatedWorkerGlobalScope, undefined, WINDOW_PROVIDER_CHANNEL);\n    connector.init();\n  }\n}\n\n// eslint-disable-next-line no-async-without-await/no-async-without-await\nexport function callWindow<T extends keyof WindowMethods>(methodName: T, ...args: WindowMethodArgs<T>) {\n  if (!connector) {\n    throw new Error('API is not initialized');\n  }\n\n  return connector.request({ name: methodName, args }) as EnsurePromise<WindowMethodResponse<T>>;\n}\n","export default function generateUniqueId() {\n  return Date.now().toString(36) + Math.random().toString(36).slice(2);\n}\n","import { bigintReviver } from './bigint';\nimport generateUniqueId from './generateUniqueId';\nimport { logDebugError } from './logs';\n\nexport interface CancellableCallback {\n  (\n    ...args: any[]\n  ): void;\n\n  isCanceled?: boolean;\n  acceptsBuffer?: boolean;\n}\n\ntype InitData = {\n  channel?: string;\n  type: 'init';\n  messageId?: string;\n  name: 'init';\n  args: any;\n};\n\ntype CallMethodData = {\n  channel?: string;\n  type: 'callMethod';\n  messageId?: string;\n  name: string;\n  args: any;\n  withCallback?: boolean;\n};\n\nexport type OriginMessageData = InitData | CallMethodData | {\n  channel?: string;\n  type: 'cancelProgress';\n  messageId: string;\n};\n\nexport interface OriginMessageEvent extends MessageEvent {\n  data: OriginMessageData;\n}\n\nexport type ApiUpdate =\n  { type: string }\n  & any;\n\nexport type WorkerMessageData = {\n  channel?: string;\n  type: 'update';\n  update: ApiUpdate;\n} | {\n  channel?: string;\n  type: 'methodResponse';\n  messageId: string;\n  response?: any;\n  error?: { message: string };\n} | {\n  channel?: string;\n  type: 'methodCallback';\n  messageId: string;\n  callbackArgs: any[];\n} | {\n  channel?: string;\n  type: 'unhandledError';\n  error?: { message: string; stack?: string };\n};\n\nexport interface WorkerMessageEvent {\n  data: WorkerMessageData;\n}\n\ninterface RequestStates {\n  messageId: string;\n  resolve: Function;\n  reject: Function;\n  callback: AnyToVoidFunction;\n}\n\ntype InputRequestTypes = Record<string, AnyFunction>;\n\ntype Values<T> = T[keyof T];\nexport type RequestTypes<T extends InputRequestTypes> = Values<{\n  [Name in keyof (T)]: {\n    name: Name & string;\n    args: Parameters<T[Name]>;\n  }\n}>;\n\nclass ConnectorClass<T extends InputRequestTypes> {\n  private requestStates = new Map<string, RequestStates>();\n\n  private requestStatesByCallback = new Map<AnyToVoidFunction, RequestStates>();\n\n  constructor(\n    public target: Worker | Window | chrome.runtime.Port | DedicatedWorkerGlobalScope,\n    private onUpdate?: (update: ApiUpdate) => void,\n    private channel?: string,\n    private shouldUseJson?: boolean,\n    private targetOrigin = '*',\n  ) {\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  public destroy() {\n  }\n\n  init(...args: any[]) {\n    this.postMessage({\n      type: 'init',\n      args,\n    });\n  }\n\n  request(messageData: RequestTypes<T>) {\n    const { requestStates, requestStatesByCallback } = this;\n\n    const messageId = generateUniqueId();\n    const payload: CallMethodData = {\n      type: 'callMethod',\n      messageId,\n      ...messageData,\n    };\n\n    const requestState = { messageId } as RequestStates;\n\n    // Re-wrap type because of `postMessage`\n    const promise: Promise<any> = new Promise((resolve, reject) => {\n      Object.assign(requestState, { resolve, reject });\n    });\n\n    if (typeof payload.args[payload.args.length - 1] === 'function') {\n      payload.withCallback = true;\n\n      const callback = payload.args.pop() as AnyToVoidFunction;\n      requestState.callback = callback;\n      requestStatesByCallback.set(callback, requestState);\n    }\n\n    requestStates.set(messageId, requestState);\n    promise\n      .catch(() => undefined)\n      .finally(() => {\n        requestStates.delete(messageId);\n\n        if (requestState.callback) {\n          requestStatesByCallback.delete(requestState.callback);\n        }\n      });\n\n    this.postMessage(payload);\n\n    return promise;\n  }\n\n  cancelCallback(progressCallback: CancellableCallback) {\n    progressCallback.isCanceled = true;\n\n    const { messageId } = this.requestStatesByCallback.get(progressCallback) || {};\n    if (!messageId) {\n      return;\n    }\n\n    this.postMessage({\n      type: 'cancelProgress',\n      messageId,\n    });\n  }\n\n  onMessage(data: WorkerMessageData | string) {\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data, bigintReviver) as WorkerMessageData;\n      } catch (err: any) {\n        logDebugError('PostMessageConnector: Failed to parse message', err);\n        return;\n      }\n    }\n\n    const { requestStates, channel } = this;\n    if (data.channel !== channel) {\n      return;\n    }\n\n    if (data.type === 'update' && this.onUpdate) {\n      this.onUpdate(data.update);\n    }\n    if (data.type === 'methodResponse') {\n      const requestState = requestStates.get(data.messageId);\n      if (requestState) {\n        if (data.error) {\n          requestState.reject(data.error);\n        } else {\n          requestState.resolve(data.response);\n        }\n      }\n    } else if (data.type === 'methodCallback') {\n      const requestState = requestStates.get(data.messageId);\n      requestState?.callback?.(...data.callbackArgs);\n    } else if (data.type === 'unhandledError') {\n      const error = new Error(data.error?.message);\n      if (data.error?.stack) {\n        error.stack = data.error.stack;\n      }\n      throw error;\n    }\n  }\n\n  private postMessage(data: AnyLiteral) {\n    data.channel = this.channel;\n\n    let rawData: AnyLiteral | string = data;\n    if (this.shouldUseJson) {\n      rawData = JSON.stringify(data);\n    }\n\n    if ('open' in this.target) { // Is Window\n      this.target.postMessage(rawData, this.targetOrigin);\n    } else {\n      this.target.postMessage(rawData);\n    }\n  }\n}\n\nexport function createConnector<T extends InputRequestTypes>(\n  worker: Worker | Window | DedicatedWorkerGlobalScope,\n  onUpdate?: (update: ApiUpdate) => void,\n  channel?: string,\n  targetOrigin?: string,\n) {\n  const connector = new ConnectorClass<T>(worker, onUpdate, channel, undefined, targetOrigin);\n\n  function handleMessage({ data }: WorkerMessageEvent | MessageEvent) {\n    connector.onMessage(data);\n  }\n\n  worker.addEventListener('message', handleMessage as any); // TS weirdly complains here\n\n  connector.destroy = () => {\n    worker.removeEventListener('message', handleMessage as any);\n  };\n\n  return connector;\n}\n\nexport function createExtensionConnector(\n  name: string,\n  onUpdate?: (update: ApiUpdate) => void,\n  getInitArgs?: () => any,\n  channel?: string,\n) {\n  const connector = new ConnectorClass(connect(), onUpdate, channel, true);\n\n  function connect() {\n    // eslint-disable-next-line no-restricted-globals\n    const port = self.chrome.runtime.connect({ name });\n\n    port.onMessage.addListener((data: string | WorkerMessageData) => {\n      connector.onMessage(data);\n    });\n\n    // For some reason port can suddenly get disconnected\n    port.onDisconnect.addListener(() => {\n      connector.target = connect();\n      connector.init(getInitArgs?.());\n    });\n\n    return port;\n  }\n\n  connector.init(getInitArgs?.());\n\n  return connector;\n}\n\nexport type Connector<T extends InputRequestTypes = InputRequestTypes> = ReturnType<typeof createConnector<T>>;\n","import type { Storage, StorageKey } from './types';\n\nimport { bigintReviver } from '../../util/bigint';\nimport { callWindow } from '../../util/windowProvider/connector';\nimport { getEnvironment } from '../environment';\n\nlet cache: AnyLiteral = {};\n\nconst storage: Storage & {\n  getKeys: () => Promise<string[] | undefined>;\n} = {\n  async getItem(key: StorageKey, force?: boolean) {\n    if (getEnvironment().isAndroidApp && key in cache && !force) {\n      return cache[key];\n    }\n\n    const result = await callWindow('capacitorStorageGetItem', key);\n    const value = result ? JSON.parse(result, bigintReviver) : undefined;\n\n    if (getEnvironment().isAndroidApp) {\n      if (value === undefined) {\n        delete cache[key];\n      } else {\n        cache[key] = value;\n      }\n    }\n\n    return value;\n  },\n\n  async setItem(key: StorageKey, value: any) {\n    await callWindow('capacitorStorageSetItem', key, JSON.stringify(value));\n\n    if (getEnvironment().isAndroidApp) {\n      cache[key] = value;\n    }\n  },\n\n  async removeItem(key: StorageKey) {\n    await callWindow('capacitorStorageRemoveItem', key);\n\n    if (getEnvironment().isAndroidApp) {\n      delete cache[key];\n    }\n  },\n\n  async clear() {\n    await callWindow('capacitorStorageClear');\n\n    if (getEnvironment().isAndroidApp) {\n      cache = {};\n    }\n  },\n\n  async getKeys() {\n    const result = await callWindow('capacitorStorageKeys');\n\n    return result?.value;\n  },\n};\n\nexport default storage;\n","import type { Storage } from './types';\n\nimport { IS_EXTENSION } from '../../config';\n\n// eslint-disable-next-line no-restricted-globals\nconst storage = IS_EXTENSION ? self.chrome.storage.local : undefined;\n\nexport default ((storage && {\n  getItem: async (key) => (await storage.get(key))?.[key],\n  setItem: (key, value) => storage.set({ [key]: value }),\n  removeItem: storage.remove.bind(storage),\n  clear: storage.clear.bind(storage),\n  getAll: storage.get.bind(storage),\n  setMany: storage.set.bind(storage),\n  getMany: storage.get.bind(storage),\n}) || {}) as Storage;\n","import * as idb from 'idb-keyval';\n\nimport type { Storage, StorageKey } from './types';\n\nimport { INDEXED_DB_NAME, INDEXED_DB_STORE_NAME } from '../../config';\nimport { fromKeyValueArrays } from '../../util/iteratees';\n\nconst store = idb.createStore(INDEXED_DB_NAME, INDEXED_DB_STORE_NAME);\n\nexport default {\n  getItem: (name: StorageKey) => idb.get(name, store),\n  setItem: (name: StorageKey, value: any) => idb.set(name, value, store),\n  removeItem: (name: StorageKey) => idb.del(name, store),\n  clear: () => idb.clear(store),\n  getAll: async () => {\n    const keys = await idb.keys(store) as string[];\n    const values = await idb.getMany(keys, store);\n    return fromKeyValueArrays(keys, values);\n  },\n  getMany: async (keys) => {\n    const values = await idb.getMany(keys, store);\n    return fromKeyValueArrays(keys, values);\n  },\n  setMany: (items) => {\n    return idb.setMany(Object.entries(items), store);\n  },\n} as Storage;\n","import type { Storage, StorageKey } from './types';\n\nimport { pick } from '../../util/iteratees';\nimport { callWindow } from '../../util/windowProvider/connector';\n\nfunction withPromise(fn: AnyFunction) {\n  return (...args: any) => Promise.resolve(fn(...args));\n}\n\nconst storage: Storage = (typeof localStorage === 'object' ? {\n  getItem: withPromise(localStorage.getItem),\n  setItem: withPromise(localStorage.setItem),\n  removeItem: withPromise(localStorage.removeItem),\n  clear: withPromise(localStorage.clear),\n  getAll: withPromise(() => ({ ...localStorage })),\n  getMany: withPromise((keys: string[]) => pick(localStorage, keys)),\n  setMany: withPromise((items: AnyLiteral) => {\n    Object.assign(localStorage, items);\n  }),\n} : {\n  getItem(key: StorageKey) {\n    return callWindow('localStorageGetItem', key);\n  },\n  setItem(key: StorageKey, value: any) {\n    return callWindow('localStorageSetItem', key, value);\n  },\n  removeItem(key: StorageKey) {\n    return callWindow('localStorageRemoveItem', key);\n  },\n  clear() {\n    return callWindow('localStorageClear');\n  },\n  getAll() {\n    return callWindow('localStorageGetAll');\n  },\n  getMany(keys: StorageKey[]) {\n    return callWindow('localStorageGetMany', keys);\n  },\n  setMany(items: AnyLiteral) {\n    return callWindow('localStorageSetMany', items);\n  },\n});\n\nexport default storage;\n","import { StorageType } from './types';\n\nimport { IS_CAPACITOR, IS_EXTENSION } from '../../config';\nimport capacitorStorage from './capacitorStorage';\nimport extensionStorage from './extension';\nimport idb from './idb';\nimport localStorage from './localStorage';\n\nexport const storage = IS_EXTENSION ? extensionStorage : IS_CAPACITOR ? capacitorStorage : idb;\n\nexport default {\n  [StorageType.IndexedDb]: idb,\n  [StorageType.LocalStorage]: localStorage,\n  [StorageType.ExtensionLocal]: extensionStorage,\n  [StorageType.CapacitorStorage]: capacitorStorage,\n};\n","import type { StorageKey } from '../storages/types';\nimport type {\n  ApiAccountAny,\n  ApiAccountWithMnemonic,\n  ApiAccountWithTon,\n  ApiAccountWithTron,\n  ApiBip39Account,\n  ApiChain,\n  ApiNetwork,\n  ApiTonWallet,\n  ApiTronWallet,\n} from '../types';\n\nimport { buildAccountId, parseAccountId } from '../../util/account';\nimport { storage } from '../storages';\n\nconst MIN_ACCOUNT_NUMBER = 0;\n\n// eslint-disable-next-line import/no-mutable-exports\nexport let loginResolve: AnyFunction;\nconst loginPromise = new Promise<void>((resolve) => {\n  loginResolve = resolve;\n});\n\nlet activeAccountId: string | undefined;\n\nexport function getActiveAccountId() {\n  return activeAccountId;\n}\n\nexport function setActiveAccountId(accountId?: string) {\n  activeAccountId = accountId;\n}\n\nexport function isAccountActive(accountId: string) {\n  return activeAccountId === accountId;\n}\n\nexport async function getAccountIds(): Promise<string[]> {\n  return Object.keys(await storage.getItem('accounts') || {});\n}\n\nexport async function getAccountWithMnemonic() {\n  const byId = await fetchStoredAccounts();\n\n  return Object.entries(byId).find(([, { type }]) => type !== 'ledger') as [string, ApiAccountWithMnemonic] | undefined;\n}\n\nexport async function getNewAccountId(network: ApiNetwork) {\n  const ids = (await getAccountIds()).map((accountId) => parseAccountId(accountId).id);\n  const id = ids.length === 0 ? MIN_ACCOUNT_NUMBER : Math.max(...ids) + 1;\n  return buildAccountId({ id, network });\n}\n\nexport async function fetchStoredAddress(accountId: string, chain: ApiChain): Promise<string> {\n  return (await fetchStoredAccount<ApiBip39Account>(accountId))[chain].address;\n}\n\nexport async function fetchStoredTonWallet(accountId: string): Promise<ApiTonWallet> {\n  return (await fetchStoredAccount<ApiAccountWithTon>(accountId)).ton;\n}\n\nexport async function fetchStoredTronWallet(accountId: string): Promise<ApiTronWallet> {\n  return (await fetchStoredAccount<ApiAccountWithTron>(accountId)).tron;\n}\n\nexport function fetchStoredAccount<T extends ApiAccountAny>(accountId: string): Promise<T> {\n  return getAccountValue(accountId, 'accounts');\n}\n\nexport function fetchStoredAccounts(): Promise<Record<string, ApiAccountAny>> {\n  return storage.getItem('accounts');\n}\n\nexport async function updateStoredAccount<T extends ApiAccountAny>(\n  accountId: string,\n  partial: Partial<T>,\n): Promise<void> {\n  const account = await fetchStoredAccount<T>(accountId);\n  return setAccountValue(accountId, 'accounts', {\n    ...account,\n    ...partial,\n  });\n}\n\nexport async function updateStoredTonWallet(accountId: string, partial: Partial<ApiTonWallet>): Promise<void> {\n  const tonWallet = await fetchStoredTonWallet(accountId);\n  return updateStoredAccount(accountId, {\n    ton: {\n      ...tonWallet,\n      ...partial,\n    },\n  });\n}\n\nexport async function getAccountValue(accountId: string, key: StorageKey) {\n  return (await storage.getItem(key))?.[accountId];\n}\n\nexport async function removeAccountValue(accountId: string, key: StorageKey) {\n  const data = await storage.getItem(key);\n  if (!data) return;\n\n  const { [accountId]: removedValue, ...restData } = data;\n  await storage.setItem(key, restData);\n}\n\nexport async function setAccountValue(accountId: string, key: StorageKey, value: any) {\n  const data = await storage.getItem(key);\n  await storage.setItem(key, { ...data, [accountId]: value });\n}\n\nexport async function removeNetworkAccountsValue(network: string, key: StorageKey) {\n  const data = await storage.getItem(key);\n  if (!data) return;\n\n  for (const accountId of Object.keys(data)) {\n    if (parseAccountId(accountId).network === network) {\n      delete data[accountId];\n    }\n  }\n\n  await storage.setItem(key, data);\n}\n\nexport async function getCurrentNetwork() {\n  const accountId = await getCurrentAccountId();\n  if (!accountId) return undefined;\n  return parseAccountId(accountId).network;\n}\n\nexport async function getCurrentAccountIdOrFail() {\n  const accountId = await getCurrentAccountId();\n  if (!accountId) {\n    throw new Error('The user is not authorized in the wallet');\n  }\n  return accountId;\n}\n\nexport function getCurrentAccountId(): Promise<string | undefined> {\n  return storage.getItem('currentAccountId');\n}\n\nexport function waitLogin() {\n  return loginPromise;\n}\n","import * as bip39 from 'bip39';\n\nimport { type ApiAccountWithMnemonic, ApiCommonError } from '../types';\n\nimport { updateStoredAccount } from './accounts';\n\nconst PBKDF2_IMPORT_KEY_ARGS = [\n  { name: 'PBKDF2' },\n  false,\n  ['deriveBits', 'deriveKey'],\n] as const;\n\nconst PBKDF2_DERIVE_KEY_ARGS = {\n  name: 'PBKDF2',\n  iterations: 100000, // Higher is more secure but slower\n  hash: 'SHA-256',\n};\n\nconst PBKDF2_DERIVE_KEY_TYPE = { name: 'AES-GCM', length: 256 };\n\nexport function generateBip39Mnemonic() {\n  return bip39.generateMnemonic(256).split(' ');\n}\n\nexport function validateBip39Mnemonic(mnemonic: string[]) {\n  return bip39.validateMnemonic(mnemonic.join(' '));\n}\n\nexport async function tryMigratingMnemonicEncryption(accountId: string, mnemonic: string[], password: string) {\n  try {\n    const mnemonicEncrypted = await encryptMnemonic(mnemonic, password);\n\n    // This is a defensive approach against potential corrupted encryption reported by some users\n    const decryptedMnemonic = await decryptMnemonic(mnemonicEncrypted, password)\n      .catch(() => undefined);\n\n    if (!password || !decryptedMnemonic) {\n      return { error: ApiCommonError.DebugError };\n    }\n\n    await updateStoredAccount<ApiAccountWithMnemonic>(accountId, { mnemonicEncrypted });\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error(err);\n  }\n\n  return undefined;\n}\n\nexport async function encryptMnemonic(mnemonic: string[], password: string) {\n  const plaintext = mnemonic.join(',');\n  const salt = crypto.getRandomValues(new Uint8Array(16)); // generate a 128-bit salt\n  const keyMaterial = await crypto.subtle.importKey(\n    'raw',\n    new TextEncoder().encode(password),\n    ...PBKDF2_IMPORT_KEY_ARGS,\n  );\n  const key = await crypto.subtle.deriveKey(\n    {\n      salt,\n      ...PBKDF2_DERIVE_KEY_ARGS,\n    },\n    keyMaterial,\n    PBKDF2_DERIVE_KEY_TYPE,\n    false,\n    ['encrypt'],\n  );\n  const iv = crypto.getRandomValues(new Uint8Array(12)); // get 96-bit random iv\n  const ptUint8 = new TextEncoder().encode(plaintext); // encode plaintext as UTF-8\n  const ctBuffer = await crypto.subtle.encrypt({ name: 'AES-GCM', iv }, key, ptUint8); // encrypt plaintext using key\n  const ctArray = Array.from(new Uint8Array(ctBuffer)); // ciphertext as byte array\n  const ctBase64 = btoa(String.fromCharCode(...ctArray)); // encode ciphertext as base64\n  const ivHex = Array.from(iv).map((b) => (`00${b.toString(16)}`).slice(-2)).join(''); // iv as hex string\n  const saltHex = Array.from(salt).map((b) => (`00${b.toString(16)}`).slice(-2)).join(''); // salt as hex string\n\n  return `${saltHex}:${ivHex}:${ctBase64}`;\n}\n\nexport async function decryptMnemonic(encrypted: string, password: string) {\n  if (!encrypted.includes(':')) {\n    return decryptMnemonicLegacy(encrypted, password);\n  }\n\n  const [saltHex, ivHex, encryptedData] = encrypted.split(':');\n  const salt = new Uint8Array(saltHex.match(/.{2}/g)!.map((b) => parseInt(b, 16)));\n  const iv = new Uint8Array(ivHex.match(/.{2}/g)!.map((b) => parseInt(b, 16)));\n  const keyMaterial = await crypto.subtle.importKey(\n    'raw',\n    new TextEncoder().encode(password),\n    ...PBKDF2_IMPORT_KEY_ARGS,\n  );\n  const key = await crypto.subtle.deriveKey(\n    { salt, ...PBKDF2_DERIVE_KEY_ARGS },\n    keyMaterial,\n    PBKDF2_DERIVE_KEY_TYPE,\n    false,\n    ['decrypt'],\n  );\n  const ctStr = atob(encryptedData); // decode base64 ciphertext\n  const ctUint8 = new Uint8Array(ctStr.match(/[\\s\\S]/g)!.map((ch) => ch.charCodeAt(0))); // ciphertext as Uint8Array\n  const plainBuffer = await crypto.subtle.decrypt({ name: 'AES-GCM', iv }, key, ctUint8); // decrypt ciphertext using key\n  const plaintext = new TextDecoder().decode(plainBuffer); // decode password from UTF-8\n\n  return plaintext.split(',');\n}\n\nasync function decryptMnemonicLegacy(encrypted: string, password: string) {\n  const pwUtf8 = new TextEncoder().encode(password); // encode password as UTF-8\n  const pwHash = await crypto.subtle.digest('SHA-256', pwUtf8); // hash the password\n  const iv = encrypted.slice(0, 24).match(/.{2}/g)!.map((byte) => parseInt(byte, 16)); // get iv from ciphertext\n  const alg = { name: 'AES-GCM', iv: new Uint8Array(iv) }; // specify algorithm to use\n  const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['decrypt']); // use pw to generate key\n  const ctStr = atob(encrypted.slice(24)); // decode base64 ciphertext\n  const ctUint8 = new Uint8Array(ctStr.match(/[\\s\\S]/g)!.map((ch) => ch.charCodeAt(0))); // ciphertext as Uint8Array\n  const plainBuffer = await crypto.subtle.decrypt(alg, key, ctUint8); // decrypt ciphertext using key\n  const plaintext = new TextDecoder().decode(plainBuffer); // decode password from UTF-8\n\n  return plaintext.split(',');\n}\n\nexport async function getMnemonic(accountId: string, password: string, account: ApiAccountWithMnemonic) {\n  try {\n    const { mnemonicEncrypted } = account;\n    const mnemonic = await decryptMnemonic(mnemonicEncrypted, password);\n\n    if (!mnemonicEncrypted.includes(':')) {\n      await tryMigratingMnemonicEncryption(accountId, mnemonic, password);\n    }\n\n    return mnemonic;\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error(err);\n\n    return undefined;\n  }\n}\n","import type { ApiActivity } from '../api/types';\n\nexport function compareActivities(a: ApiActivity, b: ApiActivity, isAsc = false) {\n  let value = a.timestamp - b.timestamp;\n  if (value === 0) {\n    value = a.id > b.id ? 1 : a.id < b.id ? -1 : 0;\n  }\n  return isAsc ? value : -value;\n}\n","import type { ApiActivity, ApiTransaction, ApiTransactionType } from '../../api/types';\nimport type { LangFn } from '../langProvider';\n\nimport { compareActivities } from '../compareActivities';\nimport { unique } from '../iteratees';\nimport { getIsTransactionWithPoisoning } from '../poisoningHash';\n\ntype UnusualTxType = 'backend-swap' | 'local' | 'additional';\n\nconst TRANSACTION_TYPE_TITLES: { [K in ApiTransactionType & keyof any]?: [complete: string, inProgress: string] } = {\n  stake: ['Staked', 'Staking'],\n  unstake: ['Unstaked', 'Unstaking'],\n  unstakeRequest: ['Unstake Requested', 'Requesting Unstake'],\n  callContract: ['Contract Called', 'Calling Contract'],\n  excess: ['Excess', 'Excess'],\n  contractDeploy: ['Contract Deployed', 'Deploying Contract'],\n  bounced: ['Bounced', 'Bouncing'],\n  mint: ['Minted', 'Minting'],\n  burn: ['Burned', 'Burning'],\n  auctionBid: ['NFT Auction Bid', 'Bidding at NFT Auction'],\n  dnsChangeAddress: ['Address Updated', 'Updating Address'],\n  dnsChangeSite: ['Site Updated', 'Updating Site'],\n  dnsChangeSubdomains: ['Subdomains Updated', 'Updating Subdomains'],\n  dnsChangeStorage: ['Storage Updated', 'Updating Storage'],\n  dnsDelete: ['Domain Record Deleted', 'Deleting Domain Record'],\n  dnsRenew: ['Domain Renewed', 'Renewing Domain'],\n  liquidityDeposit: ['Liquidity Provided', 'Providing Liquidity'],\n  liquidityWithdraw: ['Liquidity Withdrawn', 'Withdrawing Liquidity'],\n};\n\nexport const STAKING_TRANSACTION_TYPES = new Set<ApiTransactionType | undefined>([\n  'stake', 'unstake', 'unstakeRequest',\n]);\n\nexport const DNS_TRANSACTION_TYPES = new Set<ApiTransactionType | undefined>([\n  'dnsChangeAddress', 'dnsChangeSite', 'dnsChangeStorage', 'dnsChangeSubdomains', 'dnsDelete', 'dnsRenew',\n]);\n\nexport function parseTxId(txId: string): {\n  hash: string;\n  subId?: string;\n  type?: UnusualTxType;\n} {\n  const [hash, subId, type] = txId.split(':') as [string, string | undefined, UnusualTxType | undefined];\n  return { hash, type, subId };\n}\n\nexport function getIsTxIdLocal(txId: string) {\n  return txId.endsWith(':local');\n}\n\nexport function getIsBackendSwapId(id: string) {\n  return id.endsWith(':backend-swap');\n}\n\nexport function buildBackendSwapId(backendId: string) {\n  return buildTxId(backendId, undefined, 'backend-swap');\n}\n\nexport function buildLocalTxId(hash: string, subId?: number) {\n  return buildTxId(hash, subId, 'local');\n}\n\nexport function buildTxId(hash: string, subId?: number | string, type?: UnusualTxType) {\n  if (!type && subId === undefined) return hash;\n  if (type === undefined) return `${hash}:${subId}`;\n  return `${hash}:${subId ?? ''}:${type}`;\n}\n\n// eslint-disable-next-line consistent-return\nexport function getActivityTokenSlugs(activity: ApiActivity): string[] {\n  switch (activity.kind) {\n    case 'transaction': {\n      return [activity.slug];\n    }\n    case 'swap': {\n      return [activity.from, activity.to];\n    }\n  }\n}\n\nexport function getIsIdSuitableForFetchingTimestamp(id: string) {\n  return !getIsTxIdLocal(id) && !getIsBackendSwapId(id);\n}\n\nexport function getTransactionTitle(\n  { type, isIncoming }: ApiTransaction,\n  isInProgress: boolean,\n  translate: LangFn,\n) {\n  if (type) {\n    const titles = TRANSACTION_TYPE_TITLES[type];\n    if (titles) {\n      return translate(titles[isInProgress ? 1 : 0]);\n    }\n  }\n  if (isIncoming) {\n    return translate(isInProgress ? 'Receiving' : 'Received');\n  }\n  return translate(isInProgress ? 'Sending' : 'Sent');\n}\n\nexport function isScamTransaction(transaction: ApiTransaction) {\n  return Boolean(transaction.metadata?.isScam)\n    || (transaction.isIncoming && getIsTransactionWithPoisoning(transaction));\n}\n\nexport function shouldShowTransactionComment(transaction: ApiTransaction) {\n  return Boolean(transaction.comment || transaction.encryptedComment)\n    && !STAKING_TRANSACTION_TYPES.has(transaction.type)\n    && !isScamTransaction(transaction);\n}\n\nexport function getTransactionAmountDisplayMode({ type, amount, nft }: ApiTransaction) {\n  const isPlainTransfer = type === undefined && !nft;\n  if (!amount && !isPlainTransfer) {\n    return 'hide';\n  }\n  return type === 'stake' || type === 'unstake'\n    ? 'noSign'\n    : 'normal';\n}\n\nexport function shouldShowTransactionAddress({ type, isIncoming, nft, toAddress }: ApiTransaction) {\n  const shouldHide = STAKING_TRANSACTION_TYPES.has(type) || type === 'burn'\n    || (!isIncoming && nft && toAddress === nft.address);\n\n  return !shouldHide;\n}\n\nexport function mergeActivitiesToMaxTime(array1: ApiActivity[], array2: ApiActivity[]) {\n  if (!array1.length && !array2.length) {\n    return [];\n  } else if (!array1.length && array2.length) {\n    return array2;\n  } else if (!array2.length && array1.length) {\n    return array1;\n  }\n\n  const fromTimestamp = Math.max(\n    array1[array1.length - 1].timestamp,\n    array2[array2.length - 1].timestamp,\n  );\n\n  return [...array1, ...array2]\n    .filter(({ timestamp }) => timestamp >= fromTimestamp)\n    .sort(compareActivities);\n}\n\nexport function mergeActivityIdsToMaxTime(array1: string[], array2: string[], byId: Record<string, ApiActivity>) {\n  if (!array1.length && !array2.length) {\n    return [];\n  } else if (!array1.length && array2.length) {\n    return array2;\n  } else if (!array2.length && array1.length) {\n    return array1;\n  }\n\n  const fromTimestamp = Math.max(\n    byId[array1[array1.length - 1]].timestamp,\n    byId[array2[array2.length - 1]].timestamp,\n  );\n\n  return unique([...array1, ...array2])\n    .filter((id) => byId[id].timestamp >= fromTimestamp)\n    .sort((a, b) => compareActivities(byId[a], byId[b]));\n}\n","import withCache from './withCache';\n\nexport const MEANINGFUL_CHAR_LENGTH = 6;\nconst FILLER = '...';\nconst FILLER_LENGTH = FILLER.length;\n\nexport const shortenAddress = withCache((address: string, shift = MEANINGFUL_CHAR_LENGTH, fromRight = shift) => {\n  if (!address) return undefined;\n\n  if (address.length <= shift + fromRight + FILLER_LENGTH) return address;\n\n  return `${address.slice(0, shift)}${FILLER}${address.slice(-fromRight)}`;\n});\n","import type { ApiTransaction } from '../api/types';\n\nimport { TRANSACTION_ADDRESS_SHIFT } from '../config';\nimport { shortenAddress } from './shortenAddress';\n\nconst cache: Map<string, {\n  timestamp: number;\n  amount: bigint;\n  address: string;\n}> = new Map();\n\nfunction getKey(address: string) {\n  return shortenAddress(address, TRANSACTION_ADDRESS_SHIFT)!;\n}\n\nfunction addToCache(address: string, amount: bigint, timestamp: number) {\n  const key = getKey(address);\n\n  cache.set(key, {\n    address,\n    amount,\n    timestamp,\n  });\n}\n\nfunction getFromCache(address: string) {\n  const key = getKey(address);\n\n  return cache.get(key);\n}\n\nexport function updatePoisoningCache(tx: ApiTransaction) {\n  const { fromAddress: address, amount, timestamp } = tx;\n\n  const cached = getFromCache(address);\n\n  if (!cached || cached.timestamp < timestamp || (cached.timestamp === timestamp && cached.amount > amount)) {\n    addToCache(address, amount, timestamp);\n  }\n}\n\nexport function getIsTransactionWithPoisoning(tx: ApiTransaction) {\n  const { fromAddress: address } = tx;\n\n  const cached = getFromCache(address);\n\n  return cached && cached.address !== address;\n}\n\nexport function clearPoisoningCache() {\n  cache.clear();\n}\n","import { Api, HttpClient } from 'tonapi-sdk-js';\n\nimport type { ApiNetwork } from '../../../types';\n\nimport { TONAPIIO_MAINNET_URL, TONAPIIO_TESTNET_URL } from '../../../../config';\nimport { fetchWithRetry } from '../../../../util/fetch';\nimport { getEnvironment } from '../../../environment';\n\nconst MAX_LIMIT = 500;\nconst EVENTS_LIMIT = 100;\n\nlet apiByNetwork: Record<ApiNetwork, Api<unknown>> | undefined;\n\nfunction getApi(network: ApiNetwork) {\n  if (!apiByNetwork) {\n    const headers = {\n      ...getEnvironment().apiHeaders,\n      'Content-Type': 'application/json',\n    };\n\n    apiByNetwork = {\n      mainnet: new Api(new HttpClient({\n        baseUrl: TONAPIIO_MAINNET_URL,\n        baseApiParams: { headers },\n        customFetch: fetchWithRetry as typeof fetch,\n      })),\n      testnet: new Api(new HttpClient({\n        baseUrl: TONAPIIO_TESTNET_URL,\n        baseApiParams: { headers },\n        customFetch: fetchWithRetry as typeof fetch,\n      })),\n    };\n  }\n\n  return apiByNetwork[network];\n}\n\nexport async function fetchJettonBalances(network: ApiNetwork, account: string) {\n  return (await getApi(network).accounts.getAccountJettonsBalances(account, {\n    supported_extensions: ['custom_payload'],\n  })).balances;\n}\n\nexport async function fetchNftItems(network: ApiNetwork, addresses: string[]) {\n  return (await getApi(network).nft.getNftItemsByAddresses({\n    account_ids: addresses,\n  })).nft_items;\n}\n\nexport async function fetchAccountNfts(network: ApiNetwork, address: string, options?: {\n  collection?: string;\n  offset?: number;\n  limit?: number;\n}) {\n  const { collection, offset, limit } = options ?? {};\n\n  return (await getApi(network).accounts.getAccountNftItems(\n    address,\n    {\n      offset: offset ?? 0,\n      limit: limit ?? MAX_LIMIT,\n      indirect_ownership: true,\n      collection,\n    },\n  )).nft_items;\n}\n\nexport function fetchNftByAddress(network: ApiNetwork, nftAddress: string) {\n  return getApi(network).nft.getNftItemByAddress(nftAddress);\n}\n\nexport async function fetchAccountEvents(network: ApiNetwork, address: string, fromSec: number, limit?: number) {\n  return (await getApi(network).accounts.getAccountEvents(address, {\n    limit: limit ?? EVENTS_LIMIT,\n    start_date: fromSec,\n  })).events;\n}\n","export function toMilliseconds(seconds: number) {\n  return seconds * 1000;\n}\n\nexport function toSeconds(ms: number) {\n  return Math.floor(ms / 1000);\n}\n","import { BRILLIANT_API_BASE_URL, IS_CAPACITOR } from '../config';\n\nconst IPFS_GATEWAY_BASE_URL: string = 'https://ipfs.io/ipfs/';\n\nexport function fetchJsonMetadata(url: string) {\n  url = fixIpfsUrl(url);\n\n  const reserveUrl = `${BRILLIANT_API_BASE_URL}/utils/download-json?url=${url}`;\n\n  if (IS_CAPACITOR) {\n    return fetchJson(reserveUrl);\n  }\n\n  return fetchJson(url).catch(() => {\n    return fetchJson(reserveUrl);\n  });\n}\n\nexport function fixIpfsUrl(url: string) {\n  return url.replace('ipfs://', IPFS_GATEWAY_BASE_URL);\n}\n\nasync function fetchJson(url: string) {\n  const response = await fetch(url);\n  if (!response.ok) {\n    throw Error(`Http error ${response.status}`);\n  }\n  return response.json();\n}\n","function isEmptyObject(obj: Object) {\n  // eslint-disable-next-line no-restricted-syntax\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport default isEmptyObject;\n","/* eslint-disable max-len, no-misleading-character-class, no-control-regex, operator-linebreak */\n/** @copyright Mathias Bynens <https://mathiasbynens.be/>. MIT license. */\nconst RE_SYMBOL_WITH_COMBINING_MARKS =\n  /([\\0-\\u02FF\\u0370-\\u1AAF\\u1B00-\\u1DBF\\u1E00-\\u20CF\\u2100-\\uD7FF\\uE000-\\uFE1F\\uFE30-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])([\\u0300-\\u036F\\u1AB0-\\u1AFF\\u1DC0-\\u1DFF\\u20D0-\\u20FF\\uFE20-\\uFE2F]+)/g;\n/** @copyright Mathias Bynens <https://mathiasbynens.be/>. MIT license. */\nconst RE_LINEBREAK_COMBINING_MARKS =\n  /[\\0-\\x08\\x0E-\\x1F\\x7F-\\x84\\x86-\\x9F\\u0300-\\u034E\\u0350-\\u035B\\u0363-\\u036F\\u0483-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u061C\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08D4-\\u08E1\\u08E3-\\u0903\\u093A-\\u093C\\u093E-\\u094F\\u0951-\\u0957\\u0962\\u0963\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CD\\u09D7\\u09E2\\u09E3\\u0A01-\\u0A03\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AE2\\u0AE3\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0C00-\\u0C03\\u0C3E-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C81-\\u0C83\\u0CBC\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D01-\\u0D03\\u0D3E-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D82\\u0D83\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F71-\\u0F7E\\u0F80-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u180B-\\u180D\\u1885\\u1886\\u18A9\\u1920-\\u192B\\u1930-\\u193B\\u1A17-\\u1A1B\\u1A7F\\u1AB0-\\u1ABE\\u1B00-\\u1B04\\u1B34-\\u1B44\\u1B6B-\\u1B73\\u1B80-\\u1B82\\u1BA1-\\u1BAD\\u1BE6-\\u1BF3\\u1C24-\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE8\\u1CED\\u1CF2-\\u1CF4\\u1CF8\\u1CF9\\u1DC0-\\u1DF5\\u1DFB-\\u1DFF\\u200C\\u200E\\u200F\\u202A-\\u202E\\u2066-\\u206F\\u20D0-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3035\\u3099\\u309A\\uA66F-\\uA672\\uA674-\\uA67D\\uA69E\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA823-\\uA827\\uA880\\uA881\\uA8B4-\\uA8C5\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA953\\uA980-\\uA983\\uA9B3-\\uA9C0\\uAA29-\\uAA36\\uAA43\\uAA4C\\uAA4D\\uAAEB-\\uAAEF\\uAAF5\\uAAF6\\uABE3-\\uABEA\\uABEC\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE2F\\uFFF9-\\uFFFB]|\\uD800[\\uDDFD\\uDEE0\\uDF76-\\uDF7A]|\\uD802[\\uDE01-\\uDE03\\uDE05\\uDE06\\uDE0C-\\uDE0F\\uDE38-\\uDE3A\\uDE3F\\uDEE5\\uDEE6]|\\uD804[\\uDC00-\\uDC02\\uDC38-\\uDC46\\uDC7F-\\uDC82\\uDCB0-\\uDCBA\\uDD00-\\uDD02\\uDD27-\\uDD34\\uDD73\\uDD80-\\uDD82\\uDDB3-\\uDDC0\\uDDCA-\\uDDCC\\uDE2C-\\uDE37\\uDE3E\\uDEDF-\\uDEEA\\uDF00-\\uDF03\\uDF3C\\uDF3E-\\uDF44\\uDF47\\uDF48\\uDF4B-\\uDF4D\\uDF57\\uDF62\\uDF63\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC35-\\uDC46\\uDCB0-\\uDCC3\\uDDAF-\\uDDB5\\uDDB8-\\uDDC0\\uDDDC\\uDDDD\\uDE30-\\uDE40\\uDEAB-\\uDEB7]|\\uD807[\\uDC2F-\\uDC36\\uDC38-\\uDC3F\\uDC92-\\uDCA7\\uDCA9-\\uDCB6]|\\uD81A[\\uDEF0-\\uDEF4\\uDF30-\\uDF36]|\\uD81B[\\uDF51-\\uDF7E\\uDF8F-\\uDF92]|\\uD82F[\\uDC9D\\uDC9E\\uDCA0-\\uDCA3]|\\uD834[\\uDD65-\\uDD69\\uDD6D-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDE42-\\uDE44]|\\uD836[\\uDE00-\\uDE36\\uDE3B-\\uDE6C\\uDE75\\uDE84\\uDE9B-\\uDE9F\\uDEA1-\\uDEAF]|\\uD838[\\uDC00-\\uDC06\\uDC08-\\uDC18\\uDC1B-\\uDC21\\uDC23\\uDC24\\uDC26-\\uDC2A]|\\uD83A[\\uDCD0-\\uDCD6\\uDD44-\\uDD4A]|\\uDB40[\\uDC01\\uDC20-\\uDC7F\\uDD00-\\uDDEF]/g;\nconst RE_SPACE_CHARS = /[\\n\\r]/g;\nconst RE_FAKE_DOTS = /[\\u0702\\u0701\\u2024\\u00B7\\u02D9\\u0971\\u1427\\u18DF\\u22C5\\u2027]/g;\nconst RE_EMPTY_CHARS = /[\\u200B-\\u200D\\uFEFF\\u2063]/g;\n/* eslint-enable max-len, no-misleading-character-class, no-control-regex, operator-linebreak */\n\n/** Skippable characters that are not confusables */\nexport const checkLNPRegex = /^(?:[~`!@#%^&*(){}[\\];:\"'<,.>?/\\\\|_+=-]|[a-zA-Z0-9\\s])+$/;\n\nexport function checkLNP(str: string) {\n  return checkLNPRegex.test(str);\n}\n\n/**\n * Utility function to call 2 other functions which remove Combining Marks/Invisible characters\n * @param str The text to clean.\n */\nexport function clean(str: string) {\n  return str\n    .replace(RE_LINEBREAK_COMBINING_MARKS, '')\n    .replace(RE_SYMBOL_WITH_COMBINING_MARKS, '$1')\n    .replace(RE_SPACE_CHARS, ' ')\n    .replace(RE_FAKE_DOTS, '.')\n    .replace(RE_EMPTY_CHARS, '');\n}\n","export const characters = new Map<string, string>([\n  [' ', ' '],\n  ['0', ''],\n  ['1', '111'],\n  ['2', ''],\n  ['3', ''],\n  ['4', ''],\n  ['5', ''],\n  ['6', ''],\n  ['7', ''],\n  ['8', ''],\n  ['9', ''],\n  ['10', ''],\n  ['11', ''],\n  ['12', ''],\n  ['13', ''],\n  ['14', ''],\n  ['15', ''],\n  ['16', ''],\n  ['17', ''],\n  ['18', ''],\n  ['19', ''],\n  ['20', ''],\n  ['ae', ''],\n  ['OE', ''],\n  ['oe', ''],\n  ['pi', ''],\n  ['Nj', ''],\n  ['AE', ''],\n  ['A', ''],\n  ['a', ''],\n  ['B', ''],\n  ['b', ''],\n  ['C', ''],\n  ['c', ''],\n  ['D', ''],\n  ['d', ''],\n  ['E', ''],\n  ['e', ''],\n  ['F', ''],\n  ['f', ''],\n  ['G', ''],\n  ['g', ''],\n  ['H', ''],\n  ['h', ''],\n  ['I', ''],\n  ['i', ''],\n  ['J', ''],\n  ['j', ''],\n  ['K', ''],\n  ['k', ''],\n  ['L', ''],\n  ['l', '|'],\n  ['M', ''],\n  ['m', ''],\n  ['N', ''],\n  ['n', ''],\n  [\n    'O',\n    // eslint-disable-next-line max-len\n    '',\n  ],\n  [\n    'o',\n    // eslint-disable-next-line max-len\n    '',\n  ],\n  ['P', ''],\n  ['p', ''],\n  ['Q', ''],\n  ['q', ''],\n  ['R', ''],\n  ['r', ''],\n  ['S', ''],\n  ['s', ''],\n  ['T', ''],\n  ['t', ''],\n  ['U', ''],\n  ['u', ''],\n  ['V', ''],\n  ['v', ''],\n  ['W', ''],\n  ['w', ''],\n  ['X', ''],\n  ['x', ''],\n  ['Y', ''],\n  ['y', ''],\n  ['Z', ''],\n  ['z', ''],\n]);\n","// Original repo: https://github.com/gc/confusables\n\nimport { checkLNP, clean } from './util';\nimport { characters } from './characters';\n\nconst alphabetMap = new Map<string, string[]>();\nconst confusablesMap = new Map<string, string>();\n\nfor (const [base, alts] of characters.entries()) {\n  alphabetMap.set(base, [...alts]);\n\n  for (const char of alts) {\n    confusablesMap.set(char, base);\n  }\n}\n\nexport function cleanText(str: string) {\n  if (checkLNP(str)) return str;\n\n  let newStr = '';\n\n  for (const char of clean(str)) {\n    newStr += confusablesMap.get(char) || char;\n  }\n\n  return newStr;\n}\n","import { APP_ENV, APP_VERSION, BRILLIANT_API_BASE_URL } from '../../config';\nimport { fetchJson, fetchWithRetry, handleFetchErrors } from '../../util/fetch';\nimport { getEnvironment } from '../environment';\n\nconst BAD_REQUEST_CODE = 400;\n\nexport async function callBackendPost<T>(path: string, data: AnyLiteral, options?: {\n  authToken?: string;\n  isAllowBadRequest?: boolean;\n  method?: string;\n  shouldRetry?: boolean;\n  retries?: number;\n  timeouts?: number | number[];\n}): Promise<T> {\n  const {\n    authToken, isAllowBadRequest, method, shouldRetry, retries, timeouts,\n  } = options ?? {};\n\n  const url = new URL(`${BRILLIANT_API_BASE_URL}${path}`);\n\n  const init: RequestInit = {\n    method: method ?? 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getBackendHeaders(),\n      ...(authToken && { 'X-Auth-Token': authToken }),\n    },\n    body: JSON.stringify(data),\n  };\n\n  const response = shouldRetry\n    ? await fetchWithRetry(url, init, {\n      retries,\n      timeouts,\n      shouldSkipRetryFn: (message) => !message?.includes('signal is aborted'),\n    })\n    : await fetch(url.toString(), init);\n\n  await handleFetchErrors(response, isAllowBadRequest ? [BAD_REQUEST_CODE] : undefined);\n\n  return response.json();\n}\n\nexport function callBackendGet<T = any>(path: string, data?: AnyLiteral, headers?: HeadersInit): Promise<T> {\n  const url = new URL(`${BRILLIANT_API_BASE_URL}${path}`);\n\n  return fetchJson(url, data, {\n    headers: {\n      ...headers,\n      ...getBackendHeaders(),\n    },\n  });\n}\n\nfunction getBackendHeaders() {\n  return {\n    ...getEnvironment().apiHeaders,\n    'X-App-Version': APP_VERSION,\n    'X-App-Env': APP_ENV,\n  } as Record<string, string>;\n}\n","import type { ApiAddressInfo, ApiKnownAddresses } from '../types';\n\nimport { RE_LINK_TEMPLATE, RE_TG_BOT_MENTION } from '../../config';\nimport { cleanText } from '../../lib/confusables';\nimport { logDebugError } from '../../util/logs';\nimport { callBackendGet } from './backend';\n\nlet knownAddresses: ApiKnownAddresses = {};\nlet scamMarkers: RegExp[] = [];\nlet trustedSites: Set<string> = new Set();\nlet trustedCollections: Set<string> = new Set();\n\nexport async function tryUpdateKnownAddresses() {\n  try {\n    const data = await callBackendGet<{\n      knownAddresses: Record<string, ApiKnownAddresses>;\n      scamMarkers: string[];\n      trustedSites: string[];\n      trustedCollections: string[];\n    }>('/known-addresses');\n\n    knownAddresses = data.knownAddresses;\n    scamMarkers = data.scamMarkers.map((x) => new RegExp(x, 'i'));\n    trustedSites = new Set(data.trustedSites);\n    trustedCollections = new Set(data.trustedCollections);\n  } catch (err) {\n    logDebugError('tryUpdateKnownAddresses', err);\n  }\n}\n\nexport function getKnownAddresses() {\n  return knownAddresses;\n}\n\nexport function getScamMarkers() {\n  return scamMarkers;\n}\n\nexport function getKnownAddressInfo(address: string): ApiAddressInfo | undefined {\n  return knownAddresses[address];\n}\n\nexport function checkIsTrustedSite(domain: string) {\n  return trustedSites.has(domain.toLowerCase());\n}\n\nexport function checkIsTrustedCollection(address: string) {\n  return trustedCollections.has(address);\n}\n\nexport function checkHasScamLink(text: string) {\n  const matches = cleanText(text).matchAll(RE_LINK_TEMPLATE);\n\n  for (const match of matches) {\n    const host = match.groups?.host;\n    if (host && !checkIsTrustedSite(host)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function checkHasTelegramBotMention(text: string) {\n  return RE_TG_BOT_MENTION.test(cleanText(text));\n}\n","import type { Table, UpdateSpec } from 'dexie';\n\nconst IGNORED_DEXIE_ERRORS = new Set(['AbortError', 'BulkError', 'UnknownError']);\n\nasync function tryDbQuery<T>(cb: () => Promise<T>) {\n  try {\n    return await cb();\n  } catch (error: any) {\n    if (IGNORED_DEXIE_ERRORS.has(error?.name)) return undefined;\n    else throw error;\n  }\n}\n\nexport class DbRepository<T> {\n  table: Table<T>;\n\n  constructor(table: Table<T>) {\n    this.table = table;\n  }\n\n  all() {\n    return this.table.toArray();\n  }\n\n  find(where: {\n    [key: string]: any;\n  }) {\n    return tryDbQuery(() => {\n      return this.table.where(where).toArray();\n    });\n  }\n\n  put(item: T) {\n    return tryDbQuery(() => {\n      return this.table.put(item);\n    });\n  }\n\n  bulkPut(items: T[]) {\n    return tryDbQuery(() => {\n      return this.table.bulkPut(items);\n    });\n  }\n\n  update(key: string[], update: UpdateSpec<T>) {\n    return tryDbQuery(() => {\n      return this.table.update(key, update);\n    });\n  }\n\n  delete(key: string[]) {\n    return tryDbQuery(() => {\n      return this.table.delete(key);\n    });\n  }\n\n  deleteWhere(where: {\n    [key: string]: any;\n  }) {\n    return tryDbQuery(() => {\n      return this.table.where(where).delete();\n    });\n  }\n\n  clear() {\n    return tryDbQuery(() => {\n      return this.table.clear();\n    });\n  }\n}\n","import type { Table } from 'dexie';\nimport Dexie from 'dexie';\n\nimport type { ApiNft, ApiToken } from '../types';\n\nimport { DbRepository } from './repository';\n\nexport type ApiDbNft = ApiNft & {\n  accountId: string;\n  collectionAddress: string;\n};\n\nexport type ApiDbSseConnection = {\n  clientId: string;\n};\n\nconst DB_NANE = 'tables';\n\nexport class ApiDb extends Dexie {\n  nfts!: Table<ApiDbNft>;\n\n  tokens!: Table<ApiToken>;\n\n  constructor() {\n    super(DB_NANE);\n    this.version(1).stores({\n      nfts: '[accountId+address], accountId, address, collectionAddress',\n    });\n    this.version(2).stores({\n      sseConnections: '&clientId',\n    });\n    this.version(3).stores({\n      tokens: 'tokenAddress, chain, &slug',\n    });\n  }\n}\n\nexport const apiDb = new ApiDb();\n\nexport const nftRepository = new DbRepository(apiDb.nfts);\nexport const tokenRepository = new DbRepository(apiDb.tokens);\n","import type { ApiBaseCurrency, ApiStakingCommonData, ApiTokenPrice } from '../types';\n\nimport { DEFAULT_PRICE_CURRENCY } from '../../config';\n\nexport type AccountCache = { stakedAt?: number };\n\nlet stakingCommonCache: ApiStakingCommonData;\nconst accountCache: Record<string, AccountCache> = {};\nconst pricesCache: {\n  baseCurrency: ApiBaseCurrency;\n  bySlug: Record<string, ApiTokenPrice>;\n} = {\n  baseCurrency: DEFAULT_PRICE_CURRENCY,\n  bySlug: {},\n};\n\nexport function getAccountCache(accountId: string, address: string) {\n  return accountCache[`${accountId}:${address}`] ?? {};\n}\n\nexport function updateAccountCache(accountId: string, address: string, partial: Partial<AccountCache>) {\n  const key = `${accountId}:${address}`;\n  accountCache[key] = { ...accountCache[key], ...partial };\n}\n\nexport function setStakingCommonCache(data: ApiStakingCommonData) {\n  stakingCommonCache = data;\n}\n\nexport function getStakingCommonCache() {\n  return stakingCommonCache;\n}\n\nexport function getPricesCache() {\n  return pricesCache;\n}\n","import type {\n  ApiChain, ApiToken, ApiTokenWithPrice, OnApiUpdate,\n} from '../types';\n\nimport { TOKEN_INFO } from '../../config';\nimport { tokenRepository } from '../db';\nimport { getPricesCache } from './cache';\n\nconst tokensCache = {\n  ...TOKEN_INFO,\n} as Record<string, ApiToken>;\n\nexport async function loadTokensCache() {\n  const tokens = await tokenRepository.all();\n  return addTokens(tokens);\n}\n\nexport async function addTokens(tokens: ApiToken[], onUpdate?: OnApiUpdate, shouldForceSend?: boolean) {\n  const newTokens: ApiToken[] = [];\n\n  for (let i = 0; i < tokens.length; i++) {\n    const token = tokens[i];\n    const mergedToken = mergeTokenWithCache(token);\n\n    if (!(token.slug in tokensCache)) {\n      newTokens.push(mergedToken);\n    }\n\n    tokensCache[token.slug] = mergedToken;\n    tokens[i] = mergedToken;\n  }\n\n  await tokenRepository.bulkPut(tokens);\n  if ((shouldForceSend || newTokens.length) && onUpdate) {\n    sendUpdateTokens(onUpdate);\n  }\n}\n\nexport function mergeTokenWithCache(token: ApiToken): ApiToken {\n  const cacheToken = tokensCache[token.slug] || {};\n\n  return { ...cacheToken, ...token };\n}\n\nexport function getTokensCache() {\n  return tokensCache;\n}\n\nexport function getTokenBySlug(slug: string) {\n  return getTokensCache()[slug];\n}\n\nexport function getTokenByAddress(tokenAddress: string) {\n  return getTokenBySlug(buildTokenSlug('ton', tokenAddress));\n}\n\nexport function sendUpdateTokens(onUpdate: OnApiUpdate) {\n  const tokens = getTokensCache();\n  const prices = getPricesCache();\n\n  const entries = Object.values(tokens).map((token) => {\n    return [token.slug, {\n      ...token,\n      quote: prices.bySlug[token.slug] ?? {\n        slug: token.slug,\n        price: 0,\n        priceUsd: 0,\n        percentChange24h: 0,\n      },\n    }] as [string, ApiTokenWithPrice];\n  });\n\n  onUpdate({\n    type: 'updateTokens',\n    tokens: Object.fromEntries(entries),\n    baseCurrency: prices.baseCurrency,\n  });\n}\n\nexport function buildTokenSlug(chain: ApiChain, address: string) {\n  const addressPart = address.replace(/[^a-z\\d]/gi, '').slice(0, 10);\n  return `${chain}-${addressPart}`.toLowerCase();\n}\n","import type { ApiNetwork, ApiWalletInfo } from '../../../types';\nimport type { ApiTonWalletVersion } from '../types';\nimport type { AccountState, AddressBook, WalletState, WalletVersion } from './types';\n\nimport { TONCENTER_MAINNET_URL, TONCENTER_TESTNET_URL } from '../../../../config';\nimport { buildTxId } from '../../../../util/activities';\nimport { fetchJson } from '../../../../util/fetch';\nimport { buildCollectionByKey, mapValues, split } from '../../../../util/iteratees';\nimport { toBase64Address, toRawAddress } from '../util/tonCore';\nimport { getEnvironment } from '../../../environment';\n\nconst ADDRESS_BOOK_CHUNK_SIZE = 128;\nconst VERSION_MAP: Record<WalletVersion, ApiTonWalletVersion> = {\n  'wallet v1 r1': 'simpleR1',\n  'wallet v1 r2': 'simpleR2',\n  'wallet v1 r3': 'simpleR3',\n  'wallet v2 r1': 'v2R1',\n  'wallet v2 r2': 'v2R2',\n  'wallet v3 r1': 'v3R1',\n  'wallet v3 r2': 'v3R2',\n  // 'wallet v4 r1': '', // Not used in production, wrapper is missing\n  'wallet v4 r2': 'v4R2',\n  // 'wallet v5 beta': '', // Not used in production, wrapper is missing\n  'wallet v5 r1': 'W5',\n};\n\nexport async function fetchAddressBook(network: ApiNetwork, addresses: string[]): Promise<AddressBook> {\n  const chunks = split(addresses, ADDRESS_BOOK_CHUNK_SIZE);\n\n  const results = await Promise.all(chunks.map((chunk) => {\n    return callToncenterV3(network, '/addressBook', {\n      address: chunk,\n    });\n  }));\n\n  return results.reduce((acc, value) => {\n    return Object.assign(acc, value);\n  }, {} as AddressBook);\n}\n\nexport async function fixAddressFormat(network: ApiNetwork, address: string): Promise<string> {\n  const result: { address_book: Record<string, string> } = await callToncenterV3(network, '/addressBook', { address });\n  return result.address_book[address];\n}\n\nexport async function getWalletStates(network: ApiNetwork, addresses: string[]) {\n  const { wallets: states } = await callToncenterV3<{\n    addressBook: AddressBook;\n    wallets: WalletState[];\n  }>(network, '/walletStates', { address: addresses.join(',') });\n\n  const addressByRaw = Object.fromEntries(addresses.map((address) => [toRawAddress(address).toUpperCase(), address]));\n  for (const state of states) {\n    state.address = addressByRaw[state.address];\n  }\n  return buildCollectionByKey(states, 'address');\n}\n\nexport async function getWalletInfos(network: ApiNetwork, addresses: string[]): Promise<Record<string, ApiWalletInfo>> {\n  const states = await getWalletStates(network, addresses);\n  return mapValues(states, (state) => {\n    return {\n      address: toBase64Address(state.address, false),\n      version: VERSION_MAP[state.wallet_type],\n      balance: BigInt(state.balance),\n      isInitialized: state.status === 'active',\n      lastTxId: state.last_transaction_hash ? buildTxId(state.last_transaction_hash) : undefined,\n    };\n  });\n}\n\nexport async function getAccountStates(network: ApiNetwork, addresses: string[]) {\n  const { accounts: states } = await callToncenterV3<{\n    addressBook: AddressBook;\n    accounts: AccountState[];\n  }>(network, '/accountStates', { address: addresses.join(',') });\n\n  const addressByRaw = Object.fromEntries(addresses.map((address) => [toRawAddress(address), address]));\n  for (const state of states) {\n    state.address = addressByRaw[state.address.toLowerCase()];\n  }\n  return buildCollectionByKey(states, 'address');\n}\n\nexport function callToncenterV3<T = any>(network: ApiNetwork, path: string, data?: AnyLiteral) {\n  const { apiHeaders, toncenterMainnetKey, toncenterTestnetKey } = getEnvironment();\n  const baseUrl = network === 'testnet' ? TONCENTER_TESTNET_URL : TONCENTER_MAINNET_URL;\n  const url = `${baseUrl}/api/v3${path}`;\n  const apiKey = network === 'testnet' ? toncenterTestnetKey : toncenterMainnetKey;\n\n  return fetchJson(url, data, {\n    headers: {\n      ...(apiKey && { 'X-Api-Key': apiKey }),\n      ...apiHeaders,\n    },\n  }) as Promise<T>;\n}\n","import type { NftItem } from 'tonapi-sdk-js';\nimport type { DictionaryValue } from '@ton/core';\nimport { BitReader } from '@ton/core/dist/boc/BitReader';\nimport { BitString } from '@ton/core/dist/boc/BitString';\nimport { Builder } from '@ton/core/dist/boc/Builder';\nimport { Cell } from '@ton/core/dist/boc/Cell';\nimport { Slice } from '@ton/core/dist/boc/Slice';\nimport { Dictionary } from '@ton/core/dist/dict/Dictionary';\n\nimport type {\n  ApiMtwCardTextType,\n  ApiMtwCardType,\n  ApiNetwork,\n  ApiNft,\n  ApiNftMetadata,\n  ApiParsedPayload,\n  ApiTransaction,\n} from '../../../types';\nimport type { DnsCategory } from '../constants';\nimport type { JettonMetadata } from '../types';\n\nimport {\n  DEBUG,\n  LIQUID_JETTON,\n  MTW_CARDS_COLLECTION,\n  NFT_FRAGMENT_COLLECTIONS,\n  NFT_FRAGMENT_GIFT_IMAGE_TO_URL_REGEX,\n  NFT_FRAGMENT_GIFT_IMAGE_URL_PREFIX,\n} from '../../../../config';\nimport isEmptyObject from '../../../../util/isEmptyObject';\nimport { omitUndefined, pick, range } from '../../../../util/iteratees';\nimport { logDebugError } from '../../../../util/logs';\nimport { fetchJsonMetadata, fixIpfsUrl } from '../../../../util/metadata';\nimport { JettonStakingOpCodes } from '../contracts/JettonStaking/imports/constants';\nimport { checkHasScamLink, checkIsTrustedCollection } from '../../../common/addresses';\nimport { buildTokenSlug } from '../../../common/tokens';\nimport { base64ToString, sha256 } from '../../../common/utils';\nimport {\n  DNS_CATEGORY_HASH_MAP,\n  DnsOpCode,\n  JettonOpCode,\n  LiquidStakingOpCode,\n  NftOpCode,\n  OpCode,\n  OtherOpCode,\n  SingleNominatorOpCode,\n  VestingV1OpCode,\n} from '../constants';\nimport { fixAddressFormat } from '../toncenter/other';\nimport { fetchNftItems } from './tonapiio';\nimport {\n  getDnsItemDomain, getJettonMinterData, resolveTokenAddress, toBase64Address,\n} from './tonCore';\n\nconst OFFCHAIN_CONTENT_PREFIX = 0x01;\nconst SNAKE_PREFIX = 0x00;\n\nexport function fixBase64ImageData(data: string) {\n  const decodedData = base64ToString(data);\n  if (decodedData.includes('<svg')) {\n    return `data:image/svg+xml;base64,${data}`;\n  }\n  return `data:image/png;base64,${data}`;\n}\n\nconst dictSnakeBufferValue: DictionaryValue<Buffer> = {\n  parse: (slice) => {\n    const buffer = Buffer.from('');\n\n    const sliceToVal = (s: Slice, v: Buffer, isFirst: boolean) => {\n      if (isFirst && s.loadUint(8) !== SNAKE_PREFIX) {\n        throw new Error('Only snake format is supported');\n      }\n\n      v = Buffer.concat([v, s.loadBuffer(s.remainingBits / 8)]);\n      if (s.remainingRefs === 1) {\n        v = sliceToVal(s.loadRef().beginParse(), v, false);\n      }\n\n      return v;\n    };\n\n    return sliceToVal(slice.loadRef().beginParse() as any, buffer, true);\n  },\n  serialize: () => {\n    // pass\n  },\n};\n\nconst jettonOnChainMetadataSpec: {\n  [key in keyof JettonMetadata]: 'utf8' | 'ascii' | undefined;\n} = {\n  uri: 'ascii',\n  name: 'utf8',\n  description: 'utf8',\n  image: 'ascii',\n  symbol: 'utf8',\n  decimals: 'utf8',\n  custom_payload_api_uri: 'ascii',\n};\n\nexport async function fetchJettonMetadata(network: ApiNetwork, address: string) {\n  const { content } = await getJettonMinterData(network, address);\n\n  let metadata: JettonMetadata;\n\n  const slice = content.asSlice();\n  const prefix = slice.loadUint(8);\n\n  if (prefix === OFFCHAIN_CONTENT_PREFIX) {\n    const bytes = readSnakeBytes(slice);\n    const contentUri = bytes.toString('utf-8');\n    metadata = await fetchJettonOffchainMetadata(contentUri);\n  } else {\n    // On-chain content\n    metadata = await parseJettonOnchainMetadata(slice);\n    if (metadata.uri) {\n      // Semi-chain content\n      const offchainMetadata = await fetchJettonOffchainMetadata(metadata.uri);\n      metadata = { ...offchainMetadata, ...metadata };\n    }\n  }\n\n  return metadata;\n}\n\nexport async function parseJettonOnchainMetadata(slice: Slice): Promise<JettonMetadata> {\n  const dict = slice.loadDict(Dictionary.Keys.Buffer(32), dictSnakeBufferValue);\n\n  const res: { [s in keyof JettonMetadata]?: string } = {};\n\n  for (const [key, value] of Object.entries(jettonOnChainMetadataSpec)) {\n    const sha256Key = Buffer.from(await sha256(Buffer.from(key, 'ascii')));\n    const val = dict.get(sha256Key)?.toString(value);\n\n    if (val) {\n      res[key as keyof JettonMetadata] = val;\n    }\n  }\n\n  return res as JettonMetadata;\n}\n\nexport async function fetchJettonOffchainMetadata(uri: string): Promise<JettonMetadata> {\n  const metadata = await fetchJsonMetadata(uri);\n  return pick(metadata, [\n    'name',\n    'description',\n    'symbol',\n    'decimals',\n    'image',\n    'image_data',\n    'custom_payload_api_uri',\n  ]);\n}\n\nexport async function parsePayloadBase64(\n  network: ApiNetwork,\n  address: string,\n  base64: string,\n): Promise<ApiParsedPayload> {\n  const slice = dataToSlice(base64);\n  const result: ApiParsedPayload = { type: 'unknown', base64 };\n\n  if (!slice) return result;\n\n  return await parsePayloadSlice(network, address, slice, true) ?? result;\n}\n\nexport async function parsePayloadSlice(\n  network: ApiNetwork,\n  address: string,\n  slice: Slice,\n  shouldLoadItems?: boolean,\n  transactionDebug?: ApiTransaction,\n): Promise<ApiParsedPayload | undefined> {\n  let opCode: number | undefined;\n  try {\n    opCode = slice.loadUint(32);\n\n    if (opCode === OpCode.Comment) {\n      const buffer = readSnakeBytes(slice);\n      const comment = buffer.toString('utf-8');\n      return { type: 'comment', comment };\n    } else if (opCode === OpCode.Encrypted) {\n      const buffer = readSnakeBytes(slice);\n      const encryptedComment = buffer.toString('base64');\n      return { type: 'encrypted-comment', encryptedComment };\n    } else if (slice.remainingBits < 64) {\n      return undefined;\n    }\n\n    const queryId = slice.loadUintBig(64);\n\n    switch (opCode) {\n      case JettonOpCode.Transfer: {\n        const tokenAddress = await resolveTokenAddress(network, address).catch(() => '');\n        const slug = buildTokenSlug('ton', tokenAddress);\n\n        const amount = slice.loadCoins();\n        const destination = slice.loadAddress();\n        const responseDestination = slice.loadMaybeAddress();\n\n        if (!responseDestination) {\n          return {\n            type: 'tokens:transfer-non-standard',\n            queryId,\n            destination: toBase64Address(destination, undefined, network),\n            amount,\n            slug,\n          };\n        }\n\n        const customPayload = slice.loadMaybeRef();\n        const forwardAmount = slice.loadCoins();\n        let forwardPayload = slice.loadMaybeRef();\n        let forwardPayloadOpCode: number | undefined;\n\n        if (!forwardPayload && slice.remainingBits) {\n          const builder = new Builder().storeBits(slice.loadBits(slice.remainingBits));\n          range(0, slice.remainingRefs).forEach(() => {\n            builder.storeRef(slice.loadRef());\n          });\n          forwardPayload = builder.endCell();\n        }\n\n        if (forwardPayload) {\n          const forwardPayloadSlice = forwardPayload.beginParse();\n          if (forwardPayloadSlice.remainingBits > 32) {\n            forwardPayloadOpCode = forwardPayloadSlice.loadUint(32);\n          }\n        }\n\n        return {\n          type: 'tokens:transfer',\n          queryId,\n          amount,\n          destination: toBase64Address(destination, undefined, network),\n          responseDestination: toBase64Address(responseDestination, undefined, network),\n          customPayload: customPayload?.toBoc().toString('base64'),\n          forwardAmount,\n          forwardPayload: forwardPayload?.toBoc().toString('base64'),\n          forwardPayloadOpCode,\n          slug,\n        };\n      }\n      case NftOpCode.TransferOwnership: {\n        const newOwner = slice.loadAddress();\n        const responseDestination = slice.loadAddress();\n        const customPayload = slice.loadMaybeRef();\n        const forwardAmount = slice.loadCoins();\n        const forwardPayload = readForwardPayloadCell(slice);\n        const comment = forwardPayload ? readComment(forwardPayload.asSlice()) : undefined;\n\n        let nft: ApiNft | undefined;\n        if (shouldLoadItems) {\n          const [rawNft] = await fetchNftItems(network, [address]);\n          if (rawNft) {\n            nft = parseTonapiioNft(network, rawNft);\n          }\n        }\n\n        return {\n          type: 'nft:transfer',\n          queryId,\n          newOwner: toBase64Address(newOwner, undefined, network),\n          responseDestination: toBase64Address(responseDestination, undefined, network),\n          customPayload: customPayload?.toBoc().toString('base64'),\n          forwardAmount,\n          forwardPayload: forwardPayload?.toBoc().toString('base64'),\n          nftAddress: address,\n          nftName: nft?.name,\n          nft,\n          comment,\n        };\n      }\n      case NftOpCode.OwnershipAssigned: {\n        const prevOwner = slice.loadAddress();\n        const forwardPayload = readForwardPayloadCell(slice);\n        const comment = forwardPayload ? readComment(forwardPayload.asSlice()) : undefined;\n\n        let nft: ApiNft | undefined;\n        if (shouldLoadItems) {\n          const [rawNft] = await fetchNftItems(network, [address]);\n          if (rawNft) {\n            nft = parseTonapiioNft(network, rawNft);\n          }\n        }\n\n        return {\n          type: 'nft:ownership-assigned',\n          queryId,\n          prevOwner: toBase64Address(prevOwner, undefined, network),\n          comment,\n          nftAddress: address,\n          nft,\n        };\n      }\n      case JettonOpCode.Burn: {\n        const tokenAddress = await resolveTokenAddress(network, address);\n        const slug = buildTokenSlug('ton', tokenAddress);\n\n        const amount = slice.loadCoins();\n        const addressObj = slice.loadAddress();\n        const customPayload = slice.loadMaybeRef();\n        const isLiquidUnstakeRequest = tokenAddress === LIQUID_JETTON;\n\n        return {\n          type: 'tokens:burn',\n          queryId,\n          amount,\n          address: toBase64Address(addressObj, undefined, network),\n          customPayload: customPayload?.toBoc().toString('base64'),\n          slug,\n          isLiquidUnstakeRequest,\n        };\n      }\n      case LiquidStakingOpCode.DistributedAsset: {\n        return {\n          type: 'liquid-staking:withdrawal-nft',\n          queryId,\n        };\n      }\n      case LiquidStakingOpCode.Withdrawal: {\n        return {\n          type: 'liquid-staking:withdrawal',\n          queryId,\n        };\n      }\n      case LiquidStakingOpCode.Deposit: {\n        let appId: bigint | undefined;\n        if (slice.remainingBits > 0) {\n          appId = slice.loadUintBig(64);\n        }\n        return {\n          type: 'liquid-staking:deposit',\n          queryId,\n          appId,\n        };\n      }\n      case VestingV1OpCode.AddWhitelist: {\n        const toAddress = slice.loadAddress();\n        const addressString = shouldLoadItems\n          ? await fixAddressFormat(network, toAddress.toRawString())\n          : '';\n\n        return {\n          type: 'vesting:add-whitelist',\n          queryId,\n          address: addressString,\n        };\n      }\n      case SingleNominatorOpCode.Withdraw: {\n        const amount = slice.loadCoins();\n        return {\n          type: 'single-nominator:withdraw',\n          queryId,\n          amount,\n        };\n      }\n      case SingleNominatorOpCode.ChangeValidator: {\n        const toAddress = slice.loadAddress();\n        const addressString = shouldLoadItems\n          ? await fixAddressFormat(network, toAddress.toRawString())\n          : '';\n\n        return {\n          type: 'single-nominator:change-validator',\n          queryId,\n          address: addressString,\n        };\n      }\n      case LiquidStakingOpCode.Vote: {\n        const votingAddress = slice.loadAddress();\n        const expirationDate = slice.loadUint(48);\n        const vote = slice.loadBit();\n        const needConfirmation = slice.loadBit();\n\n        return {\n          type: 'liquid-staking:vote',\n          queryId,\n          votingAddress: toBase64Address(votingAddress, true),\n          expirationDate,\n          vote,\n          needConfirmation,\n        };\n      }\n      case DnsOpCode.ChangeRecord: {\n        const hash = slice.loadBuffer(32).toString('hex');\n        const category = Object.entries(DNS_CATEGORY_HASH_MAP)\n          .find(([, value]) => hash === value)?.[0] as DnsCategory ?? 'unknown';\n        const toAddress = slice.loadAddress();\n        const domain = shouldLoadItems\n          ? await getDnsItemDomain(network, toAddress)\n          : '';\n\n        if (category === 'wallet') {\n          if (slice.remainingRefs > 0) {\n            const dataSlice = slice.loadRef().beginParse();\n            slice.endParse();\n\n            const dataAddress = dataSlice.loadAddress();\n            const flags = dataSlice.loadUint(8);\n\n            const addressString = shouldLoadItems\n              ? await fixAddressFormat(network, dataAddress.toRawString())\n              : '';\n\n            return {\n              type: 'dns:change-record',\n              queryId,\n              record: {\n                type: 'wallet',\n                value: addressString,\n                flags,\n              },\n              domain,\n            };\n          } else {\n            return {\n              type: 'dns:change-record',\n              queryId,\n              record: {\n                type: 'wallet',\n                value: undefined,\n              },\n              domain,\n            };\n          }\n        } else if (slice.remainingRefs > 0) {\n          const value = slice.loadRef();\n          return {\n            type: 'dns:change-record',\n            queryId,\n            record: category === 'unknown' ? {\n              type: 'unknown',\n              key: hash,\n              value: value.toBoc().toString('base64'),\n            } : {\n              type: category,\n              value: value.toBoc().toString('base64'),\n            },\n            domain,\n          };\n        } else {\n          return {\n            type: 'dns:change-record',\n            queryId,\n            record: category === 'unknown' ? {\n              type: 'unknown',\n              key: hash,\n            } : {\n              type: category,\n            },\n            domain,\n          };\n        }\n      }\n      case OtherOpCode.TokenBridgePaySwap: {\n        const swapId = slice.loadBuffer(32).toString('hex');\n        return {\n          type: 'token-bridge:pay-swap',\n          queryId,\n          swapId,\n        };\n      }\n      case JettonStakingOpCodes.UNSTAKE_JETTONS: {\n        const amount = slice.loadCoins();\n        const isForce = slice.loadBoolean();\n        return {\n          type: 'jetton-staking:unstake',\n          queryId,\n          amount,\n          isForce,\n        };\n      }\n    }\n  } catch (err) {\n    if (DEBUG) {\n      const debugTxString = transactionDebug\n        && `${transactionDebug.txId} ${new Date(transactionDebug.timestamp)}`;\n      const opCodeHex = `0x${opCode?.toString(16).padStart(8, '0')}`;\n      logDebugError('parsePayload', opCodeHex, debugTxString, '\\n', err);\n    }\n  }\n\n  return undefined;\n}\n\nfunction dataToSlice(data: string | Buffer | Uint8Array): Slice {\n  let buffer: Buffer;\n  if (typeof data === 'string') {\n    buffer = Buffer.from(data, 'base64');\n  } else if (data instanceof Buffer) {\n    buffer = data;\n  } else {\n    buffer = Buffer.from(data);\n  }\n\n  try {\n    return Cell.fromBoc(buffer)[0].beginParse();\n  } catch (err: any) {\n    if (err?.message !== 'Invalid magic') {\n      throw err;\n    }\n  }\n\n  return new Slice(new BitReader(new BitString(buffer, 0, buffer.length * 8)), []);\n}\n\nexport function readComment(slice: Slice) {\n  if (slice.remainingBits < 32) {\n    return undefined;\n  }\n\n  const opCode = slice.loadUint(32);\n  if (opCode !== OpCode.Comment || (!slice.remainingBits && !slice.remainingRefs)) {\n    return undefined;\n  }\n\n  const buffer = readSnakeBytes(slice);\n  return buffer.toString('utf-8');\n}\n\nfunction readForwardPayloadCell(slice: Slice) {\n  let forwardPayload = slice.loadBit() && slice.remainingRefs ? slice.loadRef() : undefined;\n\n  if (!forwardPayload && slice.remainingBits) {\n    const builder = new Builder().storeBits(slice.loadBits(slice.remainingBits));\n    range(0, slice.remainingRefs).forEach(() => {\n      builder.storeRef(slice.loadRef());\n    });\n    forwardPayload = builder.endCell();\n  }\n\n  return forwardPayload ?? undefined;\n}\n\nexport function readSnakeBytes(slice: Slice) {\n  let buffer = Buffer.alloc(0);\n\n  while (slice.remainingBits >= 8) {\n    buffer = Buffer.concat([buffer, slice.loadBuffer(slice.remainingBits / 8)]);\n    if (slice.remainingRefs) {\n      slice = slice.loadRef().beginParse();\n    } else {\n      break;\n    }\n  }\n\n  return buffer;\n}\n\nfunction buildMtwCardsNftMetadata(metadata: Record<string, any>): ApiNftMetadata | undefined {\n  const { image, id } = metadata as { image?: string; id?: number };\n\n  let mtwCardType: ApiMtwCardType | undefined;\n  let mtwCardTextType: ApiMtwCardTextType | undefined;\n  let result: ApiNftMetadata = {};\n  if (image) result.imageUrl = image;\n  if (id !== undefined) result.mtwCardId = id;\n\n  if ('attributes' in metadata && Array.isArray(metadata.attributes) && metadata.attributes.length) {\n    mtwCardType = metadata.attributes\n      .find((attribute) => attribute.trait_type === 'Card Type')?.value\n      // Clean non-ascii characters with regex\n      .replace(/[^\\x20-\\x7E]/g, '')\n      .trim()\n      .toLowerCase();\n\n    if (mtwCardType) {\n      mtwCardTextType = metadata.attributes.find((attribute) => attribute.trait_type === 'Text')?.value.toLowerCase();\n\n      result.mtwCardType = mtwCardType;\n      if (mtwCardType === 'standard') {\n        result.mtwCardBorderShineType = metadata.attributes.find((attribute) => {\n          return attribute.trait_type === 'Shine';\n        })?.value.toLowerCase();\n      }\n\n      if (mtwCardTextType === 'dark' || mtwCardType === 'silver') {\n        result.mtwCardTextType = 'dark';\n      } else {\n        result.mtwCardTextType = 'light';\n      }\n\n      result = omitUndefined(result);\n    }\n  }\n\n  return !isEmptyObject(result) ? result : undefined;\n}\n\nexport function parseTonapiioNft(network: ApiNetwork, rawNft: NftItem): ApiNft | undefined {\n  if (!rawNft.metadata) {\n    return undefined;\n  }\n\n  try {\n    const {\n      address,\n      index,\n      collection,\n      metadata: rawMetadata,\n      previews,\n      sale,\n      trust,\n      owner,\n    } = rawNft;\n\n    const {\n      name, image, description, render_type: renderType, lottie,\n    } = rawMetadata as {\n      name?: string;\n      image?: string;\n      description?: string;\n      render_type?: string;\n      lottie?: string;\n    };\n\n    const collectionAddress = collection && toBase64Address(collection.address, true, network);\n    let hasScamLink = false;\n\n    if (!collectionAddress || !checkIsTrustedCollection(collectionAddress)) {\n      for (const text of [name, description].filter(Boolean)) {\n        if (checkHasScamLink(text)) {\n          hasScamLink = true;\n        }\n      }\n    }\n\n    const isWhitelisted = trust === 'whitelist';\n    const isScam = hasScamLink || description === 'SCAM' || trust === 'blacklist';\n    const isHidden = renderType === 'hidden' || isScam;\n    const imageFromPreview = previews!.find((x) => x.resolution === '1500x1500')!.url;\n    const isFragmentGift = image?.startsWith(NFT_FRAGMENT_GIFT_IMAGE_URL_PREFIX);\n\n    const metadata = {\n      ...(isWhitelisted && { lottie }),\n      ...(collectionAddress === MTW_CARDS_COLLECTION && buildMtwCardsNftMetadata(rawMetadata)),\n      ...(isFragmentGift && { fragmentUrl: image!.replace(NFT_FRAGMENT_GIFT_IMAGE_TO_URL_REGEX, 'https://$1') }),\n    };\n\n    return omitUndefined<ApiNft>({\n      index,\n      name,\n      ownerAddress: owner ? toBase64Address(owner.address, false, network) : undefined,\n      address: toBase64Address(address, true, network),\n      image: fixIpfsUrl(imageFromPreview || image || ''),\n      thumbnail: previews!.find((x) => x.resolution === '500x500')!.url,\n      isOnSale: Boolean(sale),\n      isHidden,\n      isScam,\n      description,\n      ...(collection && {\n        collectionAddress,\n        collectionName: collection.name,\n        isOnFragment: isFragmentGift || NFT_FRAGMENT_COLLECTIONS.has(collection.address),\n      }),\n      metadata,\n    });\n  } catch (err) {\n    logDebugError('buildNft', err);\n    return undefined;\n  }\n}\n","import type { Slice } from '@ton/core';\nimport { Cell } from '@ton/core';\n\nimport type {\n  ApiActivity,\n  ApiNetwork,\n  ApiNft,\n  ApiSwapActivity,\n  ApiToken,\n  ApiTransactionActivity,\n  ApiTransactionType,\n} from '../../../types';\nimport type {\n  AddressBook,\n  AnyAction,\n  AnyTokenMetadata,\n  AuctionBidAction,\n  CallContractAction,\n  ChangeDnsAction,\n  ContractDeployAction,\n  DeleteDnsAction,\n  DexDepositLiquidityAction,\n  DexWithdrawLiquidityAction,\n  JettonBurnAction,\n  JettonMasterMetadata,\n  JettonMintAction,\n  JettonTransferAction,\n  MetadataMap,\n  NftCollectionMetadata,\n  NftItemMetadata,\n  NftMintAction,\n  NftTransferAction,\n  RenewDnsAction,\n  StakeDepositAction,\n  StakeWithdrawalAction,\n  StakeWithdrawalRequestAction,\n  SwapAction,\n  TonTransferAction,\n} from './types';\n\nimport {\n  BURN_ADDRESS,\n  DNS_IMAGE_GEN_URL,\n  LIQUID_POOL,\n  MYCOIN_STAKING_POOL,\n  NFT_FRAGMENT_COLLECTIONS,\n  NFT_FRAGMENT_GIFT_IMAGE_TO_URL_REGEX,\n  NFT_FRAGMENT_GIFT_IMAGE_URL_PREFIX,\n  STON_PTON_ADDRESS,\n  TONCOIN,\n} from '../../../../config';\nimport { buildTxId } from '../../../../util/activities';\nimport { toMilliseconds, toSeconds } from '../../../../util/datetime';\nimport { toDecimal } from '../../../../util/decimals';\nimport { getDnsDomainZone } from '../../../../util/dns';\nimport { omitUndefined } from '../../../../util/iteratees';\nimport { fixIpfsUrl } from '../../../../util/metadata';\nimport safeExec from '../../../../util/safeExec';\nimport { readComment } from '../util/metadata';\nimport { toBase64Address } from '../util/tonCore';\nimport { checkHasScamLink, checkIsTrustedCollection } from '../../../common/addresses';\nimport { buildTokenSlug, getTokenBySlug } from '../../../common/tokens';\nimport {\n  EXCESS_OP_CODES,\n  JettonStakingOpCode,\n  OpCode,\n  OUR_FEE_PAYLOAD_BOC,\n  TeleitemOpCode,\n} from '../constants';\nimport { callToncenterV3 } from './other';\n\ntype ActionsResponse = {\n  actions: AnyAction[];\n  address_book: AddressBook;\n  metadata?: MetadataMap;\n};\n\ntype ParseOptions<T extends AnyAction = AnyAction> = {\n  network: ApiNetwork;\n  action: T;\n  addressBook: AddressBook;\n  walletAddress: string;\n  metadata: MetadataMap;\n};\n\ntype PartialTx = Pick<ApiTransactionActivity, 'kind' | 'id' | 'txId' | 'timestamp' | 'fee' | 'externalMsgHash'>;\n\nconst TME_RENEW_HASH_SUFFIX = '0000000000000000000000000000000000000000000000';\n\nexport async function fetchActions(options: {\n  network: ApiNetwork;\n  address: string | string[];\n  limit: number;\n  walletAddress: string;\n  fromTimestamp?: number;\n  toTimestamp?: number;\n  shouldIncludeFrom?: boolean;\n  shouldIncludeTo?: boolean;\n  includeTypes?: AnyAction['type'][];\n  excludeTypes?: AnyAction['type'][];\n}): Promise<ApiActivity[]> {\n  const {\n    network, address, limit, toTimestamp, fromTimestamp,\n    shouldIncludeFrom, shouldIncludeTo, walletAddress,\n    includeTypes, excludeTypes,\n  } = options;\n\n  const {\n    actions: rawActions,\n    address_book: addressBook,\n    metadata = {},\n  } = await callToncenterV3<ActionsResponse>(network, '/actions', {\n    account: address,\n    limit,\n    start_utime: fromTimestamp && toSeconds(fromTimestamp) + (!shouldIncludeFrom ? 1 : 0),\n    end_utime: toTimestamp && toSeconds(toTimestamp) - (!shouldIncludeTo ? 1 : 0),\n    sort: 'desc',\n    ...(includeTypes?.length && { action_type: includeTypes.join(',') }),\n    ...(excludeTypes?.length && { exclude_action_type: excludeTypes.join(',') }),\n  });\n\n  const result: ApiActivity[] = [];\n\n  for (const action of rawActions) {\n    const activities = await parseAction(action, {\n      network, action, addressBook, walletAddress, metadata,\n    });\n\n    for (const activity of activities) {\n      result.push(activity);\n    }\n  }\n\n  return result;\n}\n\nfunction parseAction(action: AnyAction, options: ParseOptions): MaybePromise<ApiActivity[]> {\n  const id = buildActionActivityId(action);\n\n  const partialTx: PartialTx = {\n    kind: 'transaction',\n    id,\n    txId: id,\n    timestamp: toMilliseconds(action.end_utime),\n    externalMsgHash: action.trace_external_hash,\n    fee: 0n, // Calculated when TransactionModal opens\n  };\n\n  let result: (ApiActivity | undefined)[] = [];\n\n  switch (action.type) {\n    case 'ton_transfer': {\n      result = [parseTonTransfer(action, options, partialTx)];\n      break;\n    }\n    case 'call_contract': {\n      result = [parseCallContract(action, options, partialTx)];\n      break;\n    }\n    case 'contract_deploy': {\n      result = [parseContractDeploy(action, options, partialTx)];\n      break;\n    }\n    case 'nft_transfer': {\n      result = [parseNftTransfer(action, options, partialTx)];\n      break;\n    }\n    case 'nft_mint': {\n      result = [parseNftMint(action, options, partialTx)];\n      break;\n    }\n    case 'jetton_transfer': {\n      result = [parseJettonTransfer(action, options, partialTx)];\n      break;\n    }\n    case 'jetton_mint': {\n      result = [parseJettonMint(action, options, partialTx)];\n      break;\n    }\n    case 'jetton_burn': {\n      result = [parseJettonBurn(action, options, partialTx)];\n      break;\n    }\n    case 'stake_deposit': {\n      result = [parseStakeDeposit(action, options, partialTx)];\n      break;\n    }\n    case 'stake_withdrawal': {\n      result = [parseStakeWithdrawal(action, options, partialTx)];\n      break;\n    }\n    case 'stake_withdrawal_request': {\n      result = [parseStakeWithdrawalRequest(action, options, partialTx)];\n      break;\n    }\n    case 'jetton_swap': {\n      result = [parseJettonSwap(action, options)];\n      break;\n    }\n    case 'change_dns':\n    case 'delete_dns':\n    case 'renew_dns': {\n      result = [parseDns(action, options, partialTx)];\n      break;\n    }\n    case 'auction_bid': {\n      result = [parseAuctionBid(action, options, partialTx)];\n      break;\n    }\n    case 'dex_deposit_liquidity': {\n      result = parseLiquidityDeposit(action, options, partialTx);\n      break;\n    }\n    case 'dex_withdraw_liquidity': {\n      result = parseLiquidityWithdraw(action, options, partialTx);\n      break;\n    }\n  }\n\n  for (const activity of result) {\n    if (!activity) continue;\n\n    if ('nft' in activity && activity.nft?.isHidden) {\n      activity.shouldHide = true;\n    }\n\n    if (activity.kind === 'transaction' && !activity.isIncoming) {\n      activity.shouldLoadDetails ??= true;\n    }\n  }\n\n  return result.filter(Boolean);\n}\n\nfunction parseTonTransfer(\n  action: TonTransferAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const { network, addressBook, walletAddress } = options;\n  const { details } = action;\n  const { encrypted: isEncrypted } = details;\n  const fromAddress = addressBook[details.source].user_friendly;\n  const toAddress = addressBook[details.destination].user_friendly;\n  const isIncoming = toAddress === walletAddress;\n  const amount = isIncoming ? BigInt(details.value) : -BigInt(details.value);\n  const normalizedAddress = toBase64Address(isIncoming ? fromAddress : toAddress, true, network);\n  const comment = (!isEncrypted && details.comment) || undefined;\n  const encryptedComment = (isEncrypted && details.comment) || undefined;\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount,\n    isIncoming,\n    fromAddress,\n    toAddress,\n    normalizedAddress,\n    comment,\n    encryptedComment,\n  };\n}\n\nfunction parseCallContract(\n  action: CallContractAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity | undefined {\n  const { network, addressBook, walletAddress } = options;\n  const { details } = action;\n\n  const fromAddress = addressBook[details.source].user_friendly;\n  const toAddress = addressBook[details.destination].user_friendly;\n\n  const isIncoming = toAddress === walletAddress;\n  const amount = isIncoming ? BigInt(details.value) : -BigInt(details.value);\n  const normalizedAddress = toBase64Address(isIncoming ? fromAddress : toAddress, true, network);\n  const opCode = Number(details.opcode);\n  const shouldHide = !isIncoming && [OpCode.OurFee, TeleitemOpCode.Ok].includes(opCode);\n\n  let type: ApiTransactionType | undefined;\n  if (EXCESS_OP_CODES.includes(opCode)) {\n    type = 'excess';\n  } else if (opCode === 0xffffffff) {\n    type = 'bounced';\n  } else if ([JettonStakingOpCode.UnstakeRequest, JettonStakingOpCode.ClaimRewards].includes(opCode)) {\n    type = 'unstakeRequest';\n  } else if (toAddress !== walletAddress) {\n    type = 'callContract';\n  }\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount,\n    isIncoming,\n    fromAddress,\n    toAddress,\n    normalizedAddress,\n    type,\n    shouldHide,\n  };\n}\n\nfunction parseContractDeploy(\n  action: ContractDeployAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity | undefined {\n  const { network, addressBook, walletAddress } = options;\n  const { details } = action;\n\n  if (!details.source) {\n    return undefined;\n  }\n\n  const fromAddress = addressBook[details.source].user_friendly;\n  const toAddress = addressBook[details.destination].user_friendly;\n\n  if (fromAddress !== walletAddress) {\n    return undefined;\n  }\n\n  // Deploy action is additional and always occurs alongside others (duplicating amount), so we hide amount and fee.\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount: -0n,\n    isIncoming: false,\n    fromAddress,\n    toAddress,\n    normalizedAddress: toBase64Address(toAddress, true, network),\n    type: 'contractDeploy',\n    shouldLoadDetails: false,\n    fee: 0n,\n  };\n}\n\nfunction parseJettonTransfer(\n  action: JettonTransferAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const { details } = action;\n  const { network, walletAddress, addressBook } = options;\n  const { is_encrypted_comment: isEncrypted, forward_payload: forwardPayload } = details;\n  const fromAddress = addressBook[details.sender].user_friendly;\n  const toAddress = addressBook[details.receiver].user_friendly;\n  const isIncoming = toAddress === walletAddress;\n  const amount = isIncoming ? BigInt(details.amount) : -BigInt(details.amount);\n  const normalizedAddress = toBase64Address(isIncoming ? fromAddress : toAddress, true, network);\n  const comment = (!isEncrypted && details.comment) || undefined;\n  const encryptedComment = (isEncrypted && details.comment) || undefined;\n  const slug = buildTokenSlug('ton', toBase64Address(details.asset, true, network));\n  const shouldHide = !isIncoming && forwardPayload === OUR_FEE_PAYLOAD_BOC;\n\n  let type: ApiTransactionType;\n  if (toAddress === BURN_ADDRESS) {\n    type = 'burn';\n  } else if (toAddress === MYCOIN_STAKING_POOL) {\n    type = 'stake';\n  } else if (fromAddress === MYCOIN_STAKING_POOL) {\n    type = 'unstake';\n  }\n\n  return {\n    ...partial,\n    slug,\n    amount,\n    isIncoming,\n    fromAddress,\n    toAddress,\n    normalizedAddress,\n    comment,\n    encryptedComment,\n    shouldHide,\n    type,\n  };\n}\n\nfunction parseJettonMint(\n  action: JettonMintAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const { details } = action;\n  const { network, walletAddress, addressBook } = options;\n\n  const fromAddress = addressBook[details.receiver_jetton_wallet].user_friendly;\n  const toAddress = addressBook[details.receiver].user_friendly;\n  const isIncoming = toAddress === walletAddress;\n  const amount = isIncoming ? BigInt(details.amount) : -BigInt(details.amount);\n  const normalizedAddress = toBase64Address(isIncoming ? fromAddress : toAddress, true, network);\n  const slug = buildTokenSlug('ton', toBase64Address(details.asset, true, network));\n\n  return {\n    ...partial,\n    slug,\n    amount,\n    isIncoming,\n    fromAddress,\n    toAddress,\n    normalizedAddress,\n    type: 'mint',\n  };\n}\n\nfunction parseJettonBurn(\n  action: JettonBurnAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const { details } = action;\n  const { network, addressBook } = options;\n\n  const fromAddress = addressBook[details.owner].user_friendly;\n  const toAddress = addressBook[details.owner_jetton_wallet].user_friendly;\n  const amount = -BigInt(details.amount);\n  const normalizedAddress = toBase64Address(fromAddress, true, network);\n  const slug = buildTokenSlug('ton', toBase64Address(details.asset, true, network));\n\n  return {\n    ...partial,\n    slug,\n    amount,\n    isIncoming: false,\n    fromAddress,\n    toAddress,\n    normalizedAddress,\n    type: 'burn',\n  };\n}\n\nfunction parseNftTransfer(\n  action: NftTransferAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity | undefined {\n  const {\n    network, addressBook, metadata, walletAddress,\n  } = options;\n\n  const {\n    nft_item_index: index,\n    nft_item: rawNftAddress,\n    nft_collection: rawCollectionAddress,\n    new_owner: newOwner,\n    old_owner: oldOwner,\n    forward_payload: forwardPayload,\n  } = action.details;\n\n  const nft = parseToncenterNft(\n    metadata,\n    rawNftAddress,\n    rawCollectionAddress ?? undefined,\n    index ?? undefined,\n  );\n\n  const fromAddress = addressBook[oldOwner ?? rawNftAddress].user_friendly;\n  const toAddress = addressBook[newOwner].user_friendly;\n  const isIncoming = toAddress === walletAddress;\n  const normalizedAddress = toBase64Address(isIncoming ? fromAddress : toAddress, true, network);\n\n  if (fromAddress !== walletAddress && toAddress !== walletAddress) {\n    return undefined;\n  }\n\n  const comment = (forwardPayload && safeReadComment(Cell.fromBase64(forwardPayload).asSlice())) || undefined;\n  const type = toAddress === BURN_ADDRESS ? 'burn' : undefined;\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount: 0n,\n    isIncoming,\n    fromAddress,\n    toAddress,\n    normalizedAddress,\n    nft,\n    type,\n    comment,\n  };\n}\n\nfunction parseNftMint(\n  action: NftMintAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const {\n    network, addressBook, metadata,\n  } = options;\n\n  const {\n    owner,\n    nft_item_index: index,\n    nft_item: rawNftAddress,\n    nft_collection: rawCollectionAddress,\n  } = action.details;\n\n  const nft = parseToncenterNft(\n    metadata,\n    rawNftAddress,\n    rawCollectionAddress ?? undefined,\n    index ?? undefined,\n  );\n\n  const fromAddress = addressBook[owner].user_friendly;\n  const toAddress = addressBook[rawNftAddress].user_friendly;\n  const normalizedAddress = toBase64Address(fromAddress, true, network);\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount: 0n,\n    isIncoming: false,\n    fromAddress,\n    toAddress,\n    normalizedAddress,\n    nft,\n    type: 'mint',\n  };\n}\n\nfunction parseStakeDeposit(\n  action: StakeDepositAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const { network, addressBook } = options;\n  const { details } = action;\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount: -BigInt(details.amount),\n    isIncoming: false,\n    fromAddress: addressBook[details.stake_holder].user_friendly,\n    toAddress: addressBook[details.pool].user_friendly,\n    normalizedAddress: toBase64Address(details.pool, true, network),\n    type: 'stake',\n  };\n}\n\nfunction parseStakeWithdrawal(\n  action: StakeWithdrawalAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const { network, addressBook } = options;\n  const { details } = action;\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount: BigInt(details.amount),\n    isIncoming: true,\n    fromAddress: details.pool ? addressBook[details.pool].user_friendly : LIQUID_POOL,\n    toAddress: addressBook[details.stake_holder].user_friendly,\n    normalizedAddress: details.pool ? toBase64Address(details.pool, true, network) : LIQUID_POOL,\n    type: 'unstake',\n    shouldLoadDetails: details.provider === 'tonstakers' && !details.payout_nft,\n  };\n}\n\nfunction parseStakeWithdrawalRequest(\n  action: StakeWithdrawalRequestAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const { network, addressBook } = options;\n  const { details } = action;\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount: 0n, // TODO (actions) Replace to real fee\n    isIncoming: false,\n    fromAddress: addressBook[details.pool].user_friendly,\n    toAddress: addressBook[details.stake_holder].user_friendly,\n    normalizedAddress: toBase64Address(details.pool, true, network),\n    type: 'unstakeRequest',\n  };\n}\n\nfunction parseJettonSwap(action: SwapAction, options: ParseOptions): ApiSwapActivity {\n  const { metadata } = options;\n  const {\n    end_utime: endUtime,\n    success: isSuccess,\n    details: {\n      dex_incoming_transfer: {\n        amount: fromAmount,\n        asset: fromAsset,\n      },\n      dex_outgoing_transfer: {\n        amount: toAmount,\n        asset: toAsset,\n      },\n    },\n  } = action;\n\n  const decimalsFrom = (fromAsset && parseToncenterJetton(fromAsset, metadata)?.decimals) || TONCOIN.decimals;\n  const decimalsTo = (toAsset && parseToncenterJetton(toAsset, metadata)?.decimals) || TONCOIN.decimals;\n\n  const fromTokenAddress = fromAsset ? toBase64Address(fromAsset, true) : undefined;\n  const toTokenAddress = toAsset ? toBase64Address(toAsset, true) : undefined;\n\n  const from = fromTokenAddress && fromTokenAddress !== STON_PTON_ADDRESS\n    ? buildTokenSlug('ton', fromTokenAddress) : TONCOIN.slug;\n  const to = toTokenAddress && toTokenAddress !== STON_PTON_ADDRESS\n    ? buildTokenSlug('ton', toTokenAddress) : TONCOIN.slug;\n\n  return {\n    kind: 'swap',\n    id: buildActionActivityId(action),\n    timestamp: toMilliseconds(endUtime),\n    from,\n    fromAmount: toDecimal(BigInt(fromAmount), decimalsFrom),\n    to,\n    toAmount: toDecimal(BigInt(toAmount), decimalsTo),\n    networkFee: '0',\n    swapFee: '0',\n    ourFee: '0',\n    status: isSuccess ? 'completed' : 'failed',\n    hashes: [],\n    externalMsgHash: action.trace_external_hash,\n    shouldLoadDetails: true,\n  };\n}\n\nfunction parseDns(\n  action: ChangeDnsAction | RenewDnsAction | DeleteDnsAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const { network, addressBook, metadata } = options;\n  const { details } = action;\n\n  const fromAddress = addressBook[details.source].user_friendly;\n  const toAddress = addressBook[details.asset].user_friendly;\n  const normalizedAddress = toBase64Address(toAddress, true, network);\n  const nft = parseToncenterNft(metadata, details.asset);\n\n  let type: ApiTransactionType;\n  if (action.type === 'change_dns') {\n    const { sum_type: sumType } = action.details.value;\n    if (sumType === 'DNSSmcAddress') {\n      type = 'dnsChangeAddress';\n    } else if (sumType === 'DNSAdnlAddress') {\n      type = 'dnsChangeSite';\n    } else if (sumType === 'DNSStorageAddress') {\n      type = 'dnsChangeStorage';\n    } else if (sumType === 'DNSNextResolver') {\n      type = 'dnsChangeSubdomains';\n    }\n  } else if (\n    action.type === 'renew_dns'\n    || (action.type === 'delete_dns' && action.details.hash.endsWith(TME_RENEW_HASH_SUFFIX))\n  ) {\n    type = 'dnsRenew';\n  } else {\n    type = 'dnsDelete';\n  }\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount: 0n, // TODO (actions) Replace to real fee\n    isIncoming: false,\n    fromAddress,\n    toAddress,\n    normalizedAddress,\n    type,\n    nft,\n  };\n}\n\nfunction parseAuctionBid(\n  action: AuctionBidAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity {\n  const { network, addressBook, metadata, walletAddress } = options;\n  const { details } = action;\n\n  const {\n    bidder,\n    auction,\n    nft_item_index: index,\n    nft_item: rawNftAddress,\n    nft_collection: rawCollectionAddress,\n  } = details;\n\n  const fromAddress = addressBook[bidder].user_friendly;\n  const toAddress = addressBook[auction].user_friendly;\n  const isIncoming = toAddress === walletAddress;\n  const amount = isIncoming ? BigInt(details.amount) : -BigInt(details.amount);\n  const normalizedAddress = toBase64Address(isIncoming ? fromAddress : toAddress, true, network);\n  const nft = parseToncenterNft(\n    metadata,\n    rawNftAddress ?? undefined,\n    rawCollectionAddress ?? undefined,\n    index ?? undefined,\n  );\n\n  return {\n    ...partial,\n    slug: TONCOIN.slug,\n    amount,\n    isIncoming,\n    fromAddress,\n    toAddress,\n    normalizedAddress,\n    type: 'auctionBid',\n    nft,\n  };\n}\n\nfunction parseLiquidityDeposit(\n  action: DexDepositLiquidityAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity[] {\n  const { network, addressBook } = options;\n  const { details } = action;\n\n  const partialExtended = {\n    ...partial,\n    fromAddress: addressBook[details.source].user_friendly,\n    toAddress: addressBook[details.pool].user_friendly,\n    normalizedAddress: toBase64Address(details.pool, true, network),\n    isIncoming: false,\n    type: 'liquidityDeposit',\n  } as const;\n\n  const activities: ApiTransactionActivity[] = [{\n    ...partialExtended,\n    amount: -BigInt(details.amount_1!),\n    slug: getAssetSlug(addressBook, details.asset_1),\n  }];\n\n  if (details.lp_tokens_minted) {\n    const id = buildActionActivityId(action, 'additional');\n    activities.push({\n      ...partialExtended,\n      id,\n      txId: id,\n      amount: -BigInt(details.amount_2!),\n      slug: getAssetSlug(addressBook, details.asset_2),\n    });\n  }\n\n  return activities;\n}\n\nfunction parseLiquidityWithdraw(\n  action: DexWithdrawLiquidityAction,\n  options: ParseOptions,\n  partial: PartialTx,\n): ApiTransactionActivity[] {\n  const { network, addressBook } = options;\n  const { details } = action;\n\n  const partialExtended = {\n    ...partial,\n    fromAddress: addressBook[details.pool].user_friendly,\n    toAddress: addressBook[details.source].user_friendly,\n    normalizedAddress: toBase64Address(details.pool, true, network),\n    isIncoming: true,\n    type: 'liquidityWithdraw',\n  } as const;\n\n  const additionalId = buildActionActivityId(action, 'additional');\n\n  return [\n    {\n      ...partialExtended,\n      amount: BigInt(details.amount_1!),\n      slug: getAssetSlug(addressBook, details.asset_1),\n    },\n    {\n      ...partialExtended,\n      id: additionalId,\n      txId: additionalId,\n      amount: BigInt(details.amount_2!),\n      slug: getAssetSlug(addressBook, details.asset_2),\n    },\n  ];\n}\n\nfunction getAssetSlug(addressBook: AddressBook, rawAddress?: string | null) {\n  return rawAddress ? buildTokenSlug('ton', addressBook[rawAddress].user_friendly) : TONCOIN.slug;\n}\n\nfunction parseToncenterNft(\n  metadataMap: MetadataMap,\n  rawNftAddress: string,\n  rawCollectionAddress?: string,\n  index?: string,\n): ApiNft | undefined {\n  try {\n    const nftMetadata = extractMetadata<NftItemMetadata>(rawNftAddress, metadataMap, 'nft_items');\n\n    if (!nftMetadata) {\n      return undefined;\n    }\n\n    const { name, description, extra } = nftMetadata;\n    let { image } = nftMetadata;\n\n    const nftAddress = toBase64Address(rawNftAddress, true);\n    const collectionMetadata = rawCollectionAddress\n      ? extractMetadata<NftCollectionMetadata>(rawCollectionAddress, metadataMap, 'nft_collections')\n      : undefined;\n    const collectionAddress = rawCollectionAddress ? toBase64Address(rawCollectionAddress, true) : undefined;\n\n    // TODO (actions) Determine that this is a domain by the collection address once Toncenter adds it\n    const domain = extra?.domain ?? name ?? '';\n    const domainZone = getDnsDomainZone(domain)?.zone;\n\n    if (domainZone && (!collectionAddress || !image)) {\n      if (domainZone.suffixes[0] === 'ton') {\n        image = `${DNS_IMAGE_GEN_URL}${extra!.domain!}`;\n      }\n\n      return omitUndefined<ApiNft>({\n        index: Number(index),\n        name: domain,\n        address: nftAddress,\n        // eslint-disable-next-line no-underscore-dangle\n        thumbnail: extra?._image_medium ?? image!,\n        image: image!,\n        description,\n        isOnSale: false, // TODO (actions) Replace with real value when Toncenter supports it\n        collectionAddress: collectionAddress ?? domainZone.resolver,\n        collectionName: domainZone.collectionName,\n        metadata: {},\n      });\n    }\n\n    let hasScamLink = false;\n\n    if (!collectionAddress || !checkIsTrustedCollection(collectionAddress)) {\n      for (const text of [name, description].filter(Boolean)) {\n        if (checkHasScamLink(text)) {\n          hasScamLink = true;\n        }\n      }\n    }\n\n    const isScam = hasScamLink; // TODO (actions) Replace with real value when Toncenter supports it\n    const isHidden = extra?.render_type === 'hidden' || isScam;\n    const isFragmentGift = image?.startsWith(NFT_FRAGMENT_GIFT_IMAGE_URL_PREFIX);\n    const fixedImage = image ? fixIpfsUrl(image) : undefined;\n    // eslint-disable-next-line no-underscore-dangle\n    const thumbnail = extra?._image_medium ?? fixedImage!;\n\n    const nft: ApiNft = omitUndefined<ApiNft>({\n      index: Number(index),\n      name: name!,\n      address: nftAddress,\n      thumbnail,\n      image: fixedImage!,\n      description,\n      isOnSale: false, // TODO (actions) Replace with real value when Toncenter supports it\n      isHidden,\n      metadata: {\n        ...(isFragmentGift && {\n          fragmentUrl: image!.replace(NFT_FRAGMENT_GIFT_IMAGE_TO_URL_REGEX, 'https://$1'),\n        }),\n      },\n      ...(collectionAddress && {\n        collectionAddress,\n        collectionName: collectionMetadata?.name,\n        isOnFragment: isFragmentGift || NFT_FRAGMENT_COLLECTIONS.has(rawCollectionAddress!),\n      }),\n    });\n\n    return nft;\n  } catch (err) {\n    return undefined;\n  }\n}\n\nfunction parseToncenterJetton(rawAddress: string, metadata: MetadataMap): ApiToken | undefined {\n  const tokenAddress = toBase64Address(rawAddress, true);\n  const slug = buildTokenSlug('ton', tokenAddress);\n  const token = getTokenBySlug(slug);\n\n  if (token) {\n    return token;\n  }\n\n  const jettonMetadata = extractMetadata<JettonMasterMetadata>(rawAddress, metadata, 'jetton_masters');\n\n  if (!jettonMetadata) {\n    return undefined;\n  }\n\n  return {\n    tokenAddress,\n    slug,\n    chain: 'ton',\n    name: jettonMetadata.name!,\n    symbol: jettonMetadata.symbol!,\n    image: jettonMetadata.image!,\n    decimals: Number(jettonMetadata.extra!.decimals),\n  };\n}\n\nfunction extractMetadata<T extends AnyTokenMetadata>(\n  rawAddress: string,\n  metadata: MetadataMap,\n  type: AnyTokenMetadata['type'],\n): T | undefined {\n  const data = metadata[rawAddress];\n  if (!data || !data.is_indexed) return undefined;\n  return data.token_info?.find((tokenInfo) => tokenInfo.type === type) as T;\n}\n\nfunction safeReadComment(slice: Slice) {\n  return safeExec(() => readComment(slice));\n}\n\nfunction buildActionActivityId(action: AnyAction, type?: 'additional') {\n  // `lt` in activity ID is needed for sorting when timestamps are same\n  const subId = `${action.start_lt}-${action.action_id}`;\n  return buildTxId(action.trace_id, subId, type);\n}\n\nexport function parseActionActivitySubId(subId: string) {\n  const [startLt, actionId] = subId.split('-');\n  return { startLt, actionId };\n}\n","import type { ApiNetwork, ApiTransaction } from '../../../types';\nimport type { ApiTransactionExtended } from '../types';\nimport type { AddressBook, Transaction, TransactionMessage } from './types';\n\nimport { TONCOIN } from '../../../../config';\nimport { buildTxId } from '../../../../util/activities';\nimport { toSeconds } from '../../../../util/datetime';\nimport { omitUndefined } from '../../../../util/iteratees';\nimport { toBase64Address } from '../util/tonCore';\nimport { callToncenterV3 } from './other';\n\nexport async function fetchTransactions(options: {\n  network: ApiNetwork;\n  address: string | string[];\n  limit: number;\n  fromTimestamp?: number;\n  toTimestamp?: number;\n  shouldIncludeFrom?: boolean;\n  shouldIncludeTo?: boolean;\n}): Promise<ApiTransaction[]> {\n  const {\n    network,\n    address,\n    limit,\n    toTimestamp,\n    fromTimestamp,\n    shouldIncludeFrom,\n    shouldIncludeTo,\n  } = options;\n\n  const data: {\n    transactions: Transaction[];\n    address_book: AddressBook;\n  } = await callToncenterV3(network, '/transactions', {\n    account: address,\n    limit,\n    start_utime: fromTimestamp && toSeconds(fromTimestamp) + (!shouldIncludeFrom ? 1 : 0),\n    end_utime: toTimestamp && toSeconds(toTimestamp) - (!shouldIncludeTo ? 1 : 0),\n    sort: 'desc',\n  });\n\n  const {\n    transactions: rawTransactions,\n    address_book: addressBook,\n  } = data;\n\n  if (!rawTransactions.length) {\n    return [];\n  }\n\n  return rawTransactions\n    .map((rawTx) => parseRawTransaction(network, rawTx, addressBook))\n    .flat();\n}\n\nexport function parseRawTransaction(\n  network: ApiNetwork,\n  rawTx: Transaction,\n  addressBook: AddressBook,\n): ApiTransactionExtended[] {\n  const {\n    now,\n    hash,\n    total_fees: totalFees,\n    description: {\n      compute_ph: {\n        exit_code: exitCode,\n      },\n    },\n  } = rawTx;\n\n  const timestamp = now as number * 1000;\n  const isIncoming = !!rawTx.in_msg.source && !rawTx.out_msgs.length;\n  const inMsgHash = rawTx.in_msg.hash;\n  const msgs: TransactionMessage[] = isIncoming ? [rawTx.in_msg] : rawTx.out_msgs;\n\n  if (!msgs.length) return [];\n\n  const oneMsgFee = BigInt(totalFees) / BigInt(msgs.length);\n\n  const transactions: ApiTransactionExtended[] = [];\n\n  msgs.forEach((msg, i) => {\n    const {\n      source,\n      destination,\n      value,\n      fwd_fee: fwdFee,\n      opcode,\n      hash: msgHash,\n    } = msg;\n\n    if (!destination) {\n      // This is log\n      return;\n    }\n\n    const fromAddress = addressBook[source!].user_friendly;\n    const toAddress = addressBook[destination!].user_friendly;\n    const normalizedAddress = toBase64Address(isIncoming ? source! : destination!, true, network);\n    const fee = oneMsgFee + BigInt(fwdFee ?? 0);\n\n    const tx: ApiTransactionExtended = omitUndefined({\n      txId: msgs.length > 1 ? buildTxId(hash, i) : buildTxId(hash),\n      timestamp,\n      isIncoming,\n      fromAddress,\n      toAddress,\n      amount: isIncoming ? BigInt(value!) : -BigInt(value!),\n      slug: TONCOIN.slug,\n      fee,\n      externalMsgHash: isIncoming ? undefined : inMsgHash,\n      normalizedAddress,\n      shouldHide: exitCode ? true : undefined,\n      hash,\n      opCode: Number(opcode) || undefined,\n      msgHash,\n    });\n\n    transactions.push(tx);\n  });\n\n  return transactions;\n}\n\nexport async function fetchLatestTxLt(network: ApiNetwork, address: string): Promise<number | undefined> {\n  const { transactions }: { transactions: any[] } = await callToncenterV3(network, '/transactions', {\n    account: address,\n    limit: 1,\n    sort: 'desc',\n  });\n\n  if (!transactions.length) {\n    return undefined;\n  }\n\n  return Number(transactions[0].lt);\n}\n","import { beginCell, Cell, storeStateInit } from '@ton/core';\n\nimport type { ApiNetwork, ApiTonWallet, ApiWalletInfo } from '../../types';\nimport type { ApiTonWalletVersion, ContractInfo } from './types';\nimport type { TonWallet } from './util/tonCore';\n\nimport { DEFAULT_WALLET_VERSION } from '../../../config';\nimport { parseAccountId } from '../../../util/account';\nimport { buildTxId } from '../../../util/activities';\nimport { extractKey, findLast } from '../../../util/iteratees';\nimport withCacheAsync from '../../../util/withCacheAsync';\nimport { fetchJettonBalances } from './util/tonapiio';\nimport {\n  getTonClient, toBase64Address, walletClassMap,\n} from './util/tonCore';\nimport { fetchStoredTonWallet } from '../../common/accounts';\nimport { base64ToBytes, hexToBytes, sha256 } from '../../common/utils';\nimport { ALL_WALLET_VERSIONS, KnownContracts, WORKCHAIN } from './constants';\nimport { getWalletInfos } from './toncenter';\n\nexport const isAddressInitialized = withCacheAsync(\n  async (network: ApiNetwork, walletOrAddress: TonWallet | string) => {\n    return (await getWalletInfo(network, walletOrAddress)).isInitialized;\n  },\n);\n\nexport const isActiveSmartContract = withCacheAsync(async (network: ApiNetwork, address: string) => {\n  const { isInitialized, isWallet } = await getWalletInfo(network, address);\n  return isInitialized ? !isWallet : undefined;\n}, (value) => value !== undefined);\n\nexport function publicKeyToAddress(\n  network: ApiNetwork,\n  publicKey: Uint8Array,\n  walletVersion: ApiTonWalletVersion,\n) {\n  const wallet = buildWallet(network, publicKey, walletVersion);\n  return toBase64Address(wallet.address, false, network);\n}\n\nexport function buildWallet(\n  network: ApiNetwork,\n  publicKey: Uint8Array | string,\n  walletVersion: ApiTonWalletVersion,\n): TonWallet {\n  if (typeof publicKey === 'string') {\n    publicKey = hexToBytes(publicKey);\n  }\n  const client = getTonClient(network);\n  const WalletClass = walletClassMap[walletVersion]!;\n  return client.open(\n    WalletClass.create({\n      publicKey: Buffer.from(publicKey),\n      workchain: WORKCHAIN,\n    }),\n  );\n}\n\nexport async function getWalletInfo(network: ApiNetwork, walletOrAddress: TonWallet | string): Promise<{\n  isInitialized: boolean;\n  isWallet: boolean;\n  seqno: number;\n  balance: bigint;\n  lastTxId?: string;\n}> {\n  const address = typeof walletOrAddress === 'string'\n    ? walletOrAddress\n    : toBase64Address(walletOrAddress.address, undefined, network);\n\n  const {\n    account_state: accountState,\n    wallet: isWallet,\n    seqno = 0,\n    balance,\n    last_transaction_id: {\n      lt,\n      hash,\n    },\n  } = await getTonClient(network).getWalletInfo(address);\n\n  return {\n    isInitialized: accountState === 'active',\n    isWallet,\n    seqno,\n    balance: BigInt(balance || '0'),\n    lastTxId: lt === '0' ? undefined : buildTxId(hash),\n  };\n}\n\nexport async function getContractInfo(network: ApiNetwork, address: string): Promise<{\n  isInitialized: boolean;\n  isSwapAllowed?: boolean;\n  isWallet?: boolean;\n  contractInfo?: ContractInfo;\n  codeHash?: string;\n}> {\n  const data = await getTonClient(network).getAddressInfo(address);\n\n  const { code, state } = data;\n\n  const codeHashOld = Buffer.from(await sha256(base64ToBytes(code))).toString('hex');\n  const contractInfo = Object.values(KnownContracts).find((info) => info.hash === codeHashOld);\n  // For inactive addresses, `code` is an empty string. Cell.fromBase64 throws when `code` is an empty string.\n  const codeHash = code && Cell.fromBase64(code).hash().toString('hex');\n\n  const isInitialized = state === 'active';\n  const isWallet = state === 'active' ? contractInfo?.type === 'wallet' : undefined;\n  const isSwapAllowed = contractInfo?.isSwapAllowed;\n\n  return {\n    isInitialized,\n    isWallet,\n    isSwapAllowed,\n    contractInfo,\n    codeHash,\n  };\n}\n\nexport async function getAccountBalance(accountId: string) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  return getWalletBalance(network, address);\n}\n\nexport async function getWalletBalance(network: ApiNetwork, walletOrAddress: TonWallet | string): Promise<bigint> {\n  return (await getWalletInfo(network, walletOrAddress)).balance;\n}\n\nexport async function getWalletSeqno(network: ApiNetwork, walletOrAddress: TonWallet | string): Promise<number> {\n  const { seqno } = await getWalletInfo(network, walletOrAddress);\n  return seqno || 0;\n}\n\nexport async function pickBestWallet(network: ApiNetwork, publicKey: Uint8Array): Promise<{\n  wallet: TonWallet;\n  version: ApiTonWalletVersion;\n  balance: bigint;\n  lastTxId?: string;\n}> {\n  const allWallets = await getWalletVersionInfos(network, publicKey);\n  const defaultWallet = allWallets.filter(({ version }) => version === DEFAULT_WALLET_VERSION)[0];\n\n  if (defaultWallet.lastTxId) {\n    return defaultWallet;\n  }\n\n  const withBiggestBalance = allWallets.reduce<typeof allWallets[0] | undefined>((best, current) => {\n    return current.balance > (best?.balance ?? 0n) ? current : best;\n  }, undefined);\n\n  if (withBiggestBalance) {\n    return withBiggestBalance;\n  }\n\n  const withLastTx = findLast(allWallets, ({ lastTxId }) => !!lastTxId);\n\n  if (withLastTx) {\n    return withLastTx;\n  }\n\n  // Workaround for NOT holders who do not have transactions\n  const v4Wallet = allWallets.find(({ version }) => version === 'v4R2')!;\n  const v4JettonBalances = await fetchJettonBalances(network, v4Wallet.address);\n  if (v4JettonBalances.length > 0) {\n    return v4Wallet;\n  }\n\n  return defaultWallet;\n}\n\nexport async function getWalletVersionInfos(\n  network: ApiNetwork,\n  publicKey: Uint8Array,\n  versions: ApiTonWalletVersion[] = ALL_WALLET_VERSIONS,\n): Promise<(ApiWalletInfo & { wallet: TonWallet })[]> {\n  const items = versions.map((version) => {\n    const wallet = buildWallet(network, publicKey, version);\n    const address = toBase64Address(wallet.address, false, network);\n    return { wallet, address, version };\n  });\n\n  const walletInfos = await getWalletInfos(network, extractKey(items, 'address'));\n\n  return items.map((item) => {\n    return {\n      ...walletInfos[item.address] ?? {\n        balance: 0n,\n        isInitialized: false,\n      },\n      ...item,\n    };\n  });\n}\n\nexport function getWalletVersions(\n  network: ApiNetwork,\n  publicKey: Uint8Array,\n  versions: ApiTonWalletVersion[] = ALL_WALLET_VERSIONS,\n): {\n    wallet: TonWallet;\n    address: string;\n    version: ApiTonWalletVersion;\n  }[] {\n  return versions.map((version) => {\n    const wallet = buildWallet(network, publicKey, version);\n    const address = toBase64Address(wallet.address, false, network);\n\n    return {\n      wallet,\n      address,\n      version,\n    };\n  });\n}\n\nexport async function getWalletStateInit(accountId: string, storedWallet: ApiTonWallet) {\n  const wallet = await getTonWallet(accountId, storedWallet);\n\n  return beginCell()\n    .storeWritable(storeStateInit(wallet!.init))\n    .endCell();\n}\n\nexport function pickWalletByAddress(network: ApiNetwork, publicKey: Uint8Array, address: string) {\n  address = toBase64Address(address, false, network);\n\n  const allWallets = getWalletVersions(network, publicKey);\n\n  return allWallets.find((w) => w.address === address)!;\n}\n\nexport async function getTonWallet(accountId: string, tonWallet?: ApiTonWallet) {\n  const { network } = parseAccountId(accountId);\n  const { publicKey, version } = tonWallet ?? await fetchStoredTonWallet(accountId);\n\n  const publicKeyBytes = hexToBytes(publicKey);\n  return buildWallet(network, publicKeyBytes, version);\n}\n\nexport function resolveWalletVersion(wallet: TonWallet) {\n  return Object.entries(walletClassMap)\n    .find(([, walletClass]) => wallet instanceof walletClass)?.[0];\n}\n","import * as tonWebMnemonic from 'tonweb-mnemonic';\nimport * as bip39 from 'bip39';\nimport nacl from 'tweetnacl';\n\nimport type {\n  ApiAccountWithMnemonic,\n  ApiLedgerAccount,\n  ApiNetwork,\n  ApiTonAccount,\n  ApiTonWallet,\n} from '../../types';\nimport type { ApiTonWalletVersion } from './types';\nimport type { TonWallet } from './util/tonCore';\n\nimport * as HDKey from '../../../lib/ed25519-hd-key';\nimport { parseAccountId } from '../../../util/account';\nimport isMnemonicPrivateKey from '../../../util/isMnemonicPrivateKey';\nimport { logDebugError } from '../../../util/logs';\nimport { toBase64Address } from './util/tonCore';\nimport { fetchStoredAccount, getNewAccountId, setAccountValue } from '../../common/accounts';\nimport { getMnemonic } from '../../common/mnemonic';\nimport { bytesToHex, hexToBytes } from '../../common/utils';\nimport { TON_BIP39_PATH } from './constants';\nimport { buildWallet, pickBestWallet, publicKeyToAddress } from './wallet';\n\nexport function generateMnemonic() {\n  return tonWebMnemonic.generateMnemonic();\n}\n\nexport function validateMnemonic(mnemonic: string[]) {\n  return tonWebMnemonic.validateMnemonic(mnemonic);\n}\n\nexport function privateKeyHexToKeyPair(privateKeyHex: string) {\n  return nacl.sign.keyPair.fromSeed(hexToBytes(privateKeyHex));\n}\n\nexport async function fetchPrivateKey(accountId: string, password: string, account?: ApiAccountWithMnemonic) {\n  try {\n    const { secretKey: privateKey } = await fetchKeyPair(accountId, password, account) || {};\n\n    return privateKey;\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error(err);\n\n    return undefined;\n  }\n}\n\nexport async function fetchKeyPair(accountId: string, password: string, account?: ApiAccountWithMnemonic) {\n  try {\n    account = account ?? await fetchStoredAccount<ApiAccountWithMnemonic>(accountId);\n    const mnemonic = await getMnemonic(accountId, password, account);\n    if (!mnemonic) {\n      return undefined;\n    }\n\n    if (isMnemonicPrivateKey(mnemonic)) {\n      return privateKeyHexToKeyPair(mnemonic[0]);\n    } else if (account.type === 'bip39') {\n      return bip39MnemonicToKeyPair(mnemonic);\n    } else {\n      return await tonWebMnemonic.mnemonicToKeyPair(mnemonic);\n    }\n  } catch (err) {\n    logDebugError('fetchKeyPair', err);\n\n    return undefined;\n  }\n}\n\nexport async function rawSign(accountId: string, password: string, dataHex: string) {\n  const privateKey = await fetchPrivateKey(accountId, password);\n  if (!privateKey) {\n    return undefined;\n  }\n\n  const signature = nacl.sign.detached(hexToBytes(dataHex), privateKey);\n\n  return bytesToHex(signature);\n}\n\nexport function getWalletFromBip39Mnemonic(\n  network: ApiNetwork,\n  mnemonic: string[],\n  version?: ApiTonWalletVersion,\n): Promise<ApiTonWallet> {\n  const { publicKey } = bip39MnemonicToKeyPair(mnemonic);\n  return getWalletFromKeys(publicKey, network, version);\n}\n\nexport async function getWalletFromMnemonic(\n  mnemonic: string[],\n  network: ApiNetwork,\n  version?: ApiTonWalletVersion,\n): Promise<ApiTonWallet & { lastTxId?: string }> {\n  const { publicKey } = await tonWebMnemonic.mnemonicToKeyPair(mnemonic);\n  return getWalletFromKeys(publicKey, network, version);\n}\n\nexport function getWalletFromPrivateKey(\n  privateKey: string,\n  network: ApiNetwork,\n  version?: ApiTonWalletVersion,\n): Promise<ApiTonWallet> {\n  const { publicKey } = privateKeyHexToKeyPair(privateKey);\n  return getWalletFromKeys(publicKey, network, version);\n}\n\nasync function getWalletFromKeys(\n  publicKey: Uint8Array,\n  network: ApiNetwork,\n  version?: ApiTonWalletVersion,\n): Promise<ApiTonWallet & { lastTxId?: string }> {\n  let wallet: TonWallet;\n  let lastTxId: string | undefined;\n  if (version) {\n    wallet = buildWallet(network, publicKey, version);\n  } else {\n    ({ wallet, version, lastTxId } = await pickBestWallet(network, publicKey));\n  }\n\n  const address = toBase64Address(wallet.address, false, network);\n  const publicKeyHex = bytesToHex(publicKey);\n\n  return {\n    type: 'ton',\n    publicKey: publicKeyHex,\n    address,\n    version,\n    index: 0,\n    lastTxId,\n  };\n}\n\nfunction bip39MnemonicToKeyPair(mnemonic: string[]) {\n  const hexSeed = bip39.mnemonicToSeedSync(mnemonic.join(' '));\n  const { key: privateKey } = HDKey.derivePath(TON_BIP39_PATH, hexSeed.toString('hex'));\n  return nacl.sign.keyPair.fromSeed(privateKey);\n}\n\nexport async function importNewWalletVersion(accountId: string, version: ApiTonWalletVersion) {\n  const { network } = parseAccountId(accountId);\n\n  const account = await fetchStoredAccount<ApiTonAccount | ApiLedgerAccount>(accountId);\n  const publicKey = hexToBytes(account.ton.publicKey);\n\n  const newAddress = publicKeyToAddress(network, publicKey, version);\n  const newAccountId = await getNewAccountId(network);\n  const newAccount: ApiTonAccount | ApiLedgerAccount = {\n    ...account,\n    ton: {\n      type: 'ton',\n      address: newAddress,\n      publicKey: account.ton.publicKey,\n      version,\n      index: account.ton.index,\n    },\n  };\n\n  const ledger = account.type === 'ledger'\n    ? { index: account.ton.index, driver: account.driver }\n    : undefined;\n\n  await setAccountValue(newAccountId, 'accounts', newAccount);\n\n  return {\n    accountId: newAccountId,\n    address: newAddress,\n    ledger,\n  };\n}\n","import type { ApiChain } from '../api/types';\n\nimport { CHAIN_CONFIG } from '../config';\n\nexport function getChainConfig<T extends ApiChain>(chain: T) {\n  return CHAIN_CONFIG[chain];\n}\n\nexport function findChainConfig(chain: any) {\n  return chain in CHAIN_CONFIG ? CHAIN_CONFIG[chain as ApiChain] : undefined;\n}\n","import type { ApiCheckTransactionDraftResult, ApiFetchEstimateDieselResult } from '../../api/chains/ton/types';\nimport type { FeePrecision, FeeTerms } from './types';\n\nimport { TONCOIN } from '../../config';\nimport { Big } from '../../lib/big.js';\nimport { bigintMax, bigintMin } from '../bigint';\nimport { getIsNativeToken } from '../tokens';\n\ntype ApiFee = Pick<ApiCheckTransactionDraftResult, 'fee' | 'realFee' | 'diesel'> & {\n  /** The slug of the token that is being transferred */\n  tokenSlug: string;\n};\n\nexport type ExplainedTransferFee = {\n  /** Whether the result implies paying the fee with a diesel */\n  isGasless: boolean;\n  /**\n   * The fee that will be sent with the transfer. The wallet must have it on the balance to send the transfer.\n   * Show this in the transfer form when the input amount is  the balance, but the remaining balance can't cover the\n   * full fee; show `realFee` otherwise. Undefined means that it's unknown.\n   */\n  fullFee?: {\n    precision: FeePrecision;\n    terms: FeeTerms<bigint>;\n    /** The sum of `terms` measured in the native token */\n    nativeSum: bigint;\n  };\n  /**\n   * The real fee (the full fee minus the excess). Undefined means that it's unknown. There is no need to fall back to\n   * `fullFee` when `realFee` is undefined (because it's undefined too in this case).\n   */\n  realFee?: {\n    precision: FeePrecision;\n    terms: FeeTerms<bigint>;\n    /** The sum of `terms` measured in the native token */\n    nativeSum: bigint;\n  };\n  /** The excess fee. Measured in the native token. It's always approximate. Undefined means that it's unknown. */\n  excessFee?: bigint;\n  /**\n   * Whether the full token balance can be transferred despite the fee.\n   * If yes, the fee will be taken from the transferred amount.\n   */\n  canTransferFullBalance: boolean;\n};\n\ntype AvailableDiesel = ApiFetchEstimateDieselResult & { amount: bigint };\ntype ApiFeeWithDiesel = ApiFee & { diesel: AvailableDiesel };\n\ntype MaxTransferAmountInput = {\n  /** The wallet balance of the transferred token. Undefined means that it's unknown. */\n  tokenBalance: bigint | undefined;\n  /** The slug of the token that is being transferred */\n  tokenSlug: string;\n  /** The full fee terms calculated by `explainApiTransferFee`. Undefined means that they're unknown. */\n  fullFee: FeeTerms<bigint> | undefined;\n  /** Whether the full token balance can be transferred despite the fee. */\n  canTransferFullBalance: boolean;\n};\n\ntype BalanceSufficientForTransferInput = Omit<MaxTransferAmountInput, 'tokenSlug'> & {\n  /** The wallet balance of the native token of the transfer chain. Undefined means that it's unknown. */\n  nativeTokenBalance: bigint | undefined;\n  /** The transferred amount. Use 0 for NFT transfers. Undefined means that it's unspecified. */\n  transferAmount: bigint | undefined;\n};\n\n/**\n * Converts the transfer fee data returned from API into data that is ready to be displayed in the transfer form UI.\n */\nexport function explainApiTransferFee(input: ApiFee): ExplainedTransferFee {\n  return shouldUseDiesel(input)\n    ? explainGaslessTransferFee(input)\n    : explainGasfullTransferFee(input);\n}\n\n/**\n * Calculates the maximum amount available for the transfer.\n * Returns undefined when it can't be calculated because of insufficient input data.\n */\nexport function getMaxTransferAmount({\n  tokenBalance,\n  tokenSlug,\n  fullFee,\n  canTransferFullBalance,\n}: MaxTransferAmountInput): bigint | undefined {\n  if (tokenBalance === undefined) {\n    return undefined;\n  }\n\n  // Returning the full balance when the fee is unknown for a better UX\n  if (canTransferFullBalance || !fullFee) {\n    return tokenBalance;\n  }\n\n  let fee = fullFee.token ?? 0n;\n  if (getIsNativeToken(tokenSlug)) {\n    // When the token is native, both `token` and `native` refer to the same currency, so they should be added\n    fee += fullFee.native ?? 0n;\n  }\n\n  return bigintMax(tokenBalance - fee, 0n);\n}\n\n/**\n * Decides whether the balance is sufficient to transfer the amount and pay the fees.\n * Returns undefined when it can't be calculated because of insufficient input data.\n */\nexport function isBalanceSufficientForTransfer({\n  tokenBalance,\n  nativeTokenBalance,\n  transferAmount,\n  fullFee,\n  canTransferFullBalance,\n}: BalanceSufficientForTransferInput) {\n  if (transferAmount === undefined || tokenBalance === undefined || nativeTokenBalance === undefined || !fullFee) {\n    return undefined;\n  }\n\n  const isFullTokenTransfer = transferAmount === tokenBalance && canTransferFullBalance;\n  const tokenRequiredAmount = (fullFee.token ?? 0n) + (isFullTokenTransfer ? 0n : transferAmount);\n  const nativeTokenRequiredAmount = fullFee.native ?? 0n;\n\n  return tokenRequiredAmount <= tokenBalance && nativeTokenRequiredAmount <= nativeTokenBalance;\n}\n\nexport function isDieselAvailable(diesel: ApiFetchEstimateDieselResult): diesel is AvailableDiesel {\n  return diesel.status !== 'not-available' && diesel.amount !== undefined;\n}\n\nexport function getDieselTokenAmount(diesel: ApiFetchEstimateDieselResult) {\n  return diesel.status === 'stars-fee' ? 0n : (diesel.amount ?? 0n);\n}\n\nfunction shouldUseDiesel(input: ApiFee): input is ApiFeeWithDiesel {\n  return input.diesel !== undefined && isDieselAvailable(input.diesel);\n}\n\n/**\n * Converts the data of a transfer not involving diesel\n */\nfunction explainGasfullTransferFee(input: ApiFee) {\n  const result: ExplainedTransferFee = {\n    isGasless: false,\n    canTransferFullBalance: input.tokenSlug === TONCOIN.slug,\n  };\n\n  if (input.fee !== undefined) {\n    result.fullFee = {\n      precision: input.realFee === input.fee ? 'exact' : 'lessThan',\n      terms: { native: input.fee },\n      nativeSum: input.fee,\n    };\n    result.realFee = result.fullFee;\n  }\n\n  if (input.realFee !== undefined) {\n    result.realFee = {\n      precision: input.realFee === input.fee ? 'exact' : 'approximate',\n      terms: { native: input.realFee },\n      nativeSum: input.realFee,\n    };\n  }\n\n  if (input.fee !== undefined && input.realFee !== undefined) {\n    result.excessFee = input.fee - input.realFee;\n  }\n\n  return result;\n}\n\n/**\n * Converts the diesel of semi-diesel transfer data\n */\nfunction explainGaslessTransferFee({ diesel }: ApiFeeWithDiesel) {\n  const isStarsDiesel = diesel.status === 'stars-fee';\n  const dieselKey = isStarsDiesel ? 'stars' : 'token';\n  const realFeeInDiesel = convertFee(diesel.realFee, diesel.nativeAmount, diesel.amount);\n  // Cover as much displayed real fee as possible with diesel, because in the excess it will return as the native token.\n  const dieselRealFee = bigintMin(diesel.amount, realFeeInDiesel);\n  // Cover the remaining real fee with the native token.\n  const nativeRealFee = bigintMax(0n, diesel.realFee - diesel.nativeAmount);\n\n  return {\n    isGasless: true,\n    canTransferFullBalance: false,\n    fullFee: {\n      precision: 'lessThan',\n      terms: {\n        [dieselKey]: diesel.amount,\n        native: diesel.remainingFee,\n      },\n      nativeSum: diesel.nativeAmount + diesel.remainingFee,\n    },\n    realFee: {\n      precision: 'approximate',\n      terms: {\n        [dieselKey]: dieselRealFee,\n        native: nativeRealFee,\n      },\n      nativeSum: diesel.realFee,\n    },\n    excessFee: diesel.nativeAmount + diesel.remainingFee - diesel.realFee,\n  } satisfies ExplainedTransferFee;\n}\n\n/**\n * `exampleFromAmount` and `exampleToAmount` define the exchange rate used to convert `amount`.\n * `exampleFromAmount` is defined in the same currency as `amount`. Mustn't be 0.\n * `exampleToAmount` is defined in the currency you want to get.\n */\nfunction convertFee(\n  amount: bigint,\n  exampleFromAmount: bigint,\n  exampleToAmount: bigint,\n) {\n  const exchangeRate = Big(exampleToAmount.toString()).div(exampleFromAmount.toString());\n  return BigInt(Big(amount.toString()).mul(exchangeRate).round().toString());\n}\n","import type { ApiChain, ApiToken, ApiTokenWithPrice } from '../api/types';\nimport type { UserToken } from '../global/types';\n\nimport { CHAIN_CONFIG, TONCOIN } from '../config';\nimport { getChainConfig } from './chain';\nimport { pick } from './iteratees';\n\nconst chainByNativeSlug = Object.fromEntries(\n  Object.entries(CHAIN_CONFIG).map(([chain, { nativeToken }]) => [nativeToken.slug, chain]),\n) as Record<string, ApiChain>;\n\nexport function getIsNativeToken(slug?: string) {\n  return slug ? slug in chainByNativeSlug : false;\n}\n\nexport function getIsTonToken(slug: string, withNative?: boolean) {\n  return Boolean(slug.startsWith('ton-') || (withNative && slug === TONCOIN.slug));\n}\n\nexport function getNativeToken(chain: ApiChain): ApiToken {\n  return getChainConfig(chain).nativeToken;\n}\n\nexport function getChainBySlug(slug: string) {\n  const items = slug.split('-');\n  return items.length > 1 ? items[0] as ApiChain : chainByNativeSlug[slug];\n}\n\nexport function buildUserToken(token: ApiTokenWithPrice | ApiToken): UserToken {\n  return {\n    ...pick(token, [\n      'symbol',\n      'slug',\n      'name',\n      'image',\n      'decimals',\n      'keywords',\n      'chain',\n      'tokenAddress',\n    ]),\n    amount: 0n,\n    totalValue: '0',\n    price: 0,\n    priceUsd: 0,\n    change24h: 0,\n  };\n}\n","// This JS library implements TON message comment encryption and decryption for Web\n// Reference C++ code - SimpleEncryptionV2 - https://github.com/ton-blockchain/ton/blob/cc0eb453cb3bf69f92693160103d33112856c056/tonlib/tonlib/keys/SimpleEncryption.cpp#L110\n// Dependencies:\n// - TonWeb 0.0.60\n// - aes-js - 3.1.2 - https://github.com/ricmoo/aes-js/releases/tag/v3.1.2 - for aes-cbc without padding\n// - noble-ed25519 - 1.7.3 - // https://github.com/paulmillr/noble-ed25519/releases/tag/1.7.3 - for getSharedKey\n\nimport type { Address } from '@ton/core';\n\nimport { OpCode } from '../constants';\nimport { toBase64Address } from './tonCore';\n\nconst ed25519 = require('../../../../lib/noble-ed25519');\nconst aesjs = require('../../../../lib/aes-js');\n\nasync function hmacSha512(key: Uint8Array, data: Uint8Array): Promise<Uint8Array> {\n  const hmacAlgo = { name: 'HMAC', hash: 'SHA-512' };\n  const hmacKey = await crypto.subtle.importKey('raw', key, hmacAlgo, false, ['sign']);\n  const signature = await crypto.subtle.sign(hmacAlgo, hmacKey, data);\n  const result = new Uint8Array(signature);\n  if (result.length !== 512 / 8) throw new Error();\n  return result;\n}\n\nfunction getAesCbcState(hash: Uint8Array): Promise<any> {\n  if (hash.length < 48) throw new Error();\n  const key = hash.slice(0, 32);\n  const iv = hash.slice(32, 32 + 16);\n\n  // Note that native crypto.subtle AES-CBC not suitable here because\n  // even if the data IS a multiple of 16 bytes, padding will still be added\n  // So we use aes-js\n\n  // eslint-disable-next-line new-cap\n  return new aesjs.ModeOfOperation.cbc(key, iv);\n}\n\nfunction getRandomPrefix(dataLength: number, minPadding: number): Uint8Array {\n  // eslint-disable-next-line no-bitwise\n  const prefixLength = ((minPadding + 15 + dataLength) & -16) - dataLength;\n  const prefix = crypto.getRandomValues(new Uint8Array(prefixLength));\n  prefix[0] = prefixLength;\n  if ((prefixLength + dataLength) % 16 !== 0) throw new Error();\n  return prefix;\n}\n\nfunction combineSecrets(a: Uint8Array, b: Uint8Array) {\n  return hmacSha512(a, b);\n}\n\nasync function encryptDataWithPrefix(data: Uint8Array, sharedSecret: Uint8Array, salt: Uint8Array) {\n  if (data.length % 16 !== 0) throw new Error();\n  const dataHash = await combineSecrets(salt, data);\n  const msgKey = dataHash.slice(0, 16);\n\n  const res = new Uint8Array(data.length + 16);\n  res.set(msgKey, 0);\n\n  const cbcStateSecret = await combineSecrets(sharedSecret, msgKey);\n  const encrypted = (await getAesCbcState(cbcStateSecret)).encrypt(data);\n  res.set(encrypted, 16);\n\n  return res;\n}\n\nasync function encryptDataImpl(data: Uint8Array, sharedSecret: Uint8Array, salt: Uint8Array) {\n  const prefix = await getRandomPrefix(data.length, 16);\n  const combined = new Uint8Array(prefix.length + data.length);\n  combined.set(prefix, 0);\n  combined.set(data, prefix.length);\n  return encryptDataWithPrefix(combined, sharedSecret, salt);\n}\n\nexport async function encryptData(\n  data: Uint8Array, myPublicKey: Uint8Array, theirPublicKey: Uint8Array, privateKey: Uint8Array, salt: Uint8Array,\n) {\n  const sharedSecret = await ed25519.getSharedSecret(privateKey, theirPublicKey);\n\n  const encrypted = await encryptDataImpl(data, sharedSecret, salt);\n  const prefixedEncrypted = new Uint8Array(myPublicKey.length + encrypted.length);\n  for (let i = 0; i < myPublicKey.length; i++) {\n    // eslint-disable-next-line no-bitwise\n    prefixedEncrypted[i] = theirPublicKey[i] ^ myPublicKey[i];\n  }\n  prefixedEncrypted.set(encrypted, myPublicKey.length);\n  return prefixedEncrypted;\n}\n\nexport async function encryptMessageComment(\n  comment: string,\n  myPublicKey: Uint8Array,\n  theirPublicKey: Uint8Array,\n  myPrivateKey: Uint8Array,\n  senderAddress: Address | string,\n) {\n  if (!comment || !comment.length) throw new Error('empty comment');\n\n  if (myPrivateKey.length === 64) {\n    myPrivateKey = myPrivateKey.slice(0, 32); // convert nacl private key\n  }\n\n  const commentBytes = new TextEncoder().encode(comment);\n\n  const salt = new TextEncoder().encode(toBase64Address(senderAddress, true));\n\n  const encryptedBytes = await encryptData(commentBytes, myPublicKey, theirPublicKey, myPrivateKey, salt);\n\n  const payload = new Uint8Array(encryptedBytes.length + 4);\n\n  const buffer = Buffer.alloc(4);\n  buffer.writeUInt32BE(OpCode.Encrypted);\n\n  payload.set(buffer, 0);\n  payload.set(encryptedBytes, 4);\n\n  return payload;\n}\n\nasync function doDecrypt(\n  cbcStateSecret: Uint8Array, msgKey: Uint8Array, encryptedData: Uint8Array, salt: Uint8Array,\n): Promise<Uint8Array> {\n  const decryptedData = (await getAesCbcState(cbcStateSecret)).decrypt(encryptedData);\n  const dataHash = await combineSecrets(salt, decryptedData);\n  const gotMsgKey = dataHash.slice(0, 16);\n  if (msgKey.join(',') !== gotMsgKey.join(',')) {\n    throw new Error('Failed to decrypt: hash mismatch');\n  }\n  const prefixLength = decryptedData[0];\n  if (prefixLength > decryptedData.length || prefixLength < 16) {\n    throw new Error('Failed to decrypt: invalid prefix size');\n  }\n  return decryptedData.slice(prefixLength);\n}\n\nasync function decryptDataImpl(\n  encryptedData: Uint8Array, sharedSecret: Uint8Array, salt: Uint8Array,\n): Promise<Uint8Array> {\n  if (encryptedData.length < 16) throw new Error('Failed to decrypt: data is too small');\n  if (encryptedData.length % 16 !== 0) throw new Error('Failed to decrypt: data size is not divisible by 16');\n  const msgKey = encryptedData.slice(0, 16);\n  const data = encryptedData.slice(16);\n  const cbcStateSecret = await combineSecrets(sharedSecret, msgKey);\n  const res = await doDecrypt(cbcStateSecret, msgKey, data, salt);\n  return res;\n}\n\nexport async function decryptData(data: Uint8Array, publicKey: Uint8Array, privateKey: Uint8Array, salt: Uint8Array) {\n  if (data.length < publicKey.length) {\n    throw new Error('Failed to decrypt: data is too small');\n  }\n  const theirPublicKey = new Uint8Array(publicKey.length);\n  for (let i = 0; i < publicKey.length; i++) {\n    // eslint-disable-next-line no-bitwise\n    theirPublicKey[i] = data[i] ^ publicKey[i];\n  }\n  const sharedSecret = await ed25519.getSharedSecret(privateKey, theirPublicKey);\n\n  const decrypted = await decryptDataImpl(data.slice(publicKey.length), sharedSecret, salt);\n  return decrypted;\n}\n\nexport async function decryptMessageComment(\n  encryptedData: Uint8Array, myPublicKey: Uint8Array, myPrivateKey: Uint8Array, senderAddress: Address | string,\n) {\n  if (myPrivateKey.length === 64) {\n    myPrivateKey = myPrivateKey.slice(0, 32); // convert nacl private key\n  }\n\n  const salt = new TextEncoder().encode(toBase64Address(senderAddress, true));\n\n  const decryptedBytes = await decryptData(encryptedData, myPublicKey, myPrivateKey, salt);\n  return new TextDecoder().decode(decryptedBytes);\n}\n","import { callBackendPost } from '../../../common/backend';\n\nconst DIESEL_URL = '/diesel';\n\nexport function dieselSendBoc(boc: string) {\n  return callBackendPost<{ result: string; paymentLink?: string }>(\n    `${DIESEL_URL}/sendBoc`, { boc, isAddition: true }, { shouldRetry: true },\n  );\n}\n","import { callBackendPost } from '../../../common/backend';\n\nconst DIESEL_URL = '/diesel';\n\nexport function dieselW5SendRequest(boc: string) {\n  return callBackendPost<{ result: string; paymentLink?: string }>(\n    `${DIESEL_URL}/w5/sendBoc`, { boc, isAddition: true }, { shouldRetry: true },\n  );\n}\n","import type { Cell } from '@ton/core';\nimport { beginCell, external, storeMessage } from '@ton/core';\n\nimport type { GaslessType } from '../transfer';\nimport type { TonClient } from './TonClient';\nimport type { TonWallet } from './tonCore';\n\nimport { dieselSendBoc } from './diesel';\nimport { dieselW5SendRequest } from './w5diesel';\n\nexport async function sendExternal(\n  client: TonClient,\n  wallet: TonWallet,\n  message: Cell,\n  gaslessType?: GaslessType,\n) {\n  const {\n    address,\n    init,\n  } = wallet;\n\n  let neededInit: { data: Cell; code: Cell } | undefined;\n  if (init && !await client.isContractDeployed(address)) {\n    neededInit = init;\n  }\n\n  const ext = external({\n    to: address,\n    init: neededInit ? {\n      code: neededInit.code,\n      data: neededInit.data,\n    } : undefined,\n    body: message,\n  });\n\n  const cell = beginCell()\n    .store(storeMessage(ext))\n    .endCell();\n\n  const isW5Gasless = gaslessType === 'w5';\n\n  const msgHash = cell.hash().toString('base64');\n  const bodyMessageHash = message.hash().toString('base64');\n  const boc = cell.toBoc().toString('base64');\n\n  let paymentLink;\n  if (isW5Gasless) {\n    const result = await dieselW5SendRequest(boc);\n    paymentLink = result.paymentLink;\n  } else if (gaslessType === 'diesel') {\n    const result = await dieselSendBoc(boc);\n    paymentLink = result.paymentLink;\n  } else {\n    await client.sendFile(boc);\n  }\n\n  return {\n    boc,\n    msgHash: isW5Gasless ? bodyMessageHash : msgHash,\n    paymentLink,\n  };\n}\n","export default class Deferred<T = void> {\n  promise: Promise<T>;\n\n  reject!: (reason?: any) => void;\n\n  resolve!: (value: T | PromiseLike<T>) => void;\n\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this.reject = reject;\n      this.resolve = resolve;\n    });\n  }\n\n  static resolved(): Deferred<void>;\n  static resolved<T>(value: T): Deferred<T>;\n  static resolved<T>(value?: T): Deferred<T | void> {\n    const deferred = new Deferred<T | void>();\n    deferred.resolve(value);\n    return deferred;\n  }\n}\n","import type { ApiNetwork } from '../types';\n\nimport Deferred from '../../util/Deferred';\nimport generateUniqueId from '../../util/generateUniqueId';\n\nconst byId: Record<string, Deferred> = {};\nconst byAddress: Record<string, Deferred> = {};\n\nexport async function waitAndCreatePendingTransfer(network: ApiNetwork, address: string) {\n  const key = `${network}:${address}`;\n  const prevPending = byAddress[key];\n\n  const id = generateUniqueId();\n  const pendingTransfer = new Deferred();\n  byAddress[key] = pendingTransfer;\n  byId[id] = pendingTransfer;\n\n  if (prevPending) {\n    await prevPending.promise;\n  }\n\n  return { id, pendingTransfer };\n}\n\nexport function getPendingTransfer(id: string): Deferred | undefined {\n  return byId[id];\n}\n","export const SEC = 1000;\nexport const MINUTE = 60 * SEC;\nexport const DAYS_IN_YEAR = 365;\nexport const FIRST_TRANSACTIONS_LIMIT = 50;\n","import { beginCell, type Cell } from '@ton/core';\nimport { sign } from '@ton/crypto';\n\nconst Opcodes = {\n  action_send_msg: 0x0ec3c86d,\n  action_set_code: 0xad4de08e,\n  action_extended_set_data: 0x1ff8ea0b,\n  action_extended_add_extension: 0x02,\n  action_extended_remove_extension: 0x03,\n  action_extended_set_signature_auth_allowed: 0x04,\n  auth_extension: 0x6578746e,\n  auth_signed: 0x7369676e,\n  auth_signed_internal: 0x73696e74,\n};\n\nexport function bufferToBigInt(buffer: Buffer): bigint {\n  return BigInt(`0x${buffer.toString('hex')}`);\n}\n\nexport function createBody(actionsList: Cell, seqno: number, secretKey: Buffer, timeout: number) {\n  const payload = beginCell()\n    .storeUint(Opcodes.auth_signed_internal, 32)\n    // TODO: calculate walletId\n    .storeUint(2147483409n, 32)\n    .storeUint(Math.floor((Date.now() + timeout) / 1000), 32)\n    .storeUint(seqno, 32)\n    .storeSlice(actionsList.beginParse())\n    .endCell();\n\n  const signature = sign(payload.hash(), secretKey);\n  return beginCell()\n    .storeSlice(payload.beginParse())\n    .storeUint(bufferToBigInt(signature), 512)\n    .endCell();\n}\n","import type { Cell, MessageRelaxed } from '@ton/core';\nimport { beginCell, SendMode, storeMessageRelaxed } from '@ton/core';\n\nexport type OutAction = ActionSendMsg;\n\nexport class ActionSendMsg {\n  public static readonly tag = 0x0ec3c86d;\n\n  public readonly tag = ActionSendMsg.tag;\n\n  constructor(public readonly mode: SendMode, public readonly outMsg: MessageRelaxed) {}\n\n  public serialize(): Cell {\n    return beginCell()\n      .storeUint(this.tag, 32)\n      .storeUint(this.mode || SendMode.IGNORE_ERRORS, 8)\n      .storeRef(beginCell().store(storeMessageRelaxed(this.outMsg)).endCell())\n      .endCell();\n  }\n}\n\nfunction packActionsListOut(actions: OutAction[]): Cell {\n  if (actions.length === 0) {\n    return beginCell().endCell();\n  }\n\n  const [action, ...rest] = actions;\n\n  return beginCell()\n    .storeRef(packActionsListOut(rest))\n    .storeSlice(action.serialize().beginParse())\n    .endCell();\n}\n\nfunction packActionsListExtended(actions: OutAction[]): Cell {\n  const outActions: OutAction[] = actions;\n\n  let builder = beginCell();\n  if (outActions.length === 0) {\n    builder = builder.storeUint(0, 1);\n  } else {\n    builder = builder.storeMaybeRef(packActionsListOut(outActions.slice().reverse()));\n  }\n  builder = builder.storeUint(0, 1);\n  return builder.endCell();\n}\n\nexport function packActionsList(actions: OutAction[]): Cell {\n  return packActionsListExtended(actions);\n}\n","export function areDeepEqual<T extends any>(value1: T, value2: T): boolean {\n  const type1 = typeof value1;\n  const type2 = typeof value2;\n  if (type1 !== type2) {\n    return false;\n  }\n\n  // eslint-disable-next-line no-null/no-null\n  if (type1 !== 'object' || value1 === null || value2 === null) {\n    return value1 === value2;\n  }\n\n  const isArray1 = Array.isArray(value1);\n  const isArray2 = Array.isArray(value2);\n\n  if (isArray1 !== isArray2) {\n    return false;\n  }\n\n  if (isArray1) {\n    const array1 = value1 as any[];\n    const array2 = value2 as any[];\n\n    if (array1.length !== array2.length) {\n      return false;\n    }\n\n    return array1.every((member1, i) => areDeepEqual(member1, array2[i]));\n  }\n\n  const object1 = value1 as AnyLiteral;\n  const object2 = value2 as AnyLiteral;\n  const keys1 = Object.keys(object1);\n  const keys2 = Object.keys(object2);\n\n  if (!keys1.every((key1) => object2.hasOwnProperty(key1))) {\n    return false;\n  }\n  if (!keys2.every((key2) => object1.hasOwnProperty(key2))) {\n    return false;\n  }\n\n  return keys1.every((key1) => areDeepEqual(object1[key1], object2[key1]));\n}\n","import type chains from '../chains';\nimport type { ApiDbSseConnection } from '../db';\nimport type { StorageKey } from '../storages/types';\nimport type {\n  ApiActivity,\n  ApiLocalTransactionParams,\n  ApiTonAccount,\n  ApiTonWallet,\n  ApiTransactionActivity,\n  OnApiUpdate,\n} from '../types';\n\nimport {\n  IS_CAPACITOR, IS_CORE_WALLET, IS_EXTENSION, MAIN_ACCOUNT_ID,\n} from '../../config';\nimport { parseAccountId } from '../../util/account';\nimport { buildLocalTxId } from '../../util/activities';\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport { assert } from '../../util/assert';\nimport { logDebugError } from '../../util/logs';\nimport { toBase64Address } from '../chains/ton/util/tonCore';\nimport { getEnvironment } from '../environment';\nimport * as migrations from '../migrations';\nimport { storage } from '../storages';\nimport capacitorStorage from '../storages/capacitorStorage';\nimport idbStorage from '../storages/idb';\nimport localStorage from '../storages/localStorage';\nimport { isAccountActive } from './accounts';\nimport {\n  checkHasScamLink,\n  checkHasTelegramBotMention,\n  getKnownAddresses,\n  getScamMarkers,\n} from './addresses';\nimport { hexToBytes } from './utils';\n\nconst actualStateVersion = 17;\nlet migrationEnsurePromise: Promise<void>;\n\nexport function buildLocalTransaction(\n  params: ApiLocalTransactionParams,\n  normalizedAddress: string,\n  subId?: number,\n): ApiTransactionActivity {\n  const { amount, ...restParams } = params;\n  const txId = buildLocalTxId(params.txId ?? params.externalMsgHash!, subId);\n\n  return updateActivityMetadata({\n    ...restParams,\n    id: txId,\n    kind: 'transaction',\n    txId,\n    timestamp: Date.now(),\n    isIncoming: false,\n    amount: -amount,\n    normalizedAddress,\n  });\n}\n\nexport function updateActivityMetadata<T extends ApiActivity>(activity: T): T {\n  if (activity.kind !== 'transaction') {\n    return activity;\n  }\n\n  const {\n    normalizedAddress, comment, isIncoming, nft,\n  } = activity;\n  let { metadata = {} } = activity;\n\n  const isNftTransfer = Boolean(nft);\n  const knownAddresses = getKnownAddresses();\n  const hasScamMarkers = comment ? getScamMarkers().some((sm) => sm.test(comment)) : false;\n  const shouldCheckComment = !hasScamMarkers && comment && isIncoming\n    && (isNftTransfer || comment.toLowerCase().includes('claim'));\n  const hasScamInComment = shouldCheckComment\n    ? (checkHasScamLink(comment) || checkHasTelegramBotMention(comment))\n    : false;\n\n  if (normalizedAddress in knownAddresses) {\n    metadata = { ...metadata, ...knownAddresses[normalizedAddress] };\n  }\n\n  if (hasScamMarkers || hasScamInComment) {\n    metadata.isScam = true;\n  }\n\n  return { ...activity, metadata };\n}\n\nlet currentOnUpdate: OnApiUpdate | undefined;\n\nexport function connectUpdater(onUpdate: OnApiUpdate) {\n  currentOnUpdate = onUpdate;\n}\n\nexport function disconnectUpdater() {\n  currentOnUpdate = undefined;\n}\n\nexport function isAlive(_onUpdate: OnApiUpdate, accountId: string) {\n  return isUpdaterAlive(_onUpdate) && isAccountActive(accountId);\n}\n\nexport function isUpdaterAlive(onUpdate: OnApiUpdate) {\n  return currentOnUpdate === onUpdate;\n}\n\nexport function startStorageMigration(onUpdate: OnApiUpdate, ton: typeof chains.ton) {\n  migrationEnsurePromise = migrateStorage(onUpdate, ton)\n    .catch((err) => {\n      logDebugError('Migration error', err);\n      currentOnUpdate?.({\n        type: 'showError',\n        error: 'Migration error',\n      });\n    });\n  return migrationEnsurePromise;\n}\n\nexport function waitStorageMigration() {\n  return migrationEnsurePromise;\n}\n\nexport async function migrateStorage(onUpdate: OnApiUpdate, ton: typeof chains.ton) {\n  let version = Number(await storage.getItem('stateVersion', true));\n\n  if (version === actualStateVersion) {\n    return;\n  }\n\n  if (IS_CORE_WALLET && !version) {\n    await migrateCoreWallet(onUpdate);\n  }\n\n  if (IS_CAPACITOR && !version) {\n    if (await storage.getItem('accounts' as StorageKey, true)) {\n      // Fix broken version\n      version = 10;\n    } else {\n      // Prepare for migration to secure storage\n      const idbVersion = await idbStorage.getItem('stateVersion');\n      if (idbVersion) {\n        version = Number(idbVersion);\n      }\n    }\n  }\n\n  // Migration to chrome.storage\n  if (IS_EXTENSION && !version && !(await storage.getItem('addresses' as StorageKey))) {\n    version = await idbStorage.getItem('stateVersion');\n\n    if (version) {\n      // Switching from IndexedDB to `chrome.storage.local`\n      const idbData = await idbStorage.getAll!();\n      await storage.setMany!(idbData);\n    }\n  }\n\n  if (!version) {\n    await storage.setItem('stateVersion', actualStateVersion);\n    return;\n  }\n\n  // First version (v1)\n  if (!version) {\n    // Support multi-accounts\n    const mnemonicEncrypted = await storage.getItem('mnemonicEncrypted' as StorageKey);\n    if (mnemonicEncrypted) {\n      await storage.setItem('mnemonicsEncrypted' as StorageKey, JSON.stringify({\n        [MAIN_ACCOUNT_ID]: mnemonicEncrypted,\n      }));\n      await storage.removeItem('mnemonicEncrypted' as StorageKey);\n    }\n\n    // Change accountId format ('0' -> '0-ton', '1-ton-mainnet' -> '1-ton')\n    if (!mnemonicEncrypted) {\n      for (const field of ['mnemonicsEncrypted', 'addresses', 'publicKeys'] as unknown as StorageKey[]) {\n        const raw = await storage.getItem(field);\n        if (!raw) continue;\n\n        const oldItem = JSON.parse(raw);\n\n        const newItem = Object.entries(oldItem).reduce((prevValue, [accountId, data]) => {\n          const [id, chain = 'ton'] = accountId.split('-');\n          const internalAccountId = [id, chain].join('-');\n          prevValue[internalAccountId] = data;\n          return prevValue;\n        }, {} as any);\n\n        await storage.setItem(field, JSON.stringify(newItem));\n      }\n    }\n\n    version = 1;\n    await storage.setItem('stateVersion', version);\n  }\n\n  if (version === 1) {\n    const addresses = await storage.getItem('addresses' as StorageKey) as string | undefined;\n    if (addresses && addresses.includes('-undefined')) {\n      for (const field of ['mnemonicsEncrypted', 'addresses', 'publicKeys'] as unknown as StorageKey[]) {\n        const newValue = (await storage.getItem(field) as string).replace('-undefined', '-ton');\n        await storage.setItem(field, newValue);\n      }\n    }\n\n    version = 2;\n    await storage.setItem('stateVersion', version);\n  }\n\n  if (version >= 2 && version <= 4) {\n    for (const key of ['addresses', 'mnemonicsEncrypted', 'publicKeys', 'dapps'] as StorageKey[]) {\n      const rawData = await storage.getItem(key);\n      if (typeof rawData === 'string') {\n        await storage.setItem(key, JSON.parse(rawData));\n      }\n    }\n\n    version = 5;\n    await storage.setItem('stateVersion', version);\n  }\n\n  if (version === 5) {\n    const dapps = await storage.getItem('dapps');\n    if (dapps) {\n      for (const accountDapps of Object.values(dapps) as any[]) {\n        for (const dapp of Object.values(accountDapps) as any[]) {\n          dapp.connectedAt = 1;\n        }\n      }\n      await storage.setItem('dapps', dapps);\n    }\n\n    version = 6;\n    await storage.setItem('stateVersion', version);\n  }\n\n  if (version === 6) {\n    for (const key of ['addresses', 'mnemonicsEncrypted', 'publicKeys', 'accounts', 'dapps'] as StorageKey[]) {\n      let data = await storage.getItem(key) as AnyLiteral;\n      if (!data) continue;\n\n      data = Object.entries(data).reduce((byAccountId, [internalAccountId, accountData]) => {\n        const parsed = parseAccountId(internalAccountId);\n        const mainnetAccountId = buildOldAccountId({ ...parsed, network: 'mainnet' });\n        const testnetAccountId = buildOldAccountId({ ...parsed, network: 'testnet' });\n        return {\n          ...byAccountId,\n          [mainnetAccountId]: accountData,\n          [testnetAccountId]: accountData,\n        };\n      }, {} as AnyLiteral);\n\n      await storage.setItem(key, data);\n    }\n\n    version = 7;\n    await storage.setItem('stateVersion', version);\n  }\n\n  if (version === 7) {\n    const addresses = (await storage.getItem('addresses' as StorageKey)) as Record<string, string> | undefined;\n\n    if (addresses) {\n      const publicKeys = (await storage.getItem('publicKeys' as StorageKey)) as Record<string, string>;\n      const accounts = (await storage.getItem('accounts') ?? {}) as Record<string, ApiTonWallet>;\n\n      for (const [accountId, oldAddress] of Object.entries(addresses)) {\n        const newAddress = toBase64Address(oldAddress, false);\n\n        accounts[accountId] = {\n          ...accounts[accountId],\n          address: newAddress,\n          publicKey: publicKeys[accountId],\n        };\n\n        onUpdate({\n          type: 'updateAccount',\n          accountId,\n          partial: {\n            address: newAddress,\n          },\n        });\n      }\n\n      await storage.setItem('accounts', accounts);\n\n      await storage.removeItem('addresses' as StorageKey);\n      await storage.removeItem('publicKeys' as StorageKey);\n    }\n\n    version = 8;\n    await storage.setItem('stateVersion', version);\n  }\n\n  if (version === 8) {\n    if (getEnvironment().isSseSupported) {\n      const dapps = await storage.getItem('dapps');\n\n      if (dapps) {\n        const items: ApiDbSseConnection[] = [];\n\n        for (const accountDapps of Object.values(dapps) as any[]) {\n          for (const dapp of Object.values(accountDapps) as any[]) {\n            if (dapp.sse?.appClientId) {\n              items.push({ clientId: dapp.sse?.appClientId });\n            }\n          }\n        }\n      }\n    }\n\n    version = 9;\n    await storage.setItem('stateVersion', version);\n  }\n\n  if (version === 9) {\n    if (IS_CAPACITOR) {\n      const data = await idbStorage.getAll!();\n\n      for (const [key, value] of Object.entries(data)) {\n        await capacitorStorage.setItem(key as StorageKey, value);\n        const newValue = await capacitorStorage.getItem(key as StorageKey, true);\n\n        if (!areDeepEqual(value, newValue)) {\n          throw new Error('Migration error!');\n        }\n      }\n      await idbStorage.clear();\n    }\n\n    version = 10;\n    await storage.setItem('stateVersion', version);\n  }\n\n  let isIosKeychainModeMigrated = false;\n  if (getEnvironment().isIosApp && version >= 10 && version <= 13) {\n    await iosBackupAndMigrateKeychainMode();\n    isIosKeychainModeMigrated = true;\n  }\n\n  if (version === 10 || version === 11 || version === 12) {\n    const accounts: Record<string, {\n      publicKey: string;\n      address: string;\n      version?: string;\n    }> | undefined = await storage.getItem('accounts', true);\n\n    if (accounts) {\n      for (const account of Object.values(accounts)) {\n        const { publicKey, address, version: walletVersion } = account;\n\n        if (walletVersion || !publicKey) continue;\n\n        const publicKeyBytes = hexToBytes(publicKey);\n        const walletInfo = ton.pickWalletByAddress('mainnet', publicKeyBytes, address);\n\n        account.version = walletInfo.version;\n      }\n\n      await storage.setItem('accounts', accounts);\n    }\n\n    version = 13;\n    await storage.setItem('stateVersion', version);\n  }\n\n  if (version === 13) {\n    const accounts: Record<string, {\n      publicKey: string;\n      address: string;\n      version?: string;\n    }> | undefined = await storage.getItem('accounts', true);\n\n    if (accounts) {\n      for (const [accountId, account] of Object.entries(accounts)) {\n        const { network } = parseAccountId(accountId);\n        if (network === 'testnet') {\n          account.address = toBase64Address(account.address, false, network);\n\n          onUpdate({\n            type: 'updateAccount',\n            accountId,\n            partial: {\n              address: account.address,\n            },\n          });\n        }\n      }\n\n      version = 14;\n      await storage.setItem('accounts', accounts);\n    }\n  }\n\n  if (version === 14 || version === 15) {\n    if (getEnvironment().isIosApp && !isIosKeychainModeMigrated) {\n      await iosBackupAndMigrateKeychainMode();\n    }\n\n    version = 16;\n    await storage.setItem('stateVersion', version);\n  }\n\n  if (version === 16) {\n    await migrations.migration16.start();\n\n    version = 17;\n    await storage.setItem('stateVersion', version);\n  }\n}\n\nfunction buildOldAccountId(account: { id: number; network: string }) {\n  const { id, network } = account;\n  return `${id}-ton-${network}`;\n}\n\nasync function iosBackupAndMigrateKeychainMode() {\n  const keys = await capacitorStorage.getKeys();\n\n  if (keys?.length) {\n    const items: [string, any][] = [];\n\n    for (const key of keys) {\n      if (key.startsWith('backup_')) {\n        continue;\n      }\n\n      const backupKey = `backup_${key}` as StorageKey;\n      const value = await capacitorStorage.getItem(key as StorageKey, true);\n\n      assert(value !== undefined, 'Empty value!');\n      await capacitorStorage.setItem(backupKey, value);\n      const backupValue = await capacitorStorage.getItem(backupKey);\n      assert(areDeepEqual(value, backupValue), 'Data has not been saved!');\n\n      items.push([key, value]);\n    }\n\n    for (const [key, value] of items) {\n      let shouldRewrite = false;\n      await capacitorStorage.setItem(key as StorageKey, value).catch(() => {\n        shouldRewrite = true;\n      });\n\n      if (shouldRewrite) {\n        await capacitorStorage.removeItem(key as StorageKey);\n        await capacitorStorage.setItem(key as StorageKey, value);\n      }\n    }\n  }\n}\n\nasync function migrateCoreWallet(onUpdate: OnApiUpdate) {\n  const currentStorage = IS_EXTENSION ? storage : localStorage;\n\n  const [\n    // Default Core Wallet version is v3R2\n    // https://github.com/toncenter/ton-wallet/blob/master/src/js/Controller.js#L128\n    walletVersion = 'v3R2',\n    isTestnet,\n    address,\n    words,\n    publicKey,\n    isTonProxyEnabled,\n    isTonMagicEnabled,\n  ] = await Promise.all([\n    currentStorage.getItem('walletVersion' as StorageKey),\n    currentStorage.getItem('isTestnet' as StorageKey),\n    currentStorage.getItem('address' as StorageKey),\n    currentStorage.getItem('words' as StorageKey),\n    currentStorage.getItem('publicKey' as StorageKey),\n    currentStorage.getItem('proxy' as StorageKey),\n    currentStorage.getItem('magic' as StorageKey),\n  ]);\n\n  if (isTestnet) {\n    onUpdate({\n      type: 'updateSettings',\n      settings: {\n        isTestnet: true,\n      },\n    });\n  }\n\n  const network = isTestnet ? 'testnet' : 'mainnet';\n  const accountId = `0-ton-${network}`;\n\n  if (address && words && publicKey) {\n    const secondNetwork = network === 'mainnet' ? 'testnet' : 'mainnet';\n    const secondAccountId = `0-ton-${secondNetwork}`;\n    const secondAddress = toBase64Address(address, false, secondNetwork);\n\n    const newAccountById: Record<string, ApiTonAccount> = {};\n    newAccountById[accountId] = {\n      type: 'ton',\n      mnemonicEncrypted: words,\n      ton: {\n        type: 'ton',\n        address,\n        version: walletVersion,\n        publicKey,\n        index: 0,\n      },\n    };\n\n    newAccountById[secondAccountId] = {\n      type: 'ton',\n      mnemonicEncrypted: words,\n      ton: {\n        type: 'ton',\n        address: secondAddress,\n        version: walletVersion,\n        publicKey,\n        index: 0,\n      },\n    };\n\n    await storage.setItem('accounts', newAccountById);\n\n    onUpdate({\n      type: 'migrateCoreApplication',\n      isTestnet,\n      accountId,\n      address,\n      secondAccountId,\n      secondAddress,\n      isTonProxyEnabled,\n      isTonMagicEnabled,\n    });\n\n    // Clean up storage after migrate the app from Core Wallet\n    [\n      'walletVersion', 'isTestnet', 'words', 'address', 'publicKey', 'magic', 'proxy', 'isLedger',\n      'ledgerTransportType', '__time', 'isDebug',\n    ].forEach((key) => {\n      void currentStorage.removeItem(key as StorageKey);\n    });\n  }\n}\n","import type { ApiActivity, ApiNetwork, ApiSwapActivity, ApiTransactionActivity } from '../../types';\nimport type {\n  AddressBook,\n  AnyAction,\n  CallContractAction,\n  JettonTransferAction,\n  SwapAction,\n  Trace,\n  TraceDetail,\n} from './toncenter/types';\nimport type { ApiTransactionExtended } from './types';\n\nimport { parseAccountId } from '../../../util/account';\nimport { getActivityTokenSlugs, parseTxId } from '../../../util/activities';\nimport { bigintAbs } from '../../../util/bigint';\nimport { toDecimal } from '../../../util/decimals';\nimport { groupBy, intersection } from '../../../util/iteratees';\nimport { logDebug } from '../../../util/logs';\nimport withCacheAsync from '../../../util/withCacheAsync';\nimport { resolveTokenWalletAddress } from './util/tonCore';\nimport { fetchStoredTonWallet } from '../../common/accounts';\nimport { updateActivityMetadata } from '../../common/helpers';\nimport { getTokenBySlug } from '../../common/tokens';\nimport { fetchTrace } from './toncenter/traces';\nimport { OpCode, OUR_FEE_PAYLOAD_BOC } from './constants';\nimport { fetchActions, fetchTransactions, parseActionActivitySubId, parseRawTransaction } from './toncenter';\n\ntype ParsedTracePart = {\n  hashes: Set<string>;\n  inputTxs: ApiTransactionExtended[];\n  sent: bigint;\n  received: bigint;\n  networkFee: bigint;\n};\n\ntype ParsedTrace = {\n  trace: Trace;\n  addressBook: AddressBook;\n  byTransactionIndex: ParsedTracePart[];\n  totalSent: bigint;\n  totalReceived: bigint;\n  totalNetworkFee: bigint;\n};\n\nconst GET_TRANSACTIONS_LIMIT = 128;\n\nexport const checkHasTransaction = withCacheAsync(async (network: ApiNetwork, address: string) => {\n  const transactions = await fetchTransactions({\n    network,\n    address,\n    limit: 1,\n  });\n  return Boolean(transactions.length);\n});\n\nexport async function fetchActivitySlice(\n  accountId: string,\n  tokenSlug?: string,\n  toTimestamp?: number,\n  fromTimestamp?: number,\n  limit?: number,\n  shouldIncludeFrom?: boolean,\n): Promise<ApiActivity[]> {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  let activities: ApiActivity[];\n\n  if (!tokenSlug) {\n    activities = await fetchActions({\n      network,\n      address,\n      walletAddress: address,\n      limit: limit ?? GET_TRANSACTIONS_LIMIT,\n      fromTimestamp,\n      toTimestamp,\n      shouldIncludeFrom,\n    });\n  } else {\n    const token = getTokenBySlug(tokenSlug);\n    const tokenWalletAddress = await resolveTokenWalletAddress(network, address, token.tokenAddress!);\n\n    activities = await fetchActions({\n      network,\n      address: tokenWalletAddress,\n      walletAddress: address,\n      limit: limit ?? GET_TRANSACTIONS_LIMIT,\n      fromTimestamp,\n      toTimestamp,\n      shouldIncludeFrom,\n    });\n\n    activities = activities.filter((activity) => getActivityTokenSlugs(activity).includes(tokenSlug));\n  }\n\n  return activities.map(updateActivityMetadata);\n}\n\nexport async function fetchNewestActionId(network: ApiNetwork, address: string) {\n  const transactions = await fetchTransactions({\n    network,\n    address,\n    limit: 1,\n  });\n\n  if (!transactions.length) {\n    return undefined;\n  }\n\n  return transactions[0].txId;\n}\n\nexport async function fetchActivityDetails(accountId: string, activity: ApiActivity): Promise<ApiActivity> {\n  const { network } = parseAccountId(accountId);\n  const { address: walletAddress } = await fetchStoredTonWallet(accountId);\n\n  const { id } = activity;\n  const { hash: traceId, subId } = parseTxId(id);\n  const { actionId } = parseActionActivitySubId(subId!);\n\n  const parsedTrace = await fetchAndParseTrace(network, walletAddress, traceId);\n  const { trace, byTransactionIndex } = parsedTrace;\n\n  const action = trace.actions.find(({ action_id }) => action_id === actionId)!;\n  const actionHashes = new Set(action.transactions);\n\n  const {\n    sent,\n    received,\n    networkFee,\n  } = byTransactionIndex.find((item) => {\n    return intersection(item.hashes, actionHashes).size;\n  })!;\n\n  let realFee = networkFee;\n\n  if (activity.kind === 'swap') {\n    ({ realFee, activity } = setSwapDetails({\n      parsedTrace, activity, action: action as SwapAction, sent, received, realFee,\n    }));\n  } else {\n    ({ realFee, activity } = setTransactionDetails({\n      parsedTrace, activity, action, sent, received, realFee,\n    }));\n  }\n\n  logDebug('Calculation of fee for action', {\n    actionId: action.action_id,\n    traceId,\n    sent: toDecimal(sent),\n    networkFee: toDecimal(networkFee),\n    returned: toDecimal(received),\n    change: toDecimal(-sent + received),\n    realFee: toDecimal(realFee),\n    details: action.details,\n  });\n\n  return activity;\n}\n\nfunction setSwapDetails(options: {\n  parsedTrace: ParsedTrace;\n  action: SwapAction;\n  activity: ApiSwapActivity;\n  sent: bigint;\n  received: bigint;\n  realFee: bigint;\n}) {\n  const { action, received, sent, parsedTrace: { trace } } = options;\n  let { realFee, activity } = options;\n\n  const { details } = action as SwapAction;\n\n  if (!details.asset_in) {\n    // TON -> token\n    realFee += sent - BigInt(details.dex_incoming_transfer.amount) - received;\n  } else if (!details.asset_out) {\n    // Token -> TON\n    realFee += sent - received + BigInt(details.dex_outgoing_transfer.amount);\n  } else {\n    // Token -> token\n    realFee += sent - received;\n  }\n\n  activity = {\n    ...activity,\n    networkFee: toDecimal(realFee),\n  };\n  delete activity.shouldLoadDetails;\n\n  let ourFee: bigint | undefined;\n  if (!details.asset_in) {\n    const ourFeeAction = trace.actions.find((_action) => {\n      return _action.type === 'call_contract' && Number(_action.details.opcode) === OpCode.OurFee;\n    }) as CallContractAction | undefined;\n    if (ourFeeAction) {\n      ourFee = BigInt(ourFeeAction.details.value);\n    }\n  } else {\n    const ourFeeAction = trace.actions.find((_action) => {\n      return _action.type === 'jetton_transfer' && _action.details.forward_payload === OUR_FEE_PAYLOAD_BOC;\n    }) as JettonTransferAction | undefined;\n    if (ourFeeAction) {\n      ourFee = BigInt(ourFeeAction.details.amount);\n    }\n  }\n\n  if (ourFee) {\n    const tokenIn = getTokenBySlug(activity.from);\n    activity.ourFee = toDecimal(ourFee, tokenIn?.decimals);\n  }\n\n  return { realFee, activity };\n}\n\nfunction setTransactionDetails(options: {\n  parsedTrace: ParsedTrace;\n  action: AnyAction;\n  activity: ApiTransactionActivity;\n  sent: bigint;\n  received: bigint;\n  realFee: bigint;\n}) {\n  const {\n    action,\n    received,\n    sent,\n    parsedTrace: {\n      byTransactionIndex,\n      totalSent,\n      totalReceived,\n      totalNetworkFee,\n    } } = options;\n  let { realFee, activity } = options;\n\n  switch (action.type) {\n    case 'jetton_transfer':\n    case 'jetton_mint':\n    case 'jetton_burn':\n    case 'nft_mint':\n    case 'nft_transfer':\n    case 'stake_withdrawal_request': {\n      realFee += sent - received;\n      break;\n    }\n    case 'stake_deposit': {\n      realFee += sent - received - BigInt(action.details.amount);\n      break;\n    }\n    case 'stake_withdrawal': {\n      realFee += sent - received + BigInt(action.details.amount);\n      break;\n    }\n    case 'change_dns':\n    case 'delete_dns':\n    case 'renew_dns': {\n      realFee += sent - received;\n      break;\n    }\n    case 'dex_deposit_liquidity': {\n      if (byTransactionIndex.length > 1) {\n        realFee = totalNetworkFee + totalSent - totalReceived;\n      } else {\n        realFee += sent - received;\n      }\n\n      if (!action.details.asset_1) {\n        realFee -= BigInt(action.details.amount_1!);\n      } else if (action.details.lp_tokens_minted && !action.details.asset_2) {\n        realFee -= BigInt(action.details.amount_2!);\n      }\n\n      if (byTransactionIndex.length > 1) {\n        realFee /= 2n;\n      }\n      break;\n    }\n    case 'dex_withdraw_liquidity': {\n      realFee += sent - received;\n      if (!action.details.asset_1) {\n        realFee += BigInt(action.details.amount_1);\n      } else if (!action.details.asset_2) {\n        realFee += BigInt(action.details.amount_2);\n      }\n      realFee /= 2n;\n      break;\n    }\n  }\n\n  activity = {\n    ...activity,\n    fee: realFee,\n  };\n  delete activity.shouldLoadDetails;\n\n  return { activity, realFee };\n}\n\nasync function fetchAndParseTrace(network: ApiNetwork, walletAddress: string, traceId: string): Promise<ParsedTrace> {\n  const {\n    trace,\n    addressBook,\n  } = await fetchTrace({\n    network,\n    traceId,\n  });\n\n  const transactions = Object.values(trace.transactions)\n    .map((rawTx) => parseRawTransaction(network, rawTx, addressBook))\n    .flat();\n  const byHash = groupBy(transactions, 'hash');\n\n  let totalSent = 0n;\n  let totalReceived = 0n;\n  let totalNetworkFee = 0n;\n\n  const byTransactionIndex: ParsedTracePart[] = [];\n\n  let isWalletTransactionFound = false;\n\n  function processTrace(traceDetail: TraceDetail, _index?: number) {\n    const hash = traceDetail.tx_hash;\n    const txs = byHash[hash];\n\n    if (!isWalletTransactionFound) {\n      isWalletTransactionFound = txs.some(({ fromAddress, isIncoming }) => {\n        return fromAddress === walletAddress && !isIncoming;\n      });\n\n      // In gasless operations, we need to skip transactions before our wallet\n      if (!isWalletTransactionFound) {\n        traceDetail.children.forEach(processTrace);\n        return;\n      }\n    }\n\n    for (const [i, tx] of txs.entries()) {\n      const {\n        fromAddress,\n        toAddress,\n        amount,\n        isIncoming,\n        fee,\n        msgHash,\n      } = tx;\n\n      const index = _index ?? i;\n\n      if (!(index in byTransactionIndex)) {\n        byTransactionIndex.push({\n          hashes: new Set(),\n          inputTxs: [],\n          sent: 0n,\n          received: 0n,\n          networkFee: 0n,\n        });\n      } else {\n        byTransactionIndex[index].hashes.add(hash);\n      }\n\n      if (fromAddress === walletAddress && !isIncoming) {\n        byTransactionIndex[index].sent += bigintAbs(amount);\n        byTransactionIndex[index].networkFee = fee;\n        totalSent += bigintAbs(amount);\n        totalNetworkFee += fee;\n      } else if (toAddress === walletAddress && isIncoming) {\n        byTransactionIndex[index].received += bigintAbs(amount);\n        byTransactionIndex[index].inputTxs.push(tx);\n        totalReceived += bigintAbs(amount);\n      }\n\n      const child = traceDetail.children.find(({ in_msg_hash }) => in_msg_hash === msgHash);\n      if (child) {\n        processTrace(child, index);\n      }\n    }\n  }\n\n  processTrace(trace.trace);\n\n  return {\n    trace,\n    addressBook,\n    byTransactionIndex,\n    totalSent,\n    totalReceived,\n    totalNetworkFee,\n  };\n}\n","import type { ApiNetwork } from '../../../types';\nimport type { AddressBook, MetadataMap, Trace } from './types';\n\nimport { callToncenterV3 } from './other';\n\ntype TracesResponse = {\n  traces: Trace[];\n  address_book: AddressBook;\n  metadata: MetadataMap;\n};\n\nexport async function fetchTrace(options: {\n  network: ApiNetwork;\n  traceId: string;\n}): Promise<{ trace: Trace; addressBook: AddressBook }> {\n  const { network, traceId } = options;\n\n  const response = await callToncenterV3<TracesResponse>(network, '/traces', {\n    trace_id: traceId,\n    include_actions: true,\n  });\n\n  return {\n    trace: response.traces[0],\n    addressBook: response.address_book,\n  };\n}\n","/* Source https://github.com/toncenter/tonweb/blob/master/src/contract/dns/DnsUtils.js */\nimport type { Cell, Slice } from '@ton/core';\nimport { Address, Builder } from '@ton/core';\n\nimport type { TonClient } from './TonClient';\n\nimport { sha256 } from '../../../common/utils';\nimport { DnsCategory } from '../constants';\n\nexport type DnsResult = Cell | Address | string | undefined;\n\nasync function categoryToBigInt(category?: string) {\n  if (!category) return 0n; // all categories\n  const categoryBytes = new TextEncoder().encode(category);\n  const categoryHashHex = Buffer.from(await sha256(categoryBytes)).toString('hex');\n  return BigInt(`0x${categoryHashHex}`);\n}\n\nfunction parseSmartContractAddressImpl(cell: Cell, prefix0: number, prefix1: number): Address | undefined {\n  const slice = cell.asSlice();\n\n  const byte0 = slice.loadUint(8);\n  const byte1 = slice.loadUint(8);\n\n  if (byte0 !== prefix0 || byte1 !== prefix1) {\n    throw new Error('Invalid dns record value prefix');\n  }\n\n  return parseAddress(slice);\n}\n\nfunction parseSmartContractAddressRecord(cell: Cell): Address | undefined {\n  return parseSmartContractAddressImpl(cell, 0x9f, 0xd3);\n}\n\nfunction parseNextResolverRecord(cell: Cell): Address | undefined {\n  return parseSmartContractAddressImpl(cell, 0xba, 0x93);\n}\n\nfunction parseStorageBagIdRecord(cell: Cell): string {\n  const slice = cell.asSlice();\n  const byte0 = slice.loadUint(8);\n  const byte1 = slice.loadUint(8);\n\n  if (byte0 !== 0x74 || byte1 !== 0x73) {\n    throw new Error('Invalid dns record value prefix');\n  }\n\n  const buffer = slice.loadBuffer(4);\n  return buffer.toString('hex');\n}\n\nfunction parseSiteRecord(cell: Cell): string {\n  const slice = cell.asSlice();\n  const byte0 = slice.loadUint(8);\n  const byte1 = slice.loadUint(8);\n\n  if (byte0 === 0xad || byte1 === 0x01) {\n    return parseAdnlAddressRecord(cell);\n  } else {\n    return parseStorageBagIdRecord(cell);\n  }\n}\n\nfunction parseAdnlAddressRecord(cell: Cell): string {\n  const slice = cell.asSlice();\n  const byte0 = slice.loadUint(8);\n  const byte1 = slice.loadUint(8);\n\n  if (byte0 !== 0xad || byte1 !== 0x01) {\n    throw new Error('Invalid dns record value prefix');\n  }\n\n  const buffer = slice.loadBuffer(4);\n  return buffer.toString('hex');\n}\n\nasync function dnsResolveImpl(\n  client: TonClient,\n  dnsAddress: string,\n  rawDomainBytes: Uint8Array,\n  category?: DnsCategory,\n  oneStep?: boolean,\n): Promise<DnsResult> {\n  const len = rawDomainBytes.length * 8;\n\n  const domainCell = new Builder()\n    .storeBuffer(Buffer.from(rawDomainBytes))\n    .asCell();\n\n  const categoryBN = await categoryToBigInt(category);\n  const { stack } = await client.callGetMethod(Address.parse(dnsAddress), 'dnsresolve', [\n    { type: 'slice', cell: domainCell },\n    { type: 'int', value: BigInt(categoryBN.toString()) },\n  ]);\n\n  const resultLen = stack.readNumber();\n\n  let cell: Cell | undefined;\n\n  try {\n    cell = stack.readCell();\n  } catch (err) {\n    // Do nothing\n  }\n\n  if (resultLen === 0) {\n    return undefined; // domain cannot be resolved\n  }\n\n  if (resultLen % 8 !== 0) {\n    throw new Error('domain split not at a component boundary');\n  }\n  // if (rawDomainBytes[resultLen] !== 0) {\n  //     throw new Error('domain split not at a component boundary');\n  // }\n  if (resultLen > len) {\n    throw new Error(`invalid response ${resultLen}/${len}`);\n  } else if (resultLen === len) {\n    if (category === DnsCategory.DnsNextResolver) {\n      return cell ? parseNextResolverRecord(cell) : undefined;\n    } else if (category === DnsCategory.Wallet) {\n      return cell ? parseSmartContractAddressRecord(cell) : undefined;\n    } else if (category === DnsCategory.Site) {\n      return cell ? parseSiteRecord(cell) : undefined;\n    } else if (category === DnsCategory.BagId) {\n      return cell ? parseStorageBagIdRecord(cell) : undefined;\n    } else {\n      return cell;\n    }\n  } else if (!cell) {\n    return undefined; // domain cannot be resolved\n  } else {\n    const nextAddress = parseNextResolverRecord(cell)!;\n    if (oneStep) {\n      if (category === DnsCategory.DnsNextResolver) {\n        return nextAddress;\n      } else {\n        return undefined;\n      }\n    } else {\n      return dnsResolveImpl(client, nextAddress.toString(), rawDomainBytes.slice(resultLen / 8), category, false);\n    }\n  }\n}\n\nfunction domainToBytes(domain: string): Uint8Array {\n  if (!domain || !domain.length) {\n    throw new Error('empty domain');\n  }\n  if (domain === '.') {\n    return new Uint8Array([0]);\n  }\n\n  domain = domain.toLowerCase();\n\n  for (let i = 0; i < domain.length; i++) {\n    if (domain.charCodeAt(i) <= 32) {\n      throw new Error('bytes in range 0..32 are not allowed in domain names');\n    }\n  }\n\n  for (let i = 0; i < domain.length; i++) {\n    const s = domain.substring(i, i + 1);\n    for (let c = 127; c <= 159; c++) { // another control codes range\n      if (s === String.fromCharCode(c)) {\n        throw new Error('bytes in range 127..159 are not allowed in domain names');\n      }\n    }\n  }\n\n  const arr = domain.split('.');\n\n  arr.forEach((part) => {\n    if (!part.length) {\n      throw new Error('domain name cannot have an empty component');\n    }\n  });\n\n  let rawDomain = `${arr.reverse().join('\\0')}\\0`;\n  if (rawDomain.length < 126) {\n    rawDomain = `\\0${rawDomain}`;\n  }\n\n  return new TextEncoder().encode(rawDomain);\n}\n\nexport function dnsResolve(\n  client: TonClient,\n  rootDnsAddress: string,\n  domain: string,\n  category?: DnsCategory,\n  oneStep?: boolean,\n): Promise<DnsResult> {\n  const rawDomainBytes = domainToBytes(domain);\n\n  return dnsResolveImpl(client, rootDnsAddress, rawDomainBytes, category, oneStep);\n}\n\nfunction parseAddress(slice: Slice): Address | undefined {\n  slice.loadUint(3);\n  let n = slice.loadUintBig(8);\n  if (n > 127n) { // Maybe it's not necessary?\n    n -= 256n;\n  }\n\n  const hashPart = slice.loadUintBig(256);\n  if (`${n.toString(10)}:${hashPart.toString(16)}` === '0:0') {\n    return undefined;\n  }\n  const s = `${n.toString(10)}:${hashPart.toString(16).padStart(64, '0')}`;\n  return Address.parse(s);\n}\n","import { Address } from '@ton/core';\n\nimport type { ApiNetwork } from '../../types';\n\nimport { getDnsDomainZone, isDnsDomain } from '../../../util/dns';\nimport { dnsResolve } from './util/dns';\nimport { getTonClient, toBase64Address } from './util/tonCore';\nimport { getKnownAddressInfo } from '../../common/addresses';\nimport { DnsCategory } from './constants';\nimport { fetchAddressBook } from './toncenter';\n\nexport async function resolveAddress(network: ApiNetwork, address: string): Promise<{\n  address: string;\n  name?: string;\n  isMemoRequired?: boolean;\n  isScam?: boolean;\n} | undefined> {\n  const isDomain = isDnsDomain(address);\n  let domain: string | undefined;\n\n  if (isDomain) {\n    const resolvedAddress = await resolveAddressByDomain(network, address);\n    if (!resolvedAddress) {\n      return undefined;\n    }\n\n    const addressBook = await fetchAddressBook(network, [resolvedAddress]);\n\n    domain = address;\n    address = addressBook[resolvedAddress].user_friendly;\n  }\n\n  const normalizedAddress = normalizeAddress(address);\n  const known = getKnownAddressInfo(normalizedAddress);\n\n  if (known) {\n    return {\n      address,\n      ...known,\n      name: domain ?? known.name,\n    };\n  }\n\n  return { address, name: domain };\n}\n\nasync function resolveAddressByDomain(network: ApiNetwork, domain: string) {\n  try {\n    const zoneMatch = getDnsDomainZone(domain);\n    if (!zoneMatch) {\n      return undefined;\n    }\n\n    const result = await dnsResolve(\n      getTonClient(network),\n      zoneMatch.zone.resolver,\n      zoneMatch.base,\n      DnsCategory.Wallet,\n    );\n\n    if (!(result instanceof Address)) {\n      return undefined;\n    }\n\n    return toBase64Address(result, undefined, network);\n  } catch (err: any) {\n    if (!err.message?.includes('exit_code')) {\n      throw err;\n    }\n    return undefined;\n  }\n}\n\nexport function normalizeAddress(address: string, network?: ApiNetwork) {\n  return toBase64Address(address, true, network);\n}\n","import type { JettonBalance } from 'tonapi-sdk-js';\nimport { Address, Cell } from '@ton/core';\n\nimport type { ApiNetwork, ApiToken } from '../../types';\nimport type { AnyPayload, JettonMetadata, TonTransferParams } from './types';\n\nimport { TON_USDT_SLUG } from '../../../config';\nimport { parseAccountId } from '../../../util/account';\nimport { fetchJsonWithProxy } from '../../../util/fetch';\nimport { logDebugError } from '../../../util/logs';\nimport { fixIpfsUrl } from '../../../util/metadata';\nimport { fetchJettonMetadata, fixBase64ImageData, parsePayloadBase64 } from './util/metadata';\nimport { fetchJettonBalances } from './util/tonapiio';\nimport {\n  buildTokenTransferBody,\n  getTokenBalance,\n  getTonClient,\n  resolveTokenAddress,\n  resolveTokenWalletAddress,\n  toBase64Address, toRawAddress,\n} from './util/tonCore';\nimport { fetchStoredTonWallet } from '../../common/accounts';\nimport { buildTokenSlug, getTokenByAddress } from '../../common/tokens';\nimport {\n  CLAIM_MINTLESS_AMOUNT,\n  DEFAULT_DECIMALS,\n  TINIEST_TOKEN_TRANSFER_REAL_AMOUNT,\n  TINY_TOKEN_TRANSFER_AMOUNT,\n  TINY_TOKEN_TRANSFER_REAL_AMOUNT,\n  TOKEN_TRANSFER_AMOUNT,\n  TOKEN_TRANSFER_FORWARD_AMOUNT,\n  TOKEN_TRANSFER_REAL_AMOUNT,\n} from './constants';\nimport { isActiveSmartContract } from './wallet';\n\nexport type TokenBalanceParsed = {\n  slug: string;\n  balance: bigint;\n  token: ApiToken;\n  jettonWallet: string;\n};\n\nexport async function getAccountTokenBalances(accountId: string) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  return getTokenBalances(network, address);\n}\n\nexport async function getTokenBalances(network: ApiNetwork, address: string) {\n  const balancesRaw = await fetchJettonBalances(network, address);\n  return balancesRaw.map((balance) => parseTokenBalance(network, balance)).filter(Boolean);\n}\n\nfunction parseTokenBalance(network: ApiNetwork, balanceRaw: JettonBalance): TokenBalanceParsed | undefined {\n  if (!balanceRaw.jetton) {\n    return undefined;\n  }\n\n  try {\n    const { balance, jetton, wallet_address: walletAddress } = balanceRaw;\n    const tokenAddress = toBase64Address(jetton.address, true, network);\n    const token = buildTokenByMetadata(tokenAddress, jetton);\n\n    return {\n      slug: token.slug,\n      balance: BigInt(balance),\n      token,\n      jettonWallet: toBase64Address(walletAddress.address, undefined, network),\n    };\n  } catch (err) {\n    logDebugError('parseTokenBalance', err);\n    return undefined;\n  }\n}\n\nexport async function insertMintlessPayload(\n  network: ApiNetwork,\n  fromAddress: string,\n  tokenAddress: string,\n  transfer: TonTransferParams,\n): Promise<TonTransferParams> {\n  const { toAddress, payload } = transfer;\n\n  const token = getTokenByAddress(tokenAddress);\n  if (typeof payload !== 'string' || !token?.customPayloadApiUrl) {\n    return transfer;\n  }\n\n  const parsedPayload = await parsePayloadBase64(network, toAddress, payload);\n  if (parsedPayload.type !== 'tokens:transfer') {\n    throw new Error('Invalid payload');\n  }\n\n  const {\n    mintlessTokenBalance,\n    isMintlessClaimed,\n    stateInit,\n    customPayload,\n  } = await getMintlessParams({\n    network,\n    token,\n    fromAddress,\n    tokenWalletAddress: transfer.toAddress,\n  });\n\n  if (!mintlessTokenBalance || isMintlessClaimed) {\n    return transfer;\n  }\n\n  const newPayload = buildTokenTransferBody({\n    toAddress: parsedPayload.destination,\n    queryId: parsedPayload.queryId,\n    tokenAmount: parsedPayload.amount,\n    forwardAmount: parsedPayload.forwardAmount,\n    forwardPayload: Cell.fromBase64(parsedPayload.forwardPayload!),\n    responseAddress: parsedPayload.responseDestination,\n    customPayload: Cell.fromBase64(customPayload!),\n  });\n\n  return {\n    ...transfer,\n    stateInit: stateInit ? Cell.fromBase64(stateInit) : undefined,\n    payload: newPayload,\n    isBase64Payload: false,\n  };\n}\n\nexport async function buildTokenTransfer(options: {\n  network: ApiNetwork;\n  tokenAddress: string;\n  fromAddress: string;\n  toAddress: string;\n  amount: bigint;\n  payload?: AnyPayload;\n  shouldSkipMintless?: boolean;\n  forwardAmount?: bigint;\n}) {\n  const {\n    network,\n    tokenAddress,\n    fromAddress,\n    toAddress,\n    amount,\n    shouldSkipMintless,\n    forwardAmount = TOKEN_TRANSFER_FORWARD_AMOUNT,\n  } = options;\n  let { payload } = options;\n\n  const tokenWalletAddress = await resolveTokenWalletAddress(network, fromAddress, tokenAddress);\n  const token = getTokenByAddress(tokenAddress)!;\n\n  const {\n    isTokenWalletDeployed = !!(await isActiveSmartContract(network, tokenWalletAddress)),\n    isMintlessClaimed,\n    mintlessTokenBalance,\n    customPayload,\n    stateInit,\n  } = await getMintlessParams({\n    network, fromAddress, token, tokenWalletAddress, shouldSkipMintless,\n  });\n\n  if (isTokenWalletDeployed) {\n    const realTokenAddress = await resolveTokenAddress(network, tokenWalletAddress);\n    if (tokenAddress !== realTokenAddress) {\n      throw new Error('Invalid contract');\n    }\n  }\n\n  payload = buildTokenTransferBody({\n    tokenAmount: amount,\n    toAddress,\n    forwardAmount,\n    forwardPayload: payload,\n    responseAddress: fromAddress,\n    customPayload: customPayload ? Cell.fromBase64(customPayload) : undefined,\n  });\n\n  // eslint-disable-next-line prefer-const\n  let { amount: toncoinAmount, realAmount } = getToncoinAmountForTransfer(\n    token, Boolean(mintlessTokenBalance) && !isMintlessClaimed,\n  );\n\n  if (forwardAmount > TOKEN_TRANSFER_FORWARD_AMOUNT) {\n    toncoinAmount += forwardAmount;\n  }\n\n  return {\n    amount: toncoinAmount,\n    realAmount,\n    toAddress: tokenWalletAddress,\n    payload,\n    stateInit: stateInit ? Cell.fromBase64(stateInit) : undefined,\n    mintlessTokenBalance,\n    isTokenWalletDeployed,\n  };\n}\n\nexport async function getTokenBalanceWithMintless(network: ApiNetwork, accountAddress: string, tokenAddress: string) {\n  const tokenWalletAddress = await resolveTokenWalletAddress(network, accountAddress, tokenAddress);\n  const token = getTokenByAddress(tokenAddress)!;\n\n  const {\n    isTokenWalletDeployed = !!(await isActiveSmartContract(network, tokenWalletAddress)),\n    mintlessTokenBalance,\n  } = await getMintlessParams({\n    network, fromAddress: accountAddress, token, tokenWalletAddress,\n  });\n\n  return calculateTokenBalanceWithMintless(network, tokenWalletAddress, isTokenWalletDeployed, mintlessTokenBalance);\n}\n\nexport async function calculateTokenBalanceWithMintless(\n  network: ApiNetwork,\n  tokenWalletAddress: string,\n  isTokenWalletDeployed?: boolean,\n  mintlessTokenBalance = 0n,\n) {\n  let balance = 0n;\n  if (isTokenWalletDeployed) {\n    balance += await getTokenBalance(network, tokenWalletAddress);\n  }\n  if (mintlessTokenBalance) {\n    balance += mintlessTokenBalance;\n  }\n  return balance;\n}\n\nasync function getMintlessParams(options: {\n  network: ApiNetwork;\n  fromAddress: string;\n  token: ApiToken;\n  tokenWalletAddress: string;\n  shouldSkipMintless?: boolean;\n}) {\n  const {\n    network, fromAddress, token, tokenWalletAddress, shouldSkipMintless,\n  } = options;\n\n  const isMintlessToken = !!token.customPayloadApiUrl;\n  let isTokenWalletDeployed: boolean | undefined;\n  let customPayload: string | undefined;\n  let stateInit: string | undefined;\n\n  let isMintlessClaimed: boolean | undefined;\n  let mintlessTokenBalance: bigint | undefined;\n\n  if (isMintlessToken && !shouldSkipMintless) {\n    isTokenWalletDeployed = !!(await isActiveSmartContract(network, tokenWalletAddress));\n    isMintlessClaimed = isTokenWalletDeployed && await checkMintlessTokenWalletIsClaimed(network, tokenWalletAddress);\n\n    if (!isMintlessClaimed) {\n      const data = await fetchMintlessTokenWalletData(token.customPayloadApiUrl!, fromAddress);\n      const isExpired = data\n        ? Date.now() > new Date(Number(data.compressed_info.expired_at) * 1000).getTime()\n        : true;\n\n      if (data && !isExpired) {\n        customPayload = data.custom_payload;\n        mintlessTokenBalance = BigInt(data.compressed_info.amount);\n\n        if (!isTokenWalletDeployed) {\n          stateInit = data.state_init;\n        }\n      }\n    }\n  }\n\n  return {\n    isTokenWalletDeployed,\n    isMintlessClaimed,\n    mintlessTokenBalance,\n    customPayload,\n    stateInit,\n  };\n}\n\nexport async function checkMintlessTokenWalletIsClaimed(network: ApiNetwork, tokenWalletAddress: string) {\n  const res = await getTonClient(network)\n    .runMethod(Address.parse(tokenWalletAddress), 'is_claimed');\n  return res.stack.readBoolean();\n}\n\nasync function fetchMintlessTokenWalletData(customPayloadApiUrl: string, address: string) {\n  const rawAddress = toRawAddress(address);\n\n  return (await fetchJsonWithProxy(`${customPayloadApiUrl}/wallet/${rawAddress}`).catch(() => undefined)) as {\n    custom_payload: string;\n    state_init: string;\n    compressed_info: {\n      amount: string;\n      start_from: string;\n      expired_at: string;\n    };\n  } | undefined;\n}\n\nexport async function fetchToken(network: ApiNetwork, address: string) {\n  const metadata = await fetchJettonMetadata(network, address);\n\n  return buildTokenByMetadata(address, metadata);\n}\n\nfunction buildTokenByMetadata(address: string, metadata: JettonMetadata): ApiToken {\n  const {\n    name,\n    symbol,\n    image,\n    image_data: imageData,\n    decimals,\n    custom_payload_api_uri: customPayloadApiUrl,\n  } = metadata;\n\n  return {\n    slug: buildTokenSlug('ton', address),\n    name,\n    symbol,\n    decimals: decimals === undefined ? DEFAULT_DECIMALS : Number(decimals),\n    chain: 'ton',\n    tokenAddress: address,\n    image: (image && fixIpfsUrl(image)) || (imageData && fixBase64ImageData(imageData)) || undefined,\n    customPayloadApiUrl,\n  };\n}\n\n/**\n * A pure function guessing the \"fee\" that needs to be attached to the token transfer.\n * In contrast to the blockchain fee, this fee is a part of the transfer itself.\n *\n * `amount` is what should be attached (acts as a fee for the user);\n * `realAmount` is approximately what will be actually spent (the rest will return in the excess).\n */\nexport function getToncoinAmountForTransfer(token: ApiToken, willClaimMintless: boolean) {\n  let amount = 0n;\n  let realAmount = 0n;\n\n  if (token.slug === TON_USDT_SLUG) {\n    amount += TINY_TOKEN_TRANSFER_AMOUNT;\n    realAmount += TINIEST_TOKEN_TRANSFER_REAL_AMOUNT;\n  } else if (token.isTiny) {\n    amount += TINY_TOKEN_TRANSFER_AMOUNT;\n    realAmount += TINY_TOKEN_TRANSFER_REAL_AMOUNT;\n  } else {\n    amount += TOKEN_TRANSFER_AMOUNT;\n    realAmount += TOKEN_TRANSFER_REAL_AMOUNT;\n  }\n\n  if (willClaimMintless) {\n    amount += CLAIM_MINTLESS_AMOUNT;\n    realAmount += CLAIM_MINTLESS_AMOUNT;\n  }\n\n  return { amount, realAmount };\n}\n","import { beginCell, Cell, external, internal, loadStateInit, SendMode, storeMessage } from '@ton/core';\n\nimport type { DieselStatus } from '../../../global/types';\nimport type Deferred from '../../../util/Deferred';\nimport type { CheckTransactionDraftOptions } from '../../methods/types';\nimport type {\n  ApiAccountWithMnemonic,\n  ApiAnyDisplayError,\n  ApiEmulationResult,\n  ApiNetwork,\n  ApiSignedTransfer,\n  ApiToken,\n} from '../../types';\nimport type {\n  AnyPayload,\n  ApiCheckMultiTransactionDraftResult,\n  ApiCheckTransactionDraftResult,\n  ApiFetchEstimateDieselResult,\n  ApiSubmitMultiTransferResult,\n  ApiSubmitTransferOptions,\n  ApiSubmitTransferTonResult,\n  ApiSubmitTransferWithDieselResult,\n  ApiTonWalletVersion,\n  TonTransferParams,\n} from './types';\nimport type { TonWallet } from './util/tonCore';\nimport { ApiTransactionDraftError, ApiTransactionError } from '../../types';\n\nimport { DEFAULT_FEE, DIESEL_ADDRESS } from '../../../config';\nimport { parseAccountId } from '../../../util/account';\nimport { bigintMultiplyToNumber } from '../../../util/bigint';\nimport { fromDecimal, toDecimal } from '../../../util/decimals';\nimport { getDieselTokenAmount, isDieselAvailable } from '../../../util/fee/transferFee';\nimport { omit, pick } from '../../../util/iteratees';\nimport { logDebug, logDebugError } from '../../../util/logs';\nimport { safeExecAsync } from '../../../util/safeExec';\nimport { pause } from '../../../util/schedulers';\nimport { emulateTrace, parseEmulation } from './util/emulation';\nimport { decryptMessageComment, encryptMessageComment } from './util/encryption';\nimport { sendExternal } from './util/sendExternal';\nimport {\n  commentToBytes,\n  getOurFeePayload,\n  getTonClient,\n  getTonWalletContract,\n  getWalletPublicKey,\n  packBytesAsSnake,\n  packBytesAsSnakeForEncryptedData,\n  parseAddress,\n  parseBase64,\n} from './util/tonCore';\nimport { fetchStoredAccount, fetchStoredTonWallet } from '../../common/accounts';\nimport { callBackendGet } from '../../common/backend';\nimport { getPendingTransfer, waitAndCreatePendingTransfer } from '../../common/pendingTransfers';\nimport { getTokenByAddress } from '../../common/tokens';\nimport { base64ToBytes } from '../../common/utils';\nimport { MINUTE, SEC } from '../../constants';\nimport { ApiServerError, handleServerError } from '../../errors';\nimport { createBody } from './walletV5/walletV5';\nimport { ActionSendMsg, packActionsList } from './walletV5/walletV5Actions';\nimport { checkHasTransaction, fetchNewestActionId } from './activities';\nimport { resolveAddress } from './address';\nimport { fetchKeyPair, fetchPrivateKey } from './auth';\nimport { ATTEMPTS, FEE_FACTOR, TRANSFER_TIMEOUT_SEC } from './constants';\nimport {\n  buildTokenTransfer,\n  calculateTokenBalanceWithMintless,\n  getTokenBalanceWithMintless,\n  getToncoinAmountForTransfer,\n} from './tokens';\nimport { getContractInfo, getTonWallet, getWalletBalance, getWalletInfo } from './wallet';\n\nconst WAIT_TRANSFER_TIMEOUT = MINUTE;\nconst WAIT_PAUSE = SEC;\n\nconst MAX_BALANCE_WITH_CHECK_DIESEL = 100000000n; // 0.1 TON\nconst PENDING_DIESEL_TIMEOUT = 15 * 60 * 1000; // 15 min\n\nconst DIESEL_NOT_AVAILABLE: ApiFetchEstimateDieselResult = {\n  status: 'not-available',\n  nativeAmount: 0n,\n  remainingFee: 0n,\n  realFee: 0n,\n};\n\nexport async function checkTransactionDraft(\n  options: CheckTransactionDraftOptions,\n): Promise<ApiCheckTransactionDraftResult> {\n  const {\n    accountId,\n    amount = 0n,\n    tokenAddress,\n    shouldEncrypt,\n    isBase64Data,\n    stateInit: stateInitString,\n    forwardAmount,\n    allowGasless,\n  } = options;\n  let { toAddress, data } = options;\n\n  const { network } = parseAccountId(accountId);\n\n  let result: ApiCheckTransactionDraftResult = {};\n\n  try {\n    result = await checkToAddress(network, toAddress);\n    if ('error' in result) {\n      return result;\n    }\n\n    toAddress = result.resolvedAddress!;\n\n    const { isInitialized } = await getContractInfo(network, toAddress);\n\n    if (stateInitString && !isBase64Data) {\n      return {\n        ...result,\n        error: ApiTransactionDraftError.StateInitWithoutBin,\n      };\n    }\n\n    let stateInit;\n\n    if (stateInitString) {\n      try {\n        stateInit = Cell.fromBase64(stateInitString);\n      } catch {\n        return {\n          ...result,\n          error: ApiTransactionDraftError.InvalidStateInit,\n        };\n      }\n    }\n\n    if (result.isBounceable && !isInitialized && !stateInit) {\n      result.isToAddressNew = !(await checkHasTransaction(network, toAddress));\n      return {\n        ...result,\n        error: ApiTransactionDraftError.InactiveContract,\n      };\n    }\n\n    result.resolvedAddress = toAddress;\n\n    if (amount < 0n) {\n      return {\n        ...result,\n        error: ApiTransactionDraftError.InvalidAmount,\n      };\n    }\n\n    const wallet = await getTonWallet(accountId);\n\n    if (typeof data === 'string' && isBase64Data) {\n      data = base64ToBytes(data);\n    }\n\n    if (data && typeof data === 'string' && shouldEncrypt) {\n      const toPublicKey = await getWalletPublicKey(network, toAddress);\n      if (!toPublicKey) {\n        return {\n          ...result,\n          error: ApiTransactionDraftError.WalletNotInitialized,\n        };\n      }\n    }\n\n    const { address, isInitialized: isWalletInitialized } = await fetchStoredTonWallet(accountId);\n\n    if (data && typeof data === 'string' && !isBase64Data) {\n      data = commentToBytes(data);\n    }\n\n    const toncoinBalance = await getWalletBalance(network, wallet);\n    let balance: bigint;\n    let toncoinAmount: bigint;\n    let fee: bigint;\n    let realFee: bigint;\n\n    if (!tokenAddress) {\n      balance = toncoinBalance;\n      toncoinAmount = amount;\n      fee = 0n;\n      realFee = 0n;\n\n      if (data instanceof Uint8Array) {\n        data = shouldEncrypt ? packBytesAsSnakeForEncryptedData(data) : packBytesAsSnake(data);\n      }\n    } else {\n      const tokenTransfer = await buildTokenTransfer({\n        network,\n        tokenAddress,\n        fromAddress: address,\n        toAddress,\n        amount,\n        payload: data,\n        forwardAmount,\n      });\n      ({ amount: toncoinAmount, toAddress, payload: data } = tokenTransfer);\n      const { realAmount: realToncoinAmount, isTokenWalletDeployed, mintlessTokenBalance } = tokenTransfer;\n\n      // When the token is transferred, actually some TON is transferred, and the token sits inside the payload.\n      // From the user perspective, this TON amount is a fee.\n      fee = toncoinAmount;\n      realFee = realToncoinAmount;\n\n      const tokenWalletAddress = toAddress;\n      balance = await calculateTokenBalanceWithMintless(\n        network, tokenWalletAddress, isTokenWalletDeployed, mintlessTokenBalance,\n      );\n    }\n\n    const isFullTonTransfer = !tokenAddress && toncoinBalance === amount;\n    const { transaction } = await signTransaction({\n      network,\n      wallet,\n      toAddress,\n      amount: toncoinAmount,\n      payload: data,\n      stateInit,\n      isFullBalance: isFullTonTransfer,\n      shouldEncrypt,\n    });\n    const blockchainFee = await calculateFee(network, wallet, transaction, isWalletInitialized);\n    const safeBlockchainFee = bigintMultiplyToNumber(blockchainFee, FEE_FACTOR);\n    fee += safeBlockchainFee;\n    realFee += safeBlockchainFee;\n    result.fee = fee;\n    result.realFee = realFee;\n    result.diesel = DIESEL_NOT_AVAILABLE;\n\n    let isEnoughBalance: boolean;\n\n    if (!tokenAddress) {\n      isEnoughBalance = isFullTonTransfer\n        ? toncoinBalance > blockchainFee\n        : toncoinBalance >= fee + amount;\n    } else {\n      const canTransferGasfully = toncoinBalance >= fee;\n\n      if (allowGasless) {\n        result.diesel = await getDiesel({\n          accountId,\n          tokenAddress,\n          canTransferGasfully,\n          toncoinBalance,\n          tokenBalance: balance,\n        });\n      }\n\n      if (isDieselAvailable(result.diesel)) {\n        isEnoughBalance = amount + getDieselTokenAmount(result.diesel) <= balance;\n      } else {\n        isEnoughBalance = canTransferGasfully && amount <= balance;\n      }\n    }\n\n    return isEnoughBalance ? result : {\n      ...result,\n      error: ApiTransactionDraftError.InsufficientBalance,\n    };\n  } catch (err: any) {\n    return {\n      ...handleServerError(err),\n      ...result,\n    };\n  }\n}\n\nfunction estimateDiesel(\n  address: string,\n  tokenAddress: string,\n  toncoinAmount: string,\n  isW5?: boolean,\n  isStars?: boolean,\n) {\n  return callBackendGet<{\n    status: DieselStatus;\n    // The amount is defined only when the status is \"available\" or \"stars-fee\": https://github.com/mytonwallet-org/mytonwallet-backend/blob/44c1bf43fb776286152db8901b45fe8341752e35/src/endpoints/diesel.ts#L163\n    amount?: string;\n    pendingCreatedAt?: string;\n  }>('/diesel/estimate', {\n    address, tokenAddress, toncoinAmount, isW5, isStars,\n  });\n}\n\nexport async function checkToAddress(network: ApiNetwork, toAddress: string) {\n  const result: {\n    addressName?: string;\n    isScam?: boolean;\n    resolvedAddress?: string;\n    isToAddressNew?: boolean;\n    isBounceable?: boolean;\n    isMemoRequired?: boolean;\n  } = {};\n\n  const resolved = await resolveAddress(network, toAddress);\n  if (resolved) {\n    result.addressName = resolved.name;\n    result.resolvedAddress = resolved.address;\n    result.isMemoRequired = resolved.isMemoRequired;\n    result.isScam = resolved.isScam;\n    toAddress = resolved.address;\n  } else {\n    return {\n      ...result,\n      error: ApiTransactionDraftError.DomainNotResolved,\n    };\n  }\n\n  const {\n    isValid, isUserFriendly, isTestOnly, isBounceable,\n  } = parseAddress(toAddress);\n\n  result.isBounceable = isBounceable;\n\n  if (!isValid) {\n    return {\n      ...result,\n      error: ApiTransactionDraftError.InvalidToAddress,\n    };\n  }\n\n  const regex = /[+=/]/;\n  const isUrlSafe = !regex.test(toAddress);\n\n  if (!isUserFriendly || !isUrlSafe || (network === 'mainnet' && isTestOnly)) {\n    return {\n      ...result,\n      error: ApiTransactionDraftError.InvalidAddressFormat,\n    };\n  }\n\n  return result;\n}\n\nexport async function submitTransfer(options: ApiSubmitTransferOptions): Promise<ApiSubmitTransferTonResult> {\n  const {\n    accountId,\n    password,\n    amount,\n    tokenAddress,\n    shouldEncrypt,\n    isBase64Data,\n    forwardAmount,\n  } = options;\n  let { stateInit } = options;\n\n  let { toAddress, data } = options;\n\n  const { network } = parseAccountId(accountId);\n\n  try {\n    const account = await fetchStoredAccount<ApiAccountWithMnemonic>(accountId);\n    const { address: fromAddress, isInitialized } = account.ton;\n    const wallet = await getTonWallet(accountId, account.ton);\n    const { publicKey, secretKey } = (await fetchKeyPair(accountId, password, account))!;\n\n    let encryptedComment: string | undefined;\n\n    if (typeof data === 'string') {\n      ({ payload: data, encryptedComment } = await stringToPayload({\n        network, toAddress, fromAddress, data, secretKey, publicKey, shouldEncrypt, isBase64Data,\n      }));\n    }\n\n    let toncoinAmount: bigint;\n\n    if (!tokenAddress) {\n      toncoinAmount = amount;\n\n      if (data instanceof Uint8Array) {\n        data = shouldEncrypt ? packBytesAsSnakeForEncryptedData(data) : packBytesAsSnake(data);\n      }\n    } else {\n      ({\n        amount: toncoinAmount,\n        toAddress,\n        payload: data,\n        stateInit,\n      } = await buildTokenTransfer({\n        network,\n        tokenAddress,\n        fromAddress,\n        toAddress,\n        amount,\n        payload: data,\n        forwardAmount,\n      }));\n    }\n\n    const { pendingTransfer } = await waitAndCreatePendingTransfer(network, fromAddress);\n\n    const toncoinBalance = await getWalletBalance(network, wallet);\n    const isFullTonTransfer = !tokenAddress && toncoinBalance === amount;\n\n    const { seqno, transaction } = await signTransaction({\n      network,\n      wallet,\n      toAddress,\n      amount: toncoinAmount,\n      payload: data,\n      stateInit,\n      privateKey: secretKey,\n      isFullBalance: isFullTonTransfer,\n      shouldEncrypt,\n    });\n\n    const blockchainFee = await calculateFee(network, wallet!, transaction, isInitialized);\n\n    const isEnoughBalance = isFullTonTransfer\n      ? toncoinBalance > blockchainFee\n      : toncoinBalance >= toncoinAmount + blockchainFee;\n\n    if (!isEnoughBalance) {\n      return { error: ApiTransactionError.InsufficientBalance };\n    }\n\n    const client = getTonClient(network);\n    const { msgHash, boc } = await sendExternal(client, wallet!, transaction);\n\n    void retrySendBoc(network, fromAddress, boc, seqno, pendingTransfer);\n\n    return {\n      amount, seqno, encryptedComment, toAddress, msgHash,\n    };\n  } catch (err: any) {\n    logDebugError('submitTransfer', err);\n\n    return { error: resolveTransactionError(err) };\n  }\n}\n\nexport async function submitTransferWithDiesel(options: {\n  accountId: string;\n  password: string;\n  toAddress: string;\n  amount: bigint;\n  data?: AnyPayload;\n  tokenAddress: string;\n  shouldEncrypt?: boolean;\n  dieselAmount: bigint;\n  isGaslessWithStars?: boolean;\n}): Promise<ApiSubmitTransferWithDieselResult> {\n  try {\n    const {\n      toAddress,\n      amount,\n      accountId,\n      password,\n      tokenAddress,\n      shouldEncrypt,\n      dieselAmount,\n      isGaslessWithStars,\n    } = options;\n\n    let { data } = options;\n\n    const { network } = parseAccountId(accountId);\n\n    const [{ address: fromAddress, version }, keyPair] = await Promise.all([\n      fetchStoredTonWallet(accountId),\n      fetchKeyPair(accountId, password),\n    ]);\n\n    const { publicKey, secretKey } = keyPair!;\n\n    let encryptedComment: string | undefined;\n\n    if (typeof data === 'string') {\n      ({ payload: data, encryptedComment } = await stringToPayload({\n        network, toAddress, fromAddress, data, secretKey, publicKey, shouldEncrypt,\n      }));\n    }\n\n    const messages: TonTransferParams[] = [\n      await buildTokenTransfer({\n        network,\n        tokenAddress,\n        fromAddress,\n        toAddress,\n        amount,\n        payload: data,\n      }),\n    ];\n\n    if (!isGaslessWithStars) {\n      messages.push(\n        await buildTokenTransfer({\n          network,\n          tokenAddress,\n          fromAddress,\n          toAddress: DIESEL_ADDRESS,\n          amount: dieselAmount,\n          shouldSkipMintless: true,\n          payload: getOurFeePayload(),\n        }),\n      );\n    }\n\n    const result = await submitMultiTransfer({\n      accountId,\n      password,\n      messages,\n      isGasless: true,\n    });\n\n    return {\n      ...result,\n      encryptedComment,\n      withW5Gasless: version === 'W5',\n    };\n  } catch (err) {\n    logDebugError('submitTransferWithDiesel', err);\n\n    return { error: resolveTransactionError(err) };\n  }\n}\n\nasync function stringToPayload({\n  network, toAddress, data, shouldEncrypt, publicKey, secretKey, fromAddress, isBase64Data,\n}: {\n  network: ApiNetwork;\n  data: string;\n  shouldEncrypt?: boolean;\n  toAddress: string;\n  publicKey: Uint8Array;\n  secretKey: Uint8Array;\n  fromAddress: string;\n  isBase64Data?: boolean;\n}): Promise<{\n    payload?: Uint8Array | Cell;\n    encryptedComment?: string;\n  }> {\n  let payload: Uint8Array | Cell | undefined;\n  let encryptedComment: string | undefined;\n\n  if (!data) {\n    payload = undefined;\n  } else if (isBase64Data) {\n    payload = parseBase64(data);\n  } else if (shouldEncrypt) {\n    const toPublicKey = (await getWalletPublicKey(network, toAddress))!;\n    payload = await encryptMessageComment(data, publicKey, toPublicKey, secretKey, fromAddress);\n    encryptedComment = Buffer.from(payload.slice(4)).toString('base64');\n  } else {\n    payload = commentToBytes(data);\n  }\n\n  return { payload, encryptedComment };\n}\n\nexport function resolveTransactionError(error: any): ApiAnyDisplayError | string {\n  if (error instanceof ApiServerError) {\n    if (error.message.includes('exitcode=35,')) {\n      return ApiTransactionError.IncorrectDeviceTime;\n    } else if (error.statusCode === 400) {\n      return error.message;\n    } else if (error.displayError) {\n      return error.displayError;\n    }\n  }\n  return ApiTransactionError.UnsuccesfulTransfer;\n}\n\nasync function signTransaction({\n  network,\n  wallet,\n  toAddress,\n  amount,\n  payload,\n  stateInit,\n  privateKey,\n  isFullBalance,\n  expireAt,\n  shouldEncrypt,\n}: {\n  network: ApiNetwork;\n  wallet: TonWallet;\n  toAddress: string;\n  amount: bigint;\n  payload?: AnyPayload;\n  stateInit?: Cell;\n  privateKey?: Uint8Array;\n  isFullBalance?: boolean;\n  expireAt?: number;\n  shouldEncrypt?: boolean;\n}) {\n  const { seqno } = await getWalletInfo(network, wallet);\n\n  if (!privateKey) {\n    privateKey = new Uint8Array(64);\n  } else {\n    logDebug('Signing transactions', { seqno, toAddress, amount });\n  }\n\n  if (!expireAt) {\n    expireAt = Math.round(Date.now() / 1000) + TRANSFER_TIMEOUT_SEC;\n  }\n\n  if (payload instanceof Uint8Array) {\n    payload = shouldEncrypt\n      ? packBytesAsSnakeForEncryptedData(payload) as Cell\n      : packBytesAsSnake(payload, 0) as Cell;\n  }\n\n  const init = stateInit ? loadStateInit(\n    stateInit.asSlice(),\n  ) : undefined;\n\n  const sendMode = isFullBalance\n    ? SendMode.CARRY_ALL_REMAINING_BALANCE\n    : SendMode.PAY_GAS_SEPARATELY + (payload ? 0 : SendMode.IGNORE_ERRORS);\n\n  const transaction = wallet.createTransfer({\n    seqno,\n    secretKey: Buffer.from(privateKey),\n    messages: [internal({\n      value: amount,\n      to: toAddress,\n      body: payload,\n      init,\n      bounce: parseAddress(toAddress).isBounceable,\n    })],\n    sendMode,\n    timeout: expireAt,\n  });\n\n  return { seqno, transaction };\n}\n\nexport async function getAccountNewestActionId(accountId: string) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  return fetchNewestActionId(network, address);\n}\n\nexport async function checkMultiTransactionDraft(\n  accountId: string,\n  messages: TonTransferParams[],\n  withDiesel?: boolean,\n  // If true and the emulation is successful, the result `fee` property will miss\n  withEmulation?: boolean,\n): Promise<ApiCheckMultiTransactionDraftResult> {\n  const result: { fee?: bigint; emulation?: ApiEmulationResult } = {};\n  let totalAmount: bigint = 0n;\n\n  const { network } = parseAccountId(accountId);\n  const { isInitialized, version, address } = await fetchStoredTonWallet(accountId);\n\n  try {\n    for (const { toAddress, amount } of messages) {\n      if (amount < 0n) {\n        return { ...result, error: ApiTransactionDraftError.InvalidAmount };\n      }\n\n      const isMainnet = network === 'mainnet';\n      const { isValid, isTestOnly } = parseAddress(toAddress);\n\n      if (!isValid || (isMainnet && isTestOnly)) {\n        return { ...result, error: ApiTransactionDraftError.InvalidToAddress };\n      }\n      totalAmount += amount;\n    }\n\n    const wallet = await getTonWallet(accountId);\n    const { balance } = await getWalletInfo(network, wallet);\n\n    const { transaction } = await signMultiTransaction({\n      network, wallet, messages, version,\n    });\n\n    if (withEmulation) {\n      result.emulation = await safeExecAsync(async () => {\n        const emulation = await emulateTrace(network, wallet, transaction, isInitialized);\n        return emulation && parseEmulation(network, address, emulation);\n      });\n    }\n\n    if (!result.emulation) {\n      const blockchainFee = await calculateFee(network, wallet, transaction, isInitialized);\n      result.fee = bigintMultiplyToNumber(blockchainFee, FEE_FACTOR);\n    }\n\n    const fee = result.emulation?.totalFee ?? result.fee ?? 0n;\n    // TODO Should `totalAmount` be `0` for `withDiesel`?\n    if (!withDiesel && balance < totalAmount + fee) {\n      return { ...result, error: ApiTransactionDraftError.InsufficientBalance };\n    }\n\n    return result;\n  } catch (err: any) {\n    return handleServerError(err);\n  }\n}\n\nexport type GaslessType = 'diesel' | 'w5';\n\ninterface SubmitMultiTransferOptions {\n  accountId: string;\n  password: string;\n  messages: TonTransferParams[];\n  expireAt?: number;\n  isGasless?: boolean;\n}\n\nexport async function submitMultiTransfer({\n  accountId, password, messages, expireAt, isGasless,\n}: SubmitMultiTransferOptions): Promise<ApiSubmitMultiTransferResult> {\n  const { network } = parseAccountId(accountId);\n\n  const account = await fetchStoredAccount<ApiAccountWithMnemonic>(accountId);\n  const { address: fromAddress, isInitialized, version } = account.ton;\n  const { pendingTransfer } = await waitAndCreatePendingTransfer(network, fromAddress);\n\n  try {\n    const wallet = await getTonWallet(accountId, account.ton);\n    const privateKey = await fetchPrivateKey(accountId, password, account);\n\n    let totalAmount = 0n;\n    messages.forEach((message) => {\n      totalAmount += BigInt(message.amount);\n    });\n\n    const { balance } = await getWalletInfo(network, wallet!);\n\n    const gaslessType = isGasless ? version === 'W5' ? 'w5' : 'diesel' : undefined;\n    const withW5Gasless = gaslessType === 'w5';\n\n    const { seqno, transaction } = await signMultiTransaction({\n      network, wallet: wallet!, messages, version, privateKey, expireAt, withW5Gasless,\n    });\n\n    if (!isGasless) {\n      const fee = await calculateFee(network, wallet!, transaction, isInitialized);\n      if (balance < totalAmount + fee) {\n        return { error: ApiTransactionError.InsufficientBalance };\n      }\n    }\n\n    const client = getTonClient(network);\n    const { msgHash, boc, paymentLink } = await sendExternal(\n      client, wallet!, transaction, gaslessType,\n    );\n\n    if (!isGasless) {\n      void retrySendBoc(network, fromAddress, boc, seqno, pendingTransfer);\n    } else {\n      // TODO: Wait for gasless transfer\n      pendingTransfer.resolve();\n    }\n\n    const clearedMessages = messages.map((message) => {\n      if (typeof message.payload !== 'string' && typeof message.payload !== 'undefined') {\n        return omit(message, ['payload']);\n      }\n      return message;\n    });\n\n    return {\n      seqno,\n      amount: totalAmount.toString(),\n      messages: clearedMessages,\n      boc,\n      msgHash,\n      paymentLink,\n      withW5Gasless,\n    };\n  } catch (err) {\n    pendingTransfer.resolve();\n\n    logDebugError('submitMultiTransfer', err);\n    return { error: resolveTransactionError(err) };\n  }\n}\n\nasync function signMultiTransaction({\n  network,\n  wallet,\n  messages,\n  version,\n  privateKey,\n  expireAt,\n  withW5Gasless,\n}: {\n  network: ApiNetwork;\n  wallet: TonWallet;\n  messages: TonTransferParams[];\n  version: ApiTonWalletVersion;\n  privateKey?: Uint8Array;\n  expireAt?: number;\n  withW5Gasless?: boolean;\n}) {\n  const { seqno } = await getWalletInfo(network, wallet);\n\n  if (!privateKey) {\n    privateKey = new Uint8Array(64);\n  } else {\n    logDebug('Signing transaction', {\n      seqno,\n      messages: messages.map((msg) => pick(msg, ['toAddress', 'amount'])),\n    });\n  }\n\n  if (!expireAt) {\n    expireAt = Math.round(Date.now() / 1000) + TRANSFER_TIMEOUT_SEC;\n  }\n\n  let hasPayload = false;\n\n  const preparedMessages = messages.map((message) => {\n    const {\n      amount, toAddress, stateInit, isBase64Payload,\n    } = message;\n    let { payload } = message;\n\n    if (isBase64Payload && typeof payload === 'string') {\n      payload = Cell.fromBase64(payload);\n    }\n\n    const init = stateInit ? loadStateInit(\n      stateInit.asSlice(),\n    ) : undefined;\n\n    if (!hasPayload && payload) {\n      hasPayload = true;\n    }\n\n    return internal({\n      value: amount,\n      to: toAddress,\n      body: payload as Cell | string | undefined, // TODO Fix Uint8Array type\n      bounce: parseAddress(toAddress).isBounceable,\n      init,\n    });\n  });\n\n  if (version === 'W5' && !withW5Gasless) {\n    // TODO Remove it. There is bug in @ton/ton library that causes transactions to be executed in reverse order.\n    preparedMessages.reverse();\n  }\n\n  let transaction;\n  if (withW5Gasless) {\n    const actionList = packActionsList(preparedMessages.map(\n      (msg) => new ActionSendMsg(SendMode.PAY_GAS_SEPARATELY, msg),\n    ));\n\n    transaction = createBody(\n      actionList,\n      seqno,\n      Buffer.from(privateKey),\n      PENDING_DIESEL_TIMEOUT,\n    );\n  } else {\n    transaction = wallet.createTransfer({\n      seqno,\n      secretKey: Buffer.from(privateKey),\n      messages: preparedMessages,\n      sendMode: SendMode.PAY_GAS_SEPARATELY + (hasPayload ? 0 : SendMode.IGNORE_ERRORS),\n      timeout: expireAt,\n    });\n  }\n\n  const externalMessage = toExternalMessage(wallet, seqno, transaction);\n\n  return { seqno, transaction, externalMessage };\n}\n\nfunction toExternalMessage(\n  contract: TonWallet,\n  seqno: number,\n  body: Cell,\n) {\n  return beginCell()\n    .storeWritable(\n      storeMessage(\n        external({\n          to: contract.address,\n          init: seqno === 0 ? contract.init : undefined,\n          body,\n        }),\n      ),\n    )\n    .endCell();\n}\n\nasync function retrySendBoc(\n  network: ApiNetwork,\n  address: string,\n  boc: string,\n  seqno: number,\n  pendingTransfer?: Deferred,\n) {\n  const tonClient = getTonClient(network);\n  const waitUntil = Date.now() + WAIT_TRANSFER_TIMEOUT;\n\n  while (Date.now() < waitUntil) {\n    const [error, walletInfo] = await Promise.all([\n      tonClient.sendFile(boc).catch((err) => String(err)),\n      getWalletInfo(network, address).catch(() => undefined),\n    ]);\n\n    // Errors mean that `seqno` was changed or not enough of balance\n    if (error?.match(/(exitcode=33|exitcode=133|inbound external message rejected by account)/)) {\n      break;\n    }\n\n    // seqno here may change before exit code appears\n    if (walletInfo && walletInfo.seqno > seqno) {\n      break;\n    }\n\n    await pause(WAIT_PAUSE);\n  }\n\n  pendingTransfer?.resolve();\n}\n\nasync function calculateFee(network: ApiNetwork, wallet: TonWallet, transaction: Cell, isInitialized?: boolean) {\n  // eslint-disable-next-line no-null/no-null\n  const { code = null, data = null } = !isInitialized ? wallet.init : {};\n\n  const { source_fees: fees } = await getTonClient(network).estimateExternalMessageFee(wallet.address, {\n    body: transaction,\n    initCode: code,\n    initData: data,\n    ignoreSignature: true,\n  });\n\n  return BigInt(fees.in_fwd_fee + fees.storage_fee + fees.gas_fee + fees.fwd_fee);\n}\n\nexport async function sendSignedMessage(accountId: string, message: ApiSignedTransfer, pendingTransferId?: string) {\n  const { network } = parseAccountId(accountId);\n  const { address: fromAddress, publicKey, version } = await fetchStoredTonWallet(accountId);\n  const client = getTonClient(network);\n  const wallet = client.open(getTonWalletContract(publicKey, version!));\n  const { base64, seqno } = message;\n  const pendingTransfer = pendingTransferId ? getPendingTransfer(pendingTransferId) : undefined;\n\n  try {\n    const { msgHash, boc } = await sendExternal(client, wallet, Cell.fromBase64(base64));\n\n    void retrySendBoc(network, fromAddress, boc, seqno, pendingTransfer);\n\n    return { boc, msgHash };\n  } catch (err) {\n    pendingTransfer?.resolve();\n    throw err;\n  }\n}\n\nexport async function sendSignedMessages(accountId: string, messages: ApiSignedTransfer[]) {\n  const { network } = parseAccountId(accountId);\n  const { address: fromAddress, publicKey, version } = await fetchStoredTonWallet(accountId);\n  const client = getTonClient(network);\n  const wallet = client.open(getTonWalletContract(publicKey, version!));\n\n  const attempts = ATTEMPTS + messages.length;\n  let index = 0;\n  let attempt = 0;\n\n  let firstBoc: string | undefined;\n\n  const msgHashes: string[] = [];\n  let pendingTransfer: Deferred | undefined;\n\n  while (index < messages.length && attempt < attempts) {\n    const { base64, seqno } = messages[index];\n    try {\n      ({ pendingTransfer } = await waitAndCreatePendingTransfer(network, fromAddress));\n\n      const { msgHash, boc } = await sendExternal(client, wallet, Cell.fromBase64(base64));\n      msgHashes.push(msgHash);\n\n      if (index === 0) {\n        firstBoc = boc;\n      }\n\n      void retrySendBoc(network, fromAddress, boc, seqno, pendingTransfer);\n\n      index++;\n    } catch (err) {\n      pendingTransfer?.resolve();\n      logDebugError('sendSignedMessages', err);\n    }\n    attempt++;\n  }\n\n  return { successNumber: index, firstBoc, msgHashes };\n}\n\nexport async function decryptComment(\n  accountId: string, encryptedComment: string, fromAddress: string, password: string,\n) {\n  const keyPair = await fetchKeyPair(accountId, password);\n  if (!keyPair) {\n    return undefined;\n  }\n\n  const { secretKey, publicKey } = keyPair;\n\n  const buffer = Buffer.from(encryptedComment, 'base64');\n\n  return decryptMessageComment(buffer, publicKey, secretKey, fromAddress);\n}\n\n/**\n * The goal of the function is acting like `checkTransactionDraft` but return only the diesel information\n */\nexport function fetchEstimateDiesel(\n  accountId: string, tokenAddress: string,\n): Promise<ApiFetchEstimateDieselResult> {\n  return getDiesel({\n    accountId,\n    tokenAddress,\n    // We pass `false` because `fetchEstimateDiesel` assumes that the transfer is gasless anyway\n    canTransferGasfully: false,\n  });\n}\n\n/**\n * Decides whether the transfer must be gasless and fetches the diesel estimate from the backend.\n */\nasync function getDiesel({\n  accountId,\n  tokenAddress,\n  canTransferGasfully,\n  toncoinBalance,\n  tokenBalance,\n}: {\n  accountId: string;\n  tokenAddress: string;\n  canTransferGasfully: boolean;\n  // The below fields allow to avoid network requests if you already have these data\n  toncoinBalance?: bigint;\n  tokenBalance?: bigint;\n}): Promise<ApiFetchEstimateDieselResult> {\n  const { network } = parseAccountId(accountId);\n  if (network !== 'mainnet') return DIESEL_NOT_AVAILABLE;\n\n  const storedTonWallet = await fetchStoredTonWallet(accountId);\n  const wallet = await getTonWallet(accountId, storedTonWallet);\n\n  const token = getTokenByAddress(tokenAddress)!;\n  if (!token.isGaslessEnabled && !token.isStarsEnabled) return DIESEL_NOT_AVAILABLE;\n\n  const { address, version } = storedTonWallet;\n  toncoinBalance ??= await getWalletBalance(network, wallet);\n  const fee = getDieselToncoinFee(token);\n  const toncoinNeeded = fee.amount - toncoinBalance;\n\n  if (toncoinBalance >= MAX_BALANCE_WITH_CHECK_DIESEL || toncoinNeeded <= 0n) return DIESEL_NOT_AVAILABLE;\n\n  const rawDiesel = await estimateDiesel(\n    address,\n    tokenAddress,\n    toDecimal(toncoinNeeded),\n    version === 'W5',\n    fee.isStars,\n  );\n  const diesel: ApiFetchEstimateDieselResult = {\n    status: rawDiesel.status,\n    amount: rawDiesel.amount === undefined\n      ? undefined\n      : fromDecimal(rawDiesel.amount, rawDiesel.status === 'stars-fee' ? 0 : token.decimals),\n    nativeAmount: toncoinNeeded,\n    remainingFee: toncoinBalance,\n    realFee: fee.realFee,\n  };\n\n  const tokenAmount = getDieselTokenAmount(diesel);\n  if (tokenAmount === 0n) {\n    return diesel;\n  }\n\n  tokenBalance ??= await getTokenBalanceWithMintless(network, address, tokenAddress);\n  const canPayDiesel = tokenBalance >= tokenAmount;\n  const isAwaitingNotExpiredPrevious = Boolean(\n    rawDiesel.pendingCreatedAt\n      && Date.now() - new Date(rawDiesel.pendingCreatedAt).getTime() < PENDING_DIESEL_TIMEOUT,\n  );\n\n  // When both TON and diesel are insufficient, we want to show the TON fee\n  const shouldBeGasless = (!canTransferGasfully && canPayDiesel) || isAwaitingNotExpiredPrevious;\n  return shouldBeGasless ? diesel : DIESEL_NOT_AVAILABLE;\n}\n\n/**\n * Guesses the total TON fee (including the gas attached to the transaction) that will be spent on a diesel transfer.\n *\n * `amount` is what will be taken from the wallet;\n * `realFee` is approximately what will be actually spent (the rest will return in the excess);\n * `isStars` tells whether the fee is estimated considering that the diesel will be paid in stars.\n */\nfunction getDieselToncoinFee(token: ApiToken) {\n  const isStars = !token.isGaslessEnabled && token.isStarsEnabled;\n  let { amount, realAmount: realFee } = getToncoinAmountForTransfer(token, false);\n\n  // Multiplying by 2 because the diesel transfer has 2 transactions:\n  // - for the transfer itself,\n  // - for sending the diesel to the MTW wallet.\n  if (!isStars) {\n    amount *= 2n;\n    realFee *= 2n;\n  }\n\n  amount += DEFAULT_FEE;\n  realFee += DEFAULT_FEE;\n\n  return { amount, realFee, isStars };\n}\n","import type { Cell } from '@ton/core';\nimport { beginCell, external, storeMessage } from '@ton/core';\n\nimport type { ApiEmulatedTransaction, ApiEmulationResult, ApiNetwork } from '../../../types';\nimport type { EmulationResponse, EmulationTransaction, EmulationTransactionMessage } from '../toncenter/emulation';\nimport type { TraceDetail } from '../toncenter/types';\nimport type { ApiTransactionExtended } from '../types';\nimport type { TonWallet } from './tonCore';\n\nimport { TONCOIN } from '../../../../config';\nimport { buildTxId } from '../../../../util/activities';\nimport { bigintAbs, bigintMultiplyToNumber } from '../../../../util/bigint';\nimport { groupBy, omitUndefined } from '../../../../util/iteratees';\nimport { FEE_FACTOR } from '../constants';\nimport { fetchEmulateTrace } from '../toncenter/emulation';\nimport { toBase64Address, toRawAddress } from './tonCore';\n\nexport function parseEmulation(network: ApiNetwork, address: string, emulation: EmulationResponse): ApiEmulationResult {\n  const rawAddress = toRawAddress(address).toUpperCase();\n\n  const transactions = Object.entries(emulation.transactions)\n    .map(([hash, rawTx]) => parseTransaction(network, hash, rawTx))\n    .flat();\n\n  const byHash = groupBy(transactions, 'hash');\n  const byTransactionIndex: ApiEmulatedTransaction[] = [];\n\n  function processTrace(trace: TraceDetail, _index?: number) {\n    const txs = byHash[trace.tx_hash] || [];\n\n    for (const [i, { toAddress, amount, fee, isIncoming }] of txs.entries()) {\n      const index = _index ?? i;\n\n      if (!(index in byTransactionIndex)) {\n        byTransactionIndex.push({\n          received: 0n,\n          fee: bigintMultiplyToNumber(fee, FEE_FACTOR),\n        });\n      }\n\n      if (toAddress === rawAddress && isIncoming) {\n        byTransactionIndex[index].received += bigintAbs(amount);\n      }\n    }\n\n    for (const [i, children] of trace.children.entries()) {\n      processTrace(children, _index ?? i);\n    }\n  }\n\n  processTrace(emulation.trace);\n\n  return {\n    totalFee: byTransactionIndex.reduce((sum, { fee }) => sum + fee, 0n),\n    totalReceived: byTransactionIndex.reduce((sum, { received }) => sum + received, 0n),\n    byTransactionIndex,\n  };\n}\n\nexport function emulateTrace(network: ApiNetwork, wallet: TonWallet, body: Cell, isInitialized?: boolean) {\n  const boc = buildExternalBoc(wallet, body, isInitialized);\n  return fetchEmulateTrace(network, boc);\n}\n\nfunction parseTransaction(network: ApiNetwork, hash: string, rawTx: EmulationTransaction): ApiTransactionExtended[] {\n  const {\n    now,\n    total_fees: totalFees,\n    description: {\n      compute_ph: {\n        exit_code: exitCode,\n      },\n    },\n  } = rawTx;\n\n  const timestamp = now as number * 1000;\n  const isIncoming = !!rawTx.in_msg.source;\n  const inMsgHash = rawTx.in_msg.hash;\n  const msgs: EmulationTransactionMessage[] = isIncoming ? [rawTx.in_msg] : rawTx.out_msgs;\n\n  if (!msgs.length) return [];\n\n  const oneMsgFee = BigInt(totalFees) / BigInt(msgs.length);\n\n  const txs = msgs.map((msg, i) => {\n    const {\n      source,\n      destination,\n      value,\n      fwd_fee: fwdFee,\n      opcode,\n      hash: msgHash,\n    } = msg;\n    const normalizedAddress = toBase64Address(isIncoming ? source! : destination, true, network);\n    const fee = oneMsgFee + BigInt(fwdFee ?? 0);\n\n    const tx: ApiTransactionExtended = omitUndefined({\n      txId: msgs.length > 1 ? buildTxId(hash, i) : buildTxId(hash),\n      timestamp,\n      isIncoming,\n      fromAddress: source!,\n      toAddress: destination,\n      amount: BigInt(value ?? 0),\n      slug: TONCOIN.slug,\n      fee,\n      inMsgHash,\n      normalizedAddress,\n      shouldHide: exitCode ? true : undefined,\n      hash,\n      opCode: Number(opcode) || undefined,\n      msgHash,\n    });\n\n    return tx;\n  });\n\n  return txs;\n}\n\nfunction buildExternalBoc(wallet: TonWallet, body: Cell, isInitialized?: boolean) {\n  const externalMessage = external({\n    to: wallet.address,\n    init: !isInitialized ? {\n      code: wallet.init.code,\n      data: wallet.init.data,\n    } : undefined,\n    body,\n  });\n\n  return beginCell()\n    .store(storeMessage(externalMessage))\n    .endCell()\n    .toBoc()\n    .toString('base64');\n}\n","import type { ApiNetwork } from '../../../types';\nimport type { TraceDetail } from './types';\n\nimport { TONCENTER_MAINNET_URL, TONCENTER_TESTNET_URL } from '../../../../config';\nimport { fetchWithRetry } from '../../../../util/fetch';\n\nexport type EmulationTransaction = {\n  account: string;\n  lt: string;\n  prev_trans_hash: string;\n  prev_trans_lt: string;\n  now: number;\n  orig_status: string;\n  end_status: string;\n  in_msg: EmulationTransactionMessage;\n  out_msgs: EmulationTransactionMessage[];\n  total_fees: number;\n  account_state_hash_before: string;\n  account_state_hash_after: string;\n  description: {\n    credit_first: boolean;\n    storage_ph: {\n      storage_fees_collected: number;\n      storage_fees_due: number | null;\n      status_change: string;\n    };\n    credit_ph: {\n      due_fees_collected: number | null;\n      credit: number;\n    } | null;\n    compute_ph: {\n      account_activated?: boolean;\n      exit_arg?: null;\n      exit_code: number;\n      gas_credit?: number | null;\n      gas_fees: number;\n      gas_limit: number;\n      gas_used: number;\n      mode: number;\n      msg_state_used: boolean;\n      skipped: boolean;\n      success: boolean;\n      vm_final_state_hash: string;\n      vm_init_state_hash: string;\n      vm_steps: number;\n      reason?: string;\n    };\n    action: {\n      success: boolean;\n      valid: boolean;\n      no_funds: boolean;\n      status_change: string;\n      total_fwd_fees: number | null;\n      total_action_fees: number | null;\n      result_code: number;\n      result_arg: null;\n      tot_actions: number;\n      spec_actions: number;\n      skipped_actions: number;\n      msgs_created: number;\n      action_list_hash: string;\n      tot_msg_size: {\n        cells: number;\n        bits: number;\n      };\n    } | null;\n    aborted: boolean;\n    bounce: boolean | null;\n    destroyed: boolean;\n  };\n};\n\nexport type EmulationTransactionMessage = {\n  hash: string;\n  source: string | null;\n  destination: string;\n  value: number | null;\n  fwd_fee: number | null;\n  ihr_fee: number | null;\n  created_lt: string | null;\n  created_at: number | null;\n  opcode: string;\n  ihr_disabled: boolean | null;\n  bounce: boolean | null;\n  bounced: boolean | null;\n  import_fee: number | null;\n  body_boc: string;\n  init_state_boc: string | null;\n};\n\ntype AccountState = {\n  balance: number;\n  account_status: string;\n  frozen_hash: string | null;\n  code_hash: string;\n  data_hash: string;\n  last_trans_hash: string;\n  last_trans_lt: string;\n  timestamp: number;\n};\n\nexport type EmulationResponse = {\n  mc_block_seqno: number;\n  trace: TraceDetail;\n  transactions: Record<string, EmulationTransaction>;\n  account_states: Record<string, AccountState>;\n  rand_seed: string;\n};\n\nexport async function fetchEmulateTrace(network: ApiNetwork, boc: string): Promise<EmulationResponse> {\n  const baseUrl = network === 'testnet' ? TONCENTER_TESTNET_URL : TONCENTER_MAINNET_URL;\n\n  const response = await fetchWithRetry(`${baseUrl}/api/emulate/v1/emulateTrace`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      boc,\n      ignore_chksig: true,\n      include_code_data: false,\n      with_actions: false,\n    }),\n  });\n\n  return response.json();\n}\n","import type { NftItem } from 'tonapi-sdk-js';\nimport type { Cell } from '@ton/core';\nimport { Address, Builder } from '@ton/core';\n\nimport type { ApiNft, ApiNftUpdate } from '../../types';\nimport type { ApiCheckTransactionDraftResult } from './types';\n\nimport {\n  BURN_ADDRESS,\n  NFT_BATCH_SIZE,\n  NOTCOIN_EXCHANGERS,\n  NOTCOIN_FORWARD_TON_AMOUNT,\n  NOTCOIN_VOUCHERS_ADDRESS,\n} from '../../../config';\nimport { parseAccountId } from '../../../util/account';\nimport { bigintMultiplyToNumber } from '../../../util/bigint';\nimport { compact } from '../../../util/iteratees';\nimport { generateQueryId } from './util';\nimport { parseTonapiioNft } from './util/metadata';\nimport {\n  fetchAccountEvents, fetchAccountNfts, fetchNftByAddress, fetchNftItems,\n} from './util/tonapiio';\nimport { commentToBytes, packBytesAsSnake, toBase64Address } from './util/tonCore';\nimport { fetchStoredTonWallet } from '../../common/accounts';\nimport {\n  NFT_PAYLOAD_SAFE_MARGIN,\n  NFT_TRANSFER_AMOUNT,\n  NFT_TRANSFER_FORWARD_AMOUNT,\n  NFT_TRANSFER_REAL_AMOUNT,\n  NftOpCode,\n} from './constants';\nimport { checkMultiTransactionDraft, checkToAddress, submitMultiTransfer } from './transfer';\nimport { isActiveSmartContract } from './wallet';\n\nexport async function getAccountNfts(accountId: string, offset?: number, limit?: number): Promise<ApiNft[]> {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  const rawNfts = await fetchAccountNfts(network, address, { offset, limit });\n  return compact(rawNfts.map((rawNft) => parseTonapiioNft(network, rawNft)));\n}\n\nexport async function checkNftOwnership(accountId: string, nftAddress: string) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  const rawNft = await fetchNftByAddress(network, nftAddress);\n  const nft = parseTonapiioNft(network, rawNft);\n\n  return address === nft?.ownerAddress;\n}\n\nexport async function getNftUpdates(accountId: string, fromSec: number) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  const events = await fetchAccountEvents(network, address, fromSec);\n  fromSec = events[0]?.timestamp ?? fromSec;\n  events.reverse();\n  const updates: ApiNftUpdate[] = [];\n\n  for (const event of events) {\n    for (const action of event.actions) {\n      let to: string;\n      let nftAddress: string;\n      let rawNft: NftItem | undefined;\n      const isPurchase = !!action.NftPurchase;\n\n      if (action.NftItemTransfer) {\n        const { sender, recipient, nft: rawNftAddress } = action.NftItemTransfer;\n        if (!sender || !recipient) continue;\n        to = toBase64Address(recipient.address, undefined, network);\n        nftAddress = toBase64Address(rawNftAddress, true, network);\n      } else if (action.NftPurchase) {\n        const { buyer } = action.NftPurchase;\n        to = toBase64Address(buyer.address, undefined, network);\n        rawNft = action.NftPurchase.nft;\n        if (!rawNft) {\n          continue;\n        }\n        nftAddress = toBase64Address(rawNft.address, true, network);\n      } else {\n        continue;\n      }\n\n      if (to === address) {\n        if (!rawNft) {\n          [rawNft] = await fetchNftItems(network, [nftAddress]);\n        }\n\n        if (rawNft) {\n          const nft = parseTonapiioNft(network, rawNft);\n\n          if (nft) {\n            updates.push({\n              type: 'nftReceived',\n              accountId,\n              nftAddress,\n              nft,\n            });\n          }\n        }\n      } else if (!isPurchase && await isActiveSmartContract(network, to)) {\n        updates.push({\n          type: 'nftPutUpForSale',\n          accountId,\n          nftAddress,\n        });\n      } else {\n        updates.push({\n          type: 'nftSent',\n          accountId,\n          nftAddress,\n          newOwnerAddress: to,\n        });\n      }\n    }\n  }\n\n  return [fromSec, updates] as [number, ApiNftUpdate[]];\n}\n\nexport async function checkNftTransferDraft(options: {\n  accountId: string;\n  nfts: ApiNft[];\n  toAddress: string;\n  comment?: string;\n}): Promise<ApiCheckTransactionDraftResult> {\n  const { accountId, nfts, comment } = options;\n  let { toAddress } = options;\n\n  const { network } = parseAccountId(accountId);\n  const { address: fromAddress } = await fetchStoredTonWallet(accountId);\n\n  const result: ApiCheckTransactionDraftResult = await checkToAddress(network, toAddress);\n  if ('error' in result) {\n    return result;\n  }\n\n  toAddress = result.resolvedAddress!;\n\n  const messages = nfts\n    .slice(0, NFT_BATCH_SIZE) // We only need to check the first batch of a multi-transaction\n    .map((nft) => buildNftTransferMessage(nft, fromAddress, toAddress, comment));\n\n  const transactionResult = await checkMultiTransactionDraft(accountId, messages);\n\n  if (transactionResult.fee !== undefined) {\n    const batchFee = transactionResult.fee;\n    result.fee = calculateNftTransferFee(nfts.length, messages.length, batchFee, NFT_TRANSFER_AMOUNT);\n    result.realFee = calculateNftTransferFee(nfts.length, messages.length, batchFee, NFT_TRANSFER_REAL_AMOUNT);\n  }\n\n  if ('error' in transactionResult) {\n    result.error = transactionResult.error;\n  }\n\n  return result;\n}\n\nexport async function submitNftTransfers(options: {\n  accountId: string;\n  password: string;\n  nfts: ApiNft[];\n  toAddress: string;\n  comment?: string;\n}) {\n  const {\n    accountId, password, nfts, toAddress, comment,\n  } = options;\n  const { address: fromAddress } = await fetchStoredTonWallet(accountId);\n  const messages = nfts.map((nft) => buildNftTransferMessage(nft, fromAddress, toAddress, comment));\n  return submitMultiTransfer({ accountId, password, messages });\n}\n\nfunction buildNftTransferMessage(nft: ApiNft, fromAddress: string, toAddress: string, comment?: string) {\n  const isNotcoinBurn = nft.collectionAddress === NOTCOIN_VOUCHERS_ADDRESS\n    && (toAddress === BURN_ADDRESS || NOTCOIN_EXCHANGERS.includes(toAddress as any));\n  const payload = isNotcoinBurn\n    ? buildNotcoinVoucherExchange(fromAddress, nft.address, nft.index)\n    : buildNftTransferPayload(fromAddress, toAddress, comment);\n\n  return {\n    payload,\n    amount: NFT_TRANSFER_AMOUNT,\n    toAddress: nft.address,\n  };\n}\n\nfunction buildNotcoinVoucherExchange(fromAddress: string, nftAddress: string, nftIndex: number) {\n  // eslint-disable-next-line no-bitwise\n  const first4Bits = Address.parse(nftAddress).hash.readUint8() >> 4;\n  const toAddress = NOTCOIN_EXCHANGERS[first4Bits];\n\n  const payload = new Builder()\n    .storeUint(0x5fec6642, 32)\n    .storeUint(nftIndex, 64)\n    .endCell();\n\n  return buildNftTransferPayload(fromAddress, toAddress, payload, NOTCOIN_FORWARD_TON_AMOUNT);\n}\n\nfunction buildNftTransferPayload(\n  fromAddress: string,\n  toAddress: string,\n  payload?: string | Cell,\n  forwardAmount = NFT_TRANSFER_FORWARD_AMOUNT,\n) {\n  let builder = new Builder()\n    .storeUint(NftOpCode.TransferOwnership, 32)\n    .storeUint(generateQueryId(), 64)\n    .storeAddress(Address.parse(toAddress))\n    .storeAddress(Address.parse(fromAddress))\n    .storeBit(false) // null custom_payload\n    .storeCoins(forwardAmount);\n\n  let forwardPayload: Cell | Uint8Array | undefined;\n\n  if (payload) {\n    if (typeof payload === 'string') {\n      const bytes = commentToBytes(payload);\n      const freeBytes = Math.floor((builder.availableBits - NFT_PAYLOAD_SAFE_MARGIN) / 8);\n      forwardPayload = packBytesAsSnake(bytes, freeBytes);\n    } else {\n      forwardPayload = payload;\n    }\n  }\n\n  if (forwardPayload instanceof Uint8Array) {\n    builder.storeBit(0);\n    builder = builder.storeBuffer(Buffer.from(forwardPayload));\n  } else {\n    builder = builder.storeMaybeRef(forwardPayload);\n  }\n\n  return builder.endCell();\n}\n\nexport function calculateNftTransferFee(\n  totalNftCount: number,\n  // How many NFTs were added to the multi-transaction before estimating it\n  estimatedBatchSize: number,\n  // The blockchain fee of the estimated multi-transaction\n  estimatedBatchBlockchainFee: bigint,\n  // How much TON is attached to each NFT during the transfer\n  amountPerNft: bigint,\n) {\n  const fullBatchCount = Math.floor(totalNftCount / estimatedBatchSize);\n  let remainingBatchSize = totalNftCount % estimatedBatchSize;\n\n  // The blockchain fee for the first NFT in a batch is almost twice higher than the fee for the other NFTs. Therefore,\n  // simply using the average NFT fee to calculate the last incomplete batch fee gives an insufficient number. To fix\n  // that, we increase the last batch size.\n  //\n  // A real life example:\n  // 1 NFT  in the batch: 0.002939195 TON\n  // 2 NFTs in the batch: 0.004470516 TON\n  // 3 NFTs in the batch: 0.006001837 TON\n  // 4 NFTs in the batch: 0.007533158 TON\n  if (remainingBatchSize > 0 && remainingBatchSize < estimatedBatchSize) {\n    remainingBatchSize += 1;\n  }\n\n  const totalBlockchainFee = bigintMultiplyToNumber(\n    estimatedBatchBlockchainFee,\n    (fullBatchCount * estimatedBatchSize + remainingBatchSize) / estimatedBatchSize,\n  );\n  return totalBlockchainFee + BigInt(totalNftCount) * amountPerNft;\n}\n","import type {\n  Cell, Contract, ContractProvider,\n} from '@ton/core';\nimport {\n  Address, beginCell, contractAddress, TupleReader,\n} from '@ton/core';\n\nexport type NominatorPoolConfig = {};\n\nexport type Nominator = {\n  address: Address;\n  amount: bigint;\n  pendingDepositAmount: bigint;\n  withdrawRequested: boolean;\n};\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport function nominatorPoolConfigToCell(config: NominatorPoolConfig): Cell {\n  return beginCell().endCell();\n}\n\nexport class NominatorPool implements Contract {\n  constructor(readonly address: Address, readonly init?: { code: Cell; data: Cell }) {}\n\n  static createFromAddress(address: Address) {\n    return new NominatorPool(address);\n  }\n\n  static createFromConfig(config: NominatorPoolConfig, code: Cell, workchain = 0) {\n    const data = nominatorPoolConfigToCell(config);\n    const init = { code, data };\n    return new NominatorPool(contractAddress(workchain, init), init);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async getListNominators(provider: ContractProvider): Promise<Nominator[]> {\n    const res = await provider.get('list_nominators', []);\n    const tupleReader = (res.stack as TupleReader).readTuple();\n    const itemsArray = (tupleReader as any).items as bigint[][];\n\n    return itemsArray.map((items: bigint[]) => {\n      const tupleItems = items.map((value) => ({ type: 'int' as const, value }));\n      const tuple = new TupleReader(tupleItems);\n\n      const hash = tuple.readBigNumber().toString(16).padStart(64, '0');\n      const address = Address.parse(`0:${hash}`);\n      const amount = tuple.readBigNumber();\n      const pendingDepositAmount = tuple.readBigNumber();\n      const withdrawRequested = Boolean(tuple.readNumber());\n\n      return {\n        address,\n        amount,\n        pendingDepositAmount,\n        withdrawRequested,\n      };\n    });\n  }\n}\n","import { randomBytes } from '../../util/random';\nimport { storage } from '../storages';\n\nlet clientId: string | undefined;\n\nexport async function getClientId() {\n  clientId = await storage.getItem('clientId');\n\n  if (!clientId) {\n    clientId = Buffer.from(randomBytes(10)).toString('hex');\n\n    const referrer = await storage.getItem('referrer');\n    if (referrer) clientId = `${clientId}:${referrer}`;\n\n    await storage.setItem('clientId', clientId);\n  }\n  return clientId;\n}\n","import { Address } from '@ton/core';\n\nimport type {\n  ApiBackendStakingState,\n  ApiJettonStakingState,\n  ApiLoyaltyType,\n  ApiNetwork,\n  ApiStakingCommonData,\n  ApiStakingJettonPool,\n  ApiStakingState,\n} from '../../types';\nimport type { StakingPoolConfigUnpacked } from './contracts/JettonStaking/StakingPool';\nimport type { Nominator } from './contracts/NominatorPool';\nimport type {\n  ApiCheckTransactionDraftResult,\n  ApiSubmitTransferTonResult,\n  TonTransferParams,\n} from './types';\nimport {\n  ApiLiquidUnstakeMode,\n  ApiTransactionDraftError,\n} from '../../types';\n\nimport {\n  LIQUID_JETTON,\n  LIQUID_POOL,\n  TONCOIN,\n  VALIDATION_PERIOD_MS,\n} from '../../../config';\nimport { parseAccountId } from '../../../util/account';\nimport { bigintDivideToNumber, bigintMultiplyToNumber } from '../../../util/bigint';\nimport { fromDecimal } from '../../../util/decimals';\nimport calcJettonStakingApr from '../../../util/ton/calcJettonStakingApr';\nimport {\n  buildJettonClaimPayload,\n  buildJettonUnstakePayload,\n  buildLiquidStakingDepositBody,\n  buildLiquidStakingWithdrawBody,\n  getJettonPoolStakeWallet,\n  getTokenBalance,\n  getTonClient,\n  resolveTokenWalletAddress,\n  toBase64Address,\n  unpackDicts,\n} from './util/tonCore';\nimport { StakeWallet } from './contracts/JettonStaking/StakeWallet';\nimport { StakingPool } from './contracts/JettonStaking/StakingPool';\nimport { NominatorPool } from './contracts/NominatorPool';\nimport { fetchStoredTonWallet } from '../../common/accounts';\nimport { callBackendGet } from '../../common/backend';\nimport { getAccountCache, getStakingCommonCache, updateAccountCache } from '../../common/cache';\nimport { getClientId } from '../../common/other';\nimport { getTokenByAddress, getTokenBySlug } from '../../common/tokens';\nimport { isKnownStakingPool } from '../../common/utils';\nimport { nftRepository } from '../../db';\nimport { STAKE_COMMENT, TON_GAS, UNSTAKE_COMMENT } from './constants';\nimport { checkTransactionDraft, submitTransfer } from './transfer';\nimport { isAddressInitialized } from './wallet';\n\nexport async function checkStakeDraft(accountId: string, amount: bigint, state: ApiStakingState) {\n  let result: ApiCheckTransactionDraftResult;\n\n  switch (state.type) {\n    case 'nominators': {\n      if (amount < TON_GAS.stakeNominators) {\n        return { error: ApiTransactionDraftError.InvalidAmount };\n      }\n\n      result = await checkTransactionDraft({\n        accountId,\n        toAddress: state.pool,\n        amount: amount + TON_GAS.stakeNominators,\n        data: STAKE_COMMENT,\n      });\n      if ('fee' in result && result.fee) {\n        result.fee = TON_GAS.stakeNominators + result.fee;\n      }\n      break;\n    }\n    case 'liquid': {\n      result = await checkTransactionDraft({\n        accountId,\n        toAddress: LIQUID_POOL,\n        amount: amount + TON_GAS.stakeLiquid,\n        data: buildLiquidStakingDepositBody(),\n      });\n      if ('fee' in result && result.fee) {\n        result.fee = TON_GAS.stakeLiquid + result.fee;\n      }\n      break;\n    }\n    case 'jetton': {\n      const { tokenSlug, pool, period } = state;\n      const { tokenAddress } = getTokenBySlug(tokenSlug);\n\n      result = await checkTransactionDraft({\n        accountId,\n        toAddress: pool,\n        tokenAddress,\n        amount,\n        data: StakingPool.stakePayload(period),\n        forwardAmount: TON_GAS.stakeJettonsForward,\n      });\n      break;\n    }\n  }\n\n  return result;\n}\n\nexport async function checkUnstakeDraft(accountId: string, amount: bigint, state: ApiStakingState) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n  const commonData = getStakingCommonCache();\n\n  let result: ApiCheckTransactionDraftResult;\n  let tokenAmount: bigint | undefined;\n\n  switch (state.type) {\n    case 'nominators': {\n      result = await checkTransactionDraft({\n        accountId,\n        toAddress: state.pool,\n        amount: TON_GAS.unstakeNominators,\n        data: UNSTAKE_COMMENT,\n      });\n      break;\n    }\n    case 'liquid': {\n      if (amount > state.balance) {\n        return { error: ApiTransactionDraftError.InsufficientBalance };\n      } else if (amount === state.balance) {\n        tokenAmount = state.tokenBalance;\n      } else {\n        tokenAmount = bigintDivideToNumber(amount, commonData.liquid.currentRate);\n      }\n\n      const params = await buildLiquidStakingWithdraw(network, address, tokenAmount);\n\n      result = await checkTransactionDraft({\n        accountId,\n        toAddress: params.toAddress,\n        amount: params.amount,\n        data: params.payload,\n      });\n      break;\n    }\n    case 'jetton': {\n      tokenAmount = amount;\n\n      result = await checkTransactionDraft({\n        accountId,\n        toAddress: state.stakeWalletAddress,\n        amount: TON_GAS.unstakeJettons,\n        data: buildJettonUnstakePayload(amount, true),\n      });\n      break;\n    }\n  }\n\n  return {\n    ...result,\n    type: state.type,\n    tokenAmount,\n  };\n}\n\nexport async function submitStake(\n  accountId: string,\n  password: string,\n  amount: bigint,\n  state: ApiStakingState,\n) {\n  let result: ApiSubmitTransferTonResult;\n\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  switch (state.type) {\n    case 'nominators': {\n      result = await submitTransfer({\n        accountId,\n        password,\n        toAddress: toBase64Address(state.pool, true, network),\n        amount: amount + TON_GAS.stakeNominators,\n        data: STAKE_COMMENT,\n      });\n      break;\n    }\n    case 'liquid': {\n      result = await submitTransfer({\n        accountId,\n        password,\n        toAddress: LIQUID_POOL,\n        amount: amount + TON_GAS.stakeLiquid,\n        data: buildLiquidStakingDepositBody(),\n      });\n      break;\n    }\n    case 'jetton': {\n      const { tokenSlug, pool, period } = state;\n      const { tokenAddress } = getTokenBySlug(tokenSlug);\n\n      result = await submitTransfer({\n        accountId,\n        password,\n        toAddress: pool,\n        tokenAddress,\n        amount,\n        data: StakingPool.stakePayload(period),\n        forwardAmount: TON_GAS.stakeJettonsForward,\n      });\n      if (!('error' in result)) {\n        result.toAddress = pool;\n      }\n      break;\n    }\n  }\n\n  if (!('error' in result)) {\n    updateAccountCache(accountId, address, { stakedAt: Date.now() });\n  }\n\n  return result;\n}\n\nexport async function submitUnstake(\n  accountId: string,\n  password: string,\n  amount: bigint,\n  state: ApiStakingState,\n) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  let result: ApiSubmitTransferTonResult;\n\n  switch (state.type) {\n    case 'nominators': {\n      result = await submitTransfer({\n        accountId,\n        password,\n        toAddress: toBase64Address(state.pool, true, network),\n        amount: TON_GAS.unstakeNominators,\n        data: UNSTAKE_COMMENT,\n      });\n      break;\n    }\n    case 'liquid': {\n      const mode = !state.instantAvailable\n        ? ApiLiquidUnstakeMode.BestRate\n        : ApiLiquidUnstakeMode.Default;\n\n      const params = await buildLiquidStakingWithdraw(network, address, amount, mode);\n\n      result = await submitTransfer({\n        accountId,\n        password,\n        toAddress: params.toAddress,\n        amount: params.amount,\n        data: params.payload,\n      });\n      break;\n    }\n    case 'jetton': {\n      result = await submitTransfer({\n        accountId,\n        password,\n        toAddress: state.stakeWalletAddress,\n        amount: TON_GAS.unstakeJettons,\n        data: buildJettonUnstakePayload(amount, true),\n      });\n    }\n  }\n\n  return result;\n}\n\nexport async function buildLiquidStakingWithdraw(\n  network: ApiNetwork,\n  address: string,\n  amount: bigint,\n  mode: ApiLiquidUnstakeMode = ApiLiquidUnstakeMode.Default,\n): Promise<TonTransferParams> {\n  const tokenWalletAddress = await resolveTokenWalletAddress(network, address, LIQUID_JETTON);\n\n  const payload = buildLiquidStakingWithdrawBody({\n    amount,\n    responseAddress: address,\n    fillOrKill: mode === ApiLiquidUnstakeMode.Instant,\n    waitTillRoundEnd: mode === ApiLiquidUnstakeMode.BestRate,\n  });\n\n  return {\n    amount: TON_GAS.unstakeLiquid,\n    toAddress: tokenWalletAddress,\n    payload,\n  };\n}\n\ntype StakingStateOptions = {\n  accountId: string;\n  backendState: ApiBackendStakingState;\n  commonData: ApiStakingCommonData;\n  address: string;\n  loyaltyType?: ApiLoyaltyType;\n  network: ApiNetwork;\n};\n\nexport async function getStakingStates(\n  accountId: string,\n  commonData: ApiStakingCommonData,\n  backendState: ApiBackendStakingState,\n): Promise<ApiStakingState[]> {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  const {\n    loyaltyType,\n    shouldUseNominators,\n    type: backendType,\n  } = backendState;\n\n  const options: StakingStateOptions = {\n    accountId, backendState, commonData, address, loyaltyType, network,\n  };\n\n  const promises: Promise<ApiStakingState>[] = [buildLiquidState(options)];\n\n  for (const poolConfig of commonData.jettonPools) {\n    promises.push(buildJettonState(options, poolConfig));\n  }\n\n  if (shouldUseNominators || backendType === 'nominators') {\n    promises.push(buildNominatorsState(options));\n  }\n\n  return Promise.all(promises);\n}\n\nasync function buildLiquidState({\n  accountId,\n  address,\n  backendState,\n  commonData,\n  loyaltyType,\n}: StakingStateOptions): Promise<ApiStakingState> {\n  const { currentRate, collection } = commonData.liquid;\n  const tokenBalance = await getLiquidStakingTokenBalance(accountId);\n  let unstakeAmount = 0n;\n\n  if (collection) {\n    const nfts = await nftRepository.find({\n      accountId,\n      collectionAddress: collection,\n    });\n\n    for (const nft of nfts ?? []) {\n      const billAmount = nft.name?.match(/Bill for (?<amount>[\\d.]+) Pool Jetton/)?.groups?.amount;\n      if (billAmount) {\n        unstakeAmount += fromDecimal(billAmount);\n      }\n    }\n  }\n\n  const accountCache = getAccountCache(accountId, address);\n  const stakedAt = Math.max(accountCache.stakedAt ?? 0, backendState.stakedAt ?? 0);\n\n  const isInstantUnstake = Date.now() - stakedAt > VALIDATION_PERIOD_MS;\n  const liquidAvailable = isInstantUnstake ? commonData.liquid.available : 0n;\n\n  let liquidApy = commonData.liquid.apy;\n  if (loyaltyType && loyaltyType in commonData.liquid.loyaltyApy) {\n    liquidApy = commonData.liquid.loyaltyApy[loyaltyType];\n  }\n\n  const fullTokenAmount = tokenBalance + unstakeAmount;\n  const balance = bigintMultiplyToNumber(fullTokenAmount, currentRate);\n\n  return {\n    type: 'liquid',\n    id: 'liquid',\n    tokenSlug: TONCOIN.slug,\n    pool: LIQUID_POOL,\n    balance,\n    annualYield: liquidApy,\n    yieldType: 'APY',\n    tokenBalance,\n    isUnstakeRequested: unstakeAmount > 0n,\n    unstakeRequestAmount: unstakeAmount,\n    instantAvailable: liquidAvailable,\n  };\n}\n\nasync function buildNominatorsState({\n  network,\n  address,\n  backendState,\n  commonData,\n}: StakingStateOptions): Promise<ApiStakingState> {\n  const balance = backendState.balance;\n  const { address: pool, apy } = backendState.nominatorsPool;\n\n  const isPrevRoundUnlocked = Date.now() > commonData.prevRound.unlock;\n  const start = isPrevRoundUnlocked ? commonData.round.start : commonData.prevRound.start;\n  const end = isPrevRoundUnlocked ? commonData.round.unlock : commonData.prevRound.unlock;\n\n  let currentNominator: Nominator | undefined;\n\n  if (backendState.type === 'nominators') {\n    const nominatorPool = getTonClient(network).open(new NominatorPool(Address.parse(pool)));\n    const nominators = await nominatorPool.getListNominators();\n    const addressObject = Address.parse(address);\n    currentNominator = nominators.find((n) => n.address.equals(addressObject));\n  }\n\n  return {\n    type: 'nominators',\n    id: 'nominators',\n    tokenSlug: TONCOIN.slug,\n    balance: currentNominator ? balance : 0n,\n    annualYield: apy,\n    yieldType: 'APY',\n    pool,\n    start,\n    end,\n    pendingDepositAmount: currentNominator?.pendingDepositAmount ?? 0n,\n    isUnstakeRequested: currentNominator?.withdrawRequested ?? false,\n  };\n}\n\nasync function buildJettonState(\n  options: StakingStateOptions,\n  poolConfig: ApiStakingJettonPool,\n): Promise<ApiJettonStakingState> {\n  const { network } = options;\n\n  // common\n  const {\n    pool: poolAddress,\n    token: tokenAddress,\n  } = poolConfig;\n\n  const { decimals, slug: tokenSlug } = getTokenByAddress(tokenAddress)!;\n\n  const tonClient = getTonClient(network);\n  const pool = tonClient.open(StakingPool.createFromAddress(Address.parse(poolAddress)));\n\n  // pool\n  const poolData = await pool.getStorageData();\n  const { tvl, rewardJettons } = unpackDicts(poolData) as StakingPoolConfigUnpacked;\n  const { rewardsDeposits } = Object.values(rewardJettons!)[0];\n  const now = Math.floor(Date.now() / 1000);\n\n  let dailyReward: bigint = 0n;\n  for (const { startTime, endTime, distributionSpeed } of Object.values(rewardsDeposits)) {\n    if (startTime < now && endTime > now) {\n      dailyReward += distributionSpeed;\n    }\n  }\n\n  const apr = calcJettonStakingApr({ tvl, dailyReward, decimals });\n\n  // wallet\n  const { address } = options;\n  const periodConfig = poolConfig.periods[0];\n\n  const stakeWallet = await getJettonPoolStakeWallet(network, poolAddress, periodConfig.period, address);\n  const walletData = await stakeWallet.getStorageData().catch(() => undefined);\n\n  let unclaimedRewards = 0n;\n  let balance = 0n;\n  let poolWallets: string[] | undefined;\n\n  if (walletData) {\n    const poolWalletAddress = await resolveTokenWalletAddress(network, poolAddress, tokenAddress);\n    const rewards = walletData && StakeWallet.getAvailableRewards(walletData, poolData);\n    unclaimedRewards = (rewards && rewards[poolWalletAddress]) ?? 0n;\n    balance = walletData.jettonBalance;\n    poolWallets = Object.keys(rewards);\n  }\n\n  const state: ApiJettonStakingState = {\n    type: 'jetton',\n    id: poolAddress,\n    pool: poolAddress,\n    tokenAddress,\n    tokenSlug,\n    annualYield: apr,\n    yieldType: 'APR',\n    balance,\n    unclaimedRewards,\n    poolWallets,\n    stakeWalletAddress: toBase64Address(stakeWallet.address, true),\n    tokenAmount: 0n,\n    tvl,\n    dailyReward,\n    period: periodConfig.period,\n  };\n\n  return state;\n}\n\nasync function getLiquidStakingTokenBalance(accountId: string) {\n  const { network } = parseAccountId(accountId);\n  if (network !== 'mainnet') {\n    return 0n;\n  }\n\n  const { address } = await fetchStoredTonWallet(accountId);\n  const walletAddress = await resolveTokenWalletAddress(network, address, LIQUID_JETTON);\n  const isInitialized = await isAddressInitialized(network, walletAddress);\n\n  if (!isInitialized) {\n    return 0n;\n  }\n\n  return getTokenBalance(network, walletAddress);\n}\n\nexport async function getBackendStakingState(accountId: string): Promise<ApiBackendStakingState> {\n  const { address } = await fetchStoredTonWallet(accountId);\n  const state = await fetchBackendStakingState(address);\n  return {\n    ...state,\n    nominatorsPool: {\n      ...state.nominatorsPool,\n      start: state.nominatorsPool.start * 1000,\n      end: state.nominatorsPool.end * 1000,\n    },\n  };\n}\n\nexport async function fetchBackendStakingState(address: string): Promise<ApiBackendStakingState> {\n  const clientId = await getClientId();\n  const stakingState = await callBackendGet(`/staking/state/${address}`, undefined, {\n    'X-App-ClientID': clientId,\n  });\n\n  stakingState.balance = fromDecimal(stakingState.balance);\n  stakingState.totalProfit = fromDecimal(stakingState.totalProfit);\n\n  if (!isKnownStakingPool(stakingState.nominatorsPool.address)) {\n    throw Error('Unexpected pool address, likely a malicious activity');\n  }\n\n  return stakingState;\n}\n\nexport function submitStakingClaim(\n  accountId: string,\n  password: string,\n  state: ApiJettonStakingState,\n) {\n  return submitTransfer({\n    accountId,\n    password,\n    toAddress: state.stakeWalletAddress,\n    amount: TON_GAS.claimJettons,\n    data: buildJettonClaimPayload(state.poolWallets!),\n  });\n}\n","import { DAYS_IN_YEAR } from '../../api/constants';\nimport { toBig } from '../decimals';\n\nexport default function calcJettonStakingApr({\n  tvl, dailyReward, decimals,\n}: {\n  tvl: bigint;\n  dailyReward: bigint;\n  decimals: number;\n}) {\n  if (!tvl) {\n    return 0;\n  }\n\n  const apr = toBig(dailyReward, decimals)\n    .div(toBig(tvl, decimals))\n    .mul(DAYS_IN_YEAR)\n    .mul(100)\n    .toFixed(2);\n\n  return Number(apr);\n}\n","import { Builder, Cell } from '@ton/core';\n\nimport type { ApiNetwork } from '../../types';\n\nimport { getTonClient } from './util/tonCore';\n\nexport function packPayloadToBoc(payload: string | Uint8Array) {\n  let cell = new Cell();\n  if (payload) {\n    if (payload instanceof Cell) {\n      cell = payload;\n    } else if (typeof payload === 'string') {\n      if (payload.length > 0) {\n        cell = new Builder()\n          .storeUint(0, 32)\n          .storeStringTail(payload)\n          .asCell();\n      }\n    } else {\n      cell = new Builder()\n        .storeBuffer(Buffer.from(payload))\n        .asCell();\n    }\n  }\n  return cell.toBoc().toString('base64');\n}\n\nexport async function checkApiAvailability(network: ApiNetwork) {\n  try {\n    await getTonClient(network).getMasterchainInfo();\n    return true;\n  } catch (err: any) {\n    return false;\n  }\n}\n","import type {\n  ApiNftTransferPayload,\n  ApiParsedPayload,\n  ApiTokensTransferNonStandardPayload,\n  ApiTokensTransferPayload,\n} from '../../api/types';\n\nexport function isNftTransferPayload(payload: ApiParsedPayload | undefined): payload is ApiNftTransferPayload {\n  return payload?.type === 'nft:transfer';\n}\n\nexport function isTokenTransferPayload(\n  payload: ApiParsedPayload | undefined,\n): payload is ApiTokensTransferPayload | ApiTokensTransferNonStandardPayload {\n  return payload?.type === 'tokens:transfer' || payload?.type === 'tokens:transfer-non-standard';\n}\n","import type {\n  ApiNetwork,\n  ApiSwapBuildRequest,\n  ApiTokensTransferPayload,\n} from '../../types';\nimport type { TonTransferParams } from './types';\n\nimport { DIESEL_ADDRESS, SWAP_FEE_ADDRESS, TONCOIN } from '../../../config';\nimport { assert as originalAssert } from '../../../util/assert';\nimport { fromDecimal } from '../../../util/decimals';\nimport { isTokenTransferPayload } from '../../../util/ton/transfer';\nimport { parsePayloadBase64 } from './util/metadata';\nimport { resolveTokenWalletAddress, toBase64Address } from './util/tonCore';\nimport { getTokenByAddress } from '../../common/tokens';\nimport { getContractInfo } from './wallet';\n\nconst FEE_ADDRESSES = [SWAP_FEE_ADDRESS, DIESEL_ADDRESS];\nconst MAX_NETWORK_FEE = 1000000000n; // 1 TON\n\nexport async function validateDexSwapTransfers(\n  network: ApiNetwork,\n  address: string,\n  request: ApiSwapBuildRequest,\n  transfers: TonTransferParams[],\n) {\n  const assert = (condition: boolean, message: string) => {\n    originalAssert(condition, message, {\n      network, address, request, transfers,\n    });\n  };\n\n  assert(transfers.length <= 2, 'Too many transfers');\n\n  const [mainTransfer, feeTransfer] = transfers;\n\n  if (request.from === TONCOIN.symbol) {\n    const maxAmount = fromDecimal(request.fromAmount) + fromDecimal(request.ourFee) + MAX_NETWORK_FEE;\n    const { isSwapAllowed, codeHash } = await getContractInfo(network, mainTransfer.toAddress);\n\n    assert(!!isSwapAllowed, `Not allowed swap contract: ${codeHash}`);\n    assert(mainTransfer.amount <= maxAmount, 'Main transfer amount is too big');\n\n    if (feeTransfer) {\n      assert(feeTransfer.amount <= mainTransfer.amount, 'Fee transfer amount is too big');\n      assert(feeTransfer.amount + mainTransfer.amount < maxAmount, 'Total amount is too big');\n      assert(FEE_ADDRESSES.includes(toBase64Address(feeTransfer.toAddress, false)), 'Unexpected fee transfer address');\n    }\n  } else {\n    const token = getTokenByAddress(request.from)!;\n    assert(!!token, 'Unknown \"from\" token');\n\n    const maxAmount = fromDecimal(request.fromAmount, token.decimals)\n      + fromDecimal(request.ourFee ?? 0, token.decimals)\n      + fromDecimal(request.dieselFee ?? 0, token.decimals);\n    const maxTonAmount = MAX_NETWORK_FEE;\n\n    const walletAddress = await resolveTokenWalletAddress(network, address, token.tokenAddress!);\n    const parsedPayload = await parsePayloadBase64(network, mainTransfer.toAddress, mainTransfer.payload as string);\n\n    assert(mainTransfer.toAddress === walletAddress, 'Main transfer address is not the token wallet address');\n    assert(isTokenTransferPayload(parsedPayload), 'Main transfer payload is not a token transfer');\n\n    const { amount: tokenAmount, destination } = parsedPayload as ApiTokensTransferPayload;\n    assert(tokenAmount <= maxAmount, 'Main transfer token amount is too big');\n\n    assert(mainTransfer.amount < maxTonAmount, 'Main transfer TON amount is too big');\n\n    const { isSwapAllowed } = await getContractInfo(network, destination);\n\n    assert(!!isSwapAllowed, 'Main transfer destination is not a swap smart contract');\n\n    if (feeTransfer) {\n      const feePayload = await parsePayloadBase64(network, feeTransfer.toAddress, feeTransfer.payload as string);\n\n      assert(feeTransfer.amount + mainTransfer.amount < maxTonAmount, 'Total TON amount is too big');\n      assert(feeTransfer.toAddress === walletAddress, 'Fee transfer address is not the token wallet address');\n      assert(isTokenTransferPayload(feePayload), 'Fee transfer payload is not a token transfer');\n\n      const { amount: tokenFeeAmount, destination: feeDestination } = feePayload as ApiTokensTransferPayload;\n\n      assert(tokenAmount + tokenFeeAmount <= maxAmount, 'Total token amount is too big');\n      assert(FEE_ADDRESSES.includes(toBase64Address(feeDestination, false)), 'Unexpected fee transfer destination');\n    }\n  }\n}\n","import { pause } from './schedulers';\n\nimport Deferred from './Deferred';\n\nconst deferreds = new Set<Deferred>();\n\nlet isFocused = true;\n\nexport function pauseOrFocus(ms: number, msWhenNotFocused = ms) {\n  const deferred = new Deferred();\n\n  deferreds.add(deferred);\n\n  void deferred.promise.then(() => {\n    deferreds.delete(deferred);\n  });\n\n  void pause(isFocused ? ms : msWhenNotFocused).then(deferred.resolve);\n\n  return deferred.promise;\n}\n\nexport function setIsAppFocused(_isFocused: boolean) {\n  isFocused = _isFocused;\n\n  if (_isFocused) {\n    deferreds.forEach((d) => d.resolve());\n  }\n}\n","import type { ApiNft, ApiUpdate, OnApiUpdate } from '../types';\n\nimport { type ApiDbNft, nftRepository } from '../db';\n\nexport async function processNftUpdates(accountId: string, updates: ApiUpdate[], onUpdate: OnApiUpdate) {\n  updates.filter((update) => !(update.type === 'nftReceived' && update.nft.isHidden)).forEach(onUpdate);\n\n  for (const update of updates) {\n    if (update.type === 'nftSent') {\n      const key = [accountId, update.nftAddress];\n      await nftRepository.delete(key);\n    } else if (update.type === 'nftReceived') {\n      const dbNft = convertToDbEntity(accountId, update.nft);\n      await nftRepository.put(dbNft);\n    } else if (update.type === 'nftPutUpForSale') {\n      const key = [accountId, update.nftAddress];\n      await nftRepository.update(key, { isOnSale: true });\n    }\n  }\n}\n\nexport async function updateAccountNfts(accountId: string, nfts: ApiNft[], onUpdate: OnApiUpdate) {\n  onUpdate({\n    type: 'updateNfts',\n    accountId,\n    nfts,\n  });\n\n  const dbNfts = nfts.map((nft) => convertToDbEntity(accountId, nft));\n\n  await nftRepository.deleteWhere({ accountId });\n  await nftRepository.bulkPut(dbNfts);\n}\n\nfunction convertToDbEntity(accountId: string, nft: ApiNft): ApiDbNft {\n  return {\n    ...nft,\n    collectionAddress: nft.collectionAddress ?? '',\n    accountId,\n  };\n}\n","import type { ApiActivity, ApiSwapActivity, ApiSwapHistoryItem } from '../types';\n\nimport { SWAP_API_VERSION, TONCOIN } from '../../config';\nimport { parseAccountId } from '../../util/account';\nimport { buildBackendSwapId, parseTxId } from '../../util/activities';\nimport { compareActivities } from '../../util/compareActivities';\nimport { logDebugError } from '../../util/logs';\nimport { fetchStoredTonWallet } from './accounts';\nimport { callBackendGet, callBackendPost } from './backend';\nimport { buildTokenSlug, getTokenByAddress, getTokenBySlug } from './tokens';\n\nexport function swapGetHistory(address: string, params: {\n  fromTimestamp?: number;\n  toTimestamp?: number;\n  status?: ApiSwapHistoryItem['status'];\n  isCex?: boolean;\n  asset?: string;\n  hashes?: string[];\n}): Promise<ApiSwapHistoryItem[]> {\n  return callBackendPost(`/swap/history/${address}`, {\n    ...params,\n    swapVersion: SWAP_API_VERSION,\n  });\n}\n\nexport function swapGetHistoryItem(address: string, id: string): Promise<ApiSwapHistoryItem> {\n  return callBackendGet(`/swap/history/${address}/${id}`, {\n    swapVersion: SWAP_API_VERSION,\n  });\n}\n\nexport function swapItemToActivity(swap: ApiSwapHistoryItem): ApiSwapActivity {\n  return {\n    ...swap,\n    id: buildBackendSwapId(swap.id),\n    kind: 'swap',\n    from: getSwapItemSlug(swap, swap.from),\n    to: getSwapItemSlug(swap, swap.to),\n    shouldLoadDetails: !swap.cex,\n  };\n}\n\nexport function getSwapItemSlug(item: ApiSwapHistoryItem, asset: string) {\n  if (asset === TONCOIN.symbol) {\n    return TONCOIN.slug;\n  }\n  if (item.cex) {\n    return getTokenByAddress(asset)?.slug ?? asset;\n  }\n  return buildTokenSlug('ton', asset);\n}\n\nexport async function patchSwapItem(options: {\n  address: string;\n  swapId: string;\n  authToken: string;\n  msgHash?: string;\n  error?: string;\n}) {\n  const {\n    address, swapId, authToken, msgHash, error,\n  } = options;\n  await callBackendPost(`/swap/history/${address}/${swapId}/update`, {\n    swapVersion: SWAP_API_VERSION,\n    msgHash,\n    error,\n  }, {\n    method: 'PATCH',\n    authToken,\n  });\n}\n\nexport async function swapReplaceCexActivities(\n  accountId: string,\n  activities: ApiActivity[],\n  slug?: string,\n  isToNow?: boolean,\n): Promise<ApiActivity[]> {\n  if (!activities.length || parseAccountId(accountId).network === 'testnet') {\n    return activities;\n  }\n\n  try {\n    const { address } = await fetchStoredTonWallet(accountId);\n\n    const firstTimestamp = activities[0].timestamp;\n    const lastTimestamp = activities[activities.length - 1].timestamp;\n\n    const [fromTime, toTime] = firstTimestamp < lastTimestamp\n      ? [firstTimestamp, isToNow ? Date.now() : lastTimestamp]\n      : [lastTimestamp, isToNow ? Date.now() : firstTimestamp];\n\n    const hashes = activities.map(({ id }) => parseTxId(id).hash);\n\n    const swaps = await swapGetHistory(address, {\n      fromTimestamp: fromTime,\n      toTimestamp: toTime,\n      asset: slug ? getTokenBySlug(slug).tokenAddress ?? TONCOIN.symbol : undefined,\n      hashes,\n      isCex: true,\n    });\n\n    if (!swaps.length) {\n      return activities;\n    }\n\n    const result: ApiActivity[] = [];\n    const allSwapHashes: Set<string> = new Set();\n\n    for (const swap of swaps) {\n      swap.hashes.forEach((hash) => allSwapHashes.add(hash));\n\n      const isSwapHere = swap.timestamp > fromTime && swap.timestamp < toTime;\n      if (isSwapHere) {\n        result.push(swapItemToActivity(swap));\n      }\n    }\n\n    for (const activity of activities) {\n      if (activity.kind === 'transaction' && allSwapHashes.has(parseTxId(activity.id).hash)) {\n        result.push({ ...activity, shouldHide: true });\n      } else {\n        result.push(activity);\n      }\n    }\n\n    result.sort(compareActivities);\n\n    return result;\n  } catch (err) {\n    logDebugError('swapReplaceCexActivities', err);\n    return activities;\n  }\n}\n","import type { ApiTransactionActivity } from '../types';\n\nimport { createCallbackManager } from '../../util/callbacks';\n\nexport const txCallbacks = createCallbackManager();\n\nexport function whenTxComplete(normalizedAddress: string, amount: bigint) {\n  return new Promise<{ result: boolean; transaction: ApiTransactionActivity }>((resolve) => {\n    txCallbacks.addCallback(\n      function callback(transaction: ApiTransactionActivity) {\n        if (transaction.normalizedAddress === normalizedAddress && transaction.amount === -amount) {\n          txCallbacks.removeCallback(callback);\n          resolve({ result: true, transaction });\n        }\n      },\n    );\n  });\n}\n","export function createCallbackManager<T extends AnyToVoidFunction = AnyToVoidFunction>() {\n  const callbacks = new Set<T>();\n\n  function addCallback(cb: T) {\n    callbacks.add(cb);\n\n    return () => {\n      removeCallback(cb);\n    };\n  }\n\n  function removeCallback(cb: T) {\n    callbacks.delete(cb);\n  }\n\n  function runCallbacks(...args: Parameters<T>) {\n    callbacks.forEach((callback) => {\n      callback(...args);\n    });\n  }\n\n  function hasCallbacks() {\n    return Boolean(callbacks.size);\n  }\n\n  return {\n    runCallbacks,\n    addCallback,\n    removeCallback,\n    hasCallbacks,\n  };\n}\n\nexport type CallbackManager<T extends AnyToVoidFunction = AnyToVoidFunction>\n  = ReturnType<typeof createCallbackManager<T>>;\n\nexport class EventEmitter {\n  private channels = new Map<string, CallbackManager>();\n\n  on(name: string, handler: AnyToVoidFunction) {\n    this.resolveChannel(name).addCallback(handler);\n    return this;\n  }\n\n  removeListener(name: string, handler: AnyToVoidFunction) {\n    this.resolveChannel(name).removeCallback(handler);\n    return this;\n  }\n\n  emit(name: string, ...args: any) {\n    this.resolveChannel(name).runCallbacks(...args);\n    return this;\n  }\n\n  private resolveChannel(name: string) {\n    let channel = this.channels.get(name);\n    if (!channel) {\n      channel = createCallbackManager();\n      this.channels.set(name, channel);\n    }\n\n    return channel;\n  }\n}\n","import type { ApiNetwork, ApiToken, OnApiUpdate } from '../../types';\n\nimport { buildCollectionByKey } from '../../../util/iteratees';\nimport { logDebugError } from '../../../util/logs';\nimport { addTokens } from '../../common/tokens';\nimport { getAccountStates } from './toncenter';\n\nexport async function updateTokenHashes(network: ApiNetwork, tokens: ApiToken[], onUpdate?: OnApiUpdate) {\n  const tokensToFetch = tokens.filter((token) => (\n    token.chain === 'ton'\n    && !token.codeHash\n    && ['LP', 'STAKED', 'POOL'].some((option) => token.symbol.toUpperCase().includes(option))\n  ));\n\n  if (!tokensToFetch.length) {\n    return;\n  }\n\n  const tokensByAddress = buildCollectionByKey(tokensToFetch, 'tokenAddress');\n\n  try {\n    const states = await getAccountStates(network, tokensToFetch.map((token) => token.tokenAddress!));\n\n    for (const address of Object.keys(states)) {\n      if (!tokensByAddress[address]) continue;\n      tokensByAddress[address].codeHash = Buffer.from(states[address].code_hash, 'base64').toString('hex');\n    }\n\n    await addTokens(Object.values(tokensByAddress).filter((token) => token.codeHash), onUpdate, true);\n  } catch (err) {\n    logDebugError('Failed to fetch contract code hashes for tokens', err);\n  }\n}\n","import type { ApiVestingInfo } from '../../types';\n\nimport { parseAccountId } from '../../../util/account';\nimport { fetchStoredTonWallet } from '../../common/accounts';\nimport { callBackendGet } from '../../common/backend';\n\nexport async function fetchVestings(accountId: string) {\n  const { network } = parseAccountId(accountId);\n  const isTestnet = network === 'testnet';\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  return callBackendGet<ApiVestingInfo[]>(`/vesting/${address}`, { isTestnet });\n}\n","import type {\n  ApiActivity,\n  ApiBalanceBySlug,\n  ApiNetwork,\n  ApiNftUpdate,\n  ApiStakingState,\n  ApiVestingInfo,\n  ApiWalletInfo,\n  OnApiUpdate,\n} from '../../types';\nimport type { TokenBalanceParsed } from './tokens';\n\nimport {\n  IS_CORE_WALLET,\n  LEDGER_WALLET_VERSIONS,\n  POPULAR_WALLET_VERSIONS,\n  SWAP_CROSSCHAIN_SLUGS,\n  TONCOIN,\n} from '../../../config';\nimport { parseAccountId } from '../../../util/account';\nimport { getActivityTokenSlugs } from '../../../util/activities';\nimport { areDeepEqual } from '../../../util/areDeepEqual';\nimport { logDebugError } from '../../../util/logs';\nimport { pauseOrFocus } from '../../../util/pauseOrFocus';\nimport {\n  fetchStoredAccount,\n  fetchStoredAccounts,\n  fetchStoredTonWallet,\n  getActiveAccountId,\n  updateStoredTonWallet,\n} from '../../common/accounts';\nimport { getStakingCommonCache } from '../../common/cache';\nimport { isAlive, isUpdaterAlive } from '../../common/helpers';\nimport { processNftUpdates, updateAccountNfts } from '../../common/nft';\nimport { swapReplaceCexActivities } from '../../common/swap';\nimport { addTokens } from '../../common/tokens';\nimport { txCallbacks } from '../../common/txCallbacks';\nimport { hexToBytes } from '../../common/utils';\nimport { FIRST_TRANSACTIONS_LIMIT, SEC } from '../../constants';\nimport { AbortOperationError } from '../../errors';\nimport { fetchActivitySlice } from './activities';\nimport { getAccountNfts, getNftUpdates } from './nfts';\nimport { updateTokenHashes } from './priceless';\nimport { getBackendStakingState, getStakingStates } from './staking';\nimport { getAccountTokenBalances } from './tokens';\nimport { fetchVestings } from './vesting';\nimport { getWalletInfo, getWalletVersionInfos, isAddressInitialized } from './wallet';\n\nconst BALANCE_BASED_INTERVAL = 1.1 * SEC;\nconst BALANCE_BASED_INTERVAL_WHEN_NOT_FOCUSED = 10 * SEC;\nconst DOUBLE_CHECK_TOKENS_PAUSE = 30 * SEC;\nconst DOUBLE_CHECK_ACTIVITIES_PAUSE = 10 * SEC; // TODO (actions) Can it be reduced?\nconst NFT_FULL_INTERVAL = 60 * SEC;\n\nconst STAKING_INTERVAL = 5 * SEC;\nconst STAKING_INTERVAL_WHEN_NOT_FOCUSED = 10 * SEC;\n\nconst VERSIONS_INTERVAL = 5 * 60 * SEC;\nconst VERSIONS_INTERVAL_WHEN_NOT_FOCUSED = 15 * 60 * SEC;\nconst VESTING_INTERVAL = 10 * SEC;\nconst VESTING_INTERVAL_WHEN_NOT_FOCUSED = 60 * SEC;\n\nconst BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL = 30 * SEC;\nconst BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL_WHEN_NOT_FOCUSED = 60 * SEC;\n\nconst lastBalanceCache: Record<string, ApiBalanceBySlug> = {};\n\nexport function setupPolling(accountId: string, onUpdate: OnApiUpdate, newestActivityTimestamp?: number) {\n  void setupBalanceBasedPolling(accountId, onUpdate, newestActivityTimestamp);\n  void setupWalletVersionsPolling(accountId, onUpdate);\n\n  if (!IS_CORE_WALLET) {\n    void setupStakingPolling(accountId, onUpdate);\n    void setupVestingPolling(accountId, onUpdate);\n  }\n}\n\nasync function setupBalanceBasedPolling(accountId: string, onUpdate: OnApiUpdate, newestActivityTimestamp?: number) {\n  delete lastBalanceCache[accountId];\n\n  const { network } = parseAccountId(accountId);\n  // eslint-disable-next-line prefer-const\n  let { address, isInitialized } = await fetchStoredTonWallet(accountId);\n\n  let nftFromSec = Math.round(Date.now() / 1000);\n  let nftUpdates: ApiNftUpdate[];\n  let lastNftFullUpdate = 0;\n  let doubleCheckTokensTime: number | undefined;\n  let doubleCheckActivitiesTime: number | undefined;\n\n  async function updateBalance(cache: ApiBalanceBySlug, newBalances: ApiBalanceBySlug, changedSlugs: string[]) {\n    const { balance, lastTxId } = await getWalletInfo(network, address);\n    const isToncoinBalanceChanged = balance !== undefined && balance !== cache[TONCOIN.slug];\n\n    newBalances[TONCOIN.slug] = balance;\n    if (isToncoinBalanceChanged) {\n      changedSlugs.push(TONCOIN.slug);\n    }\n\n    return { lastTxId, isToncoinBalanceChanged };\n  }\n\n  async function updateNfts(isToncoinBalanceChanged: boolean) {\n    if (Date.now() - lastNftFullUpdate < NFT_FULL_INTERVAL) {\n      // Partial update\n      if (isToncoinBalanceChanged) {\n        const nftResult = await getNftUpdates(accountId, nftFromSec).catch(logAndRescue);\n\n        throwErrorIfUpdaterNotAlive(onUpdate, accountId);\n\n        if (nftResult) {\n          [nftFromSec, nftUpdates] = nftResult;\n          void processNftUpdates(accountId, nftUpdates, onUpdate);\n        }\n      }\n    } else {\n      // Full update\n      const nfts = await getAccountNfts(accountId).catch(logAndRescue);\n      lastNftFullUpdate = Date.now();\n\n      throwErrorIfUpdaterNotAlive(onUpdate, accountId);\n\n      if (nfts) {\n        nftFromSec = Math.round(Date.now() / 1000);\n        void updateAccountNfts(accountId, nfts, onUpdate);\n      }\n    }\n  }\n\n  async function updateTokenBalances(\n    isToncoinBalanceChanged: boolean,\n    cache: ApiBalanceBySlug,\n    newBalances: ApiBalanceBySlug,\n    changedSlugs: string[],\n  ) {\n    let tokenBalances: TokenBalanceParsed[] = [];\n\n    if (isToncoinBalanceChanged || (doubleCheckTokensTime && doubleCheckTokensTime < Date.now())) {\n      doubleCheckTokensTime = isToncoinBalanceChanged ? Date.now() + DOUBLE_CHECK_TOKENS_PAUSE : undefined;\n      tokenBalances = await getAccountTokenBalances(accountId);\n\n      throwErrorIfUpdaterNotAlive(onUpdate, accountId);\n\n      const tokens = tokenBalances.filter(Boolean).map(({ token }) => token);\n      await addTokens(tokens, onUpdate);\n      await updateTokenHashes(network, tokens, onUpdate);\n\n      tokenBalances.forEach(({ slug, balance: tokenBalance }) => {\n        newBalances[slug] = tokenBalance;\n        if (cache[slug] !== tokenBalance) {\n          changedSlugs.push(slug);\n        }\n      });\n    }\n\n    return tokenBalances;\n  }\n\n  async function updateActivities(isToncoinBalanceChanged: boolean, balances: ApiBalanceBySlug) {\n    if (!isToncoinBalanceChanged && (!doubleCheckActivitiesTime || doubleCheckActivitiesTime > Date.now())) {\n      return;\n    }\n\n    doubleCheckActivitiesTime = isToncoinBalanceChanged ? Date.now() + DOUBLE_CHECK_ACTIVITIES_PAUSE : undefined;\n    if (newestActivityTimestamp) {\n      newestActivityTimestamp = await loadNewActivities(accountId, newestActivityTimestamp, onUpdate);\n    } else {\n      newestActivityTimestamp = await loadInitialActivities(accountId, Object.keys(balances), onUpdate);\n    }\n  }\n\n  while (isAlive(onUpdate, accountId)) {\n    try {\n      onUpdate({ type: 'updatingStatus', kind: 'activities', isUpdating: true });\n      onUpdate({ type: 'updatingStatus', kind: 'balance', isUpdating: true });\n\n      const newBalances: ApiBalanceBySlug = {};\n      const changedSlugs: string[] = [];\n      const cache = lastBalanceCache[accountId] ?? {};\n\n      const { isToncoinBalanceChanged } = await updateBalance(cache, newBalances, changedSlugs);\n\n      throwErrorIfUpdaterNotAlive(onUpdate, accountId);\n\n      await updateTokenBalances(isToncoinBalanceChanged, cache, newBalances, changedSlugs);\n\n      lastBalanceCache[accountId] = newBalances;\n\n      if (changedSlugs.length) {\n        onUpdate({\n          type: 'updateBalances',\n          accountId,\n          chain: 'ton',\n          balances: newBalances,\n        });\n      }\n\n      onUpdate({ type: 'updatingStatus', kind: 'balance', isUpdating: false });\n\n      await Promise.all([\n        updateActivities(isToncoinBalanceChanged, newBalances),\n        updateNfts(isToncoinBalanceChanged),\n      ]);\n\n      onUpdate({ type: 'updatingStatus', kind: 'activities', isUpdating: false });\n\n      if (isToncoinBalanceChanged && !isInitialized && await isAddressInitialized(network, address)) {\n        isInitialized = true;\n        await updateStoredTonWallet(accountId, { isInitialized });\n      }\n    } catch (err) {\n      if (err instanceof AbortOperationError) {\n        return;\n      }\n      logDebugError('setupBalanceBasedPolling', err);\n    }\n\n    await pauseOrFocus(BALANCE_BASED_INTERVAL, BALANCE_BASED_INTERVAL_WHEN_NOT_FOCUSED);\n  }\n}\n\nfunction throwErrorIfUpdaterNotAlive(onUpdate: OnApiUpdate, accountId: string) {\n  if (!isAlive(onUpdate, accountId)) {\n    throw new AbortOperationError();\n  }\n}\n\nasync function setupStakingPolling(accountId: string, onUpdate: OnApiUpdate) {\n  const { network } = parseAccountId(accountId);\n\n  if (network !== 'mainnet') {\n    return;\n  }\n\n  let lastStates: ApiStakingState[] | undefined;\n\n  while (isAlive(onUpdate, accountId)) {\n    try {\n      const common = getStakingCommonCache();\n      const backendState = await getBackendStakingState(accountId);\n      const { shouldUseNominators, totalProfit } = backendState;\n      const states = await getStakingStates(accountId, common, backendState);\n\n      if (!isAlive(onUpdate, accountId)) return;\n\n      if (!areDeepEqual(states, lastStates)) {\n        lastStates = states;\n        onUpdate({\n          type: 'updateStaking',\n          accountId,\n          states,\n          common,\n          totalProfit,\n          shouldUseNominators,\n        });\n      }\n    } catch (err) {\n      logDebugError('setupStakingPolling', err);\n    }\n\n    await pauseOrFocus(STAKING_INTERVAL, STAKING_INTERVAL_WHEN_NOT_FOCUSED);\n  }\n}\n\nasync function loadNewActivities(accountId: string, newestActivityTimestamp: number, onUpdate: OnApiUpdate) {\n  let activities = await fetchActivitySlice(\n    accountId, undefined, undefined, newestActivityTimestamp, FIRST_TRANSACTIONS_LIMIT,\n  );\n\n  if (activities.length) {\n    newestActivityTimestamp = activities[0].timestamp;\n  }\n\n  activities = await swapReplaceCexActivities(accountId, activities, undefined, true);\n\n  activities.slice().reverse().forEach((transaction) => {\n    txCallbacks.runCallbacks(transaction);\n  });\n\n  onUpdate({\n    type: 'newActivities',\n    chain: 'ton',\n    activities,\n    accountId,\n  });\n\n  return newestActivityTimestamp;\n}\n\nasync function loadInitialActivities(accountId: string, tokenSlugs: string[], onUpdate: OnApiUpdate) {\n  const bySlug: Record<string, ApiActivity[]> = {};\n  let mainActivities: ApiActivity[] = [];\n\n  let newestActivityTimestamp: number | undefined;\n\n  await Promise.all(tokenSlugs.map(async (slug) => {\n    const tokenSlug = slug !== TONCOIN.slug ? slug : undefined;\n    let activities = await fetchActivitySlice(accountId, tokenSlug, undefined, FIRST_TRANSACTIONS_LIMIT);\n\n    if (SWAP_CROSSCHAIN_SLUGS.has(slug)) {\n      activities = await swapReplaceCexActivities(accountId, activities, slug, true);\n    }\n\n    if (slug === TONCOIN.slug && activities.length) {\n      // Activities for each Jetton wallet are loaded only the first time.\n      // New token activities will be loaded along with TON.\n      newestActivityTimestamp = activities[0].timestamp;\n\n      // There is no way to load TON activities without loading activities of other tokens\n      mainActivities = activities;\n      activities = activities.filter((activity) => getActivityTokenSlugs(activity).includes(TONCOIN.slug));\n    }\n\n    bySlug[slug] = activities;\n  }));\n\n  onUpdate({\n    type: 'initialActivities',\n    chain: 'ton',\n    accountId,\n    mainActivities,\n    bySlug,\n  });\n\n  return newestActivityTimestamp;\n}\n\nfunction logAndRescue(err: Error) {\n  logDebugError('Polling error', err);\n\n  return undefined;\n}\n\nasync function setupWalletVersionsPolling(accountId: string, onUpdate: OnApiUpdate) {\n  const account = await fetchStoredAccount(accountId);\n\n  if (account.type === 'bip39') {\n    return;\n  }\n\n  const isLedger = account.type === 'ledger';\n  const { publicKey, version } = account.ton;\n  const publicKeyBytes = hexToBytes(publicKey);\n  const { network } = parseAccountId(accountId);\n\n  const versions = (isLedger ? LEDGER_WALLET_VERSIONS : POPULAR_WALLET_VERSIONS)\n    .filter((value) => value !== version);\n  let lastResult: ApiWalletInfo[] | undefined;\n\n  while (isAlive(onUpdate, accountId)) {\n    try {\n      const versionInfos = (await getWalletVersionInfos(\n        network, publicKeyBytes, versions,\n      )).filter((versionInfo) => !!versionInfo.lastTxId || versionInfo.version === 'W5');\n\n      const filteredVersions = versionInfos.map(({ wallet, ...rest }) => rest);\n\n      if (!isAlive(onUpdate, accountId)) return;\n\n      if (!areDeepEqual(versionInfos, lastResult)) {\n        lastResult = versionInfos;\n        onUpdate({\n          type: 'updateWalletVersions',\n          accountId,\n          currentVersion: version,\n          versions: filteredVersions,\n        });\n      }\n    } catch (err) {\n      logDebugError('setupWalletVersionsPolling', err);\n    }\n\n    await pauseOrFocus(VERSIONS_INTERVAL, VERSIONS_INTERVAL_WHEN_NOT_FOCUSED);\n  }\n}\n\nasync function setupVestingPolling(accountId: string, onUpdate: OnApiUpdate) {\n  let lastVestingInfo: ApiVestingInfo[] | undefined;\n\n  while (isAlive(onUpdate, accountId)) {\n    try {\n      const vestingInfo = await fetchVestings(accountId);\n\n      if (!isAlive(onUpdate, accountId)) return;\n      if (!areDeepEqual(lastVestingInfo, vestingInfo)) {\n        lastVestingInfo = vestingInfo;\n        onUpdate({\n          type: 'updateVesting',\n          accountId,\n          vestingInfo,\n        });\n      }\n    } catch (err) {\n      logDebugError('setupVestingPolling', err);\n    }\n\n    await pauseOrFocus(VESTING_INTERVAL, VESTING_INTERVAL_WHEN_NOT_FOCUSED);\n  }\n}\n\nexport async function setupInactiveAccountsBalancePolling(onUpdate: OnApiUpdate) {\n  interface BalancePollingAccount {\n    id: string;\n    network: ApiNetwork;\n    address: string;\n  }\n  let addressToAccountsMap: { [address: string]: BalancePollingAccount[] } = {};\n  let activeAccountId: string | undefined;\n\n  const localOnUpdate = onUpdate;\n\n  async function updateAddressToAccountsMap() {\n    const accountsById = await fetchStoredAccounts();\n    addressToAccountsMap = {};\n\n    Object.entries(accountsById)\n      .filter(([id]) => id !== activeAccountId)\n      .forEach(([accountId, account]) => {\n        const { network } = parseAccountId(accountId);\n        const { address } = account.ton;\n\n        const balancePollingAccount: BalancePollingAccount = {\n          id: accountId,\n          network,\n          address,\n        };\n\n        if (!addressToAccountsMap[address]) {\n          addressToAccountsMap[address] = [];\n        }\n        addressToAccountsMap[address].push(balancePollingAccount);\n      });\n  }\n\n  async function updateBalance(\n    account: BalancePollingAccount,\n    cache: ApiBalanceBySlug,\n    newBalances: ApiBalanceBySlug,\n    changedSlugs: string[],\n  ) {\n    const { balance, lastTxId } = await getWalletInfo(account.network, account.address);\n    const isToncoinBalanceChanged = balance !== undefined && balance !== cache[TONCOIN.slug];\n    newBalances[TONCOIN.slug] = balance;\n\n    if (isToncoinBalanceChanged) {\n      changedSlugs.push(TONCOIN.slug);\n    }\n\n    return { lastTxId, isToncoinBalanceChanged };\n  }\n\n  async function updateTokenBalances(\n    account: BalancePollingAccount,\n    cache: ApiBalanceBySlug,\n    newBalances: ApiBalanceBySlug,\n    changedSlugs: string[],\n  ) {\n    const tokenBalances = await getAccountTokenBalances(account.id);\n\n    if (!activeAccountId) {\n      throw new AbortOperationError();\n    }\n    throwErrorIfUpdaterNotAlive(localOnUpdate, activeAccountId);\n\n    if (!tokenBalances) {\n      return;\n    }\n\n    const tokens = tokenBalances.filter(Boolean).map(({ token }) => token);\n    await addTokens(tokens, onUpdate);\n    await updateTokenHashes(account.network, tokens, onUpdate);\n\n    tokenBalances.forEach(({ slug, balance: tokenBalance }) => {\n      newBalances[slug] = tokenBalance;\n      if (cache[slug] !== tokenBalance) {\n        changedSlugs.push(slug);\n      }\n    });\n  }\n\n  while (isUpdaterAlive(localOnUpdate)) {\n    try {\n      activeAccountId = getActiveAccountId();\n      await updateAddressToAccountsMap();\n      for (const address of Object.keys(addressToAccountsMap)) {\n        const account = addressToAccountsMap[address][0];\n        const cache = lastBalanceCache[account.id] ?? {};\n        const newBalances: ApiBalanceBySlug = {};\n        const changedSlugs: string[] = [];\n\n        const { isToncoinBalanceChanged } = await updateBalance(account, cache, newBalances, changedSlugs);\n\n        if (isUpdaterAlive(localOnUpdate) && isToncoinBalanceChanged) {\n          await updateTokenBalances(account, cache, newBalances, changedSlugs);\n\n          lastBalanceCache[account.id] = newBalances;\n\n          if (changedSlugs.length) {\n            // Notify all accounts with the same address\n            addressToAccountsMap[account.address].forEach((acc) => {\n              onUpdate({\n                type: 'updateBalances',\n                accountId: acc.id,\n                chain: 'ton',\n                balances: newBalances,\n              });\n            });\n          }\n        }\n      }\n    } catch (err) {\n      if (err instanceof AbortOperationError) {\n        break;\n      }\n      logDebugError('setupBalancesPolling', err);\n    }\n\n    await pauseOrFocus(BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL, BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL_WHEN_NOT_FOCUSED);\n  }\n}\n","import { TronWeb } from 'tronweb';\n\nimport type { ApiNetwork } from '../../../types';\n\nimport { getChainConfig } from '../../../../util/chain';\n\nlet clientByNetwork: Record<ApiNetwork, TronWeb> | undefined;\n\nconst parametersByNetwork: {\n  [network in ApiNetwork]?: {\n    energyUnitFee: number;\n    bandwidthUnitFee: number;\n  }\n} = {};\n\nconst chainConfig = getChainConfig('tron');\n\nexport function getTronClient(network: ApiNetwork = 'mainnet') {\n  if (!clientByNetwork) {\n    clientByNetwork = {\n      mainnet: new TronWeb({\n        fullHost: chainConfig.mainnet.apiUrl,\n      }),\n      testnet: new TronWeb({\n        fullHost: chainConfig.testnet.apiUrl,\n      }),\n    };\n  }\n\n  return clientByNetwork[network];\n}\n\nexport async function getChainParameters(network: ApiNetwork) {\n  if (!(network in parametersByNetwork)) {\n    const chainParameters = await getTronClient(network).trx.getChainParameters();\n    const energyUnitFee = chainParameters.find((param) => param.key === 'getEnergyFee')!.value;\n    const bandwidthUnitFee = chainParameters.find((param) => param.key === 'getTransactionFee')!.value;\n    parametersByNetwork[network] = { energyUnitFee, bandwidthUnitFee };\n  }\n\n  return parametersByNetwork[network]!;\n}\n","import { TronWeb } from 'tronweb';\n\nimport type { ApiNetwork, ApiTransactionActivity } from '../../types';\n\nimport { TRX } from '../../../config';\nimport { parseAccountId } from '../../../util/account';\nimport { getChainConfig } from '../../../util/chain';\nimport { compareActivities } from '../../../util/compareActivities';\nimport { fetchJson } from '../../../util/fetch';\nimport { buildCollectionByKey } from '../../../util/iteratees';\nimport { fetchStoredTronWallet } from '../../common/accounts';\nimport { buildTokenSlug, getTokenBySlug } from '../../common/tokens';\n\nexport async function getTokenTransactionSlice(\n  accountId: string,\n  slug: string,\n  toTimestamp?: number,\n  fromTimestamp?: number,\n  limit?: number,\n) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTronWallet(accountId);\n\n  if (slug === TRX.slug) {\n    const rawTransactions = await getTrxTransactions(network, address, {\n      min_timestamp: fromTimestamp ? fromTimestamp + 1000 : undefined,\n      max_timestamp: toTimestamp ? toTimestamp - 1000 : undefined,\n      limit,\n    });\n    return rawTransactions.map((rawTx) => parseRawTrxTransaction(address, rawTx)).filter(Boolean);\n  } else {\n    const { tokenAddress } = getTokenBySlug(slug);\n    const rawTransactions = await getTrc20Transactions(network, address, {\n      contract_address: tokenAddress,\n      min_timestamp: fromTimestamp ? fromTimestamp + 1000 : undefined,\n      max_timestamp: toTimestamp ? toTimestamp - 1000 : undefined,\n      limit,\n    });\n    return rawTransactions.map((rawTx) => parseRawTrc20Transaction(address, rawTx));\n  }\n}\n\nexport async function getAllTransactionSlice(\n  accountId: string,\n  toTimestamp: number,\n  limit: number,\n  tokenSlugs: string[],\n) {\n  const chunks = (await Promise.all([\n    getTokenTransactionSlice(accountId, TRX.slug, toTimestamp, undefined, limit),\n    ...tokenSlugs.map((slug) => getTokenTransactionSlice(\n      accountId, slug, toTimestamp, undefined, limit,\n    )),\n  ])).filter((chunk) => chunk.length);\n\n  if (!chunks.length) {\n    return [];\n  }\n\n  // TODO ,     \" \",          .\n  //         .\n  const mainChunk = chunks.reduce((prevChunk, chunk) => {\n    if (prevChunk.length > chunk.length) return prevChunk;\n    if (prevChunk.length < chunk.length) return chunk;\n    if (prevChunk[prevChunk.length - 1].timestamp < chunk[chunk.length - 1].timestamp) return chunk;\n    return prevChunk;\n  }, [] as ApiTransactionActivity[]);\n\n  const fromTimestamp = mainChunk[mainChunk.length - 1].timestamp;\n\n  const [trxChunk, ...tokenChunks] = chunks;\n\n  return mergeTransactions(trxChunk, tokenChunks.flat())\n    .flat()\n    .filter(({ timestamp }) => timestamp >= fromTimestamp)\n    .sort(compareActivities);\n}\n\nasync function getTrxTransactions(\n  network: ApiNetwork,\n  address: string,\n  queryParams: {\n    only_confirmed?: boolean;\n    only_unconfirmed?: boolean;\n    only_to?: boolean;\n    only_from?: boolean;\n    limit?: number;\n    fingerprint?: string;\n    order_by?: 'block_timestamp,asc' | 'block_timestamp,desc';\n    min_timestamp?: number;\n    max_timestamp?: number;\n    search_internal?: boolean;\n  } = {},\n): Promise<any[]> {\n  const baseUrl = getChainConfig('tron')[network].apiUrl;\n  const url = new URL(`${baseUrl}/v1/accounts/${address}/transactions`);\n\n  const result = await fetchJson(url.toString(), queryParams);\n\n  return result.data;\n}\n\nfunction parseRawTrxTransaction(address: string, rawTx: any): ApiTransactionActivity | undefined {\n  const {\n    raw_data: rawData,\n    txID: txId,\n    energy_fee: energyFee,\n    net_fee: netFee,\n    block_timestamp: timestamp,\n  } = rawTx;\n\n  const amount = BigInt(rawData.contract[0].parameter.value.amount ?? 0);\n  const fromAddress = TronWeb.address.fromHex(rawData.contract[0].parameter.value.owner_address);\n  const toAddress = TronWeb.address.fromHex(rawData.contract[0].parameter.value.to_address!);\n\n  const slug = TRX.slug;\n  const isIncoming = toAddress === address;\n  const normalizedAddress = isIncoming ? fromAddress : toAddress;\n  const fee = BigInt(energyFee + netFee);\n  const shouldHide = rawData.contract[0].type === 'TransferAssetContract';\n\n  return {\n    id: txId,\n    kind: 'transaction',\n    txId,\n    timestamp,\n    fromAddress,\n    toAddress,\n    amount: isIncoming ? amount : -amount,\n    slug,\n    isIncoming,\n    normalizedAddress,\n    fee,\n    shouldHide,\n  };\n}\n\nasync function getTrc20Transactions(\n  network: ApiNetwork,\n  address: string,\n  queryParams: {\n    only_confirmed?: boolean;\n    only_unconfirmed?: boolean;\n    limit?: number;\n    fingerprint?: string;\n    order_by?: 'block_timestamp,asc' | 'block_timestamp,desc';\n    min_timestamp?: number;\n    max_timestamp?: number;\n    contract_address?: string;\n    only_to?: boolean;\n    only_from?: boolean;\n  } = {},\n): Promise<any[]> {\n  const baseUrl = getChainConfig('tron')[network].apiUrl;\n  const url = new URL(`${baseUrl}/v1/accounts/${address}/transactions/trc20`);\n\n  const result = await fetchJson(url.toString(), queryParams);\n\n  return result.data;\n}\n\nfunction parseRawTrc20Transaction(address: string, rawTx: any): ApiTransactionActivity {\n  const {\n    transaction_id: txId,\n    block_timestamp: timestamp,\n    from: fromAddress,\n    to: toAddress,\n    value,\n    token_info: tokenInfo,\n  } = rawTx;\n\n  const amount = BigInt(value);\n  const slug = buildTokenSlug(TRX.chain, tokenInfo.address);\n  const isIncoming = toAddress === address;\n  const normalizedAddress = isIncoming ? fromAddress : toAddress;\n  const fee = 0n;\n\n  return {\n    id: txId,\n    kind: 'transaction',\n    txId,\n    timestamp,\n    fromAddress,\n    toAddress,\n    amount: isIncoming ? amount : -amount,\n    slug,\n    isIncoming,\n    normalizedAddress,\n    fee,\n  };\n}\n\nexport function mergeTransactions(trxTxs: ApiTransactionActivity[], tokenTxs: ApiTransactionActivity[]) {\n  const tokenTxById = buildCollectionByKey(tokenTxs, 'id');\n  const trxTxsCleared: ApiTransactionActivity[] = [];\n\n  for (const tx of trxTxs) {\n    const tokenTx = tokenTxById[tx.id];\n    if (tx.toAddress) {\n      trxTxsCleared.push(tx);\n    } else if (tokenTx) {\n      tokenTx.fee = tx.fee;\n    }\n  }\n\n  return [trxTxsCleared, tokenTxs];\n}\n","import type { TronWeb } from 'tronweb';\n\nimport type { ApiNetwork } from '../../types';\n\nimport { logDebugError } from '../../../util/logs';\nimport { getTronClient } from './util/tronweb';\n\nexport async function getWalletBalance(network: ApiNetwork, address: string) {\n  const tronWeb = getTronClient(network);\n  return BigInt(await tronWeb.trx.getBalance(address));\n}\n\nexport async function getTrc20Balance(network: ApiNetwork, tokenAddress: string, address: string) {\n  const result = await callContract(getTronClient(network), tokenAddress, 'balanceOf(address)', [\n    { type: 'address', value: address },\n  ], address);\n\n  if (!result.length) {\n    return 0n;\n  }\n\n  return BigInt(`0x${result[0]}`);\n}\n\nexport async function callContract(\n  tronWeb: TronWeb,\n  address: string,\n  functions: string,\n  parameters: any[] = [],\n  issuerAddress: string,\n) {\n  try {\n    const result = await tronWeb.transactionBuilder.triggerSmartContract(\n      address,\n      functions,\n      { _isConstant: true },\n      parameters,\n      issuerAddress,\n    );\n    return result && result.result ? result.constant_result : [];\n  } catch (err: any) {\n    logDebugError('callContract', err);\n    return [];\n  }\n}\n","import type { ApiActivity, ApiActivityTimestamps, ApiBalanceBySlug, OnApiUpdate } from '../../types';\n\nimport { TRX } from '../../../config';\nimport { parseAccountId } from '../../../util/account';\nimport { getChainConfig } from '../../../util/chain';\nimport { compareActivities } from '../../../util/compareActivities';\nimport isEmptyObject from '../../../util/isEmptyObject';\nimport { logDebugError } from '../../../util/logs';\nimport { pauseOrFocus } from '../../../util/pauseOrFocus';\nimport { fetchStoredAccounts, fetchStoredTronWallet, getActiveAccountId } from '../../common/accounts';\nimport { isAlive, isUpdaterAlive } from '../../common/helpers';\nimport { buildTokenSlug } from '../../common/tokens';\nimport { txCallbacks } from '../../common/txCallbacks';\nimport { FIRST_TRANSACTIONS_LIMIT, SEC } from '../../constants';\nimport { getTokenTransactionSlice, mergeTransactions } from './transactions';\nimport { getTrc20Balance, getWalletBalance } from './wallet';\n\nconst BALANCE_INTERVAL = 1.1 * SEC;\nconst BALANCE_INTERVAL_WHEN_NOT_FOCUSED = 10 * SEC;\n\nconst BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL = 30 * SEC;\nconst BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL_WHEN_NOT_FOCUSED = 60 * SEC;\n\nconst lastBalanceCache: Record<string, ApiBalanceBySlug> = {};\n\nexport async function setupPolling(\n  accountId: string,\n  onUpdate: OnApiUpdate,\n  newestActivityTimestamps: ApiActivityTimestamps,\n) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTronWallet(accountId);\n\n  const { usdtAddress } = getChainConfig('tron')[network];\n  const usdtSlug = buildTokenSlug('tron', usdtAddress);\n  const slugs = [TRX.slug, usdtSlug];\n\n  while (isAlive(onUpdate, accountId)) {\n    try {\n      if (!lastBalanceCache[accountId]) lastBalanceCache[accountId] = {};\n      const accountLastBalances = lastBalanceCache[accountId];\n\n      const [trxBalance, usdtBalance] = await Promise.all([\n        getWalletBalance(network, address),\n        getTrc20Balance(network, usdtAddress, address),\n      ]);\n\n      if (trxBalance !== accountLastBalances[TRX.slug] || usdtBalance !== accountLastBalances[usdtAddress]) {\n        onUpdate({\n          type: 'updateBalances',\n          accountId,\n          chain: 'tron',\n          balances: {\n            [TRX.slug]: trxBalance,\n            [usdtSlug]: usdtBalance,\n          },\n        });\n\n        if (isEmptyObject(newestActivityTimestamps)) {\n          newestActivityTimestamps = await loadInitialActivities(accountId, slugs, onUpdate);\n        } else {\n          newestActivityTimestamps = await loadNewActivities(accountId, newestActivityTimestamps, slugs, onUpdate);\n        }\n\n        accountLastBalances[TRX.slug] = trxBalance;\n        accountLastBalances[usdtAddress] = usdtBalance;\n      }\n    } catch (err) {\n      logDebugError('tron:setupPolling', err);\n    }\n\n    await pauseOrFocus(BALANCE_INTERVAL, BALANCE_INTERVAL_WHEN_NOT_FOCUSED);\n  }\n}\n\nexport async function setupInactiveAccountsBalancePolling(onUpdate: OnApiUpdate) {\n  while (isUpdaterAlive(onUpdate)) {\n    try {\n      const accountsById = await fetchStoredAccounts();\n      const activeAccountId = getActiveAccountId();\n\n      for (const [accountId] of Object.entries(accountsById)\n        .filter(([id, acc]) => acc.type === 'bip39' && id !== activeAccountId)) {\n        const { network } = parseAccountId(accountId);\n        const { address } = await fetchStoredTronWallet(accountId);\n\n        const { usdtAddress } = getChainConfig('tron')[network];\n        const usdtSlug = buildTokenSlug('tron', usdtAddress);\n\n        const [trxBalance, usdtBalance] = await Promise.all([\n          getWalletBalance(network, address),\n          getTrc20Balance(network, usdtAddress, address),\n        ]);\n\n        if (!lastBalanceCache[accountId]) lastBalanceCache[accountId] = {};\n        const accountLastBalances = lastBalanceCache[accountId];\n\n        if (trxBalance !== accountLastBalances[TRX.slug] || usdtBalance !== accountLastBalances[usdtSlug]) {\n          onUpdate({\n            type: 'updateBalances',\n            accountId,\n            chain: 'tron',\n            balances: {\n              [TRX.slug]: trxBalance,\n              [usdtSlug]: usdtBalance,\n            },\n          });\n\n          accountLastBalances[TRX.slug] = trxBalance;\n          accountLastBalances[usdtSlug] = usdtBalance;\n        }\n      }\n    } catch (err) {\n      logDebugError('tron:setupPolling', err);\n    }\n\n    await pauseOrFocus(BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL, BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL_WHEN_NOT_FOCUSED);\n  }\n}\n\nasync function loadInitialActivities(\n  accountId: string,\n  tokenSlugs: string[],\n  onUpdate: OnApiUpdate,\n) {\n  const result: ApiActivityTimestamps = {};\n  const bySlug: Record<string, ApiActivity[]> = {};\n\n  const chunks = await Promise.all(tokenSlugs.map(async (slug) => {\n    const transactions = await getTokenTransactionSlice(\n      accountId, slug, undefined, undefined, FIRST_TRANSACTIONS_LIMIT,\n    );\n\n    result[slug] = transactions[0]?.timestamp;\n    bySlug[slug] = transactions;\n\n    return transactions;\n  }));\n\n  const [trxChunk, ...tokenChunks] = chunks;\n  const mainActivities = mergeTransactions(trxChunk, tokenChunks.flat())\n    .flat()\n    .sort(compareActivities);\n\n  mainActivities.slice().reverse().forEach((transaction) => {\n    txCallbacks.runCallbacks(transaction);\n  });\n\n  onUpdate({\n    type: 'initialActivities',\n    chain: 'tron',\n    accountId,\n    mainActivities,\n    bySlug,\n  });\n\n  return result;\n}\n\nasync function loadNewActivities(\n  accountId: string,\n  newestActivityTimestamps: ApiActivityTimestamps,\n  tokenSlugs: string[],\n  onUpdate: OnApiUpdate,\n) {\n  const result: ApiActivityTimestamps = {};\n\n  const chunks = await Promise.all(tokenSlugs.map(async (slug) => {\n    let newestActivityTimestamp = newestActivityTimestamps[slug];\n    const transactions = await getTokenTransactionSlice(\n      accountId, slug, undefined, newestActivityTimestamp, FIRST_TRANSACTIONS_LIMIT,\n    );\n    newestActivityTimestamp = transactions[0]?.timestamp ?? newestActivityTimestamp;\n    result[slug] = newestActivityTimestamp;\n    return transactions;\n  }));\n\n  const [trxChunk, ...tokenChunks] = chunks;\n  const transactions = mergeTransactions(trxChunk, tokenChunks.flat())\n    .flat()\n    .sort(compareActivities);\n\n  transactions.slice().reverse().forEach((transaction) => {\n    txCallbacks.runCallbacks(transaction);\n  });\n\n  onUpdate({\n    type: 'newActivities',\n    chain: 'tron',\n    activities: transactions,\n    accountId,\n  });\n\n  return result;\n}\n","export const TRON_GAS = {\n  transferTrc20Estimated: 28_214_970n,\n};\n\nexport const ONE_TRX = 1_000_000n;\n","// Importing from `tronweb/lib/commonjs/types` breaks eslint (eslint doesn't like any of import placement options)\n// eslint-disable-next-line simple-import-sort/imports\nimport type { TronWeb } from 'tronweb';\n\nimport type { ApiSubmitTransferOptions, CheckTransactionDraftOptions } from '../../methods/types';\nimport type { ApiCheckTransactionDraftResult } from '../ton/types';\nimport { ApiTransactionDraftError, ApiTransactionError } from '../../types';\nimport type { ApiAccountWithMnemonic, ApiBip39Account, ApiNetwork } from '../../types';\n\nimport { parseAccountId } from '../../../util/account';\nimport { logDebugError } from '../../../util/logs';\nimport { getChainParameters, getTronClient } from './util/tronweb';\nimport { fetchStoredAccount, fetchStoredTronWallet } from '../../common/accounts';\nimport { getMnemonic } from '../../common/mnemonic';\nimport { handleServerError } from '../../errors';\nimport { getTrc20Balance, getWalletBalance } from './wallet';\nimport type { ApiSubmitTransferTronResult } from './types';\nimport { hexToString } from '../../../util/stringFormat';\nimport { ONE_TRX, TRON_GAS } from './constants';\n\nconst SIGNATURE_SIZE = 65;\n\nexport async function checkTransactionDraft(\n  options: CheckTransactionDraftOptions,\n): Promise<ApiCheckTransactionDraftResult> {\n  const {\n    accountId, amount, toAddress, tokenAddress,\n  } = options;\n  const { network } = parseAccountId(accountId);\n\n  const tronWeb = getTronClient(network);\n  const result: ApiCheckTransactionDraftResult = {};\n\n  try {\n    if (!tronWeb.isAddress(toAddress)) {\n      return { error: ApiTransactionDraftError.InvalidToAddress };\n    }\n\n    result.resolvedAddress = toAddress;\n\n    const { address } = await fetchStoredTronWallet(accountId);\n    const [trxBalance, bandwidth, { energyUnitFee, bandwidthUnitFee }] = await Promise.all([\n      getWalletBalance(network, address),\n      tronWeb.trx.getBandwidth(address),\n      getChainParameters(network),\n    ]);\n\n    let fee: bigint;\n\n    if (tokenAddress) {\n      fee = await estimateTrc20TransferFee(tronWeb, {\n        network,\n        toAddress,\n        tokenAddress,\n        amount,\n        energyUnitFee,\n        fromAddress: address,\n      });\n    } else {\n      // This call throws \"Error: Invalid amount provided\" when the amount is 0.\n      // It doesn't throw when the amount is > than the balance.\n      const [transaction, account] = await Promise.all([\n        tronWeb.transactionBuilder.sendTrx(toAddress, Number(amount ?? 1), address),\n        tronWeb.trx.getAccount(toAddress),\n      ]);\n\n      const size = 9 + 60 + Buffer.from(transaction.raw_data_hex, 'hex').byteLength + SIGNATURE_SIZE;\n      fee = bandwidth > size ? 0n : BigInt(size) * BigInt(bandwidthUnitFee);\n\n      // If the account is not activated, we pay an extra 1 TRX for activation\n      if (account.balance === undefined) {\n        fee += ONE_TRX;\n      }\n    }\n\n    result.fee = fee;\n    result.realFee = fee;\n\n    const trxAmount = tokenAddress ? fee : (amount ?? 0n) + fee;\n    const isEnoughTrx = trxBalance >= trxAmount;\n\n    if (!isEnoughTrx) {\n      result.error = ApiTransactionDraftError.InsufficientBalance;\n    }\n\n    // todo: Check that the amount  the token balance (in case of a token transfer)\n\n    return result;\n  } catch (err) {\n    logDebugError('tron:checkTransactionDraft', err);\n    return {\n      ...handleServerError(err),\n      ...result,\n    };\n  }\n}\n\nexport async function submitTransfer(options: ApiSubmitTransferOptions): Promise<ApiSubmitTransferTronResult> {\n  const {\n    accountId, password, toAddress, amount, fee = 0n, tokenAddress,\n  } = options;\n\n  const { network } = parseAccountId(accountId);\n\n  try {\n    const tronWeb = getTronClient(network);\n\n    const account = await fetchStoredAccount<ApiAccountWithMnemonic>(accountId);\n    const { address } = (account as ApiBip39Account).tron;\n    const trxBalance = await getWalletBalance(network, address);\n\n    const trxAmount = tokenAddress ? fee : fee + amount;\n    const isEnoughTrx = trxBalance >= trxAmount;\n\n    if (!isEnoughTrx) {\n      return { error: ApiTransactionError.InsufficientBalance };\n    }\n\n    // todo: Check that the amount  the token balance (in case of a token transfer)\n\n    const mnemonic = await getMnemonic(accountId, password, account);\n    const privateKey = tronWeb.fromMnemonic(mnemonic!.join(' ')).privateKey.slice(2);\n\n    if (tokenAddress) {\n      const { transaction } = await buildTrc20Transfer(tronWeb, {\n        toAddress, tokenAddress, amount, feeLimit: fee, fromAddress: address,\n      });\n\n      const signedTx = await tronWeb.trx.sign(transaction, privateKey);\n      const result = await tronWeb.trx.sendRawTransaction(signedTx);\n\n      return { amount, toAddress, txId: result.transaction.txID };\n    } else {\n      const result = await tronWeb.trx.sendTransaction(toAddress, Number(amount), {\n        privateKey,\n      });\n\n      if ('code' in result && !('result' in result && result.result)) {\n        const error = 'message' in result && result.message\n          ? hexToString(result.message)\n          : result.code.toString();\n\n        logDebugError('submitTransfer', { error, result });\n\n        return { error };\n      }\n\n      return { amount, toAddress, txId: result.transaction.txID };\n    }\n  } catch (err: any) {\n    logDebugError('submitTransfer', err);\n    return { error: ApiTransactionError.UnsuccesfulTransfer };\n  }\n}\n\nasync function estimateTrc20TransferFee(tronWeb: TronWeb, options: {\n  network: ApiNetwork;\n  tokenAddress: string;\n  toAddress: string;\n  amount?: bigint;\n  energyUnitFee: number;\n  fromAddress: string;\n}) {\n  const {\n    network, tokenAddress, toAddress, energyUnitFee, fromAddress,\n  } = options;\n\n  let { amount } = options;\n  const tokenBalance = await getTrc20Balance(network, tokenAddress, fromAddress);\n\n  if (!tokenBalance) {\n    return TRON_GAS.transferTrc20Estimated;\n  }\n\n  if (amount === undefined || amount > tokenBalance) {\n    amount = 1n;\n  }\n\n  // This call throws \"Error: REVERT opcode executed\" when the given amount is more than the token balance.\n  // It doesn't throw when the amount is 0.\n  const { energy_required: energyRequired } = await tronWeb.transactionBuilder.estimateEnergy(\n    tokenAddress,\n    'transfer(address,uint256)',\n    {},\n    [\n      { type: 'address', value: toAddress },\n      { type: 'uint256', value: Number(amount) },\n    ],\n    fromAddress,\n  );\n\n  return BigInt(energyUnitFee * energyRequired);\n}\n\nasync function buildTrc20Transfer(tronWeb: TronWeb, options: {\n  tokenAddress: string;\n  toAddress: string;\n  amount: bigint;\n  feeLimit: bigint;\n  fromAddress: string;\n}) {\n  const {\n    amount, tokenAddress, toAddress, feeLimit, fromAddress,\n  } = options;\n\n  const { transaction } = await tronWeb.transactionBuilder.triggerSmartContract(\n    tokenAddress,\n    'transfer(address,uint256)',\n    { feeLimit: Number(feeLimit) },\n    [\n      { type: 'address', value: toAddress },\n      { type: 'uint256', value: Number(amount) },\n    ],\n    fromAddress,\n  );\n\n  return { transaction };\n}\n","export function isAscii(str: string) {\n  for (let i = 0; i < str.length; i++) {\n    if (str.charCodeAt(i) > 127) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function insertSubstring(str: string, start: number, newSubStr: string) {\n  if (start < 0) {\n    start = str.length - start;\n  }\n  return str.slice(0, start) + newSubStr + str.slice(start);\n}\n\nexport function hexToString(hex: string): string {\n  let result = '';\n  for (let i = 0; i < hex.length; i += 2) {\n    result += String.fromCharCode(parseInt(hex.slice(i, i + 2), 16));\n  }\n\n  return result;\n}\n","import type { ApiNetwork, ApiTronWallet } from '../../types';\n\nimport { getTronClient } from './util/tronweb';\n\nexport { setupPolling, setupInactiveAccountsBalancePolling } from './polling';\nexport { checkTransactionDraft, submitTransfer } from './transfer';\nexport { getWalletBalance } from './wallet';\nexport { getAllTransactionSlice, getTokenTransactionSlice } from './transactions';\n\nexport function getWalletFromBip39Mnemonic(network: ApiNetwork, mnemonic: string[]): ApiTronWallet {\n  const { address, publicKey } = getTronClient(network).fromMnemonic(mnemonic.join(' '));\n  return {\n    type: 'tron',\n    address,\n    publicKey,\n    index: 0,\n  };\n}\n\nexport function checkApiAvailability(network: ApiNetwork) {\n  const isConnected = getTronClient(network).isConnected();\n  return Boolean(isConnected);\n}\n","import * as ton from './ton';\nimport * as tron from './tron';\n\nexport default {\n  ton,\n  tron,\n};\n","import { logDebugError } from '../util/logs';\n\ninterface Hooks {\n  onFirstLogin: AnyFunction;\n  onFullLogout: AnyFunction;\n  onWindowNeeded: AnyFunction;\n  onDappDisconnected: (accountId: string, origin: string) => any;\n  onDappsChanged: AnyFunction;\n  onSwapCreated: (accountId: string, fromTimestamp: number) => any;\n}\n\nconst hooks: Partial<{\n  [K in keyof Hooks]: Hooks[K][];\n}> = {};\n\nexport function addHooks(partial: Partial<Hooks>) {\n  for (const [name, hook] of Object.entries(partial) as Entries<Hooks>) {\n    hooks[name] = (hooks[name] ?? []).concat([hook]);\n  }\n}\n\nexport async function callHook<T extends keyof Hooks>(name: T, ...args: Parameters<Hooks[T]>) {\n  for (const hook of hooks[name] ?? []) {\n    try {\n      // @ts-ignore\n      await hook(...args);\n    } catch (err) {\n      logDebugError(`callHooks:${name}`, err);\n    }\n  }\n}\n","import type {\n  ApiDapp, ApiDappsState, ApiNetwork, ApiSite, ApiSiteCategory, OnApiUpdate,\n} from '../types';\n\nimport { parseAccountId } from '../../util/account';\nimport {\n  getAccountValue, removeAccountValue, removeNetworkAccountsValue, setAccountValue,\n} from '../common/accounts';\nimport { callBackendGet } from '../common/backend';\nimport { isUpdaterAlive } from '../common/helpers';\nimport { callHook } from '../hooks';\nimport { storage } from '../storages';\n\nconst activeDappByAccountId: Record<string, string> = {};\n\nlet onUpdate: OnApiUpdate;\n\nexport function initDapps(_onUpdate: OnApiUpdate) {\n  onUpdate = _onUpdate;\n}\n\nexport function onActiveDappAccountUpdated(accountId: string) {\n  const activeDappOrigin = getActiveDapp(accountId);\n\n  onUpdate({\n    type: 'updateActiveDapp',\n    accountId,\n    origin: activeDappOrigin,\n  });\n}\n\nexport function activateDapp(accountId: string, origin: string) {\n  const oldAccountId = findActiveDappAccount(origin);\n  activeDappByAccountId[accountId] = origin;\n\n  // The method can be called in headless mode (tonConnect:reconnect)\n  if (!onUpdate || !isUpdaterAlive(onUpdate)) {\n    return;\n  }\n\n  if (oldAccountId) {\n    onUpdate({\n      type: 'updateActiveDapp',\n      accountId: oldAccountId,\n    });\n  }\n\n  onUpdate({\n    type: 'updateActiveDapp',\n    accountId,\n    origin,\n  });\n}\n\nexport function getActiveDapp(accountId: string) {\n  return activeDappByAccountId[accountId];\n}\n\nexport function deactivateDapp(origin: string) {\n  const accountId = findActiveDappAccount(origin);\n  if (!accountId) {\n    return false;\n  }\n\n  deactivateAccountDapp(accountId);\n\n  return true;\n}\n\nexport function findActiveDappAccount(origin: string) {\n  return Object.keys(activeDappByAccountId).find((acc) => origin === activeDappByAccountId[acc]);\n}\n\nexport function deactivateAccountDapp(accountId: string) {\n  const activeOrigin = activeDappByAccountId[accountId];\n  if (!activeOrigin) {\n    return false;\n  }\n\n  delete activeDappByAccountId[accountId];\n\n  if (onUpdate && isUpdaterAlive(onUpdate)) {\n    onUpdate({\n      type: 'updateActiveDapp',\n      accountId,\n    });\n  }\n\n  return true;\n}\n\nexport function deactivateAllDapps() {\n  for (const [accountId, value] of Object.entries(activeDappByAccountId)) {\n    if (!value) {\n      continue;\n    }\n\n    delete activeDappByAccountId[accountId];\n\n    onUpdate({\n      type: 'updateActiveDapp',\n      accountId,\n    });\n  }\n}\n\nexport function isDappActive(accountId: string, origin: string) {\n  return activeDappByAccountId[accountId] === origin;\n}\n\nexport async function updateDapp(accountId: string, origin: string, update: Partial<ApiDapp>) {\n  const dapp = await getDapp(accountId, origin);\n  await addDapp(accountId, { ...dapp!, ...update });\n}\n\nexport async function getDapp(accountId: string, origin: string): Promise<ApiDapp | undefined> {\n  return (await getAccountValue(accountId, 'dapps'))?.[origin];\n}\n\nexport async function addDapp(accountId: string, dapp: ApiDapp) {\n  const dapps = await getDappsByOrigin(accountId);\n  dapps[dapp.origin] = dapp;\n  await setAccountValue(accountId, 'dapps', dapps);\n}\n\nexport async function deleteDapp(accountId: string, origin: string, dontNotifyDapp?: boolean) {\n  const dapps = await getDappsByOrigin(accountId);\n  if (!(origin in dapps)) {\n    return false;\n  }\n\n  if (isDappActive(accountId, origin)) {\n    deactivateAccountDapp(accountId);\n  }\n\n  delete dapps[origin];\n  await setAccountValue(accountId, 'dapps', dapps);\n\n  if (onUpdate && isUpdaterAlive(onUpdate)) {\n    onUpdate({\n      type: 'dappDisconnect',\n      accountId,\n      origin,\n    });\n  }\n\n  if (!dontNotifyDapp) {\n    await callHook('onDappDisconnected', accountId, origin);\n  }\n\n  await callHook('onDappsChanged');\n\n  return true;\n}\n\nexport async function deleteAllDapps(accountId: string) {\n  deactivateAccountDapp(accountId);\n\n  const origins = Object.keys(await getDappsByOrigin(accountId));\n  await setAccountValue(accountId, 'dapps', {});\n\n  origins.forEach((origin) => {\n    onUpdate({\n      type: 'dappDisconnect',\n      accountId,\n      origin,\n    });\n    void callHook('onDappDisconnected', accountId, origin);\n  });\n\n  await callHook('onDappsChanged');\n}\n\nexport async function getDapps(accountId: string): Promise<ApiDapp[]> {\n  return Object.values(await getDappsByOrigin(accountId));\n}\n\nexport async function getDappsByOrigin(accountId: string): Promise<Record<string, ApiDapp>> {\n  return await getAccountValue(accountId, 'dapps') || {};\n}\n\nexport async function findLastConnectedAccount(network: ApiNetwork, origin: string) {\n  const dapps = await getDappsState() || {};\n\n  let connectedAt = 0;\n  let lastConnectedAccountId: string | undefined;\n\n  Object.entries(dapps).forEach(([accountId, byOrigin]) => {\n    if (!(origin in byOrigin)) return;\n    if (parseAccountId(accountId).network !== network) return;\n\n    if ((byOrigin[origin].connectedAt) > connectedAt) {\n      connectedAt = byOrigin[origin].connectedAt;\n      lastConnectedAccountId = accountId;\n    }\n  });\n\n  return lastConnectedAccountId;\n}\n\nexport function getDappsState(): Promise<ApiDappsState | undefined> {\n  return storage.getItem('dapps');\n}\n\nexport async function removeAccountDapps(accountId: string) {\n  await removeAccountValue(accountId, 'dapps');\n\n  void callHook('onDappsChanged');\n}\n\nexport async function removeAllDapps() {\n  await storage.removeItem('dapps');\n\n  await callHook('onDappsChanged');\n}\n\nexport function removeNetworkDapps(network: ApiNetwork) {\n  return removeNetworkAccountsValue(network, 'dapps');\n}\n\nexport function getSseLastEventId(): Promise<string | undefined> {\n  return storage.getItem('sseLastEventId');\n}\n\nexport function setSseLastEventId(lastEventId: string) {\n  return storage.setItem('sseLastEventId', lastEventId);\n}\n\nexport function loadExploreSites(\n  { isLandscape }: { isLandscape: boolean },\n): Promise<{ categories: ApiSiteCategory[]; sites: ApiSite[] }> {\n  return callBackendGet('/v2/dapp/catalog', { isLandscape });\n}\n","let resolvePromise: Function;\nconst preloadPromise = new Promise((resolve) => {\n  resolvePromise = resolve;\n});\n\nexport function resolveDataPreloadPromise() {\n  resolvePromise();\n}\n\nexport async function waitDataPreload() {\n  await preloadPromise;\n}\n","import type { ApiBaseCurrency } from '../types';\n\nimport { DEFAULT_PRICE_CURRENCY } from '../../config';\nimport { storage } from '../storages';\n\nexport async function getBaseCurrency() {\n  return (await storage.getItem('baseCurrency')) ?? DEFAULT_PRICE_CURRENCY;\n}\n\nexport function setBaseCurrency(currency: ApiBaseCurrency) {\n  return storage.setItem('baseCurrency', currency);\n}\n","import type { ApiNetwork } from '../types';\n\nimport { parseAccountId } from '../../util/account';\nimport chains from '../chains';\nimport { getTokenByAddress } from '../common/tokens';\n\nconst { ton } = chains;\n\nexport { getTokenBySlug, buildTokenSlug } from '../common/tokens';\n\nexport function fetchToken(accountId: string, address: string) {\n  const { network } = parseAccountId(accountId);\n  return ton.fetchToken(network, address);\n}\n\nexport function resolveTokenWalletAddress(network: ApiNetwork, address: string, tokenAddress: string) {\n  const chain = chains.ton;\n\n  return chain.resolveTokenWalletAddress(network, address, tokenAddress);\n}\n\nexport function resolveTokenAddress(network: ApiNetwork, tokenWalletAddress: string) {\n  const chain = chains.ton;\n\n  return chain.resolveTokenAddress(network, tokenWalletAddress);\n}\n\nexport function fetchTokenBalances(accountId: string) {\n  const chain = chains.ton;\n\n  return chain.getAccountTokenBalances(accountId);\n}\n\nexport function fetchTokenBalancesByAddress(address: string, network: ApiNetwork) {\n  const chain = chains.ton;\n\n  return chain.getTokenBalances(network, address);\n}\n\nexport function getAmountForTokenTransfer(tokenAddress: string, willClaimMintless: boolean) {\n  const chain = chains.ton;\n  const token = getTokenByAddress(tokenAddress)!;\n\n  return chain.getToncoinAmountForTransfer(token, willClaimMintless);\n}\n","import { Cell } from '@ton/core';\n\nimport type { ApiSubmitTransferWithDieselResult } from '../chains/ton/types';\nimport type {\n  ApiActivity,\n  ApiChain,\n  ApiLocalTransactionParams,\n  ApiSignedTransfer,\n  ApiTransactionActivity,\n  OnApiUpdate,\n} from '../types';\nimport type { ApiSubmitTransferOptions, ApiSubmitTransferResult, CheckTransactionDraftOptions } from './types';\n\nimport { parseAccountId } from '../../util/account';\nimport { mergeActivitiesToMaxTime } from '../../util/activities';\nimport { getChainConfig } from '../../util/chain';\nimport { logDebugError } from '../../util/logs';\nimport chains from '../chains';\nimport { fetchStoredAccount, fetchStoredAddress, fetchStoredTonWallet } from '../common/accounts';\nimport { buildLocalTransaction } from '../common/helpers';\nimport { getPendingTransfer, waitAndCreatePendingTransfer } from '../common/pendingTransfers';\nimport { swapReplaceCexActivities } from '../common/swap';\nimport { handleServerError } from '../errors';\nimport { buildTokenSlug } from './tokens';\n\nlet onUpdate: OnApiUpdate;\n\nconst { ton, tron } = chains;\n\nexport function initTransactions(_onUpdate: OnApiUpdate) {\n  onUpdate = _onUpdate;\n}\n\nexport async function fetchActivitySlice(\n  accountId: string,\n  chain: ApiChain,\n  slug: string,\n  fromTimestamp?: number,\n  limit?: number,\n): Promise<ApiActivity[] | { error: string }> {\n  let activities: ApiActivity[];\n\n  try {\n    if (chain === 'ton') {\n      activities = await chains[chain].fetchActivitySlice(\n        accountId, slug, fromTimestamp, undefined, limit,\n      );\n    } else {\n      activities = await chains[chain].getTokenTransactionSlice(\n        accountId, slug, fromTimestamp, undefined, limit,\n      );\n    }\n\n    activities = await swapReplaceCexActivities(accountId, activities, slug);\n\n    return activities;\n  } catch (err) {\n    logDebugError('fetchActivitySlice', err);\n    return handleServerError(err);\n  }\n}\n\nexport async function fetchAllActivitySlice(\n  accountId: string,\n  limit: number,\n  toTimestamp: number,\n  tronTokenSlugs: string[],\n): Promise<ApiActivity[] | { error: string }> {\n  try {\n    const { type } = await fetchStoredAccount(accountId);\n\n    let tonActivities = await ton.fetchActivitySlice(accountId, undefined, toTimestamp, undefined, limit);\n\n    if (type !== 'bip39') {\n      tonActivities = await swapReplaceCexActivities(accountId, tonActivities);\n      return tonActivities;\n    }\n\n    const tronActivities: ApiActivity[] = await tron.getAllTransactionSlice(\n      accountId, toTimestamp, limit, tronTokenSlugs,\n    );\n\n    const activities = mergeActivitiesToMaxTime(tonActivities, tronActivities);\n\n    return await swapReplaceCexActivities(accountId, activities);\n  } catch (err) {\n    logDebugError('fetchAllActivitySlice', err);\n    return handleServerError(err);\n  }\n}\n\nexport function checkTransactionDraft(chain: ApiChain, options: CheckTransactionDraftOptions) {\n  return chains[chain].checkTransactionDraft(options);\n}\n\nexport async function submitTransfer(\n  chain: ApiChain,\n  options: ApiSubmitTransferOptions,\n  shouldCreateLocalActivity = true,\n): Promise<(ApiSubmitTransferResult | ApiSubmitTransferWithDieselResult) & { txId?: string }> {\n  const {\n    accountId,\n    password,\n    toAddress,\n    amount,\n    tokenAddress,\n    comment,\n    fee,\n    realFee,\n    shouldEncrypt,\n    isBase64Data,\n    withDiesel,\n    dieselAmount,\n    isGaslessWithStars,\n  } = options;\n  const stateInit = typeof options.stateInit === 'string' ? Cell.fromBase64(options.stateInit) : options.stateInit;\n\n  const fromAddress = await fetchStoredAddress(accountId, chain);\n\n  let result: ApiSubmitTransferResult | ApiSubmitTransferWithDieselResult;\n\n  if (withDiesel && chain === 'ton') {\n    result = await ton.submitTransferWithDiesel({\n      accountId,\n      password,\n      toAddress,\n      amount,\n      tokenAddress: tokenAddress!,\n      data: comment,\n      shouldEncrypt,\n      dieselAmount: dieselAmount!,\n      isGaslessWithStars,\n    });\n  } else {\n    result = await chains[chain].submitTransfer({\n      accountId,\n      password,\n      toAddress,\n      amount,\n      tokenAddress,\n      data: comment,\n      shouldEncrypt,\n      isBase64Data,\n      stateInit,\n      fee,\n    });\n  }\n\n  if ('error' in result) {\n    return result;\n  }\n\n  if (!shouldCreateLocalActivity) {\n    return result;\n  }\n\n  const slug = tokenAddress\n    ? buildTokenSlug(chain, tokenAddress)\n    : getChainConfig(chain).nativeToken.slug;\n\n  let localActivity: ApiTransactionActivity;\n\n  if ('msgHash' in result) {\n    const { encryptedComment, msgHash } = result;\n    localActivity = createLocalTransaction(accountId, chain, {\n      amount,\n      fromAddress,\n      toAddress,\n      comment: shouldEncrypt ? undefined : comment,\n      encryptedComment,\n      fee: realFee ?? 0n,\n      slug,\n      externalMsgHash: msgHash,\n      extra: {\n        ...('withW5Gasless' in result && { withW5Gasless: result.withW5Gasless }),\n      },\n    });\n    if ('paymentLink' in result && result.paymentLink) {\n      onUpdate({ type: 'openUrl', url: result.paymentLink, isExternal: true });\n    }\n  } else {\n    const { txId } = result;\n    localActivity = createLocalTransaction(accountId, chain, {\n      txId,\n      amount,\n      fromAddress,\n      toAddress,\n      comment,\n      fee: realFee ?? 0n,\n      slug,\n    });\n  }\n\n  return {\n    ...result,\n    txId: localActivity.txId,\n  };\n}\n\nexport async function waitAndCreateTonPendingTransfer(accountId: string) {\n  const { network } = parseAccountId(accountId);\n  const { address } = await fetchStoredTonWallet(accountId);\n\n  return (await waitAndCreatePendingTransfer(network, address)).id;\n}\n\nexport async function sendSignedTransferMessage(\n  accountId: string,\n  message: ApiSignedTransfer,\n  pendingTransferId: string,\n) {\n  const { msgHash } = await ton.sendSignedMessage(accountId, message, pendingTransferId);\n\n  const localActivity = createLocalTransaction(accountId, 'ton', {\n    ...message.localActivity,\n    externalMsgHash: msgHash,\n  });\n\n  return localActivity.txId;\n}\n\nexport function cancelPendingTransfer(id: string) {\n  getPendingTransfer(id)?.resolve();\n}\n\nexport function decryptComment(accountId: string, encryptedComment: string, fromAddress: string, password: string) {\n  const chain = chains.ton;\n\n  return chain.decryptComment(accountId, encryptedComment, fromAddress, password);\n}\n\nexport function createLocalTransaction(\n  accountId: string,\n  chain: ApiChain,\n  params: ApiLocalTransactionParams,\n  subId?: number,\n) {\n  const { network } = parseAccountId(accountId);\n  const { toAddress } = params;\n\n  let normalizedAddress: string;\n  if (params.normalizedAddress) {\n    normalizedAddress = params.normalizedAddress;\n  } else if (chain === 'ton') {\n    normalizedAddress = ton.normalizeAddress(toAddress, network);\n  } else {\n    normalizedAddress = toAddress;\n  }\n\n  const localTransaction = buildLocalTransaction(params, normalizedAddress, subId);\n\n  onUpdate({\n    type: 'newLocalActivity',\n    activity: localTransaction,\n    accountId,\n  });\n\n  return localTransaction;\n}\n\nexport function fetchEstimateDiesel(accountId: string, tokenAddress: string) {\n  const chain = chains.ton;\n\n  return chain.fetchEstimateDiesel(accountId, tokenAddress);\n}\n\nexport function fetchTonActivityDetails(accountId: string, activity: ApiActivity) {\n  return chains.ton.fetchActivityDetails(accountId, activity);\n}\n","import type {\n  ApiJettonStakingState,\n  ApiStakingCommonData,\n  ApiStakingHistory,\n  ApiStakingState,\n  ApiTransactionActivity,\n} from '../types';\n\nimport { TONCOIN } from '../../config';\nimport { fromDecimal } from '../../util/decimals';\nimport { logDebugError } from '../../util/logs';\nimport chains from '../chains';\nimport { fetchStoredTonWallet } from '../common/accounts';\nimport { callBackendGet } from '../common/backend';\nimport { setStakingCommonCache } from '../common/cache';\nimport { createLocalTransaction } from './transactions';\n\nconst { ton } = chains;\n\nexport function initStaking() {\n}\n\nexport function checkStakeDraft(accountId: string, amount: bigint, state: ApiStakingState) {\n  return ton.checkStakeDraft(accountId, amount, state);\n}\n\nexport function checkUnstakeDraft(accountId: string, amount: bigint, state: ApiStakingState) {\n  return ton.checkUnstakeDraft(accountId, amount, state);\n}\n\nexport async function submitStake(\n  accountId: string,\n  password: string,\n  amount: bigint,\n  state: ApiStakingState,\n  realFee?: bigint,\n) {\n  const { address: fromAddress } = await fetchStoredTonWallet(accountId);\n\n  const result = await ton.submitStake(\n    accountId, password, amount, state,\n  );\n\n  if ('error' in result) {\n    return false;\n  }\n\n  let localActivity: ApiTransactionActivity;\n\n  if (state.tokenSlug === TONCOIN.slug) {\n    localActivity = createLocalTransaction(accountId, 'ton', {\n      amount,\n      fromAddress,\n      toAddress: result.toAddress,\n      fee: realFee ?? 0n,\n      type: 'stake',\n      slug: state.tokenSlug,\n      externalMsgHash: result.msgHash,\n    });\n  } else {\n    localActivity = createLocalTransaction(accountId, 'ton', {\n      amount,\n      fromAddress,\n      toAddress: result.toAddress,\n      fee: realFee ?? 0n,\n      type: 'stake',\n      slug: state.tokenSlug,\n      externalMsgHash: result.msgHash,\n    });\n  }\n\n  return {\n    ...result,\n    txId: localActivity.txId,\n  };\n}\n\nexport async function submitUnstake(\n  accountId: string,\n  password: string,\n  amount: bigint,\n  state: ApiStakingState,\n  realFee?: bigint,\n) {\n  const { address: fromAddress } = await fetchStoredTonWallet(accountId);\n\n  const result = await ton.submitUnstake(accountId, password, amount, state);\n  if ('error' in result) {\n    return false;\n  }\n\n  const localActivity = createLocalTransaction(accountId, 'ton', {\n    amount: result.amount,\n    fromAddress,\n    toAddress: result.toAddress,\n    fee: realFee ?? 0n,\n    type: 'unstakeRequest',\n    slug: TONCOIN.slug,\n    externalMsgHash: result.msgHash,\n  });\n\n  return {\n    ...result,\n    txId: localActivity.txId,\n  };\n}\n\nexport async function getStakingHistory(\n  accountId: string,\n  limit?: number,\n  offset?: number,\n): Promise<ApiStakingHistory> {\n  const { address } = await fetchStoredTonWallet(accountId);\n  return callBackendGet(`/staking/profits/${address}`, { limit, offset });\n}\n\nexport async function tryUpdateStakingCommonData() {\n  try {\n    const data = await callBackendGet('/staking/common');\n    data.round.start *= 1000;\n    data.round.end *= 1000;\n    data.round.unlock *= 1000;\n    data.prevRound.start *= 1000;\n    data.prevRound.end *= 1000;\n    data.prevRound.unlock *= 1000;\n    data.liquid.available = fromDecimal(data.liquid.available);\n\n    setStakingCommonCache(data as ApiStakingCommonData);\n  } catch (err) {\n    logDebugError('tryUpdateLiquidStakingState', err);\n  }\n}\n\nexport function fetchBackendStakingState(address: string) {\n  return ton.getBackendStakingState(address);\n}\n\nexport async function submitStakingClaim(\n  accountId: string,\n  password: string,\n  state: ApiJettonStakingState,\n  realFee?: bigint,\n) {\n  const { address: fromAddress } = await fetchStoredTonWallet(accountId);\n\n  const result = await ton.submitStakingClaim(accountId, password, state);\n\n  if ('error' in result) {\n    return result;\n  }\n\n  const localActivity = createLocalTransaction(accountId, 'ton', {\n    amount: result.amount,\n    fromAddress,\n    toAddress: result.toAddress,\n    fee: realFee ?? 0n,\n    slug: TONCOIN.slug,\n    externalMsgHash: result.msgHash,\n  });\n\n  return {\n    ...result,\n    txId: localActivity.txId,\n  };\n}\n","import nacl from 'tweetnacl';\n\nimport type { Theme } from '../../global/types';\nimport type { AccountCache } from '../common/cache';\nimport type { StorageKey } from '../storages/types';\nimport type { ApiChain, ApiNetwork } from '../types';\n\nimport { getLogs, logDebugError } from '../../util/logs';\nimport { setIsAppFocused } from '../../util/pauseOrFocus';\nimport chains from '../chains';\nimport { fetchStoredAccounts, fetchStoredTonWallet, updateStoredAccount } from '../common/accounts';\nimport { callBackendGet } from '../common/backend';\nimport { updateAccountCache } from '../common/cache';\nimport { handleServerError } from '../errors';\nimport { storage } from '../storages';\n\nconst SIGN_MESSAGE = Buffer.from('MyTonWallet_AuthToken_n6i0k4w8pb');\n\nexport function checkApiAvailability(chain: ApiChain, network: ApiNetwork) {\n  return chains[chain].checkApiAvailability(network);\n}\n\nexport async function getBackendAuthToken(accountId: string, password: string) {\n  const accountWallet = await fetchStoredTonWallet(accountId);\n  let { authToken } = accountWallet;\n  const { publicKey, isInitialized } = accountWallet;\n\n  if (!authToken) {\n    const privateKey = await chains.ton.fetchPrivateKey(accountId, password);\n    const signature = nacl.sign.detached(SIGN_MESSAGE, privateKey!);\n    authToken = Buffer.from(signature).toString('base64');\n\n    await updateStoredAccount(accountId, {\n      ton: {\n        ...accountWallet,\n        authToken,\n      },\n    });\n  }\n\n  if (!isInitialized) {\n    authToken += `:${publicKey}`;\n  }\n\n  return authToken;\n}\n\nexport async function fetchAccountConfigForDebugPurposesOnly() {\n  try {\n    const [accounts, stateVersion, mnemonicsEncrypted] = await Promise.all([\n      fetchStoredAccounts(),\n      storage.getItem('stateVersion'),\n      storage.getItem('mnemonicsEncrypted' as StorageKey),\n    ]);\n\n    return JSON.stringify({ accounts, stateVersion, mnemonicsEncrypted });\n  } catch (err) {\n    logDebugError('fetchAccountConfigForDebugPurposesOnly', err);\n\n    return undefined;\n  }\n}\n\nexport function ping() {\n  return true;\n}\n\nexport function updateAccountMemoryCache(accountId: string, address: string, partial: Partial<AccountCache>) {\n  updateAccountCache(accountId, address, partial);\n}\n\nexport { setIsAppFocused, getLogs };\n\nexport async function getMoonpayOnrampUrl(chain: ApiChain, address: string, theme: Theme) {\n  try {\n    return await callBackendGet<{ url: string }>('/onramp-url', {\n      chain,\n      address,\n      theme,\n    });\n  } catch (err) {\n    logDebugError('getMoonpayOnrampUrl', err);\n\n    return handleServerError(err);\n  }\n}\n","import type { TonTransferParams } from '../chains/ton/types';\nimport type {\n  ApiChain,\n  ApiSwapActivity,\n  ApiSwapAsset,\n  ApiSwapBuildRequest,\n  ApiSwapBuildResponse,\n  ApiSwapCexCreateTransactionRequest,\n  ApiSwapCexCreateTransactionResponse,\n  ApiSwapCexEstimateRequest,\n  ApiSwapCexEstimateResponse,\n  ApiSwapEstimateRequest,\n  ApiSwapEstimateResponse,\n  ApiSwapHistoryItem,\n  ApiSwapPairAsset,\n  ApiSwapTonAsset,\n  ApiSwapTransfer,\n  OnApiUpdate,\n} from '../types';\nimport type { ApiSubmitTransferOptions } from './types';\n\nimport { SWAP_API_VERSION, TONCOIN } from '../../config';\nimport { parseAccountId } from '../../util/account';\nimport { buildLocalTxId } from '../../util/activities';\nimport { omitUndefined } from '../../util/iteratees';\nimport chains from '../chains';\nimport { fetchStoredAccount, fetchStoredTonWallet } from '../common/accounts';\nimport { callBackendGet, callBackendPost } from '../common/backend';\nimport {\n  getSwapItemSlug, patchSwapItem, swapGetHistoryItem, swapItemToActivity,\n} from '../common/swap';\nimport { ApiServerError } from '../errors';\nimport { callHook } from '../hooks';\nimport { getBackendAuthToken } from './other';\nimport { submitTransfer } from './transactions';\n\nconst ton = chains.ton;\n\nlet onUpdate: OnApiUpdate;\n\nexport function initSwap(_onUpdate: OnApiUpdate) {\n  onUpdate = _onUpdate;\n}\n\nexport async function swapBuildTransfer(\n  accountId: string,\n  password: string,\n  request: ApiSwapBuildRequest,\n) {\n  const { network } = parseAccountId(accountId);\n  const authToken = await getBackendAuthToken(accountId, password);\n\n  const { address, version } = await fetchStoredTonWallet(accountId);\n  request.walletVersion = version;\n\n  const { id, transfers } = await swapBuild(authToken, request);\n\n  const transferList = transfers.map((transfer) => ({\n    ...transfer,\n    amount: BigInt(transfer.amount),\n    isBase64Payload: true,\n  }));\n\n  try {\n    await ton.validateDexSwapTransfers(network, address, request, transferList);\n\n    const result = await ton.checkMultiTransactionDraft(accountId, transferList, request.shouldTryDiesel);\n\n    if ('error' in result) {\n      await patchSwapItem({\n        address, swapId: id, authToken, error: result.error,\n      });\n      return result;\n    }\n\n    return { ...result, id, transfers };\n  } catch (err: any) {\n    await patchSwapItem({\n      address, swapId: id, authToken, error: errorToString(err),\n    });\n    throw err;\n  }\n}\n\nexport async function swapSubmit(\n  accountId: string,\n  password: string,\n  transfers: ApiSwapTransfer[],\n  historyItem: ApiSwapHistoryItem,\n  isGasless?: boolean,\n) {\n  const swapId = historyItem.id;\n  const account = await fetchStoredAccount(accountId);\n\n  const { ton: { address } } = account;\n  const authToken = account.ton.authToken ?? await getBackendAuthToken(accountId, password);\n\n  try {\n    const transferList: TonTransferParams[] = transfers.map((transfer) => ({\n      ...transfer,\n      amount: BigInt(transfer.amount),\n      isBase64Payload: true,\n    }));\n\n    if (historyItem.from !== TONCOIN.symbol) {\n      transferList[0] = await ton.insertMintlessPayload('mainnet', address, historyItem.from, transferList[0]);\n    }\n\n    const result = await ton.submitMultiTransfer({\n      accountId,\n      password,\n      messages: transferList,\n      isGasless,\n    });\n\n    if ('error' in result) {\n      await patchSwapItem({\n        address, swapId, authToken, error: result.error,\n      });\n      return result;\n    }\n\n    delete result.messages[0].stateInit;\n\n    const from = getSwapItemSlug(historyItem, historyItem.from);\n    const to = getSwapItemSlug(historyItem, historyItem.to);\n\n    const swap: ApiSwapActivity = {\n      ...historyItem,\n      id: buildLocalTxId(result.msgHash),\n      from,\n      to,\n      kind: 'swap',\n      externalMsgHash: result.msgHash,\n      extra: omitUndefined({\n        withW5Gasless: result.withW5Gasless,\n      }),\n    };\n\n    onUpdate({\n      type: 'newLocalActivity',\n      accountId,\n      activity: swap,\n    });\n\n    await patchSwapItem({\n      address, swapId, authToken, msgHash: result.msgHash,\n    });\n\n    void callHook('onSwapCreated', accountId, swap.timestamp - 1);\n\n    return result;\n  } catch (err: any) {\n    await patchSwapItem({\n      address, swapId, authToken, error: errorToString(err),\n    });\n    throw err;\n  }\n}\n\nfunction errorToString(err: Error | string) {\n  return typeof err === 'string' ? err : err.stack;\n}\n\nexport async function fetchSwaps(accountId: string, ids: string[]) {\n  const { address } = await fetchStoredTonWallet(accountId);\n  const results = await Promise.allSettled(\n    ids.map((id) => swapGetHistoryItem(address, id.replace('swap:', ''))),\n  );\n\n  const nonExistentIds: string[] = [];\n\n  const swaps = results\n    .map((result, i) => {\n      if (result.status === 'rejected') {\n        if (result.reason instanceof ApiServerError && result.reason.statusCode === 404) {\n          nonExistentIds.push(ids[i]);\n        }\n        return undefined;\n      }\n\n      return swapItemToActivity(result.value);\n    })\n    .filter(Boolean);\n\n  return { nonExistentIds, swaps };\n}\n\nexport async function swapEstimate(\n  accountId: string,\n  request: ApiSwapEstimateRequest,\n): Promise<ApiSwapEstimateResponse | { error: string }> {\n  const walletVersion = (await fetchStoredTonWallet(accountId)).version;\n\n  return callBackendPost('/swap/ton/estimate', {\n    ...request,\n    swapVersion: SWAP_API_VERSION,\n    walletVersion,\n  }, {\n    isAllowBadRequest: true,\n  });\n}\n\nexport function swapBuild(authToken: string, request: ApiSwapBuildRequest): Promise<ApiSwapBuildResponse> {\n  return callBackendPost('/swap/ton/build', {\n    ...request,\n    swapVersion: SWAP_API_VERSION,\n    isMsgHashMode: true,\n  }, {\n    authToken,\n  });\n}\n\nexport function swapGetAssets(): Promise<ApiSwapAsset[]> {\n  return callBackendGet('/swap/assets');\n}\n\nexport function swapGetTonCurrencies(): Promise<ApiSwapTonAsset[]> {\n  return callBackendGet('/swap/ton/tokens');\n}\n\nexport function swapGetPairs(symbolOrTokenAddress: string): Promise<ApiSwapPairAsset[]> {\n  return callBackendGet('/swap/pairs', { asset: symbolOrTokenAddress });\n}\n\nexport function swapCexEstimate(\n  request: ApiSwapCexEstimateRequest,\n): Promise<ApiSwapCexEstimateResponse | { error: string }> {\n  return callBackendPost<ApiSwapCexEstimateResponse | { error: string }>(\n    '/swap/cex/estimate',\n    request,\n    { isAllowBadRequest: true },\n  );\n}\n\nexport function swapCexValidateAddress(params: { slug: string; address: string }): Promise<{\n  result: boolean;\n  message?: string;\n}> {\n  return callBackendGet('/swap/cex/validate-address', params);\n}\n\nexport async function swapCexCreateTransaction(\n  accountId: string,\n  password: string,\n  request: ApiSwapCexCreateTransactionRequest,\n): Promise<{\n    swap: ApiSwapHistoryItem;\n    activity: ApiSwapActivity;\n  }> {\n  const authToken = await getBackendAuthToken(accountId, password);\n\n  const { swap } = await callBackendPost<ApiSwapCexCreateTransactionResponse>('/swap/cex/createTransaction', {\n    ...request,\n    swapVersion: SWAP_API_VERSION,\n  }, {\n    authToken,\n  });\n\n  const activity = swapItemToActivity(swap);\n\n  onUpdate({\n    type: 'newActivities',\n    accountId,\n    activities: [activity],\n  });\n\n  void callHook('onSwapCreated', accountId, swap.timestamp - 1);\n\n  return { swap, activity };\n}\n\nexport async function swapCexSubmit(chain: ApiChain, transferOptions: ApiSubmitTransferOptions, swapId: string) {\n  const result = await submitTransfer(chain, transferOptions, false);\n\n  if (chain === 'ton' && 'msgHash' in result) {\n    const { accountId, password } = transferOptions;\n    const { address } = await fetchStoredTonWallet(accountId);\n    const authToken = await getBackendAuthToken(accountId, password);\n    await patchSwapItem({ address, authToken, msgHash: result.msgHash, swapId });\n  }\n\n  return result;\n}\n","import type {\n  ApiAccountAny,\n  ApiAccountConfig,\n  ApiAccountWithMnemonic,\n  ApiCountryCode,\n  ApiSwapAsset,\n  ApiTokenPrice,\n  OnApiUpdate,\n} from '../types';\n\nimport { IS_AIR_APP, TONCOIN } from '../../config';\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport { buildCollectionByKey, omit } from '../../util/iteratees';\nimport { logDebugError } from '../../util/logs';\nimport { pauseOrFocus } from '../../util/pauseOrFocus';\nimport chains from '../chains';\nimport { tryUpdateKnownAddresses } from '../common/addresses';\nimport { callBackendGet, callBackendPost } from '../common/backend';\nimport { getPricesCache } from '../common/cache';\nimport { isAlive, isUpdaterAlive } from '../common/helpers';\nimport { getBaseCurrency } from '../common/prices';\nimport { addTokens, loadTokensCache } from '../common/tokens';\nimport { MINUTE } from '../constants';\nimport { resolveDataPreloadPromise } from './preload';\nimport { tryUpdateStakingCommonData } from './staking';\nimport { swapGetAssets } from './swap';\n\nconst SEC = 1000;\nconst BACKEND_INTERVAL = 30 * SEC;\nconst LONG_BACKEND_INTERVAL = 60 * SEC;\nconst INCORRECT_TIME_DIFF = 30 * SEC;\n\nconst ACCOUNT_CONFIG_INTERVAL = 60 * SEC;\nconst ACCOUNT_CONFIG_INTERVAL_INTERVAL_WHEN_NOT_FOCUSED = 10 * MINUTE;\n\nconst { ton, tron } = chains;\n\nlet onUpdate: OnApiUpdate;\n\nexport async function initPolling(_onUpdate: OnApiUpdate) {\n  onUpdate = _onUpdate;\n\n  await tryUpdatePrices();\n\n  void Promise.allSettled([\n    tryUpdateKnownAddresses(),\n    tryUpdateTokens(_onUpdate, true),\n    tryUpdateSwapTokens(_onUpdate),\n    tryUpdateStakingCommonData(),\n  ]).then(() => resolveDataPreloadPromise());\n\n  void tryUpdateConfig(_onUpdate);\n\n  void setupBackendPolling();\n  void setupLongBackendPolling();\n  if (IS_AIR_APP) {\n    void ton.setupInactiveAccountsBalancePolling(onUpdate);\n    void tron.setupInactiveAccountsBalancePolling(onUpdate);\n  }\n}\n\nexport async function setupBackendPolling() {\n  const localOnUpdate = onUpdate;\n\n  while (isUpdaterAlive(localOnUpdate)) {\n    await pauseOrFocus(BACKEND_INTERVAL);\n    if (!isUpdaterAlive(localOnUpdate)) return;\n\n    try {\n      await tryUpdatePrices(localOnUpdate);\n      await tryUpdateTokens(localOnUpdate);\n    } catch (err) {\n      logDebugError('setupBackendPolling', err);\n    }\n  }\n}\n\nexport async function setupLongBackendPolling() {\n  const localOnUpdate = onUpdate;\n\n  while (isUpdaterAlive(localOnUpdate)) {\n    await pauseOrFocus(LONG_BACKEND_INTERVAL);\n\n    await Promise.all([\n      tryUpdateKnownAddresses(),\n      tryUpdateStakingCommonData(),\n      tryUpdateConfig(localOnUpdate),\n      tryUpdateSwapTokens(localOnUpdate),\n    ]);\n  }\n}\n\nexport async function tryUpdatePrices(localOnUpdate?: OnApiUpdate) {\n  if (!localOnUpdate) {\n    localOnUpdate = onUpdate;\n  }\n\n  try {\n    const baseCurrency = await getBaseCurrency();\n    const pricesData = await callBackendGet<Record<string, ApiTokenPrice>>('/prices/current', {\n      base: baseCurrency,\n    });\n\n    if (!isUpdaterAlive(localOnUpdate)) return;\n\n    const prices = getPricesCache();\n    prices.bySlug = buildCollectionByKey(Object.values(pricesData), 'slug');\n    prices.baseCurrency = baseCurrency;\n  } catch (err) {\n    logDebugError('tryUpdatePrices', err);\n  }\n}\n\nexport async function tryUpdateTokens(localOnUpdate?: OnApiUpdate, isFirstRun?: boolean) {\n  if (!localOnUpdate) {\n    localOnUpdate = onUpdate;\n  }\n\n  if (isFirstRun) {\n    await loadTokensCache();\n  }\n\n  try {\n    let tokens = await callBackendGet<any[]>('/known-tokens');\n    tokens = tokens.map((token) => ({\n      ...omit(token, ['minterAddress']),\n      tokenAddress: token.minterAddress,\n      chain: 'ton',\n    }));\n\n    if (!isUpdaterAlive(localOnUpdate)) return;\n\n    await addTokens(tokens, onUpdate, true);\n  } catch (err) {\n    logDebugError('tryUpdateTokens', err);\n  }\n}\n\nexport async function tryUpdateSwapTokens(localOnUpdate?: OnApiUpdate) {\n  if (!localOnUpdate) {\n    localOnUpdate = onUpdate;\n  }\n\n  try {\n    const assets = await swapGetAssets();\n\n    if (!isUpdaterAlive(localOnUpdate)) return;\n\n    const prices = getPricesCache();\n    const tokens = assets.reduce((acc: Record<string, ApiSwapAsset>, asset) => {\n      acc[asset.slug] = {\n        // Fix legacy variable names\n        ...omit(asset as any, ['blockchain']) as ApiSwapAsset,\n        chain: 'blockchain' in asset ? asset.blockchain as string : asset.chain,\n        tokenAddress: 'contract' in asset && asset.contract !== TONCOIN.symbol\n          ? asset.contract as string\n          : asset.tokenAddress,\n        price: prices.bySlug[asset.slug]?.price ?? 0,\n      };\n      return acc;\n    }, {});\n\n    onUpdate({\n      type: 'updateSwapTokens',\n      tokens,\n    });\n  } catch (err) {\n    logDebugError('tryUpdateSwapTokens', err);\n  }\n}\n\nexport async function tryUpdateConfig(localOnUpdate: OnApiUpdate) {\n  try {\n    const {\n      isLimited,\n      isCopyStorageEnabled = false,\n      supportAccountsCount = 1,\n      now: serverUtc,\n      country: countryCode,\n      isUpdateRequired: isAppUpdateRequired,\n    } = await callBackendGet<{\n      isLimited: boolean;\n      isCopyStorageEnabled?: boolean;\n      supportAccountsCount?: number;\n      now: number;\n      country: ApiCountryCode;\n      isUpdateRequired: boolean;\n    }>('/utils/get-config');\n\n    if (!isUpdaterAlive(localOnUpdate)) return;\n\n    onUpdate({\n      type: 'updateConfig',\n      isLimited,\n      isCopyStorageEnabled,\n      supportAccountsCount,\n      countryCode,\n      isAppUpdateRequired,\n    });\n\n    const localUtc = (new Date()).getTime();\n    if (Math.abs(serverUtc - localUtc) > INCORRECT_TIME_DIFF) {\n      onUpdate({\n        type: 'incorrectTime',\n      });\n    }\n  } catch (err) {\n    logDebugError('tryUpdateRegion', err);\n  }\n}\n\nexport async function setupAccountConfigPolling(accountId: string, account: ApiAccountAny) {\n  let lastResult: ApiAccountConfig | undefined;\n\n  const partialAccount = omit(account as ApiAccountWithMnemonic, ['mnemonicEncrypted']);\n\n  while (isAlive(onUpdate, accountId)) {\n    try {\n      const accountConfig = await callBackendPost<ApiAccountConfig>('/account-config', partialAccount);\n\n      if (!isAlive(onUpdate, accountId)) return;\n\n      if (!areDeepEqual(accountConfig, lastResult)) {\n        lastResult = accountConfig;\n        onUpdate({\n          type: 'updateAccountConfig',\n          accountId,\n          accountConfig,\n        });\n      }\n    } catch (err) {\n      logDebugError('setupBackendAccountPolling', err);\n    }\n\n    await pauseOrFocus(ACCOUNT_CONFIG_INTERVAL, ACCOUNT_CONFIG_INTERVAL_INTERVAL_WHEN_NOT_FOCUSED);\n  }\n}\n","import type {\n  ApiActivityTimestamps, ApiChain, ApiLedgerAccount, ApiTonWallet, OnApiUpdate,\n} from '../types';\n\nimport { IS_CORE_WALLET, IS_EXTENSION } from '../../config';\nimport { parseAccountId } from '../../util/account';\nimport { getChainConfig } from '../../util/chain';\nimport { compact } from '../../util/iteratees';\nimport chains from '../chains';\nimport {\n  fetchStoredAccount,\n  fetchStoredTonWallet,\n  getActiveAccountId,\n  loginResolve,\n  setActiveAccountId,\n} from '../common/accounts';\nimport { waitStorageMigration } from '../common/helpers';\nimport { sendUpdateTokens } from '../common/tokens';\nimport { callHook } from '../hooks';\nimport { storage } from '../storages';\nimport { deactivateAccountDapp, deactivateAllDapps, onActiveDappAccountUpdated } from './dapps';\nimport { setupAccountConfigPolling } from './polling';\n\nconst { ton, tron } = chains;\n\nlet onUpdate: OnApiUpdate;\n\nexport function initAccounts(_onUpdate: OnApiUpdate) {\n  onUpdate = _onUpdate;\n}\n\nexport async function activateAccount(accountId: string, newestActivityTimestamps: ApiActivityTimestamps = {}) {\n  await waitStorageMigration();\n\n  const prevAccountId = getActiveAccountId();\n  const isFirstLogin = !prevAccountId;\n\n  setActiveAccountId(accountId);\n  await storage.setItem('currentAccountId', accountId);\n  loginResolve();\n\n  if (IS_EXTENSION) {\n    if (prevAccountId && parseAccountId(prevAccountId).network !== parseAccountId(accountId).network) {\n      deactivateAllDapps();\n    }\n\n    void callHook('onFirstLogin');\n    onActiveDappAccountUpdated(accountId);\n  }\n\n  if (isFirstLogin) {\n    sendUpdateTokens(onUpdate);\n  }\n\n  const account = await fetchStoredAccount(accountId);\n\n  if (!IS_CORE_WALLET) {\n    void setupAccountConfigPolling(accountId, account);\n  }\n\n  if ('ton' in account) {\n    const newestTonTimestamps = compact(Object.values(pickChainTimestamps(newestActivityTimestamps, 'ton')));\n    const newestActivityTimestamp = newestTonTimestamps.length ? Math.max(...newestTonTimestamps) : undefined;\n    ton.setupPolling(accountId, onUpdate, newestActivityTimestamp);\n  }\n  if ('tron' in account) {\n    void tron.setupPolling(accountId, onUpdate, pickChainTimestamps(newestActivityTimestamps, 'tron'));\n  }\n}\n\nfunction pickChainTimestamps(bySlug: ApiActivityTimestamps, chain: ApiChain) {\n  const { slug: nativeSlug } = getChainConfig(chain).nativeToken;\n  return Object.entries(bySlug).reduce((newBySlug, [slug, timestamp]) => {\n    if (slug === nativeSlug || slug.startsWith(`${chain}-`)) {\n      newBySlug[slug] = timestamp;\n    }\n    return newBySlug;\n  }, {} as ApiActivityTimestamps);\n}\n\nexport function deactivateAllAccounts() {\n  deactivateCurrentAccount();\n  setActiveAccountId(undefined);\n\n  if (IS_EXTENSION) {\n    deactivateAllDapps();\n    void callHook('onFullLogout');\n  }\n}\n\nexport function deactivateCurrentAccount() {\n  if (IS_EXTENSION) {\n    deactivateAccountDapp(getActiveAccountId()!);\n  }\n}\n\nexport function fetchTonWallet(accountId: string): Promise<ApiTonWallet> {\n  return fetchStoredTonWallet(accountId);\n}\n\nexport function fetchLedgerAccount(accountId: string) {\n  return fetchStoredAccount<ApiLedgerAccount>(accountId);\n}\n","import type { GlobalState } from '../../global/types';\nimport type { LedgerWalletInfo } from '../../util/ledger/types';\nimport type { ApiTonWalletVersion } from '../chains/ton/types';\nimport type {\n  ApiAccountAny,\n  ApiAccountWithMnemonic,\n  ApiActivityTimestamps,\n  ApiChain,\n  ApiLedgerAccount,\n  ApiNetwork,\n  ApiTonWallet,\n} from '../types';\nimport { ApiCommonError } from '../types';\n\nimport { DEFAULT_WALLET_VERSION, IS_BIP39_MNEMONIC_ENABLED, IS_CORE_WALLET } from '../../config';\nimport { buildAccountId, parseAccountId } from '../../util/account';\nimport isMnemonicPrivateKey from '../../util/isMnemonicPrivateKey';\nimport chains from '../chains';\nimport { toBase64Address } from '../chains/ton/util/tonCore';\nimport {\n  fetchStoredAccounts,\n  getNewAccountId,\n  removeAccountValue,\n  removeNetworkAccountsValue,\n  setAccountValue,\n  updateStoredAccount,\n} from '../common/accounts';\nimport {\n  decryptMnemonic, encryptMnemonic, generateBip39Mnemonic, validateBip39Mnemonic,\n} from '../common/mnemonic';\nimport { nftRepository } from '../db';\nimport { getEnvironment } from '../environment';\nimport { handleServerError } from '../errors';\nimport { storage } from '../storages';\nimport { activateAccount, deactivateAllAccounts, deactivateCurrentAccount } from './accounts';\nimport { removeAccountDapps, removeAllDapps, removeNetworkDapps } from './dapps';\n\nexport { importNewWalletVersion } from '../chains/ton';\n\nconst { ton, tron } = chains;\n\nexport function generateMnemonic(isBip39 = IS_BIP39_MNEMONIC_ENABLED) {\n  if (isBip39) return generateBip39Mnemonic();\n  return ton.generateMnemonic();\n}\n\nexport function createWallet(\n  network: ApiNetwork,\n  mnemonic: string[],\n  password: string,\n  version?: ApiTonWalletVersion,\n) {\n  if (!version) version = DEFAULT_WALLET_VERSION;\n\n  return importMnemonic(network, mnemonic, password, version);\n}\n\nexport function validateMnemonic(mnemonic: string[]) {\n  return (validateBip39Mnemonic(mnemonic) && IS_BIP39_MNEMONIC_ENABLED) || chains.ton.validateMnemonic(mnemonic);\n}\n\nexport async function importMnemonic(\n  network: ApiNetwork,\n  mnemonic: string[],\n  password: string,\n  version?: ApiTonWalletVersion,\n) {\n  const isPrivateKey = isMnemonicPrivateKey(mnemonic);\n  let isBip39Mnemonic = validateBip39Mnemonic(mnemonic);\n  const isTonMnemonic = await ton.validateMnemonic(mnemonic);\n\n  if (!isPrivateKey && !isTonMnemonic && (!isBip39Mnemonic || !IS_BIP39_MNEMONIC_ENABLED)) {\n    throw new Error('Invalid mnemonic');\n  }\n\n  const accountId: string = await getNewAccountId(network);\n  const mnemonicEncrypted = await encryptMnemonic(mnemonic, password);\n\n  // This is a defensive approach against potential corrupted encryption reported by some users\n  const decryptedMnemonic = await decryptMnemonic(mnemonicEncrypted, password)\n    .catch(() => undefined);\n\n  if (!password || !decryptedMnemonic) {\n    return { error: ApiCommonError.DebugError };\n  }\n\n  let account: ApiAccountAny;\n  let tonWallet: ApiTonWallet & { lastTxId?: string } | undefined;\n  let tonAddress: string;\n  let tronAddress: string | undefined;\n\n  try {\n    if (isBip39Mnemonic && isTonMnemonic) {\n      tonWallet = await ton.getWalletFromMnemonic(mnemonic, network, version);\n      if (tonWallet.lastTxId) {\n        isBip39Mnemonic = false;\n      }\n    }\n\n    if (isBip39Mnemonic) {\n      const tronWallet = tron.getWalletFromBip39Mnemonic(network, mnemonic);\n      tonWallet = await ton.getWalletFromBip39Mnemonic(network, mnemonic);\n\n      tonAddress = tonWallet.address;\n      tronAddress = tronWallet.address;\n      account = {\n        type: 'bip39',\n        mnemonicEncrypted,\n        tron: tronWallet,\n        ton: tonWallet,\n      };\n    } else {\n      if (!tonWallet) {\n        tonWallet = isPrivateKey\n          ? await ton.getWalletFromPrivateKey(mnemonic[0], network, version)\n          : await ton.getWalletFromMnemonic(mnemonic, network, version);\n      }\n      account = {\n        type: 'ton',\n        mnemonicEncrypted,\n        ton: tonWallet,\n      };\n      tonAddress = tonWallet.address;\n    }\n\n    await setAccountValue(accountId, 'accounts', account);\n    const secondNetworkAccount = IS_CORE_WALLET ? await createAccountWithSecondNetwork({\n      accountId, network, mnemonic, mnemonicEncrypted, version,\n    }) : undefined;\n    void activateAccount(accountId);\n\n    return {\n      accountId,\n      tonAddress,\n      tronAddress,\n      secondNetworkAccount,\n    };\n  } catch (err) {\n    return handleServerError(err);\n  }\n}\n\nexport async function createAccountWithSecondNetwork(options: {\n  accountId: string;\n  network: ApiNetwork;\n  mnemonic: string[];\n  mnemonicEncrypted: string;\n  version?: ApiTonWalletVersion;\n}): Promise<GlobalState['auth']['secondNetworkAccount']> {\n  const {\n    mnemonic, version, mnemonicEncrypted,\n  } = options;\n  const { network, accountId } = options;\n  const tonWallet = await ton.getWalletFromMnemonic(mnemonic, network, version);\n\n  const secondNetwork = network === 'testnet' ? 'mainnet' : 'testnet';\n  const secondAccountId = buildAccountId({ ...parseAccountId(accountId), network: secondNetwork });\n  tonWallet.address = toBase64Address(tonWallet.address, false, secondNetwork);\n  const account = {\n    type: 'ton',\n    mnemonicEncrypted,\n    ton: tonWallet,\n  };\n  await setAccountValue(secondAccountId, 'accounts', account);\n\n  return {\n    accountId: secondAccountId,\n    addressByChain: { ton: tonWallet.address } as Record<ApiChain, string>,\n    network: secondNetwork,\n  };\n}\n\nexport async function importLedgerWallet(network: ApiNetwork, walletInfo: LedgerWalletInfo) {\n  const accountId: string = await getNewAccountId(network);\n  const {\n    publicKey, address, index, driver, deviceId, deviceName, version,\n  } = walletInfo;\n\n  await storeHardwareAccount(accountId, {\n    type: 'ledger',\n    ton: {\n      type: 'ton',\n      address,\n      publicKey,\n      version,\n      index,\n    },\n    driver,\n    deviceId,\n    deviceName,\n  });\n\n  return { accountId, address, walletInfo };\n}\n\nfunction storeHardwareAccount(accountId: string, account?: ApiLedgerAccount) {\n  return setAccountValue(accountId, 'accounts', account);\n}\n\nexport async function removeNetworkAccounts(network: ApiNetwork) {\n  deactivateAllAccounts();\n\n  await Promise.all([\n    removeNetworkAccountsValue(network, 'accounts'),\n    getEnvironment().isDappSupported && removeNetworkDapps(network),\n  ]);\n}\n\nexport async function resetAccounts() {\n  deactivateAllAccounts();\n\n  await Promise.all([\n    storage.removeItem('accounts'),\n    storage.removeItem('currentAccountId'),\n    getEnvironment().isDappSupported && removeAllDapps(),\n    nftRepository.clear(),\n  ]);\n}\n\nexport async function removeAccount(\n  accountId: string,\n  nextAccountId: string,\n  newestActivityTimestamps?: ApiActivityTimestamps,\n) {\n  await Promise.all([\n    removeAccountValue(accountId, 'accounts'),\n    getEnvironment().isDappSupported && removeAccountDapps(accountId),\n    nftRepository.deleteWhere({ accountId }),\n  ]);\n\n  deactivateCurrentAccount();\n  await activateAccount(nextAccountId, newestActivityTimestamps);\n}\n\nexport async function changePassword(oldPassword: string, password: string) {\n  for (const [accountId, account] of Object.entries(await fetchStoredAccounts())) {\n    if (!('mnemonicEncrypted' in account)) continue;\n\n    const mnemonic = await decryptMnemonic(account.mnemonicEncrypted, oldPassword);\n    const encryptedMnemonic = await encryptMnemonic(mnemonic, password);\n\n    await updateStoredAccount<ApiAccountWithMnemonic>(accountId, {\n      mnemonicEncrypted: encryptedMnemonic,\n    });\n  }\n}\n","import generateUniqueId from '../../util/generateUniqueId';\nimport { ApiUserRejectsError } from '../errors';\n\nconst deferreds = new Map<string, Deferred>();\n\nclass Deferred<T = any> {\n  resolve!: AnyToVoidFunction;\n\n  reject!: AnyToVoidFunction;\n\n  promise = new Promise<T>((resolve, reject) => {\n    this.resolve = resolve;\n    this.reject = reject;\n  });\n}\n\nexport function createDappPromise(promiseId = generateUniqueId()) {\n  const deferred = new Deferred();\n\n  deferreds.set(promiseId, deferred);\n\n  const { promise } = deferred;\n\n  return { promiseId, promise };\n}\n\nexport function resolveDappPromise(promiseId: string, value?: any) {\n  const deferred = deferreds.get(promiseId);\n  if (!deferred) {\n    return;\n  }\n\n  deferred.resolve(value);\n  deferreds.delete(promiseId);\n}\n\nexport function rejectDappPromise(promiseId: string, reason: string = 'Unknown rejection reason') {\n  const deferred = deferreds.get(promiseId);\n  if (!deferred) {\n    return;\n  }\n\n  deferred.reject(new ApiUserRejectsError(reason));\n  deferreds.delete(promiseId);\n}\n\nexport function rejectAllDappPromises(message: string) {\n  Array.from(deferreds.keys()).forEach((id) => {\n    rejectDappPromise(id, message);\n  });\n}\n","import * as tonWebMnemonic from 'tonweb-mnemonic';\n\nimport type { ApiAccountWithMnemonic, ApiChain, ApiNetwork } from '../types';\n\nimport { parseAccountId } from '../../util/account';\nimport chains from '../chains';\nimport { fetchPrivateKey as fetchTonPrivateKey } from '../chains/ton';\nimport {\n  fetchStoredAccount,\n  fetchStoredAddress,\n  fetchStoredTonWallet,\n  getAccountWithMnemonic,\n} from '../common/accounts';\nimport * as dappPromises from '../common/dappPromises';\nimport { getMnemonic } from '../common/mnemonic';\n\nconst ton = chains.ton;\n\nexport async function fetchPrivateKey(accountId: string, password: string) {\n  const account = await fetchStoredAccount<ApiAccountWithMnemonic>(accountId);\n  const privateKey = await fetchTonPrivateKey(accountId, password, account);\n\n  return Buffer.from(privateKey!).toString('hex');\n}\n\nexport async function fetchMnemonic(accountId: string, password: string) {\n  const account = await fetchStoredAccount<ApiAccountWithMnemonic>(accountId);\n  return getMnemonic(accountId, password, account);\n}\n\nexport function getMnemonicWordList() {\n  return tonWebMnemonic.wordlists.default;\n}\n\nexport async function verifyPassword(password: string) {\n  const [accountId, account] = (await getAccountWithMnemonic()) ?? [];\n  if (!accountId || !account) {\n    throw new Error('The user is not authorized in the wallet');\n  }\n\n  return Boolean(await getMnemonic(accountId, password, account));\n}\n\nexport function confirmDappRequest(promiseId: string, data: any) {\n  dappPromises.resolveDappPromise(promiseId, data);\n}\n\nexport function confirmDappRequestConnect(promiseId: string, data: {\n  password?: string;\n  accountId?: string;\n  signature?: string;\n}) {\n  dappPromises.resolveDappPromise(promiseId, data);\n}\n\nexport function cancelDappRequest(promiseId: string, reason?: string) {\n  dappPromises.rejectDappPromise(promiseId, reason);\n}\n\nexport async function getWalletSeqno(accountId: string, address?: string) {\n  const { network } = parseAccountId(accountId);\n  if (!address) {\n    ({ address } = await fetchStoredTonWallet(accountId));\n  }\n  return ton.getWalletSeqno(network, address);\n}\n\nexport function fetchAddress(accountId: string, chain: ApiChain) {\n  return fetchStoredAddress(accountId, chain);\n}\n\nexport function isWalletInitialized(network: ApiNetwork, address: string) {\n  const chain = chains.ton;\n\n  return chain.isAddressInitialized(network, address);\n}\n\nexport function getWalletBalance(chain: ApiChain, network: ApiNetwork, address: string) {\n  return chains[chain].getWalletBalance(network, address);\n}\n\nexport function getContractInfo(network: ApiNetwork, address: string) {\n  const chain = chains.ton;\n\n  return chain.getContractInfo(network, address);\n}\n\nexport function getWalletInfo(network: ApiNetwork, address: string) {\n  const chain = chains.ton;\n\n  return chain.getWalletInfo(network, address);\n}\n","import type { ApiNft } from '../types';\n\nimport { TONCOIN } from '../../config';\nimport { bigintDivideToNumber } from '../../util/bigint';\nimport chains from '../chains';\nimport { fetchStoredTonWallet } from '../common/accounts';\nimport { createLocalTransaction } from './transactions';\n\nconst { ton } = chains;\n\nexport function fetchNfts(accountId: string) {\n  return ton.getAccountNfts(accountId);\n}\n\nexport function checkNftTransferDraft(options: {\n  accountId: string;\n  nfts: ApiNft[];\n  toAddress: string;\n  comment?: string;\n}) {\n  return ton.checkNftTransferDraft(options);\n}\n\nexport async function submitNftTransfers(\n  accountId: string,\n  password: string,\n  nfts: ApiNft[],\n  toAddress: string,\n  comment?: string,\n  totalRealFee = 0n,\n) {\n  const { address: fromAddress } = await fetchStoredTonWallet(accountId);\n\n  const result = await ton.submitNftTransfers({\n    accountId, password, nfts, toAddress, comment,\n  });\n\n  if ('error' in result) {\n    return result;\n  }\n\n  const realFeePerNft = bigintDivideToNumber(totalRealFee, Object.keys(result.messages).length);\n\n  for (const [index, message] of result.messages.entries()) {\n    createLocalTransaction(accountId, 'ton', {\n      amount: 0n, // Regular NFT transfers should have no amount in the activity list\n      fromAddress,\n      toAddress,\n      comment,\n      fee: realFeePerNft,\n      normalizedAddress: message.toAddress,\n      slug: TONCOIN.slug,\n      externalMsgHash: result.msgHash,\n      nft: nfts?.[index],\n    }, index);\n  }\n\n  return result;\n}\n\nexport function checkNftOwnership(accountId: string, nftAddress: string) {\n  return ton.checkNftOwnership(accountId, nftAddress);\n}\n","import type { CHAIN, ConnectEventError, ConnectEventSuccess } from '@tonconnect/protocol';\n\nexport interface TransactionPayload {\n  valid_until?: number;\n  network?: CHAIN;\n  from?: string; // https://github.com/ton-blockchain/ton-connect/blob/main/wallet-guidelines.md#multi-accounts\n  messages: TransactionPayloadMessage[];\n}\n\nexport interface TransactionPayloadMessage {\n  address: string;\n  amount: string;\n  payload?: string;\n  stateInit?: string;\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport enum CONNECT_EVENT_ERROR_CODES {\n  UNKNOWN_ERROR = 0,\n  BAD_REQUEST_ERROR = 1,\n  MANIFEST_NOT_FOUND_ERROR = 2,\n  MANIFEST_CONTENT_ERROR = 3,\n  UNKNOWN_APP_ERROR = 100,\n  USER_REJECTS_ERROR = 300,\n  METHOD_NOT_SUPPORTED = 400,\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport enum SEND_TRANSACTION_ERROR_CODES {\n  UNKNOWN_ERROR = 0,\n  BAD_REQUEST_ERROR = 1,\n  UNKNOWN_APP_ERROR = 100,\n  USER_REJECTS_ERROR = 300,\n  METHOD_NOT_SUPPORTED = 400,\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport enum SIGN_DATA_ERROR_CODES {\n  UNKNOWN_ERROR = 0,\n  BAD_REQUEST_ERROR = 1,\n  UNKNOWN_APP_ERROR = 100,\n  USER_REJECTS_ERROR = 300,\n  METHOD_NOT_SUPPORTED = 400,\n}\n\nexport type AllErrorCodes = CONNECT_EVENT_ERROR_CODES | SEND_TRANSACTION_ERROR_CODES | SIGN_DATA_ERROR_CODES;\nexport type ConnectEvent = ConnectEventSuccess | ConnectEventError;\n\nexport interface ApiTonConnectProof {\n  timestamp: number;\n  domain: string;\n  payload: string;\n}\n","import type { DeviceInfo } from '@tonconnect/protocol';\n\nimport {\n  APP_NAME, IS_EXTENSION, IS_TELEGRAM_APP, TONCONNECT_PROTOCOL_VERSION,\n} from '../config';\nimport packageJson from '../../package.json';\nimport { W5_MAX_MESSAGES } from '../api/chains/ton/constants';\n\ntype DevicePlatform = DeviceInfo['platform'];\n\n/*\n This function is called in TonConnect `connect` method (where we know the wallet version)\n and in JS Bridge (where no account is selected, so we show maximum number of messages).\n*/\nexport function tonConnectGetDeviceInfo(maxMessages = W5_MAX_MESSAGES): DeviceInfo {\n  return {\n    platform: getPlatform()!,\n    appName: APP_NAME,\n    appVersion: packageJson.version,\n    maxProtocolVersion: TONCONNECT_PROTOCOL_VERSION,\n    features: [\n      'SendTransaction', // TODO DEPRECATED\n      { name: 'SendTransaction', maxMessages },\n    ],\n  };\n}\n\nfunction getPlatform(): DevicePlatform {\n  const { userAgent } = navigator;\n  const platform = navigator.platform || navigator?.userAgentData?.platform || '';\n\n  const macosPlatforms = ['macOS', 'Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'];\n  const windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'];\n  const iphonePlatforms = ['iPhone'];\n  const ipadPlatforms = ['iPad', 'iPod'];\n\n  let devicePlatform: DevicePlatform | undefined;\n\n  if (IS_EXTENSION || IS_TELEGRAM_APP) {\n    devicePlatform = 'browser';\n  } else if (/Android/.test(userAgent)) {\n    devicePlatform = 'android';\n  } else if (iphonePlatforms.indexOf(platform) !== -1) {\n    devicePlatform = 'iphone';\n  } else if (ipadPlatforms.indexOf(platform) !== -1) {\n    devicePlatform = 'ipad';\n  } else if (macosPlatforms.indexOf(platform) !== -1) {\n    devicePlatform = 'mac';\n  } else if (windowsPlatforms.indexOf(platform) !== -1) {\n    devicePlatform = 'windows';\n  } else if (/Linux/.test(platform)) {\n    devicePlatform = 'linux';\n  } else {\n    devicePlatform = 'browser';\n  }\n\n  return devicePlatform;\n}\n","// eslint-disable-next-line max-classes-per-file\nimport type { ApiAnyDisplayError } from '../types';\nimport type { AllErrorCodes } from './types';\nimport { ApiTransactionError } from '../types';\nimport { CONNECT_EVENT_ERROR_CODES } from './types';\n\nimport { ApiBaseError } from '../errors';\n\nexport class TonConnectError extends ApiBaseError {\n  code: number;\n\n  constructor(message: string, code: AllErrorCodes = 0, displayError?: ApiAnyDisplayError) {\n    super(message);\n    this.code = code;\n    this.displayError = displayError;\n  }\n}\n\nexport class ManifestContentError extends TonConnectError {\n  constructor(message = 'Manifest content error') {\n    super(message, CONNECT_EVENT_ERROR_CODES.MANIFEST_CONTENT_ERROR);\n  }\n}\n\nexport class UnknownError extends TonConnectError {\n  constructor(message = 'Unknown error.') {\n    super(message, 0);\n  }\n}\n\nexport class BadRequestError extends TonConnectError {\n  constructor(message = 'Bad request', displayError?: ApiAnyDisplayError) {\n    super(message, 1, displayError);\n  }\n}\n\nexport class UnknownAppError extends TonConnectError {\n  constructor(message = 'Unknown app error') {\n    super(message, 100);\n  }\n}\n\nexport class UserRejectsError extends TonConnectError {\n  constructor(message = 'The user rejected the action') {\n    super(message, 300);\n  }\n}\n\nexport class InsufficientBalance extends BadRequestError {\n  constructor(message = 'Insufficient balance') {\n    super(message, ApiTransactionError.InsufficientBalance);\n  }\n}\n","import type { ApiDappTransfer, ApiParsedPayload } from '../types';\n\nimport { isNftTransferPayload, isTokenTransferPayload } from '../../util/ton/transfer';\nimport { ONE_TON } from '../chains/ton/constants';\n\nconst MAX_SINGLE_AMOUNT_AS_FEE = 1n * ONE_TON;\nconst MAX_TOTAL_AMOUNT_AS_FEE = 3n * ONE_TON;\n// https://stackoverflow.com/a/417184\nconst URL_MAX_LENGTH = 2000;\n\nexport function isValidString(value: any, maxLength = 100) {\n  return typeof value === 'string' && value.length <= maxLength;\n}\n\nexport function isValidUrl(url: string) {\n  const isString = isValidString(url, URL_MAX_LENGTH);\n  if (!isString) return false;\n\n  try {\n    // eslint-disable-next-line no-new\n    new URL(url);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n\nexport function getTransferActualToAddress(toAddress: string, payload: ApiParsedPayload | undefined) {\n  // This function implementation is not complete. That is, other transfer types may have another actual \"to\" address.\n  if (isNftTransferPayload(payload)) {\n    return payload.newOwner;\n  }\n  if (isTokenTransferPayload(payload)) {\n    return payload.destination;\n  }\n  return toAddress;\n}\n\nexport function isTransferPayloadDangerous(payload: ApiParsedPayload | undefined) {\n  return payload?.type === 'unknown';\n}\n\n/**\n * If applicable and safe, makes the transfers' amounts act as a fee. Returns a mapped list of the given dapp transfers.\n */\nexport function showDappTransferAmountsAsFee(transfers: ApiDappTransfer[]) {\n  // Large TON amounts should be shown as a fee, because the fee is barely noticeable in the UI. This function doesn't\n  // consider the emulated `received` amount, because it's not reliable and can be tampered by scammers.\n\n  const totalAmountAsFee = transfers.reduce((sum, transfer) => (\n    sum + (shouldShowTransferAmountAsFee(transfer) ? transfer.displayedAmount : 0n)\n  ), 0n);\n\n  if (totalAmountAsFee === 0n || totalAmountAsFee > MAX_TOTAL_AMOUNT_AS_FEE) {\n    return transfers;\n  }\n\n  return transfers.map((transfer) => {\n    if (!shouldShowTransferAmountAsFee(transfer)) {\n      return transfer;\n    }\n    return {\n      ...transfer,\n      displayedAmount: 0n,\n      fullFee: transfer.fullFee + transfer.displayedAmount,\n    };\n  });\n}\n\nfunction shouldShowTransferAmountAsFee({ amount, payload }: ApiDappTransfer) {\n  return amount <= MAX_SINGLE_AMOUNT_AS_FEE\n    && (isNftTransferPayload(payload) || isTokenTransferPayload(payload));\n}\n","/* TonConnect specification https://github.com/ton-blockchain/ton-connect */\n\nimport { Address, Cell } from '@ton/core';\nimport type {\n  ConnectEventError,\n  ConnectItemReply,\n  ConnectRequest,\n  DisconnectRpcRequest,\n  DisconnectRpcResponse,\n  SendTransactionRpcRequest,\n  SendTransactionRpcResponse,\n  SignDataRpcRequest,\n  TonProofItem,\n  TonProofItemReplySuccess,\n} from '@tonconnect/protocol';\nimport { CHAIN } from '@tonconnect/protocol';\nimport nacl from 'tweetnacl';\n\nimport type { ApiCheckMultiTransactionDraftResult, TonTransferParams } from '../chains/ton/types';\nimport type {\n  ApiAccountAny,\n  ApiAccountWithMnemonic,\n  ApiAnyDisplayError,\n  ApiDappMetadata,\n  ApiDappRequest,\n  ApiDappTransfer,\n  ApiNetwork,\n  ApiSignedTransfer,\n  ApiTonWallet,\n  OnApiUpdate,\n} from '../types';\nimport type {\n  ApiTonConnectProof, ConnectEvent, TransactionPayload, TransactionPayloadMessage,\n} from './types';\nimport { ApiCommonError, ApiTransactionError } from '../types';\nimport { CONNECT_EVENT_ERROR_CODES, SEND_TRANSACTION_ERROR_CODES, SIGN_DATA_ERROR_CODES } from './types';\n\nimport { IS_EXTENSION, TONCOIN } from '../../config';\nimport { parseAccountId } from '../../util/account';\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport { bigintDivideToNumber } from '../../util/bigint';\nimport { logDebugError } from '../../util/logs';\nimport { fetchJsonMetadata } from '../../util/metadata';\nimport safeExec from '../../util/safeExec';\nimport { tonConnectGetDeviceInfo } from '../../util/tonConnectEnvironment';\nimport chains from '../chains';\nimport { getContractInfo, parsePayloadBase64 } from '../chains/ton';\nimport { fetchKeyPair } from '../chains/ton/auth';\nimport { DEFAULT_MAX_MESSAGES, LEDGER_MAX_MESSAGES, W5_MAX_MESSAGES } from '../chains/ton/constants';\nimport {\n  getIsRawAddress, getWalletPublicKey, toBase64Address, toRawAddress,\n} from '../chains/ton/util/tonCore';\nimport {\n  fetchStoredAccount,\n  getCurrentAccountId,\n  getCurrentAccountIdOrFail,\n} from '../common/accounts';\nimport { getKnownAddressInfo } from '../common/addresses';\nimport { createDappPromise } from '../common/dappPromises';\nimport { isUpdaterAlive } from '../common/helpers';\nimport { bytesToBase64, hexToBytes, sha256 } from '../common/utils';\nimport * as apiErrors from '../errors';\nimport { ApiServerError } from '../errors';\nimport { callHook } from '../hooks';\nimport {\n  activateDapp,\n  addDapp,\n  deactivateAccountDapp,\n  deactivateDapp,\n  deleteDapp,\n  findLastConnectedAccount,\n  getDapp,\n  getDappsByOrigin,\n  updateDapp,\n} from '../methods/dapps';\nimport { createLocalTransaction } from '../methods/transactions';\nimport * as errors from './errors';\nimport { UnknownAppError } from './errors';\nimport {\n  getTransferActualToAddress,\n  isTransferPayloadDangerous,\n  isValidString,\n  isValidUrl,\n  showDappTransferAmountsAsFee,\n} from './utils';\n\nconst BLANK_GIF_DATA_URL = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n\nconst ton = chains.ton;\n\nlet resolveInit: AnyFunction;\nconst initPromise = new Promise((resolve) => {\n  resolveInit = resolve;\n});\n\nlet onPopupUpdate: OnApiUpdate;\n\nexport function initTonConnect(_onPopupUpdate: OnApiUpdate) {\n  onPopupUpdate = _onPopupUpdate;\n  resolveInit();\n}\n\nexport async function connect(request: ApiDappRequest, message: ConnectRequest, id: number): Promise<ConnectEvent> {\n  try {\n    await openExtensionPopup(true);\n\n    onPopupUpdate({\n      type: 'dappLoading',\n      connectionType: 'connect',\n      isSse: request && 'sseOptions' in request,\n    });\n\n    const dappMetadata = await fetchDappMetadata(message.manifestUrl);\n\n    if (!IS_EXTENSION) {\n      request.origin = dappMetadata.origin;\n    }\n\n    const { origin } = await validateRequest(request, true);\n\n    const addressItem = message.items.find(({ name }) => name === 'ton_addr');\n    const proofItem = message.items.find(({ name }) => name === 'ton_proof') as TonProofItem | undefined;\n    const proof = proofItem ? {\n      timestamp: Math.round(Date.now() / 1000),\n      domain: new URL(origin).host,\n      payload: proofItem.payload,\n    } : undefined;\n\n    if (!addressItem) {\n      throw new errors.BadRequestError(\"Missing 'ton_addr'\");\n    }\n\n    if (proof && !proof.domain.includes('.')) {\n      throw new errors.BadRequestError('Invalid domain');\n    }\n\n    let accountId = await getCurrentAccountOrFail();\n\n    const { promiseId, promise } = createDappPromise();\n\n    const dapp = {\n      ...dappMetadata,\n      origin,\n      connectedAt: Date.now(),\n      ...('sseOptions' in request && {\n        sse: request.sseOptions,\n      }),\n    };\n\n    onPopupUpdate({\n      type: 'dappConnect',\n      identifier: 'identifier' in request ? request.identifier : undefined,\n      promiseId,\n      accountId,\n      dapp,\n      permissions: {\n        address: true,\n        proof: !!proof,\n      },\n      proof,\n    });\n\n    const promiseResult: {\n      accountId?: string;\n      password?: string;\n      signature?: string;\n    } | undefined = await promise;\n\n    accountId = promiseResult!.accountId!;\n    request.accountId = accountId;\n    await addDapp(accountId, dapp);\n    activateDapp(accountId, origin);\n\n    const account = await fetchStoredAccount(accountId);\n    const { address } = account.ton;\n\n    const maxMessages = getMaxMessages(account);\n    const deviceInfo = tonConnectGetDeviceInfo(maxMessages);\n    const items: ConnectItemReply[] = [\n      await buildTonAddressReplyItem(accountId, account.ton),\n    ];\n\n    if (proof) {\n      const { password, signature } = promiseResult!;\n\n      let proofReplyItem: TonProofItemReplySuccess;\n      if (password) {\n        proofReplyItem = await signTonProof(accountId, account as ApiAccountWithMnemonic, password, address, proof!);\n      } else {\n        proofReplyItem = buildTonProofReplyItem(proof, signature!);\n      }\n\n      items.push(proofReplyItem);\n    }\n\n    onPopupUpdate({ type: 'updateDapps' });\n    onPopupUpdate({ type: 'dappConnectComplete' });\n\n    return {\n      event: 'connect',\n      id,\n      payload: {\n        items,\n        device: deviceInfo,\n      },\n    };\n  } catch (err) {\n    logDebugError('tonConnect:connect', err);\n\n    safeExec(() => {\n      onPopupUpdate({\n        type: 'dappCloseLoading',\n      });\n    });\n\n    return formatConnectError(id, err as Error);\n  }\n}\n\nexport async function reconnect(request: ApiDappRequest, id: number): Promise<ConnectEvent> {\n  try {\n    const { origin, accountId } = await validateRequest(request);\n\n    activateDapp(accountId, origin);\n    const currentDapp = await getDapp(accountId, origin);\n    if (!currentDapp) {\n      throw new UnknownAppError();\n    }\n\n    await updateDapp(accountId, origin, { connectedAt: Date.now() });\n\n    const account = await fetchStoredAccount<ApiAccountWithMnemonic>(accountId);\n\n    const maxMessages = getMaxMessages(account);\n    const deviceInfo = tonConnectGetDeviceInfo(maxMessages);\n    const items: ConnectItemReply[] = [\n      await buildTonAddressReplyItem(accountId, account.ton),\n    ];\n\n    return {\n      event: 'connect',\n      id,\n      payload: {\n        items,\n        device: deviceInfo,\n      },\n    };\n  } catch (e) {\n    logDebugError('tonConnect:reconnect', e);\n    return formatConnectError(id, e as Error);\n  }\n}\n\nfunction getMaxMessages(account: ApiAccountAny) {\n  const { type, ton: { version } } = account;\n\n  if (type === 'ledger') {\n    return LEDGER_MAX_MESSAGES;\n  } else if (version === 'W5') {\n    return W5_MAX_MESSAGES;\n  } else {\n    return DEFAULT_MAX_MESSAGES;\n  }\n}\n\nexport async function disconnect(\n  request: ApiDappRequest,\n  message: DisconnectRpcRequest,\n): Promise<DisconnectRpcResponse> {\n  try {\n    const { origin, accountId } = await validateRequest(request);\n\n    await deleteDapp(accountId, origin, true);\n    deactivateAccountDapp(accountId);\n    onPopupUpdate({ type: 'updateDapps' });\n  } catch (err) {\n    logDebugError('tonConnect:disconnect', err);\n  }\n  return {\n    id: message.id,\n    result: {},\n  };\n}\n\nexport async function sendTransaction(\n  request: ApiDappRequest,\n  message: SendTransactionRpcRequest,\n): Promise<SendTransactionRpcResponse> {\n  try {\n    const { origin, accountId } = await validateRequest(request);\n    const { network } = parseAccountId(accountId);\n\n    const txPayload = JSON.parse(message.params[0]) as TransactionPayload;\n    const { messages, network: dappNetworkRaw } = txPayload;\n\n    const account = await fetchStoredAccount(accountId);\n    const {\n      type, ton: {\n        address,\n        publicKey: publicKeyHex,\n      },\n    } = account;\n\n    const maxMessages = getMaxMessages(account);\n\n    if (messages.length > maxMessages) {\n      throw new errors.BadRequestError(`Payload contains more than ${maxMessages} messages, which exceeds limit`);\n    }\n\n    const dappNetwork = dappNetworkRaw\n      ? (dappNetworkRaw === CHAIN.MAINNET ? 'mainnet' : 'testnet')\n      : undefined;\n    let validUntil = txPayload.valid_until;\n    if (validUntil && validUntil > 10 ** 10) {\n      // If milliseconds were passed instead of seconds\n      validUntil = Math.round(validUntil / 1000);\n    }\n\n    const isLedger = type === 'ledger';\n\n    let vestingAddress: string | undefined;\n\n    if (txPayload.from && toBase64Address(txPayload.from) !== toBase64Address(address)) {\n      const publicKey = hexToBytes(publicKeyHex);\n      if (isLedger && await checkIsHisVestingWallet(network, publicKey, txPayload.from)) {\n        vestingAddress = txPayload.from;\n      } else {\n        throw new errors.BadRequestError(undefined, ApiTransactionError.WrongAddress);\n      }\n    }\n\n    if (dappNetwork && network !== dappNetwork) {\n      throw new errors.BadRequestError(undefined, ApiTransactionError.WrongNetwork);\n    }\n\n    await openExtensionPopup(true);\n\n    onPopupUpdate({\n      type: 'dappLoading',\n      connectionType: 'sendTransaction',\n      accountId,\n      isSse: Boolean('sseOptions' in request && request.sseOptions),\n    });\n\n    const {\n      preparedMessages,\n      checkResult,\n    } = await checkTransactionMessages(accountId, messages, network);\n\n    if ('error' in checkResult) {\n      throw new errors.BadRequestError(checkResult.error, checkResult.error);\n    }\n\n    const dapp = (await getDappsByOrigin(accountId))[origin];\n    const transactionsForRequest = await prepareTransactionForRequest(network, messages, checkResult);\n\n    const { promiseId, promise } = createDappPromise();\n\n    onPopupUpdate({\n      type: 'dappSendTransactions',\n      promiseId,\n      accountId,\n      dapp,\n      transactions: transactionsForRequest,\n      vestingAddress,\n    });\n\n    // eslint-disable-next-line prefer-const\n    const response: string | ApiSignedTransfer[] = await promise;\n\n    if (validUntil && validUntil < (Date.now() / 1000)) {\n      throw new errors.BadRequestError('The confirmation timeout has expired');\n    }\n\n    let boc: string | undefined;\n    let error: string | undefined;\n    let msgHash: string | undefined;\n\n    if (isLedger) {\n      const signedTransfers = response as ApiSignedTransfer[];\n      const submitResult = await ton.sendSignedMessages(accountId, signedTransfers);\n      boc = submitResult.firstBoc;\n      msgHash = submitResult.msgHashes[0];\n\n      if (submitResult.successNumber > 0) {\n        if (submitResult.successNumber < messages.length) {\n          onPopupUpdate({\n            type: 'showError',\n            error: ApiTransactionError.PartialTransactionFailure,\n          });\n        }\n      } else {\n        error = 'Failed transfers';\n      }\n    } else {\n      const password = response as string;\n      const submitResult = await ton.submitMultiTransfer({\n        accountId, password, messages: preparedMessages, expireAt: validUntil,\n      });\n      if ('error' in submitResult) {\n        error = submitResult.error;\n      } else {\n        ({ boc, msgHash } = submitResult);\n      }\n    }\n\n    if (error) {\n      throw new errors.UnknownError(error);\n    }\n\n    transactionsForRequest.forEach(({ amount, normalizedAddress, payload }, index) => {\n      const comment = payload?.type === 'comment' ? payload.comment : undefined;\n      createLocalTransaction(accountId, 'ton', {\n        amount,\n        fromAddress: address,\n        toAddress: normalizedAddress,\n        comment,\n        fee: checkResult.fee!,\n        slug: TONCOIN.slug,\n        externalMsgHash: msgHash,\n      }, index);\n    });\n\n    return {\n      result: boc!,\n      id: message.id,\n    };\n  } catch (err) {\n    logDebugError('tonConnect:sendTransaction', err);\n\n    safeExec(() => {\n      onPopupUpdate({\n        type: 'dappCloseLoading',\n      });\n    });\n\n    let code = SEND_TRANSACTION_ERROR_CODES.UNKNOWN_ERROR;\n    let errorMessage = 'Unhandled error';\n    let displayError: ApiAnyDisplayError | undefined;\n\n    if (err instanceof apiErrors.ApiUserRejectsError) {\n      code = SEND_TRANSACTION_ERROR_CODES.USER_REJECTS_ERROR;\n      errorMessage = err.message;\n    } else if (err instanceof errors.TonConnectError) {\n      code = err.code;\n      errorMessage = err.message;\n      displayError = err.displayError;\n    } else if (err instanceof ApiServerError) {\n      displayError = err.displayError;\n    } else {\n      displayError = ApiCommonError.Unexpected;\n    }\n\n    if (onPopupUpdate && isUpdaterAlive(onPopupUpdate) && displayError) {\n      onPopupUpdate({\n        type: 'showError',\n        error: displayError,\n      });\n    }\n    return {\n      error: {\n        code,\n        message: errorMessage,\n      },\n      id: message.id,\n    };\n  }\n}\n\nasync function checkIsHisVestingWallet(network: ApiNetwork, ownerPublicKey: Uint8Array, address: string) {\n  const [info, publicKey] = await Promise.all([\n    getContractInfo(network, address),\n    getWalletPublicKey(network, address),\n  ]);\n\n  return info.contractInfo?.name === 'vesting' && areDeepEqual(ownerPublicKey, publicKey);\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport function signData(request: ApiDappRequest, message: SignDataRpcRequest) {\n  return {\n    error: {\n      code: SIGN_DATA_ERROR_CODES.METHOD_NOT_SUPPORTED,\n      message: 'Method not supported',\n    },\n    id: message.id,\n  };\n}\n\nasync function checkTransactionMessages(\n  accountId: string,\n  messages: TransactionPayloadMessage[],\n  network: ApiNetwork,\n) {\n  const preparedMessages: TonTransferParams[] = messages.map((msg) => {\n    const {\n      address: toAddress,\n      amount,\n      payload,\n      stateInit,\n    } = msg;\n\n    return {\n      toAddress: getIsRawAddress(toAddress)\n        ? toBase64Address(toAddress, true, network)\n        : toAddress,\n      amount: BigInt(amount),\n      payload: payload ? Cell.fromBase64(payload) : undefined,\n      stateInit: stateInit ? Cell.fromBase64(stateInit) : undefined,\n    };\n  });\n\n  const checkResult = await ton.checkMultiTransactionDraft(accountId, preparedMessages, false, true);\n\n  return {\n    preparedMessages,\n    checkResult,\n  };\n}\n\nasync function prepareTransactionForRequest(\n  network: ApiNetwork,\n  messages: TransactionPayloadMessage[],\n  checkResult: ApiCheckMultiTransactionDraftResult,\n) {\n  if (!checkResult.emulation && checkResult.fee === undefined) {\n    throw new Error('Both `emulation` and `fee` miss in the check result');\n  }\n\n  const transactions = await Promise.all(messages.map(\n    async ({\n      address,\n      amount: rawAmount,\n      payload: rawPayload,\n      stateInit,\n    }, index): Promise<ApiDappTransfer> => {\n      const amount = BigInt(rawAmount);\n      const toAddress = getIsRawAddress(address) ? toBase64Address(address, true, network) : address;\n      // Fix address format for `waitTxComplete` to work properly\n      const normalizedAddress = toBase64Address(address, undefined, network);\n      const payload = rawPayload ? await parsePayloadBase64(network, toAddress, rawPayload) : undefined;\n      const { isScam } = getKnownAddressInfo(normalizedAddress) || {};\n      const emulationResult = checkResult.emulation?.byTransactionIndex[index];\n\n      return {\n        toAddress,\n        amount,\n        rawPayload,\n        payload,\n        stateInit,\n        normalizedAddress,\n        isScam,\n        isDangerous: isTransferPayloadDangerous(payload),\n        displayedToAddress: getTransferActualToAddress(toAddress, payload),\n        displayedAmount: amount,\n        fullFee: emulationResult?.fee ?? bigintDivideToNumber(checkResult.fee!, messages.length),\n        received: emulationResult?.received ?? 0n,\n      };\n    },\n  ));\n\n  return showDappTransferAmountsAsFee(transactions);\n}\n\nexport async function deactivate(request: ApiDappRequest) {\n  try {\n    const { origin } = await validateRequest(request, true);\n\n    deactivateDapp(origin);\n  } catch (err) {\n    logDebugError('tonConnect:deactivate', err);\n  }\n}\n\nfunction formatConnectError(id: number, error: Error): ConnectEventError {\n  let code = CONNECT_EVENT_ERROR_CODES.UNKNOWN_ERROR;\n  let message = 'Unhandled error';\n\n  if (error instanceof apiErrors.ApiUserRejectsError) {\n    code = CONNECT_EVENT_ERROR_CODES.USER_REJECTS_ERROR;\n    message = error.message;\n  } else if (error instanceof errors.TonConnectError) {\n    code = error.code;\n    message = error.message;\n  }\n\n  return {\n    id,\n    event: 'connect_error',\n    payload: {\n      code,\n      message,\n    },\n  };\n}\n\nasync function buildTonAddressReplyItem(accountId: string, wallet: ApiTonWallet): Promise<ConnectItemReply> {\n  const { network } = parseAccountId(accountId);\n  const { publicKey, address } = wallet;\n\n  const stateInit = await ton.getWalletStateInit(accountId, wallet);\n\n  return {\n    name: 'ton_addr',\n    address: toRawAddress(address),\n    network: network === 'mainnet' ? CHAIN.MAINNET : CHAIN.TESTNET,\n    publicKey,\n    walletStateInit: stateInit\n      .toBoc({ idx: true, crc32: true })\n      .toString('base64'),\n  };\n}\n\nasync function signTonProof(\n  accountId: string,\n  account: ApiAccountWithMnemonic,\n  password: string,\n  walletAddress: string,\n  proof: ApiTonConnectProof,\n): Promise<TonProofItemReplySuccess> {\n  const keyPair = await fetchKeyPair(accountId, password, account);\n  const { timestamp, domain, payload } = proof;\n\n  const timestampBuffer = Buffer.allocUnsafe(8);\n  timestampBuffer.writeBigInt64LE(BigInt(timestamp));\n\n  const domainBuffer = Buffer.from(domain);\n  const domainLengthBuffer = Buffer.allocUnsafe(4);\n  domainLengthBuffer.writeInt32LE(domainBuffer.byteLength);\n\n  const address = Address.parse(walletAddress);\n\n  const addressWorkchainBuffer = Buffer.allocUnsafe(4);\n  addressWorkchainBuffer.writeInt32BE(address.workChain);\n\n  const addressBuffer = Buffer.concat([\n    addressWorkchainBuffer,\n    address.hash,\n  ]);\n\n  const messageBuffer = Buffer.concat([\n    Buffer.from('ton-proof-item-v2/', 'utf8'),\n    addressBuffer,\n    domainLengthBuffer,\n    domainBuffer,\n    timestampBuffer,\n    Buffer.from(payload),\n  ]);\n\n  const bufferToSign = Buffer.concat([\n    Buffer.from('ffff', 'hex'),\n    Buffer.from('ton-connect', 'utf8'),\n    Buffer.from(await sha256(messageBuffer)),\n  ]);\n\n  const signature = nacl.sign.detached(\n    Buffer.from(await sha256(bufferToSign)),\n    keyPair!.secretKey,\n  );\n\n  return buildTonProofReplyItem(proof, bytesToBase64(signature));\n}\n\nfunction buildTonProofReplyItem(proof: ApiTonConnectProof, signature: string): TonProofItemReplySuccess {\n  const { timestamp, domain, payload } = proof;\n  const domainBuffer = Buffer.from(domain);\n\n  return {\n    name: 'ton_proof',\n    proof: {\n      timestamp,\n      domain: {\n        lengthBytes: domainBuffer.byteLength,\n        value: domainBuffer.toString('utf8'),\n      },\n      signature,\n      payload,\n    },\n  };\n}\n\nexport async function fetchDappMetadata(manifestUrl: string, origin?: string): Promise<ApiDappMetadata> {\n  try {\n    const data = await fetchJsonMetadata(manifestUrl);\n\n    const { url, name, iconUrl } = await data;\n    const safeIconUrl = (iconUrl.startsWith('data:') || iconUrl === '') ? BLANK_GIF_DATA_URL : iconUrl;\n    if (!isValidUrl(url) || !isValidString(name) || !isValidUrl(safeIconUrl)) {\n      throw new Error('Invalid data');\n    }\n\n    return {\n      origin: origin ?? new URL(url).origin,\n      url,\n      name,\n      iconUrl: safeIconUrl,\n      manifestUrl,\n    };\n  } catch (err) {\n    logDebugError('fetchDapp', err);\n    throw new errors.ManifestContentError();\n  }\n}\n\nasync function validateRequest(request: ApiDappRequest, skipConnection = false) {\n  const { origin } = request;\n  if (!origin) {\n    throw new errors.BadRequestError('Invalid origin');\n  }\n\n  let accountId = '';\n  if (request.accountId) {\n    accountId = request.accountId;\n  } else if (!skipConnection) {\n    const { network } = parseAccountId(await getCurrentAccountIdOrFail());\n    const lastAccountId = await findLastConnectedAccount(network, origin);\n    if (!lastAccountId) {\n      throw new errors.BadRequestError('The connection is outdated, try relogin');\n    }\n    accountId = lastAccountId;\n  }\n\n  return { origin, accountId };\n}\n\nasync function openExtensionPopup(force?: boolean) {\n  if (!IS_EXTENSION || (!force && onPopupUpdate && isUpdaterAlive(onPopupUpdate))) {\n    return false;\n  }\n\n  await callHook('onWindowNeeded');\n  await initPromise;\n\n  return true;\n}\n\nasync function getCurrentAccountOrFail() {\n  const accountId = await getCurrentAccountId();\n  if (!accountId) {\n    throw new errors.BadRequestError('The user is not authorized in the wallet');\n  }\n  return accountId;\n}\n","import type {\n  AppRequest,\n  ConnectRequest,\n  DisconnectEvent,\n  RpcRequests,\n} from '@tonconnect/protocol';\nimport nacl, { randomBytes } from 'tweetnacl';\n\nimport type { ApiDappRequest, ApiSseOptions, OnApiUpdate } from '../types';\n\nimport { parseAccountId } from '../../util/account';\nimport { handleFetchErrors } from '../../util/fetch';\nimport { extractKey } from '../../util/iteratees';\nimport { logDebug, logDebugError } from '../../util/logs';\nimport safeExec from '../../util/safeExec';\nimport { getCurrentNetwork, waitLogin } from '../common/accounts';\nimport { bytesToHex } from '../common/utils';\nimport { getDappsState, getSseLastEventId, setSseLastEventId } from '../methods/dapps';\nimport * as tonConnect from './index';\n\ntype SseDapp = {\n  accountId: string;\n  origin: string;\n} & ApiSseOptions;\n\ntype ReturnStrategy = 'back' | 'none' | string;\n\nconst BRIDGE_URL = 'https://tonconnectbridge.mytonwallet.org/bridge';\nconst TTL_SEC = 300;\nconst NONCE_SIZE = 24;\nconst MAX_CONFIRM_DURATION = 60 * 1000;\n\nlet sseEventSource: EventSource | undefined;\nlet sseDapps: SseDapp[] = [];\nlet delayedReturnParams: {\n  validUntil: number;\n  url: string;\n  isFromInAppBrowser?: boolean;\n} | undefined;\n\nlet onUpdate: OnApiUpdate;\n\nexport function initSse(_onUpdate: OnApiUpdate) {\n  onUpdate = _onUpdate;\n}\n\nexport async function startSseConnection({\n  url, isFromInAppBrowser, identifier,\n}: {\n  url: string;\n  isFromInAppBrowser?: boolean;\n  identifier?: string;\n}): Promise<ReturnStrategy | undefined> {\n  const { searchParams: params, origin } = new URL(url);\n\n  const ret: ReturnStrategy = params.get('ret') || 'back';\n  const version = Number(params.get('v') as string);\n  const appClientId = params.get('id') as string;\n  // `back` strategy cannot be implemented\n  const shouldOpenUrl = ret !== 'back' && ret !== 'none';\n  const r = params.get('r');\n\n  if (!r) {\n    if (shouldOpenUrl) {\n      delayedReturnParams = {\n        validUntil: Date.now() + MAX_CONFIRM_DURATION,\n        url: ret,\n        isFromInAppBrowser,\n      };\n    }\n    return undefined;\n  }\n\n  const connectRequest: ConnectRequest | null = safeExec(() => JSON.parse(r)) || JSON.parse(decodeURIComponent(r));\n\n  logDebug('SSE Start connection:', {\n    version, appClientId, connectRequest, ret, origin, identifier,\n  });\n\n  const { secretKey: secretKeyArray, publicKey: publicKeyArray } = nacl.box.keyPair();\n  const secretKey = bytesToHex(secretKeyArray);\n  const clientId = bytesToHex(publicKeyArray);\n\n  const lastOutputId = 0;\n  const request: ApiDappRequest = {\n    identifier,\n    sseOptions: {\n      clientId,\n      appClientId,\n      secretKey,\n      lastOutputId,\n    },\n  };\n\n  await waitLogin();\n\n  if (!connectRequest) {\n    onUpdate({\n      type: 'showError',\n      error: 'Invalid TON Connect link',\n    });\n\n    return undefined;\n  }\n\n  const result = await tonConnect.connect(request, connectRequest, lastOutputId);\n\n  await sendMessage(result, secretKey, clientId, appClientId);\n\n  if (result.event !== 'connect_error') {\n    await resetupSseConnection();\n  }\n\n  if (!shouldOpenUrl) {\n    return undefined;\n  }\n\n  return ret;\n}\n\nexport async function resetupSseConnection() {\n  const [lastEventId, dappsState, network] = await Promise.all([\n    getSseLastEventId(),\n    getDappsState(),\n    getCurrentNetwork(),\n  ]);\n\n  if (!dappsState || !network) {\n    return;\n  }\n\n  sseDapps = Object.entries(dappsState).reduce((result, [accountId, dapps]) => {\n    if (parseAccountId(accountId).network === network) {\n      for (const dapp of Object.values(dapps)) {\n        if (dapp.sse?.clientId) {\n          result.push({\n            ...dapp.sse,\n            accountId,\n            origin: dapp.origin,\n          });\n        }\n      }\n    }\n    return result;\n  }, [] as SseDapp[]);\n\n  const clientIds = extractKey(sseDapps, 'clientId').filter(Boolean);\n  if (!clientIds.length) {\n    return;\n  }\n\n  closeEventSource();\n  sseEventSource = openEventSource(clientIds, lastEventId);\n\n  sseEventSource.onopen = () => {\n    logDebug('EventSource opened');\n  };\n\n  sseEventSource.onerror = (e) => {\n    logDebugError('EventSource', e.type);\n  };\n\n  sseEventSource.onmessage = async (event) => {\n    const { from, message: encryptedMessage } = JSON.parse(event.data);\n\n    const sseDapp = sseDapps.find(({ appClientId }) => appClientId === from);\n    if (!sseDapp) {\n      logDebug(`Dapp with clientId ${from} not found`);\n      return;\n    }\n\n    const {\n      accountId, clientId, appClientId, secretKey, origin, lastOutputId,\n    } = sseDapp;\n    const message = decryptMessage(encryptedMessage, appClientId, secretKey) as AppRequest<keyof RpcRequests>;\n\n    logDebug('SSE Event:', message);\n\n    await setSseLastEventId(event.lastEventId);\n    const sseOptions = {\n      clientId,\n      appClientId,\n      secretKey,\n      lastOutputId,\n    };\n\n    // @ts-ignore\n    const result = await tonConnect[message.method]({ origin, accountId, sseOptions }, message);\n\n    await sendMessage(result, secretKey, clientId, appClientId);\n\n    if (delayedReturnParams) {\n      const { validUntil, url, isFromInAppBrowser } = delayedReturnParams;\n      if (validUntil > Date.now()) {\n        onUpdate({ type: 'openUrl', url, isExternal: !isFromInAppBrowser });\n      }\n      delayedReturnParams = undefined;\n    }\n  };\n}\n\nexport async function sendSseDisconnect(accountId: string, origin: string) {\n  const sseDapp = sseDapps.find((dapp) => dapp.origin === origin && dapp.accountId === accountId);\n  if (!sseDapp) return;\n\n  const { secretKey, clientId, appClientId } = sseDapp;\n  const lastOutputId = sseDapp.lastOutputId + 1;\n\n  const response: DisconnectEvent = {\n    event: 'disconnect',\n    id: lastOutputId,\n    payload: {},\n  };\n\n  await sendMessage(response, secretKey, clientId, appClientId);\n}\n\nfunction sendMessage(\n  message: AnyLiteral, secretKey: string, clientId: string, toId: string, topic?: 'signTransaction' | 'signData',\n) {\n  const buffer = Buffer.from(JSON.stringify(message));\n  const encryptedMessage = encryptMessage(buffer, toId, secretKey);\n  return sendRawMessage(encryptedMessage, clientId, toId, topic);\n}\n\nasync function sendRawMessage(body: string, clientId: string, toId: string, topic?: 'signTransaction' | 'signData') {\n  const url = new URL(`${BRIDGE_URL}/message`);\n  url.searchParams.set('client_id', clientId);\n  url.searchParams.set('to', toId);\n  url.searchParams.set('ttl', TTL_SEC.toString());\n  if (topic) {\n    url.searchParams.set('topic', topic);\n  }\n\n  const response = await fetch(url, { method: 'POST', body });\n  await handleFetchErrors(response);\n}\n\nfunction closeEventSource() {\n  if (!sseEventSource) return;\n\n  safeExec(() => { sseEventSource!.close(); });\n  sseEventSource = undefined;\n}\n\nfunction openEventSource(clientIds: string[], lastEventId?: string) {\n  const url = new URL(`${BRIDGE_URL}/events`);\n  url.searchParams.set('client_id', clientIds.join(','));\n  if (lastEventId) {\n    url.searchParams.set('last_event_id', lastEventId);\n  }\n  return new EventSource(url);\n}\n\nfunction encryptMessage(message: Uint8Array, publicKey: string, secretKey: string) {\n  const nonce = randomBytes(NONCE_SIZE);\n  const encrypted = nacl.box(\n    message, nonce, Buffer.from(publicKey, 'hex'), Buffer.from(secretKey, 'hex'),\n  );\n  return Buffer.concat([nonce, encrypted]).toString('base64');\n}\n\nfunction decryptMessage(message: string, publicKey: string, secretKey: string) {\n  const fullBuffer = Buffer.from(message, 'base64');\n  const nonce = fullBuffer.subarray(0, NONCE_SIZE);\n  const encrypted = fullBuffer.subarray(NONCE_SIZE);\n  const decrypted = nacl.box.open(\n    encrypted,\n    nonce,\n    Buffer.from(publicKey, 'hex'),\n    Buffer.from(secretKey, 'hex'),\n  );\n  const jsonText = new TextDecoder('utf-8').decode(decrypted!);\n  return JSON.parse(jsonText);\n}\n","import type { ApiBaseCurrency, ApiHistoryList, ApiPriceHistoryPeriod } from '../types';\n\nimport { DEFAULT_PRICE_CURRENCY, TONCOIN } from '../../config';\nimport { callBackendGet } from '../common/backend';\nimport { waitDataPreload } from './preload';\nimport { getTokenBySlug } from './tokens';\n\nexport { setBaseCurrency, getBaseCurrency } from '../common/prices';\n\nexport async function fetchPriceHistory(\n  slug: string,\n  period: ApiPriceHistoryPeriod,\n  baseCurrency: ApiBaseCurrency = DEFAULT_PRICE_CURRENCY,\n): Promise<ApiHistoryList | undefined> {\n  await waitDataPreload();\n  const token = getTokenBySlug(slug);\n\n  if (!token) {\n    return [];\n  }\n\n  const assetId = token.chain === TONCOIN.chain && token.tokenAddress ? token.tokenAddress : token.symbol;\n\n  return callBackendGet(`/prices/chart/${assetId}`, {\n    base: baseCurrency,\n    period,\n  });\n}\n","import type {\n  ApiSubscribeNotificationsProps, ApiSubscribeNotificationsResult, ApiUnsubscribeNotificationsProps,\n} from '../types';\n\nimport { logDebugError } from '../../util/logs';\nimport { callBackendPost } from '../common/backend';\nimport { handleServerError } from '../errors';\n\nexport async function subscribeNotifications(props: ApiSubscribeNotificationsProps) {\n  try {\n    return await callBackendPost<ApiSubscribeNotificationsResult>(\n      '/notifications/subscribe', props, { shouldRetry: true },\n    );\n  } catch (err) {\n    logDebugError('subscribeNotifications', err);\n    return handleServerError(err);\n  }\n}\n\nexport async function unsubscribeNotifications(props: ApiUnsubscribeNotificationsProps) {\n  try {\n    return await callBackendPost<{ ok: true }>(\n      '/notifications/unsubscribe', props, { shouldRetry: true },\n    );\n  } catch (err) {\n    logDebugError('unsubscribeNotifications', err);\n    return handleServerError(err);\n  }\n}\n","import type { ApiInitArgs, OnApiUpdate } from '../types';\n\nimport { IS_EXTENSION } from '../../config';\nimport { initWindowConnector } from '../../util/windowProvider/connector';\nimport chains from '../chains';\nimport { callBackendGet } from '../common/backend';\nimport { connectUpdater, startStorageMigration } from '../common/helpers';\nimport { setEnvironment } from '../environment';\nimport { addHooks } from '../hooks';\nimport { storage } from '../storages';\nimport * as tonConnect from '../tonConnect';\nimport * as tonConnectSse from '../tonConnect/sse';\nimport * as methods from '.';\n\naddHooks({\n  onDappDisconnected: tonConnectSse.sendSseDisconnect,\n  onDappsChanged: tonConnectSse.resetupSseConnection,\n});\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport default async function init(onUpdate: OnApiUpdate, args: ApiInitArgs) {\n  connectUpdater(onUpdate);\n  const environment = setEnvironment(args);\n\n  if (!IS_EXTENSION) {\n    initWindowConnector();\n  }\n\n  methods.initAccounts(onUpdate);\n  void methods.initPolling(onUpdate);\n  methods.initTransactions(onUpdate);\n  methods.initStaking();\n  methods.initSwap(onUpdate);\n\n  if (environment.isDappSupported) {\n    methods.initDapps(onUpdate);\n    tonConnect.initTonConnect(onUpdate);\n  }\n\n  if (environment.isSseSupported) {\n    tonConnectSse.initSse(onUpdate);\n  }\n\n  await startStorageMigration(onUpdate, chains.ton);\n\n  if (environment.isSseSupported) {\n    void tonConnectSse.resetupSseConnection();\n  }\n\n  void saveReferrer(args);\n}\n\nasync function saveReferrer(args: ApiInitArgs) {\n  let referrer = await storage.getItem('referrer');\n\n  if (referrer !== undefined) return;\n\n  if (args.referrer) {\n    referrer = args.referrer;\n  } else {\n    ({ referrer } = await callBackendGet<{ referrer?: string }>('/referrer/get'));\n  }\n\n  // An empty string means no referrer\n  await storage.setItem('referrer', referrer ?? '');\n}\n","import type { StorageKey } from '../storages/types';\n\nimport { storage } from '../storages';\n\ntype OldAccount = {\n  address: string;\n  publicKey: string;\n  version: string;\n  ledger?: {\n    index: number;\n    driver: string;\n    deviceId?: string;\n    deviceName?: string;\n  };\n  authToken?: string;\n  isInitialized?: boolean;\n};\n\nexport async function start() {\n  const oldAccountById: Record<string, OldAccount> | undefined = await storage.getItem('accounts');\n\n  if (!oldAccountById) return;\n\n  const mnemonicById: Record<string, string> = await storage.getItem('mnemonicsEncrypted' as StorageKey);\n  const newAccountById: Record<string, any> = {};\n\n  for (const [accountId, oldAccount] of Object.entries(oldAccountById)) {\n    const {\n      address, version, publicKey, authToken, ledger, isInitialized,\n    } = oldAccount;\n\n    const tonWallet = {\n      type: 'ton',\n      address,\n      version,\n      publicKey,\n      authToken,\n      isInitialized,\n      index: ledger?.index ?? 0,\n    };\n\n    newAccountById[accountId] = ledger ? {\n      type: 'ledger',\n      ton: tonWallet,\n      driver: ledger.driver,\n      deviceId: ledger.deviceId,\n      deviceName: ledger.deviceName,\n    } : {\n      type: 'ton',\n      mnemonicEncrypted: mnemonicById[accountId],\n      ton: tonWallet,\n    };\n  }\n\n  await storage.setItem('accounts', newAccountById);\n}\n","import type {\n  MethodArgs, Methods,\n} from '../../methods/types';\nimport type { TonConnectMethodArgs, TonConnectMethods } from '../../tonConnect/types/misc';\nimport type {\n  ApiInitArgs, OnApiUpdate,\n} from '../../types';\n\nimport { createPostMessageInterface } from '../../../util/createPostMessageInterface';\nimport * as methods from '../../methods';\nimport init from '../../methods/init';\nimport * as tonConnectApi from '../../tonConnect';\n\ncreatePostMessageInterface((name: string, origin?: string, ...args: any[]) => {\n  if (name === 'init') {\n    return init(args[0] as OnApiUpdate, args[1] as ApiInitArgs);\n  } else {\n    if (name.startsWith('tonConnect_')) {\n      name = name.replace('tonConnect_', '');\n      const method = tonConnectApi[name as keyof TonConnectMethods];\n      // @ts-ignore\n      return method(...args as TonConnectMethodArgs<keyof TonConnectMethods>);\n    }\n\n    const method = methods[name as keyof Methods];\n\n    // @ts-ignore\n    return method(...args as MethodArgs<keyof Methods>);\n  }\n});\n","export enum ApiCommonError {\n  Unexpected = 'Unexpected',\n  ServerError = 'ServerError',\n  DebugError = 'DebugError',\n  UnsupportedVersion = 'UnsupportedVersion',\n}\n\nexport enum ApiAuthError {\n  InvalidMnemonic = 'InvalidMnemonic',\n}\n\nexport enum ApiTransactionDraftError {\n  InvalidAmount = 'InvalidAmount',\n  InvalidToAddress = 'InvalidToAddress',\n  InsufficientBalance = 'InsufficientBalance',\n  InvalidStateInit = 'InvalidStateInit',\n  StateInitWithoutBin = 'StateInitWithoutBin',\n  DomainNotResolved = 'DomainNotResolved',\n  WalletNotInitialized = 'WalletNotInitialized',\n  InvalidAddressFormat = 'InvalidAddressFormat',\n  InactiveContract = 'InactiveContract',\n}\n\nexport enum ApiTransactionError {\n  PartialTransactionFailure = 'PartialTransactionFailure',\n  IncorrectDeviceTime = 'IncorrectDeviceTime',\n  InsufficientBalance = 'InsufficientBalance',\n  UnsuccesfulTransfer = 'UnsuccesfulTransfer',\n  NotSupportedHardwareOperation = 'NotSupportedHardwareOperation',\n  HardwareBlindSigningNotEnabled = 'HardwareBlindSigningNotEnabled',\n  WrongAddress = 'WrongAddress',\n  WrongNetwork = 'WrongNetwork',\n}\n\nexport type ApiAnyDisplayError = ApiCommonError | ApiAuthError | ApiTransactionDraftError | ApiTransactionError;\n","import type { ApiTonWalletVersion } from '../chains/ton/types';\nimport type { ApiTransactionActivity } from './activity';\nimport type { ApiParsedPayload } from './payload';\nimport type { ApiSseOptions } from './storage';\n\nexport type ApiChain = 'ton' | 'tron';\nexport type ApiNetwork = 'mainnet' | 'testnet';\nexport type ApiLedgerDriver = 'HID' | 'USB';\n\nexport interface AccountIdParsed {\n  id: number;\n  network: ApiNetwork;\n}\n\nexport interface ApiInitArgs {\n  isElectron: boolean;\n  isNativeBottomSheet: boolean;\n  isIosApp: boolean;\n  isAndroidApp: boolean;\n  referrer?: string;\n}\n\nexport interface ApiToken {\n  name: string;\n  symbol: string;\n  slug: string;\n  decimals: number;\n  chain: ApiChain;\n  tokenAddress?: string;\n  image?: string;\n  isPopular?: boolean;\n  keywords?: string[];\n  cmcSlug?: string;\n  color?: string;\n  isGaslessEnabled?: boolean;\n  isStarsEnabled?: boolean;\n  isTiny?: boolean;\n  customPayloadApiUrl?: string;\n  codeHash?: string;\n}\n\nexport interface ApiTokenWithPrice extends ApiToken {\n  quote: ApiTokenPrice;\n}\n\nexport interface ApiTokenPrice {\n  slug: string;\n  price: number;\n  priceUsd: number;\n  percentChange24h: number;\n}\n\nexport type ApiKnownAddresses = Record<string, ApiAddressInfo>;\n\nexport interface ApiAddressInfo {\n  name?: string;\n  isScam?: boolean;\n  isMemoRequired?: boolean;\n}\n\nexport type ApiActivityTimestamps = Record<string, number | undefined>;\nexport type ApiTransactionType = 'stake' | 'unstake' | 'unstakeRequest'\n| 'callContract' | 'excess' | 'contractDeploy' | 'bounced'\n| 'mint' | 'burn' | 'auctionBid'\n| 'dnsChangeAddress' | 'dnsChangeSite' | 'dnsChangeSubdomains' | 'dnsChangeStorage' | 'dnsDelete' | 'dnsRenew'\n| 'liquidityDeposit' | 'liquidityWithdraw'\n| undefined;\n\nexport interface ApiTransaction {\n  txId: string;\n  timestamp: number;\n  /** The amount to show in the UI (may mismatch the actual attached TON amount) */\n  amount: bigint;\n  fromAddress: string;\n  toAddress: string;\n  comment?: string;\n  encryptedComment?: string;\n  /** The fee to show in the UI (not the same as the network fee) */\n  fee: bigint;\n  slug: string;\n  isIncoming: boolean;\n  normalizedAddress: string; // Only for TON now\n  externalMsgHash?: string; // Only for TON\n  shouldHide?: boolean;\n  type?: ApiTransactionType;\n  metadata?: ApiTransactionMetadata;\n  nft?: ApiNft;\n}\n\nexport interface ApiTransactionMetadata extends ApiAddressInfo {\n}\n\nexport type ApiMtwCardType = 'black' | 'platinum' | 'gold' | 'silver' | 'standard';\nexport type ApiMtwCardTextType = 'light' | 'dark';\nexport type ApiMtwCardBorderShineType = 'up' | 'down' | 'left' | 'right' | 'radioactive';\n\nexport interface ApiNftMetadata {\n  lottie?: string;\n  imageUrl?: string;\n  fragmentUrl?: string;\n  mtwCardId?: number;\n  mtwCardType?: ApiMtwCardType;\n  mtwCardTextType?: ApiMtwCardTextType;\n  mtwCardBorderShineType?: ApiMtwCardBorderShineType;\n}\n\nexport interface ApiNft {\n  index: number;\n  ownerAddress?: string;\n  name?: string;\n  address: string;\n  thumbnail: string;\n  image: string;\n  description?: string;\n  collectionName?: string;\n  collectionAddress?: string;\n  isOnSale: boolean;\n  isHidden?: boolean;\n  isOnFragment?: boolean;\n  isScam?: boolean;\n  metadata: ApiNftMetadata;\n}\n\nexport type ApiHistoryList = Array<[number, number]>;\n\nexport type ApiStakingType = 'nominators' | 'liquid' | 'jetton';\n\ntype BaseStakingState = {\n  id: string;\n  tokenSlug: string;\n  annualYield: number;\n  yieldType: ApiYieldType;\n  balance: bigint;\n  pool: string;\n  isUnstakeRequested?: boolean;\n};\n\nexport type ApiNominatorsStakingState = BaseStakingState & {\n  type: 'nominators';\n  start: number;\n  end: number;\n  pendingDepositAmount: bigint;\n};\n\nexport type ApiLiquidStakingState = BaseStakingState & {\n  type: 'liquid';\n  tokenBalance: bigint;\n  unstakeRequestAmount: bigint;\n  instantAvailable: bigint;\n};\n\nexport type ApiJettonStakingState = BaseStakingState & {\n  type: 'jetton';\n  tokenAddress: string;\n  unclaimedRewards: bigint;\n  stakeWalletAddress: string;\n  tokenAmount: bigint;\n  period: number;\n  tvl: bigint;\n  dailyReward: bigint;\n  poolWallets?: string[];\n};\n\nexport type ApiYieldType = 'APY' | 'APR';\nexport type ApiStakingState = ApiNominatorsStakingState | ApiLiquidStakingState | ApiJettonStakingState;\nexport type ApiToncoinStakingState = ApiNominatorsStakingState | ApiLiquidStakingState;\n\nexport interface ApiNominatorsPool {\n  address: string;\n  apy: number;\n  start: number;\n  end: number;\n}\n\nexport interface ApiBackendStakingState {\n  balance: bigint;\n  totalProfit: bigint;\n  type?: ApiStakingType;\n  nominatorsPool: ApiNominatorsPool;\n  loyaltyType?: ApiLoyaltyType;\n  shouldUseNominators?: boolean;\n  stakedAt?: number;\n}\n\nexport type ApiStakingHistory = {\n  timestamp: number;\n  profit: string;\n}[];\n\nexport interface ApiDappPermissions {\n  isAddressRequired?: boolean;\n  isPasswordRequired?: boolean;\n}\n\nexport type ApiDappRequest = {\n  origin?: string;\n  accountId?: string;\n  identifier?: string;\n  sseOptions?: ApiSseOptions;\n} | {\n  origin: string;\n  accountId: string;\n};\n\nexport interface ApiTransferToSign {\n  toAddress: string;\n  amount: bigint;\n  rawPayload?: string;\n  payload?: ApiParsedPayload;\n  stateInit?: string;\n}\n\nexport interface ApiDappTransfer extends ApiTransferToSign {\n  isScam?: boolean;\n  /** Whether the transfer should be treated with cautiousness, because its payload is unclear */\n  isDangerous: boolean;\n  normalizedAddress: string;\n  /** The transfer address to show in the UI */\n  displayedToAddress: string;\n  /**\n   * The transaction TON amount that should be shown in the UI.\n   * It may be less than `amount` because the difference is added to `fullFee`.\n   */\n  displayedAmount: bigint;\n  /** The transaction full fee to show in the UI. Includes the network fee and the TON amount used as a fee. */\n  fullFee: bigint;\n  /**\n   * The TON amount that will be returned back as a result of the transaction.\n   * - If `fullFee`  `excess`, the UI should show the difference as the real fee;\n   * - Otherwise, the UI should show the difference as the returned amount.\n   */\n  received: bigint;\n}\n\nexport interface ApiSignedTransfer {\n  base64: string;\n  seqno: number;\n  /** Will be used to create a local activity in the global state after the transfer is sent */\n  localActivity: Omit<ApiLocalTransactionParams, 'externalMsgHash'>;\n}\n\n/**\n * The `fee` field should contain the final (real) fee, because we want to show the real fee in local transactions\n */\nexport type ApiLocalTransactionParams = Omit<\nApiTransactionActivity, 'id' | 'txId' | 'timestamp' | 'isIncoming' | 'normalizedAddress' | 'kind' | 'shouldLoadDetails'\n> & {\n  txId?: string;\n  normalizedAddress?: string;\n};\n\nexport type ApiBaseCurrency = 'USD' | 'EUR' | 'RUB' | 'CNY' | 'BTC' | 'TON';\n\nexport enum ApiLiquidUnstakeMode {\n  Default,\n  Instant,\n  BestRate,\n}\n\nexport type ApiLoyaltyType = 'black' | 'platinum' | 'gold' | 'silver' | 'standard';\n\nexport type ApiBalanceBySlug = Record<string, bigint>;\n\nexport type ApiWalletInfo = {\n  address: string;\n  version: ApiTonWalletVersion;\n  balance: bigint;\n  isInitialized: boolean;\n  lastTxId?: string;\n};\n\n// Country codes from ISO-3166-1 spec\nexport type ApiCountryCode = 'AF' | 'AX' | 'AL' | 'DZ' | 'AS' | 'AD' | 'AO' | 'AI' | 'AQ' | 'AG' | 'AR'\n| 'AM' | 'AW' | 'AU' | 'AT' | 'AZ' | 'BS' | 'BH' | 'BD' | 'BB' | 'BY' | 'BE' | 'BZ' | 'BJ' | 'BM'\n| 'BT' | 'BO' | 'BQ' | 'BA' | 'BW' | 'BV' | 'BR' | 'IO' | 'BN' | 'BG' | 'BF' | 'BI' | 'CV' | 'KH'\n| 'CM' | 'CA' | 'KY' | 'CF' | 'TD' | 'CL' | 'CN' | 'CX' | 'CC' | 'CO' | 'KM' | 'CG' | 'CD' | 'CK'\n| 'CR' | 'CI' | 'HR' | 'CU' | 'CW' | 'CY' | 'CZ' | 'DK' | 'DJ' | 'DM' | 'DO' | 'EC' | 'EG' | 'SV'\n| 'GQ' | 'ER' | 'EE' | 'SZ' | 'ET' | 'FK' | 'FO' | 'FJ' | 'FI' | 'FR' | 'GF' | 'PF' | 'TF' | 'GA'\n| 'GM' | 'GE' | 'DE' | 'GH' | 'GI' | 'GR' | 'GL' | 'GD' | 'GP' | 'GU' | 'GT' | 'GG' | 'GN' | 'GW'\n| 'GY' | 'HT' | 'HM' | 'VA' | 'HN' | 'HK' | 'HU' | 'IS' | 'IN' | 'ID' | 'IR' | 'IQ' | 'IE' | 'IM'\n| 'IL' | 'IT' | 'JM' | 'JP' | 'JE' | 'JO' | 'KZ' | 'KE' | 'KI' | 'KP' | 'KR' | 'KW' | 'KG' | 'LA'\n| 'LV' | 'LB' | 'LS' | 'LR' | 'LY' | 'LI' | 'LT' | 'LU' | 'MO' | 'MG' | 'MW' | 'MY' | 'MV' | 'ML'\n| 'MT' | 'MH' | 'MQ' | 'MR' | 'MU' | 'YT' | 'MX' | 'FM' | 'MD' | 'MC' | 'MN' | 'ME' | 'MS' | 'MA'\n| 'MZ' | 'MM' | 'NA' | 'NR' | 'NP' | 'NL' | 'NC' | 'NZ' | 'NI' | 'NE' | 'NG' | 'NU' | 'NF' | 'MP'\n| 'NO' | 'OM' | 'PK' | 'PW' | 'PS' | 'PA' | 'PG' | 'PY' | 'PE' | 'PH' | 'PN' | 'PL' | 'PT' | 'PR'\n| 'QA' | 'MK' | 'RO' | 'RU' | 'RW' | 'RE' | 'BL' | 'SH' | 'KN' | 'LC' | 'MF' | 'PM' | 'VC' | 'WS'\n| 'SM' | 'ST' | 'SA' | 'SN' | 'RS' | 'SC' | 'SL' | 'SG' | 'SX' | 'SK' | 'SI' | 'SB' | 'SO' | 'ZA'\n| 'GS' | 'SS' | 'ES' | 'LK' | 'SD' | 'SR' | 'SJ' | 'SE' | 'CH' | 'SY' | 'TW' | 'TJ' | 'TZ' | 'TH'\n| 'TL' | 'TG' | 'TK' | 'TO' | 'TT' | 'TN' | 'TR' | 'TM' | 'TC' | 'TV' | 'UG' | 'UA' | 'AE' | 'GB'\n| 'US' | 'UM' | 'UY' | 'UZ' | 'VU' | 'VE' | 'VN' | 'VG' | 'VI' | 'WF' | 'EH' | 'YE' | 'ZM' | 'ZW';\n","import type { ApiTonWalletVersion } from './api/chains/ton/types';\nimport type {\n  ApiBaseCurrency,\n  ApiLiquidStakingState,\n  ApiNominatorsStakingState,\n  ApiSwapAsset,\n  ApiSwapDexLabel,\n} from './api/types';\nimport type { LangItem, TokenPeriod } from './global/types';\n\nexport const APP_ENV = process.env.APP_ENV;\n\nexport const IS_CORE_WALLET = process.env.IS_CORE_WALLET === '1';\nexport const APP_NAME = process.env.APP_NAME || (IS_CORE_WALLET ? 'TON Wallet' : 'MyTonWallet');\nexport const APP_VERSION = process.env.APP_VERSION!;\nexport const APP_ENV_MARKER = APP_ENV === 'staging' ? 'Beta' : APP_ENV === 'development' ? 'Dev' : undefined;\nexport const EXTENSION_NAME = IS_CORE_WALLET ? 'TON Wallet' : 'MyTonWallet  My TON Wallet';\nexport const EXTENSION_DESCRIPTION = IS_CORE_WALLET\n  ? 'Set up your own TON Wallet on The Open Network'\n  // eslint-disable-next-line max-len\n  : 'The most feature-rich TON extension  with support of multi-accounts, tokens, NFT, TON DNS, TON Sites, TON Proxy, and TON Magic.';\n\nexport const DEBUG = APP_ENV !== 'production' && APP_ENV !== 'perf' && APP_ENV !== 'test';\nexport const DEBUG_MORE = false;\nexport const DEBUG_API = false;\n\nexport const IS_PRODUCTION = APP_ENV === 'production';\nexport const IS_TEST = APP_ENV === 'test';\nexport const IS_PERF = APP_ENV === 'perf';\nexport const IS_EXTENSION = process.env.IS_EXTENSION === '1';\nexport const IS_FIREFOX_EXTENSION = process.env.IS_FIREFOX_EXTENSION === '1';\nexport const IS_OPERA_EXTENSION = process.env.IS_OPERA_EXTENSION === '1';\nexport const IS_PACKAGED_ELECTRON = process.env.IS_PACKAGED_ELECTRON === '1';\nexport const IS_CAPACITOR = process.env.IS_CAPACITOR === '1';\nexport const IS_ANDROID_DIRECT = process.env.IS_ANDROID_DIRECT === '1';\nexport const IS_AIR_APP = process.env.IS_AIR_APP === '1';\nexport const IS_TELEGRAM_APP = process.env.IS_TELEGRAM_APP === '1';\n\nexport const ELECTRON_HOST_URL = 'https://dumb-host';\nexport const INACTIVE_MARKER = '[Inactive]';\nexport const PRODUCTION_URL = IS_CORE_WALLET ? 'https://wallet.ton.org' : 'https://mytonwallet.app';\nexport const BETA_URL = IS_CORE_WALLET ? 'https://beta.wallet.ton.org' : 'https://beta.mytonwallet.app';\nexport const APP_INSTALL_URL = 'https://get.mytonwallet.io/';\nexport const APP_REPO_URL = 'https://github.com/mytonwalletorg/mytonwallet';\nexport const BASE_URL = process.env.BASE_URL;\n\nexport const BOT_USERNAME = process.env.BOT_USERNAME || 'MyTonWalletBot';\n\nexport const SWAP_FEE_ADDRESS = process.env.SWAP_FEE_ADDRESS || 'UQDUkQbpTVIgt7v66-JTFR-3-eXRFz_4V66F-Ufn6vOg0GOp';\nexport const DIESEL_ADDRESS = process.env.DIESEL_ADDRESS || 'UQC9lQOaEHC6YASiJJ2NrKEOlITMMQmc8j0_iZEHy-4sl3tG';\n\nexport const STRICTERDOM_ENABLED = DEBUG && !IS_PACKAGED_ELECTRON;\n\nexport const DEBUG_ALERT_MSG = 'Shoot!\\nSomething went wrong, please see the error details in Dev Tools Console.';\n\nexport const PIN_LENGTH = 4;\nexport const NATIVE_BIOMETRICS_USERNAME = IS_CORE_WALLET ? 'TonWallet' : 'MyTonWallet';\nexport const NATIVE_BIOMETRICS_SERVER = IS_CORE_WALLET ? 'https://wallet.ton.org' : 'https://mytonwallet.app';\n\nexport const IS_BIP39_MNEMONIC_ENABLED = !IS_CORE_WALLET;\nexport const MNEMONIC_COUNT = 24;\nexport const MNEMONIC_COUNTS = IS_BIP39_MNEMONIC_ENABLED ? [12, 24] : [24];\n\nexport const PRIVATE_KEY_HEX_LENGTH = 64;\nexport const MNEMONIC_CHECK_COUNT = 3;\n\nexport const MOBILE_SCREEN_MAX_WIDTH = 700; // px\n\nexport const ANIMATION_END_DELAY = 50;\n\nexport const ANIMATED_STICKER_TINY_ICON_PX = 16;\nexport const ANIMATED_STICKER_ICON_PX = 30;\nexport const ANIMATED_STICKER_TINY_SIZE_PX = 70;\nexport const ANIMATED_STICKER_SMALL_SIZE_PX = 110;\nexport const ANIMATED_STICKER_MIDDLE_SIZE_PX = 120;\nexport const ANIMATED_STICKER_DEFAULT_PX = 150;\nexport const ANIMATED_STICKER_BIG_SIZE_PX = 156;\nexport const ANIMATED_STICKER_HUGE_SIZE_PX = 192;\n\nexport const DEFAULT_LANDSCAPE_ACTION_TAB_ID = 0;\nexport const TRANSACTION_ADDRESS_SHIFT = 4;\n\nexport const WHOLE_PART_DELIMITER = ''; // https://www.compart.com/en/unicode/U+202F\n\nexport const DEFAULT_SLIPPAGE_VALUE = 5;\n\nexport const GLOBAL_STATE_CACHE_DISABLED = false;\nexport const GLOBAL_STATE_CACHE_KEY = IS_CORE_WALLET ? 'tonwallet-global-state' : 'mytonwallet-global-state';\n\nexport const ANIMATION_LEVEL_MIN = 0;\nexport const ANIMATION_LEVEL_MED = 1;\nexport const ANIMATION_LEVEL_MAX = 2;\nexport const ANIMATION_LEVEL_DEFAULT = ANIMATION_LEVEL_MAX;\nexport const THEME_DEFAULT = 'system';\n\nexport const MAIN_ACCOUNT_ID = '0-ton-mainnet';\n\nexport const TONCENTER_MAINNET_URL = process.env.TONCENTER_MAINNET_URL || 'https://toncenter.mytonwallet.org';\nexport const TONCENTER_MAINNET_KEY = process.env.TONCENTER_MAINNET_KEY;\nexport const ELECTRON_TONCENTER_MAINNET_KEY = process.env.ELECTRON_TONCENTER_MAINNET_KEY;\nexport const TONAPIIO_MAINNET_URL = process.env.TONAPIIO_MAINNET_URL || 'https://tonapiio.mytonwallet.org';\n\nexport const TONCENTER_TESTNET_URL = process.env.TONCENTER_TESTNET_URL || 'https://toncenter-testnet.mytonwallet.org';\nexport const TONCENTER_TESTNET_KEY = process.env.TONCENTER_TESTNET_KEY;\nexport const ELECTRON_TONCENTER_TESTNET_KEY = process.env.ELECTRON_TONCENTER_TESTNET_KEY;\nexport const TONAPIIO_TESTNET_URL = process.env.TONAPIIO_TESTNET_URL || 'https://tonapiio-testnet.mytonwallet.org';\n\nexport const BRILLIANT_API_BASE_URL = process.env.BRILLIANT_API_BASE_URL || 'https://api.mytonwallet.org';\n\nexport const TRON_MAINNET_API_URL = process.env.TRON_MAINNET_API_URL || 'https://tronapi.mytonwallet.org';\nexport const TRON_TESTNET_API_URL = process.env.TRON_TESTNET_API_URL || 'https://api.shasta.trongrid.io';\n\nexport const FRACTION_DIGITS = 9;\nexport const SHORT_FRACTION_DIGITS = 2;\n\nexport const MAX_PUSH_NOTIFICATIONS_ACCOUNT_COUNT = 3;\n\nexport const SUPPORT_USERNAME = 'mysupport';\nexport const MTW_TIPS_CHANNEL_NAME = { en: 'MyTonWalletTips', ru: 'MyTonWalletTipsRu' };\nexport const MTW_CARDS_BASE_URL = 'https://static.mytonwallet.org/cards/';\nexport const MTW_CARDS_MINT_BASE_URL = 'https://static.mytonwallet.org/mint-cards/';\nexport const MYTONWALLET_PROMO_URL = 'https://mytonwallet.io/';\nexport const TELEGRAM_WEB_URL = 'https://web.telegram.org/a/';\nexport const NFT_MARKETPLACE_URL = 'https://getgems.io/';\nexport const NFT_MARKETPLACE_TITLE = 'GetGems';\nexport const GETGEMS_BASE_MAINNET_URL = 'https://getgems.io/';\nexport const GETGEMS_BASE_TESTNET_URL = 'https://testnet.getgems.io/';\nexport const HELPCENTER_URL = { en: 'https://help.mytonwallet.io/', ru: 'https://help.mytonwallet.io/ru' };\nexport const EMPTY_HASH_VALUE = 'NOHASH';\n\nexport const CHANGELLY_SUPPORT_EMAIL = 'support@changelly.com';\nexport const CHANGELLY_LIVE_CHAT_URL = 'https://changelly.com/';\nexport const CHANGELLY_SECURITY_EMAIL = 'security@changelly.com';\nexport const CHANGELLY_TERMS_OF_USE = 'https://changelly.com/terms-of-use';\nexport const CHANGELLY_PRIVACY_POLICY = 'https://changelly.com/privacy-policy';\nexport const CHANGELLY_AML_KYC = 'https://changelly.com/aml-kyc';\nexport const CHANGELLY_WAITING_DEADLINE = 3 * 60 * 60 * 1000; // 3 hour\n\nexport const PROXY_HOSTS = process.env.PROXY_HOSTS;\n\nexport const TINY_TRANSFER_MAX_COST = 0.01;\n\nexport const IMAGE_CACHE_NAME = 'mtw-image';\nexport const LANG_CACHE_NAME = 'mtw-lang-182';\n\nexport const LANG_LIST: LangItem[] = [{\n  langCode: 'en',\n  name: 'English',\n  nativeName: 'English',\n  rtl: false,\n}, {\n  langCode: 'es',\n  name: 'Spanish',\n  nativeName: 'Espaol',\n  rtl: false,\n}, {\n  langCode: 'ru',\n  name: 'Russian',\n  nativeName: '',\n  rtl: false,\n}, {\n  langCode: 'zh-Hans',\n  name: 'Chinese (Simplified)',\n  nativeName: '',\n  rtl: false,\n}, {\n  langCode: 'zh-Hant',\n  name: 'Chinese (Traditional)',\n  nativeName: '',\n  rtl: false,\n}, {\n  langCode: 'tr',\n  name: 'Turkish',\n  nativeName: 'Trke',\n  rtl: false,\n}, {\n  langCode: 'de',\n  name: 'German',\n  nativeName: 'Deutsch',\n  rtl: false,\n}, {\n  langCode: 'th',\n  name: 'Thai',\n  nativeName: '',\n  rtl: false,\n}, {\n  langCode: 'uk',\n  name: 'Ukrainian',\n  nativeName: '',\n  rtl: false,\n}, {\n  langCode: 'pl',\n  name: 'Polish',\n  nativeName: 'Polski',\n  rtl: false,\n}];\n\nexport const IS_STAKING_DISABLED = IS_CORE_WALLET;\nexport const STAKING_CYCLE_DURATION_MS = 131_072_000; // 36.4 hours\nexport const VALIDATION_PERIOD_MS = 65_536_000; // 18.2 h.\nexport const ONE_TON = 1_000_000_000n;\nexport const DEFAULT_FEE = 15_000_000n; // 0.015 TON\n\nexport const STAKING_POOLS = process.env.STAKING_POOLS ? process.env.STAKING_POOLS.split(' ') : [];\nexport const LIQUID_POOL = process.env.LIQUID_POOL || 'EQD2_4d91M4TVbEBVyBF8J1UwpMJc361LKVCz6bBlffMW05o';\nexport const LIQUID_JETTON = process.env.LIQUID_JETTON || 'EQCqC6EhRJ_tpWngKxL6dV0k6DSnRUrs9GSVkLbfdCqsj6TE';\nexport const STAKING_MIN_AMOUNT = ONE_TON;\nexport const NOMINATORS_STAKING_MIN_AMOUNT = 10_000n * ONE_TON;\nexport const MIN_ACTIVE_STAKING_REWARDS = 100_000_000n; // 0.1 MY\n\nexport const TONCONNECT_PROTOCOL_VERSION = 2;\nexport const TONCONNECT_WALLET_JSBRIDGE_KEY = IS_CORE_WALLET ? 'tonwallet' : 'mytonwallet';\n\nexport const NFT_FRAGMENT_COLLECTIONS = new Set([\n  '0:0e41dc1dc3c9067ed24248580e12b3359818d83dee0304fabcf80845eafafdb2', // Anonymous Telegram Numbers\n  '0:80d78a35f955a14b679faa887ff4cd5bfc0f43b4a4eea2a7e6927f3701b273c2', // Telegram Usernames\n]);\nexport const NFT_FRAGMENT_GIFT_IMAGE_URL_PREFIX = 'https://nft.fragment.com/gift/';\nexport const NFT_FRAGMENT_GIFT_IMAGE_TO_URL_REGEX = /^https?:\\/\\/nft\\.(fragment\\.com\\/gift\\/[\\w-]+-\\d+)\\.\\w+$/i;\n\nexport const MTW_CARDS_WEBSITE = 'https://cards.mytonwallet.io';\nexport const MTW_CARDS_COLLECTION = 'EQCQE2L9hfwx1V8sgmF9keraHx1rNK9VmgR1ctVvINBGykyM';\nexport const TON_DNS_COLLECTION = 'EQC3dNlesgVD8YbAazcauIrXBPfiVhMMr5YYk2in0Mtsz0Bz';\n\nexport const TONCOIN = {\n  name: 'Toncoin',\n  symbol: 'TON',\n  slug: 'toncoin',\n  decimals: 9,\n  chain: 'ton',\n  cmcSlug: 'toncoin',\n} as const;\n\nexport const TRX = {\n  name: 'TRON',\n  symbol: 'TRX',\n  slug: 'trx',\n  decimals: 6,\n  chain: 'tron',\n  cmcSlug: 'tron',\n} as const;\n\nexport const MYCOIN = {\n  name: 'MyTonWallet Coin',\n  symbol: 'MY',\n  slug: 'ton-eqcfvnlrbn',\n  decimals: 9,\n  chain: 'ton',\n  minterAddress: 'EQCFVNlRb-NHHDQfv3Q9xvDXBLJlay855_xREsq5ZDX6KN-w',\n} as const;\n\nexport const MYCOIN_TESTNET = {\n  ...MYCOIN,\n  slug: 'ton-kqawlxpebw',\n  minterAddress: 'kQAWlxpEbwhCDFX9gp824ee2xVBhAh5VRSGWfbNFDddAbQoQ',\n} as const;\n\nexport const CHAIN_CONFIG = {\n  ton: {\n    isMemoSupported: true,\n    isDnsSupported: true,\n    addressRegex: /^([-\\w_]{48}|0:[\\da-h]{64})$/i,\n    addressPrefixRegex: /^([-\\w_]{1,48}|0:[\\da-h]{0,64})$/i,\n    nativeToken: TONCOIN,\n  },\n  tron: {\n    isMemoSupported: false,\n    isDnsSupported: false,\n    addressRegex: /^T[1-9A-HJ-NP-Za-km-z]{33}$/,\n    addressPrefixRegex: /^T[1-9A-HJ-NP-Za-km-z]{0,33}$/,\n    nativeToken: TRX,\n    mainnet: {\n      apiUrl: TRON_MAINNET_API_URL,\n      usdtAddress: 'TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t',\n    },\n    testnet: {\n      apiUrl: TRON_TESTNET_API_URL,\n      usdtAddress: 'TG3XXyExBkPp9nzdajDZsozEu4BkaSJozs',\n    },\n  },\n} as const;\n\nexport const TRC20_USDT_MAINNET_SLUG = 'tron-tr7nhqjekq';\nexport const TRC20_USDT_TESTNET_SLUG = 'tron-tg3xxyexbk';\nexport const TON_USDT_SLUG = 'ton-eqcxe6mutq';\nexport const STAKED_TON_SLUG = 'ton-eqcqc6ehrj';\nexport const STAKED_MYCOIN_SLUG = 'ton-eqcbzvsfwq';\nexport const TRX_SWAP_COUNT_FEE_ADDRESS = 'TW2LXSebZ7Br1zHaiA2W1zRojDkDwjGmpw';\nexport const MYCOIN_STAKING_POOL = 'EQC3roTiRRsoLzfYVK7yVVoIZjTEqAjQU3ju7aQ7HWTVL5o5';\n\n// In cross-chain swaps, only a few TON/TRON tokens are available.\n// Its not optimal to request swap history for all the others.\nexport const SWAP_CROSSCHAIN_SLUGS = new Set([\n  TONCOIN.slug,\n  TON_USDT_SLUG,\n  TRX.slug,\n  TRC20_USDT_MAINNET_SLUG,\n]);\n\nexport const STON_PTON_ADDRESS = 'EQCM3B12QK1e4yZSf8GtBRT0aLMNyEsBc_DhVfRRtOEffLez';\n\nexport const DNS_IMAGE_GEN_URL = 'https://dns-image.mytonwallet.org/img?d=';\n\nconst TRC20_USDT = {\n  name: 'Tether USD',\n  symbol: 'USDT',\n  decimals: 6,\n  chain: 'tron',\n} as const;\n\nconst TON_USDT = {\n  name: 'Tether USD',\n  symbol: 'USD',\n  chain: 'ton',\n  slug: TON_USDT_SLUG,\n  decimals: 6,\n  tokenAddress: 'EQCxE6mUtQJKFnGfaROTKOt1lZbDiiX1kCixRv7Nw2Id_sDs',\n} as const;\n\nexport const DEFAULT_ENABLED_TOKEN_SLUGS = [\n  TONCOIN.slug, TON_USDT_SLUG, TRX.slug, TRC20_USDT_TESTNET_SLUG, TRC20_USDT_MAINNET_SLUG,\n] as string[];\n\n// Toncoin, USDT TON, TRX, USDT TRC20\nexport const DEFAULT_ENABLED_TOKEN_COUNT = 4;\n\nexport const PRIORITY_TOKEN_SLUGS = [\n  TONCOIN.slug, TON_USDT_SLUG, TRX.slug,\n] as string[];\n\nexport const TOKEN_INFO = {\n  toncoin: {\n    ...TONCOIN,\n    quote: {\n      slug: TONCOIN.slug,\n      price: 1.95,\n      priceUsd: 1.95,\n      percentChange24h: 0,\n    },\n  },\n  trx: {\n    ...TRX,\n    quote: {\n      slug: TRX.slug,\n      price: 0,\n      priceUsd: 0,\n      percentChange24h: 0,\n    },\n  },\n  [TRC20_USDT_MAINNET_SLUG]: { // mainnet\n    ...TRC20_USDT,\n    slug: TRC20_USDT_MAINNET_SLUG,\n    tokenAddress: 'TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t',\n    quote: {\n      slug: TRC20_USDT_MAINNET_SLUG,\n      price: 0,\n      priceUsd: 0,\n      percentChange24h: 0,\n    },\n  },\n  [TRC20_USDT_TESTNET_SLUG]: { // testnet\n    ...TRC20_USDT,\n    slug: TRC20_USDT_TESTNET_SLUG,\n    tokenAddress: 'TG3XXyExBkPp9nzdajDZsozEu4BkaSJozs',\n    quote: {\n      slug: TRC20_USDT_TESTNET_SLUG,\n      price: 0,\n      priceUsd: 0,\n      percentChange24h: 0,\n    },\n  },\n  [TON_USDT_SLUG]: {\n    ...TON_USDT,\n    // eslint-disable-next-line max-len\n    image: 'https://cache.tonapi.io/imgproxy/T3PB4s7oprNVaJkwqbGg54nexKE0zzKhcrPv8jcWYzU/rs:fill:200:200:1/g:no/aHR0cHM6Ly90ZXRoZXIudG8vaW1hZ2VzL2xvZ29DaXJjbGUucG5n.webp',\n    quote: {\n      slug: TON_USDT_SLUG,\n      price: 0,\n      priceUsd: 0,\n      percentChange24h: 0,\n    },\n  },\n  [MYCOIN.slug]: {\n    ...MYCOIN,\n    // eslint-disable-next-line max-len\n    image: 'https://cache.tonapi.io/imgproxy/Qy038wCBKISofJ0hYMlj6COWma330cx3Ju1ZSPM2LRU/rs:fill:200:200:1/g:no/aHR0cHM6Ly9teXRvbndhbGxldC5pby9sb2dvLTI1Ni1ibHVlLnBuZw.webp',\n    quote: {\n      slug: MYCOIN.slug,\n      price: 0,\n      priceUsd: 0,\n      percentChange24h: 0,\n    },\n  },\n};\n\nexport const TOKEN_WITH_LABEL: Record<string, string> = {\n  [TRC20_USDT_MAINNET_SLUG]: 'TRC-20',\n  [TRC20_USDT_TESTNET_SLUG]: 'TRC-20',\n  [TON_USDT_SLUG]: 'TON',\n};\n\nexport const INIT_SWAP_ASSETS: Record<string, ApiSwapAsset> = {\n  toncoin: {\n    name: 'Toncoin',\n    symbol: TONCOIN.symbol,\n    chain: TONCOIN.chain,\n    slug: TONCOIN.slug,\n    decimals: TONCOIN.decimals,\n    price: 0,\n    priceUsd: 0,\n    isPopular: true,\n  },\n  [TON_USDT_SLUG]: {\n    name: 'Tether USD',\n    symbol: 'USD',\n    chain: 'ton',\n    slug: TON_USDT_SLUG,\n    decimals: 9,\n    // eslint-disable-next-line max-len\n    image: 'https://cache.tonapi.io/imgproxy/T3PB4s7oprNVaJkwqbGg54nexKE0zzKhcrPv8jcWYzU/rs:fill:200:200:1/g:no/aHR0cHM6Ly90ZXRoZXIudG8vaW1hZ2VzL2xvZ29DaXJjbGUucG5n.webp',\n    tokenAddress: 'EQCxE6mUtQJKFnGfaROTKOt1lZbDiiX1kCixRv7Nw2Id_sDs',\n    price: 0,\n    priceUsd: 0,\n    isPopular: true,\n  },\n};\n\nexport const DEFAULT_TRX_SWAP_FIRST_TOKEN_SLUG = TONCOIN.slug;\nexport const DEFAULT_SWAP_FISRT_TOKEN_SLUG = TONCOIN.slug;\nexport const DEFAULT_SWAP_SECOND_TOKEN_SLUG = TON_USDT_SLUG;\nexport const DEFAULT_TRANSFER_TOKEN_SLUG = TONCOIN.slug;\nexport const DEFAULT_CEX_SWAP_SECOND_TOKEN_SLUG = TRC20_USDT_MAINNET_SLUG;\nexport const SWAP_DEX_LABELS: Record<ApiSwapDexLabel, string> = {\n  dedust: 'DeDust',\n  ston: 'STON.fi',\n};\n\nexport const MULTITAB_DATA_CHANNEL_NAME = IS_CORE_WALLET ? 'tw-multitab' : 'mtw-multitab';\nexport const ACTIVE_TAB_STORAGE_KEY = IS_CORE_WALLET ? 'tw-active-tab' : 'mtw-active-tab';\n\nexport const INDEXED_DB_NAME = 'keyval-store';\nexport const INDEXED_DB_STORE_NAME = 'keyval';\n\nexport const WINDOW_PROVIDER_CHANNEL = 'windowProvider';\n\nexport const SHOULD_SHOW_ALL_ASSETS_AND_ACTIVITY = IS_CORE_WALLET;\nexport const PORTRAIT_MIN_ASSETS_TAB_VIEW = 4;\nexport const LANDSCAPE_MIN_ASSETS_TAB_VIEW = 6;\n\nexport const DEFAULT_PRICE_CURRENCY = 'USD';\nexport const SHORT_CURRENCY_SYMBOL_MAP = {\n  USD: '$',\n  EUR: '',\n  RUB: '',\n  CNY: '',\n};\nexport const CURRENCY_LIST: { value: ApiBaseCurrency; name: string }[] = [\n  {\n    value: 'USD',\n    name: 'US Dollar',\n  }, {\n    value: 'EUR',\n    name: 'Euro',\n  }, {\n    value: 'RUB',\n    name: 'Ruble',\n  }, {\n    value: 'CNY',\n    name: 'Yuan',\n  }, {\n    value: 'BTC',\n    name: 'Bitcoin',\n  }, {\n    value: TONCOIN.symbol,\n    name: 'Toncoin',\n  },\n];\n\nexport const BURN_ADDRESS = 'UQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJKZ';\n\nexport const DEFAULT_WALLET_VERSION: ApiTonWalletVersion = 'W5';\nexport const POPULAR_WALLET_VERSIONS: ApiTonWalletVersion[] = ['v3R1', 'v3R2', 'v4R2', 'W5'];\nexport const LEDGER_WALLET_VERSIONS: ApiTonWalletVersion[] = ['v3R2', 'v4R2'];\n\nexport const DEFAULT_TIMEOUT = 10000;\nexport const DEFAULT_RETRIES = 3;\nexport const DEFAULT_ERROR_PAUSE = 500;\n\nexport const HISTORY_PERIODS: TokenPeriod[] = ['1D', '7D', '1M', '3M', '1Y', 'ALL'];\n\nexport const BROWSER_HISTORY_LIMIT = 10;\n\nexport const NFT_BATCH_SIZE = 4;\nexport const NOTCOIN_VOUCHERS_ADDRESS = 'EQDmkj65Ab_m0aZaW8IpKw4kYqIgITw_HRstYEkVQ6NIYCyW';\nexport const BURN_CHUNK_DURATION_APPROX_SEC = 30;\nexport const NOTCOIN_FORWARD_TON_AMOUNT = 30000000n; // 0.03 TON\nexport const NOTCOIN_EXCHANGERS = [\n  'EQAPZauWVPUcm2hUJT9n36pxznEhl46rEn1bzBXN0RY_yiy2',\n  'EQASgm0Qv3h2H2mF0W06ikPqYq2ctT3dyXMJH_svbEKKB3iZ',\n  'EQArlmP-RhVIG2yAFGZyPZfM3m0YccxmpvoRi6sgRzWnAA0s',\n  'EQA6pL-spYqZp1Ck6o3rpY45Cl-bvLMW_j3qdVejOkUWpLnm',\n  'EQBJ_ehYjumQKbXfWUue1KHKXdTm1GuYJB0Fj2ST_DwORvpd',\n  'EQBRmYSjxh9xlZpUqEmGjF5UjukI9v_Cm2kCTu4CoBn3XkOD',\n  'EQBkiqncd7AFT5_23H-RoA2Vynk-Nzq_dLoeMVRthAU9RF0p',\n  'EQB_OzTHXbztABe0QHgr4PtAV8T64LR6aDunXgaAoihOdxwO',\n  'EQCL-x5kLg6tKVNGryItTuj6tG3FH5mhUEu0xRqQc-kbEmbe',\n  'EQCZh2yJ46RaQH3AYmjEA8SMMXi77Oein4-3lvqkHseIAhD-',\n  'EQChKo5IK3iNqUHUGDB9gtzjCjMTPtmsFqekuCA2MdreVEyu',\n  'EQC6DNCBv076TIliRMfOt20RpbS7rNKDfSky3WrFEapFt8AH',\n  'EQDE_XFZOYae_rl3ZMsgBCtRSmYhl8B4y2BZEP7oiGBDhlgy',\n  'EQDddqpGA2ePXQF47A2DSL3GF6ZzIVmimfM2d16cdymy2noT',\n  'EQDv0hNNAamhYltCh3pTJrq3oRB9RW2ZhEYkTP6fhj5BtZNu',\n  'EQD2mP7zgO7-imUJhqYry3i07aJ_SR53DaokMupfAAobt0Xw',\n] as const;\n\nexport const CLAIM_ADDRESS = 'EQB3zOTvPi1PmwdcTpqSfFKZnhi1GNKEVJM-LdoAirdLtash';\nexport const CLAIM_AMOUNT = 30000000n; // 0.03 TON\nexport const CLAIM_COMMENT = 'claim';\n\nexport const MINT_CARD_ADDRESS = 'UQBpst3ZWJ9Dqq5gE2YH-yPsFK_BqMOmgi7Z_qK6v7WbrKhq';\nexport const MINT_CARD_COMMENT = 'Mint card';\n\n// eslint-disable-next-line max-len\nexport const RE_LINK_TEMPLATE = /((ftp|https?):\\/\\/)?(?<host>(www\\\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z][-a-zA-Z0-9]{1,62})\\b([-a-zA-Z0-9()@:%_+.,~#?&/=]*)/g;\n// eslint-disable-next-line max-len\nexport const RE_TG_BOT_MENTION = /telegram[:\\s-]*((@[a-z0-9_]+)|(https:\\/\\/)?(t\\.me|telegram\\.me|telegram\\.dog)\\/[a-z0-9_]+)/mig;\n\nexport const STARS_SYMBOL = '';\n\nexport const GIVEAWAY_CHECKIN_URL = process.env.GIVEAWAY_CHECKIN_URL || 'https://giveaway.mytonwallet.io';\n\nexport const AUTOLOCK_OPTIONS_LIST = [\n  {\n    value: 'never',\n    name: 'Disabled',\n    selectedName: 'Disabled',\n    period: 0,\n  },\n  {\n    value: '1',\n    name: '30 seconds',\n    selectedName: 'If away for 30 sec',\n    period: 30_000,\n  },\n  {\n    value: '2',\n    name: '3 minutes',\n    selectedName: 'If away for 3 min',\n    period: 60_000 * 3,\n  },\n  {\n    value: '3',\n    name: '10 minutes',\n    selectedName: 'If away for 10 min',\n    period: 60_000 * 10,\n  },\n] as const;\n\nexport const PRICELESS_TOKEN_HASHES = new Set([\n  '82566ad72b6568fe7276437d3b0c911aab65ed701c13601941b2917305e81c11', // Stonfi V1\n  'ec614ea4aaea3f7768606f1c1632b3374d3de096a1e7c4ba43c8009c487fee9d', // Stonfi V2\n  'c0f9d14fbc8e14f0d72cba2214165eee35836ab174130912baf9dbfa43ead562', // Dedust (for example, EQBkh7Mc411WTYF0o085MtwJpYpvGhZOMBphhIFzEpzlVODp)\n  '1275095b6da3911292406f4f4386f9e780099b854c6dee9ee2895ddce70927c1', // Dedust (for example, EQCm92zFBkLe_qcFDp7WBvI6JFSDsm4WbDPvZ7xNd7nPL_6M)\n  '5d01684bdf1d5c9be2682c4e36074202432628bd3477d77518d66b0976b78cca', // USDT Storm LP (for example, EQAzm06UMMsnFQrNKEubV1myIR-mm2ZOCnoic36frCgD8MLR)\n  '173e31eee054cb0c76f77edc7956bed766bf48a1f63bd062d87040dcd3df700f', // FIVA SY tsTON EQAxGi9Al7hamLAORroxGkvfap6knGyzI50ThkP3CLPLTtOZ\n  '5226dd4e6db9af26b24d5ca822bc4053b7e08152f923932abf25030c7e38bb42', // FIVA PT tsTON EQAkxIRGXgs2vD2zjt334MBjD3mXg2GsyEZHfzuYX_trQkFL\n  'fea2c08a704e5192b7f37434927170440d445b87aab865c3ea2a68abe7168204', // FIVA YT tsTON EQAcy60qg22RCq87A_qgYK8hooEgjCZ44yxhdnKYdlWIfKXL\n  'e691cf9081a8aeb22ed4d94829f6626c9d822752e035800b5543c43f83d134b5', // FIVA LP tsTON EQD3BjCjxuf8mu5kvxajVbe-Ila1ScZZlAi03oS7lMmAJjM3\n  '301ce25925830d713b326824e552e962925c4ff45b1e3ea21fc363a459a49b43', // FIVA SY eUSDT EQDi9blCcyT-k8iMpFMYY0t7mHVyiCB50ZsRgyUECJDuGvIl\n  '02250f83fbb8624d859c2c045ac70ee2b3b959688c3d843aec773be9b36dbfc3', // FIVA PT eUSDT EQBzVrYkYPHx8D_HPfQacm1xONa4XSRxl826vHkx_laP2HOe\n  'dba3adb2c917db80fd71a6a68c1fc9e12976491a8309d5910f9722efc084ce4d', // FIVA YT eUSDT EQCwUSc2qrY5rn9BfFBG9ARAHePTUvITDl97UD0zOreWzLru\n  '7da9223b90984d6a144e71611a8d7c65a6298cad734faed79438dc0f7a8e53d1', // FIVA LP eUSDT EQBNlIZxIbQGQ78cXgG3VRcyl8A0kLn_6BM9kabiHHhWC4qY\n]);\n\nexport const STAKED_TOKEN_SLUGS = new Set([\n  STAKED_TON_SLUG,\n  STAKED_MYCOIN_SLUG,\n]);\n\nexport const DEFAULT_OUR_SWAP_FEE = 0.875;\n\nexport const DEFAULT_STAKING_STATE: ApiLiquidStakingState = {\n  type: 'liquid',\n  id: 'liquid',\n  tokenSlug: TONCOIN.slug,\n  annualYield: 3.9,\n  yieldType: 'APY',\n  balance: 0n,\n  pool: LIQUID_POOL,\n  tokenBalance: 0n,\n  unstakeRequestAmount: 0n,\n  instantAvailable: 0n,\n};\n\nexport const DEFAULT_NOMINATORS_STAKING_STATE: ApiNominatorsStakingState = {\n  type: 'nominators',\n  id: 'nominators',\n  tokenSlug: TONCOIN.slug,\n  annualYield: 3.9,\n  yieldType: 'APY',\n  balance: 0n,\n  pool: 'Ef8dgIOIRyCLU0NEvF8TD6Me3wrbrkS1z3Gpjk3ppd8m8-s_',\n  start: 0,\n  end: 0,\n  pendingDepositAmount: 0n,\n};\n\nexport const SWAP_API_VERSION = 2;\n\nexport const JVAULT_URL = 'https://jvault.xyz';\n\nexport const TON_DNS_ZONES = [\n  {\n    suffixes: ['ton'],\n    baseFormat: /^([-\\da-z]+\\.){0,2}[-\\da-z]{4,126}$/i,\n    resolver: 'EQC3dNlesgVD8YbAazcauIrXBPfiVhMMr5YYk2in0Mtsz0Bz',\n    collectionName: 'TON DNS Domains',\n  },\n  {\n    suffixes: ['t.me'],\n    baseFormat: /^([-\\da-z]+\\.){0,2}[-_\\da-z]{4,32}$/i,\n    resolver: 'EQCA14o1-VWhS2efqoh_9M1b_A9DtKTuoqfmkn83AbJzwnPi',\n    isTelemint: true,\n    collectionName: 'Telegram Usernames',\n  },\n  {\n    suffixes: ['vip', 'ton.vip', 'vip.ton'],\n    baseFormat: /^([-\\da-z]+\\.){0,2}?[\\da-z]{1,24}$/i,\n    resolver: 'EQBWG4EBbPDv4Xj7xlPwzxd7hSyHMzwwLB5O6rY-0BBeaixS',\n    collectionName: 'VIP DNS Domains',\n    isUnofficial: true,\n  },\n  {\n    suffixes: ['gram'],\n    baseFormat: /^([-\\da-z]+\\.){0,2}[\\da-z]{1,127}$/i,\n    resolver: 'EQAic3zPce496ukFDhbco28FVsKKl2WUX_iJwaL87CBxSiLQ',\n    collectionName: 'GRAM DNS Domains',\n    isUnofficial: true,\n  },\n];\n","// Version 3.1.2\n/*! MIT License. Copyright 2015-2018 Richard Moore <me@ricmoo.com>. See LICENSE.txt. */\n(function(root) {\n  \"use strict\";\n\n  function checkInt(value) {\n    return (parseInt(value) === value);\n  }\n\n  function checkInts(arrayish) {\n    if (!checkInt(arrayish.length)) { return false; }\n\n    for (var i = 0; i < arrayish.length; i++) {\n      if (!checkInt(arrayish[i]) || arrayish[i] < 0 || arrayish[i] > 255) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  function coerceArray(arg, copy) {\n\n    // ArrayBuffer view\n    if (arg.buffer && arg.name === 'Uint8Array') {\n\n      if (copy) {\n        if (arg.slice) {\n          arg = arg.slice();\n        } else {\n          arg = Array.prototype.slice.call(arg);\n        }\n      }\n\n      return arg;\n    }\n\n    // It's an array; check it is a valid representation of a byte\n    if (Array.isArray(arg)) {\n      if (!checkInts(arg)) {\n        throw new Error('Array contains invalid value: ' + arg);\n      }\n\n      return new Uint8Array(arg);\n    }\n\n    // Something else, but behaves like an array (maybe a Buffer? Arguments?)\n    if (checkInt(arg.length) && checkInts(arg)) {\n      return new Uint8Array(arg);\n    }\n\n    throw new Error('unsupported array-like object');\n  }\n\n  function createArray(length) {\n    return new Uint8Array(length);\n  }\n\n  function copyArray(sourceArray, targetArray, targetStart, sourceStart, sourceEnd) {\n    if (sourceStart != null || sourceEnd != null) {\n      if (sourceArray.slice) {\n        sourceArray = sourceArray.slice(sourceStart, sourceEnd);\n      } else {\n        sourceArray = Array.prototype.slice.call(sourceArray, sourceStart, sourceEnd);\n      }\n    }\n    targetArray.set(sourceArray, targetStart);\n  }\n\n\n\n  var convertUtf8 = (function() {\n    function toBytes(text) {\n      var result = [], i = 0;\n      text = encodeURI(text);\n      while (i < text.length) {\n        var c = text.charCodeAt(i++);\n\n        // if it is a % sign, encode the following 2 bytes as a hex value\n        if (c === 37) {\n          result.push(parseInt(text.substr(i, 2), 16))\n          i += 2;\n\n          // otherwise, just the actual byte\n        } else {\n          result.push(c)\n        }\n      }\n\n      return coerceArray(result);\n    }\n\n    function fromBytes(bytes) {\n      var result = [], i = 0;\n\n      while (i < bytes.length) {\n        var c = bytes[i];\n\n        if (c < 128) {\n          result.push(String.fromCharCode(c));\n          i++;\n        } else if (c > 191 && c < 224) {\n          result.push(String.fromCharCode(((c & 0x1f) << 6) | (bytes[i + 1] & 0x3f)));\n          i += 2;\n        } else {\n          result.push(String.fromCharCode(((c & 0x0f) << 12) | ((bytes[i + 1] & 0x3f) << 6) | (bytes[i + 2] & 0x3f)));\n          i += 3;\n        }\n      }\n\n      return result.join('');\n    }\n\n    return {\n      toBytes: toBytes,\n      fromBytes: fromBytes,\n    }\n  })();\n\n  var convertHex = (function() {\n    function toBytes(text) {\n      var result = [];\n      for (var i = 0; i < text.length; i += 2) {\n        result.push(parseInt(text.substr(i, 2), 16));\n      }\n\n      return result;\n    }\n\n    // http://ixti.net/development/javascript/2011/11/11/base64-encodedecode-of-utf8-in-browser-with-js.html\n    var Hex = '0123456789abcdef';\n\n    function fromBytes(bytes) {\n      var result = [];\n      for (var i = 0; i < bytes.length; i++) {\n        var v = bytes[i];\n        result.push(Hex[(v & 0xf0) >> 4] + Hex[v & 0x0f]);\n      }\n      return result.join('');\n    }\n\n    return {\n      toBytes: toBytes,\n      fromBytes: fromBytes,\n    }\n  })();\n\n\n  // Number of rounds by keysize\n  var numberOfRounds = {16: 10, 24: 12, 32: 14}\n\n  // Round constant words\n  var rcon = [0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36, 0x6c, 0xd8, 0xab, 0x4d, 0x9a, 0x2f, 0x5e, 0xbc, 0x63, 0xc6, 0x97, 0x35, 0x6a, 0xd4, 0xb3, 0x7d, 0xfa, 0xef, 0xc5, 0x91];\n\n  // S-box and Inverse S-box (S is for Substitution)\n  var S = [0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76, 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0, 0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15, 0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75, 0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84, 0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf, 0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8, 0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2, 0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73, 0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb, 0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79, 0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08, 0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a, 0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e, 0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf, 0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16];\n  var Si =[0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38, 0xbf, 0x40, 0xa3, 0x9e, 0x81, 0xf3, 0xd7, 0xfb, 0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87, 0x34, 0x8e, 0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb, 0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23, 0x3d, 0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e, 0x08, 0x2e, 0xa1, 0x66, 0x28, 0xd9, 0x24, 0xb2, 0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25, 0x72, 0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65, 0xb6, 0x92, 0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda, 0x5e, 0x15, 0x46, 0x57, 0xa7, 0x8d, 0x9d, 0x84, 0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a, 0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06, 0xd0, 0x2c, 0x1e, 0x8f, 0xca, 0x3f, 0x0f, 0x02, 0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b, 0x3a, 0x91, 0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea, 0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6, 0x73, 0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85, 0xe2, 0xf9, 0x37, 0xe8, 0x1c, 0x75, 0xdf, 0x6e, 0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89, 0x6f, 0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b, 0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2, 0x79, 0x20, 0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4, 0x1f, 0xdd, 0xa8, 0x33, 0x88, 0x07, 0xc7, 0x31, 0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f, 0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d, 0x2d, 0xe5, 0x7a, 0x9f, 0x93, 0xc9, 0x9c, 0xef, 0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0, 0xc8, 0xeb, 0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6, 0x26, 0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d];\n\n  // Transformations for encryption\n  var T1 = [0xc66363a5, 0xf87c7c84, 0xee777799, 0xf67b7b8d, 0xfff2f20d, 0xd66b6bbd, 0xde6f6fb1, 0x91c5c554, 0x60303050, 0x02010103, 0xce6767a9, 0x562b2b7d, 0xe7fefe19, 0xb5d7d762, 0x4dababe6, 0xec76769a, 0x8fcaca45, 0x1f82829d, 0x89c9c940, 0xfa7d7d87, 0xeffafa15, 0xb25959eb, 0x8e4747c9, 0xfbf0f00b, 0x41adadec, 0xb3d4d467, 0x5fa2a2fd, 0x45afafea, 0x239c9cbf, 0x53a4a4f7, 0xe4727296, 0x9bc0c05b, 0x75b7b7c2, 0xe1fdfd1c, 0x3d9393ae, 0x4c26266a, 0x6c36365a, 0x7e3f3f41, 0xf5f7f702, 0x83cccc4f, 0x6834345c, 0x51a5a5f4, 0xd1e5e534, 0xf9f1f108, 0xe2717193, 0xabd8d873, 0x62313153, 0x2a15153f, 0x0804040c, 0x95c7c752, 0x46232365, 0x9dc3c35e, 0x30181828, 0x379696a1, 0x0a05050f, 0x2f9a9ab5, 0x0e070709, 0x24121236, 0x1b80809b, 0xdfe2e23d, 0xcdebeb26, 0x4e272769, 0x7fb2b2cd, 0xea75759f, 0x1209091b, 0x1d83839e, 0x582c2c74, 0x341a1a2e, 0x361b1b2d, 0xdc6e6eb2, 0xb45a5aee, 0x5ba0a0fb, 0xa45252f6, 0x763b3b4d, 0xb7d6d661, 0x7db3b3ce, 0x5229297b, 0xdde3e33e, 0x5e2f2f71, 0x13848497, 0xa65353f5, 0xb9d1d168, 0x00000000, 0xc1eded2c, 0x40202060, 0xe3fcfc1f, 0x79b1b1c8, 0xb65b5bed, 0xd46a6abe, 0x8dcbcb46, 0x67bebed9, 0x7239394b, 0x944a4ade, 0x984c4cd4, 0xb05858e8, 0x85cfcf4a, 0xbbd0d06b, 0xc5efef2a, 0x4faaaae5, 0xedfbfb16, 0x864343c5, 0x9a4d4dd7, 0x66333355, 0x11858594, 0x8a4545cf, 0xe9f9f910, 0x04020206, 0xfe7f7f81, 0xa05050f0, 0x783c3c44, 0x259f9fba, 0x4ba8a8e3, 0xa25151f3, 0x5da3a3fe, 0x804040c0, 0x058f8f8a, 0x3f9292ad, 0x219d9dbc, 0x70383848, 0xf1f5f504, 0x63bcbcdf, 0x77b6b6c1, 0xafdada75, 0x42212163, 0x20101030, 0xe5ffff1a, 0xfdf3f30e, 0xbfd2d26d, 0x81cdcd4c, 0x180c0c14, 0x26131335, 0xc3ecec2f, 0xbe5f5fe1, 0x359797a2, 0x884444cc, 0x2e171739, 0x93c4c457, 0x55a7a7f2, 0xfc7e7e82, 0x7a3d3d47, 0xc86464ac, 0xba5d5de7, 0x3219192b, 0xe6737395, 0xc06060a0, 0x19818198, 0x9e4f4fd1, 0xa3dcdc7f, 0x44222266, 0x542a2a7e, 0x3b9090ab, 0x0b888883, 0x8c4646ca, 0xc7eeee29, 0x6bb8b8d3, 0x2814143c, 0xa7dede79, 0xbc5e5ee2, 0x160b0b1d, 0xaddbdb76, 0xdbe0e03b, 0x64323256, 0x743a3a4e, 0x140a0a1e, 0x924949db, 0x0c06060a, 0x4824246c, 0xb85c5ce4, 0x9fc2c25d, 0xbdd3d36e, 0x43acacef, 0xc46262a6, 0x399191a8, 0x319595a4, 0xd3e4e437, 0xf279798b, 0xd5e7e732, 0x8bc8c843, 0x6e373759, 0xda6d6db7, 0x018d8d8c, 0xb1d5d564, 0x9c4e4ed2, 0x49a9a9e0, 0xd86c6cb4, 0xac5656fa, 0xf3f4f407, 0xcfeaea25, 0xca6565af, 0xf47a7a8e, 0x47aeaee9, 0x10080818, 0x6fbabad5, 0xf0787888, 0x4a25256f, 0x5c2e2e72, 0x381c1c24, 0x57a6a6f1, 0x73b4b4c7, 0x97c6c651, 0xcbe8e823, 0xa1dddd7c, 0xe874749c, 0x3e1f1f21, 0x964b4bdd, 0x61bdbddc, 0x0d8b8b86, 0x0f8a8a85, 0xe0707090, 0x7c3e3e42, 0x71b5b5c4, 0xcc6666aa, 0x904848d8, 0x06030305, 0xf7f6f601, 0x1c0e0e12, 0xc26161a3, 0x6a35355f, 0xae5757f9, 0x69b9b9d0, 0x17868691, 0x99c1c158, 0x3a1d1d27, 0x279e9eb9, 0xd9e1e138, 0xebf8f813, 0x2b9898b3, 0x22111133, 0xd26969bb, 0xa9d9d970, 0x078e8e89, 0x339494a7, 0x2d9b9bb6, 0x3c1e1e22, 0x15878792, 0xc9e9e920, 0x87cece49, 0xaa5555ff, 0x50282878, 0xa5dfdf7a, 0x038c8c8f, 0x59a1a1f8, 0x09898980, 0x1a0d0d17, 0x65bfbfda, 0xd7e6e631, 0x844242c6, 0xd06868b8, 0x824141c3, 0x299999b0, 0x5a2d2d77, 0x1e0f0f11, 0x7bb0b0cb, 0xa85454fc, 0x6dbbbbd6, 0x2c16163a];\n  var T2 = [0xa5c66363, 0x84f87c7c, 0x99ee7777, 0x8df67b7b, 0x0dfff2f2, 0xbdd66b6b, 0xb1de6f6f, 0x5491c5c5, 0x50603030, 0x03020101, 0xa9ce6767, 0x7d562b2b, 0x19e7fefe, 0x62b5d7d7, 0xe64dabab, 0x9aec7676, 0x458fcaca, 0x9d1f8282, 0x4089c9c9, 0x87fa7d7d, 0x15effafa, 0xebb25959, 0xc98e4747, 0x0bfbf0f0, 0xec41adad, 0x67b3d4d4, 0xfd5fa2a2, 0xea45afaf, 0xbf239c9c, 0xf753a4a4, 0x96e47272, 0x5b9bc0c0, 0xc275b7b7, 0x1ce1fdfd, 0xae3d9393, 0x6a4c2626, 0x5a6c3636, 0x417e3f3f, 0x02f5f7f7, 0x4f83cccc, 0x5c683434, 0xf451a5a5, 0x34d1e5e5, 0x08f9f1f1, 0x93e27171, 0x73abd8d8, 0x53623131, 0x3f2a1515, 0x0c080404, 0x5295c7c7, 0x65462323, 0x5e9dc3c3, 0x28301818, 0xa1379696, 0x0f0a0505, 0xb52f9a9a, 0x090e0707, 0x36241212, 0x9b1b8080, 0x3ddfe2e2, 0x26cdebeb, 0x694e2727, 0xcd7fb2b2, 0x9fea7575, 0x1b120909, 0x9e1d8383, 0x74582c2c, 0x2e341a1a, 0x2d361b1b, 0xb2dc6e6e, 0xeeb45a5a, 0xfb5ba0a0, 0xf6a45252, 0x4d763b3b, 0x61b7d6d6, 0xce7db3b3, 0x7b522929, 0x3edde3e3, 0x715e2f2f, 0x97138484, 0xf5a65353, 0x68b9d1d1, 0x00000000, 0x2cc1eded, 0x60402020, 0x1fe3fcfc, 0xc879b1b1, 0xedb65b5b, 0xbed46a6a, 0x468dcbcb, 0xd967bebe, 0x4b723939, 0xde944a4a, 0xd4984c4c, 0xe8b05858, 0x4a85cfcf, 0x6bbbd0d0, 0x2ac5efef, 0xe54faaaa, 0x16edfbfb, 0xc5864343, 0xd79a4d4d, 0x55663333, 0x94118585, 0xcf8a4545, 0x10e9f9f9, 0x06040202, 0x81fe7f7f, 0xf0a05050, 0x44783c3c, 0xba259f9f, 0xe34ba8a8, 0xf3a25151, 0xfe5da3a3, 0xc0804040, 0x8a058f8f, 0xad3f9292, 0xbc219d9d, 0x48703838, 0x04f1f5f5, 0xdf63bcbc, 0xc177b6b6, 0x75afdada, 0x63422121, 0x30201010, 0x1ae5ffff, 0x0efdf3f3, 0x6dbfd2d2, 0x4c81cdcd, 0x14180c0c, 0x35261313, 0x2fc3ecec, 0xe1be5f5f, 0xa2359797, 0xcc884444, 0x392e1717, 0x5793c4c4, 0xf255a7a7, 0x82fc7e7e, 0x477a3d3d, 0xacc86464, 0xe7ba5d5d, 0x2b321919, 0x95e67373, 0xa0c06060, 0x98198181, 0xd19e4f4f, 0x7fa3dcdc, 0x66442222, 0x7e542a2a, 0xab3b9090, 0x830b8888, 0xca8c4646, 0x29c7eeee, 0xd36bb8b8, 0x3c281414, 0x79a7dede, 0xe2bc5e5e, 0x1d160b0b, 0x76addbdb, 0x3bdbe0e0, 0x56643232, 0x4e743a3a, 0x1e140a0a, 0xdb924949, 0x0a0c0606, 0x6c482424, 0xe4b85c5c, 0x5d9fc2c2, 0x6ebdd3d3, 0xef43acac, 0xa6c46262, 0xa8399191, 0xa4319595, 0x37d3e4e4, 0x8bf27979, 0x32d5e7e7, 0x438bc8c8, 0x596e3737, 0xb7da6d6d, 0x8c018d8d, 0x64b1d5d5, 0xd29c4e4e, 0xe049a9a9, 0xb4d86c6c, 0xfaac5656, 0x07f3f4f4, 0x25cfeaea, 0xafca6565, 0x8ef47a7a, 0xe947aeae, 0x18100808, 0xd56fbaba, 0x88f07878, 0x6f4a2525, 0x725c2e2e, 0x24381c1c, 0xf157a6a6, 0xc773b4b4, 0x5197c6c6, 0x23cbe8e8, 0x7ca1dddd, 0x9ce87474, 0x213e1f1f, 0xdd964b4b, 0xdc61bdbd, 0x860d8b8b, 0x850f8a8a, 0x90e07070, 0x427c3e3e, 0xc471b5b5, 0xaacc6666, 0xd8904848, 0x05060303, 0x01f7f6f6, 0x121c0e0e, 0xa3c26161, 0x5f6a3535, 0xf9ae5757, 0xd069b9b9, 0x91178686, 0x5899c1c1, 0x273a1d1d, 0xb9279e9e, 0x38d9e1e1, 0x13ebf8f8, 0xb32b9898, 0x33221111, 0xbbd26969, 0x70a9d9d9, 0x89078e8e, 0xa7339494, 0xb62d9b9b, 0x223c1e1e, 0x92158787, 0x20c9e9e9, 0x4987cece, 0xffaa5555, 0x78502828, 0x7aa5dfdf, 0x8f038c8c, 0xf859a1a1, 0x80098989, 0x171a0d0d, 0xda65bfbf, 0x31d7e6e6, 0xc6844242, 0xb8d06868, 0xc3824141, 0xb0299999, 0x775a2d2d, 0x111e0f0f, 0xcb7bb0b0, 0xfca85454, 0xd66dbbbb, 0x3a2c1616];\n  var T3 = [0x63a5c663, 0x7c84f87c, 0x7799ee77, 0x7b8df67b, 0xf20dfff2, 0x6bbdd66b, 0x6fb1de6f, 0xc55491c5, 0x30506030, 0x01030201, 0x67a9ce67, 0x2b7d562b, 0xfe19e7fe, 0xd762b5d7, 0xabe64dab, 0x769aec76, 0xca458fca, 0x829d1f82, 0xc94089c9, 0x7d87fa7d, 0xfa15effa, 0x59ebb259, 0x47c98e47, 0xf00bfbf0, 0xadec41ad, 0xd467b3d4, 0xa2fd5fa2, 0xafea45af, 0x9cbf239c, 0xa4f753a4, 0x7296e472, 0xc05b9bc0, 0xb7c275b7, 0xfd1ce1fd, 0x93ae3d93, 0x266a4c26, 0x365a6c36, 0x3f417e3f, 0xf702f5f7, 0xcc4f83cc, 0x345c6834, 0xa5f451a5, 0xe534d1e5, 0xf108f9f1, 0x7193e271, 0xd873abd8, 0x31536231, 0x153f2a15, 0x040c0804, 0xc75295c7, 0x23654623, 0xc35e9dc3, 0x18283018, 0x96a13796, 0x050f0a05, 0x9ab52f9a, 0x07090e07, 0x12362412, 0x809b1b80, 0xe23ddfe2, 0xeb26cdeb, 0x27694e27, 0xb2cd7fb2, 0x759fea75, 0x091b1209, 0x839e1d83, 0x2c74582c, 0x1a2e341a, 0x1b2d361b, 0x6eb2dc6e, 0x5aeeb45a, 0xa0fb5ba0, 0x52f6a452, 0x3b4d763b, 0xd661b7d6, 0xb3ce7db3, 0x297b5229, 0xe33edde3, 0x2f715e2f, 0x84971384, 0x53f5a653, 0xd168b9d1, 0x00000000, 0xed2cc1ed, 0x20604020, 0xfc1fe3fc, 0xb1c879b1, 0x5bedb65b, 0x6abed46a, 0xcb468dcb, 0xbed967be, 0x394b7239, 0x4ade944a, 0x4cd4984c, 0x58e8b058, 0xcf4a85cf, 0xd06bbbd0, 0xef2ac5ef, 0xaae54faa, 0xfb16edfb, 0x43c58643, 0x4dd79a4d, 0x33556633, 0x85941185, 0x45cf8a45, 0xf910e9f9, 0x02060402, 0x7f81fe7f, 0x50f0a050, 0x3c44783c, 0x9fba259f, 0xa8e34ba8, 0x51f3a251, 0xa3fe5da3, 0x40c08040, 0x8f8a058f, 0x92ad3f92, 0x9dbc219d, 0x38487038, 0xf504f1f5, 0xbcdf63bc, 0xb6c177b6, 0xda75afda, 0x21634221, 0x10302010, 0xff1ae5ff, 0xf30efdf3, 0xd26dbfd2, 0xcd4c81cd, 0x0c14180c, 0x13352613, 0xec2fc3ec, 0x5fe1be5f, 0x97a23597, 0x44cc8844, 0x17392e17, 0xc45793c4, 0xa7f255a7, 0x7e82fc7e, 0x3d477a3d, 0x64acc864, 0x5de7ba5d, 0x192b3219, 0x7395e673, 0x60a0c060, 0x81981981, 0x4fd19e4f, 0xdc7fa3dc, 0x22664422, 0x2a7e542a, 0x90ab3b90, 0x88830b88, 0x46ca8c46, 0xee29c7ee, 0xb8d36bb8, 0x143c2814, 0xde79a7de, 0x5ee2bc5e, 0x0b1d160b, 0xdb76addb, 0xe03bdbe0, 0x32566432, 0x3a4e743a, 0x0a1e140a, 0x49db9249, 0x060a0c06, 0x246c4824, 0x5ce4b85c, 0xc25d9fc2, 0xd36ebdd3, 0xacef43ac, 0x62a6c462, 0x91a83991, 0x95a43195, 0xe437d3e4, 0x798bf279, 0xe732d5e7, 0xc8438bc8, 0x37596e37, 0x6db7da6d, 0x8d8c018d, 0xd564b1d5, 0x4ed29c4e, 0xa9e049a9, 0x6cb4d86c, 0x56faac56, 0xf407f3f4, 0xea25cfea, 0x65afca65, 0x7a8ef47a, 0xaee947ae, 0x08181008, 0xbad56fba, 0x7888f078, 0x256f4a25, 0x2e725c2e, 0x1c24381c, 0xa6f157a6, 0xb4c773b4, 0xc65197c6, 0xe823cbe8, 0xdd7ca1dd, 0x749ce874, 0x1f213e1f, 0x4bdd964b, 0xbddc61bd, 0x8b860d8b, 0x8a850f8a, 0x7090e070, 0x3e427c3e, 0xb5c471b5, 0x66aacc66, 0x48d89048, 0x03050603, 0xf601f7f6, 0x0e121c0e, 0x61a3c261, 0x355f6a35, 0x57f9ae57, 0xb9d069b9, 0x86911786, 0xc15899c1, 0x1d273a1d, 0x9eb9279e, 0xe138d9e1, 0xf813ebf8, 0x98b32b98, 0x11332211, 0x69bbd269, 0xd970a9d9, 0x8e89078e, 0x94a73394, 0x9bb62d9b, 0x1e223c1e, 0x87921587, 0xe920c9e9, 0xce4987ce, 0x55ffaa55, 0x28785028, 0xdf7aa5df, 0x8c8f038c, 0xa1f859a1, 0x89800989, 0x0d171a0d, 0xbfda65bf, 0xe631d7e6, 0x42c68442, 0x68b8d068, 0x41c38241, 0x99b02999, 0x2d775a2d, 0x0f111e0f, 0xb0cb7bb0, 0x54fca854, 0xbbd66dbb, 0x163a2c16];\n  var T4 = [0x6363a5c6, 0x7c7c84f8, 0x777799ee, 0x7b7b8df6, 0xf2f20dff, 0x6b6bbdd6, 0x6f6fb1de, 0xc5c55491, 0x30305060, 0x01010302, 0x6767a9ce, 0x2b2b7d56, 0xfefe19e7, 0xd7d762b5, 0xababe64d, 0x76769aec, 0xcaca458f, 0x82829d1f, 0xc9c94089, 0x7d7d87fa, 0xfafa15ef, 0x5959ebb2, 0x4747c98e, 0xf0f00bfb, 0xadadec41, 0xd4d467b3, 0xa2a2fd5f, 0xafafea45, 0x9c9cbf23, 0xa4a4f753, 0x727296e4, 0xc0c05b9b, 0xb7b7c275, 0xfdfd1ce1, 0x9393ae3d, 0x26266a4c, 0x36365a6c, 0x3f3f417e, 0xf7f702f5, 0xcccc4f83, 0x34345c68, 0xa5a5f451, 0xe5e534d1, 0xf1f108f9, 0x717193e2, 0xd8d873ab, 0x31315362, 0x15153f2a, 0x04040c08, 0xc7c75295, 0x23236546, 0xc3c35e9d, 0x18182830, 0x9696a137, 0x05050f0a, 0x9a9ab52f, 0x0707090e, 0x12123624, 0x80809b1b, 0xe2e23ddf, 0xebeb26cd, 0x2727694e, 0xb2b2cd7f, 0x75759fea, 0x09091b12, 0x83839e1d, 0x2c2c7458, 0x1a1a2e34, 0x1b1b2d36, 0x6e6eb2dc, 0x5a5aeeb4, 0xa0a0fb5b, 0x5252f6a4, 0x3b3b4d76, 0xd6d661b7, 0xb3b3ce7d, 0x29297b52, 0xe3e33edd, 0x2f2f715e, 0x84849713, 0x5353f5a6, 0xd1d168b9, 0x00000000, 0xeded2cc1, 0x20206040, 0xfcfc1fe3, 0xb1b1c879, 0x5b5bedb6, 0x6a6abed4, 0xcbcb468d, 0xbebed967, 0x39394b72, 0x4a4ade94, 0x4c4cd498, 0x5858e8b0, 0xcfcf4a85, 0xd0d06bbb, 0xefef2ac5, 0xaaaae54f, 0xfbfb16ed, 0x4343c586, 0x4d4dd79a, 0x33335566, 0x85859411, 0x4545cf8a, 0xf9f910e9, 0x02020604, 0x7f7f81fe, 0x5050f0a0, 0x3c3c4478, 0x9f9fba25, 0xa8a8e34b, 0x5151f3a2, 0xa3a3fe5d, 0x4040c080, 0x8f8f8a05, 0x9292ad3f, 0x9d9dbc21, 0x38384870, 0xf5f504f1, 0xbcbcdf63, 0xb6b6c177, 0xdada75af, 0x21216342, 0x10103020, 0xffff1ae5, 0xf3f30efd, 0xd2d26dbf, 0xcdcd4c81, 0x0c0c1418, 0x13133526, 0xecec2fc3, 0x5f5fe1be, 0x9797a235, 0x4444cc88, 0x1717392e, 0xc4c45793, 0xa7a7f255, 0x7e7e82fc, 0x3d3d477a, 0x6464acc8, 0x5d5de7ba, 0x19192b32, 0x737395e6, 0x6060a0c0, 0x81819819, 0x4f4fd19e, 0xdcdc7fa3, 0x22226644, 0x2a2a7e54, 0x9090ab3b, 0x8888830b, 0x4646ca8c, 0xeeee29c7, 0xb8b8d36b, 0x14143c28, 0xdede79a7, 0x5e5ee2bc, 0x0b0b1d16, 0xdbdb76ad, 0xe0e03bdb, 0x32325664, 0x3a3a4e74, 0x0a0a1e14, 0x4949db92, 0x06060a0c, 0x24246c48, 0x5c5ce4b8, 0xc2c25d9f, 0xd3d36ebd, 0xacacef43, 0x6262a6c4, 0x9191a839, 0x9595a431, 0xe4e437d3, 0x79798bf2, 0xe7e732d5, 0xc8c8438b, 0x3737596e, 0x6d6db7da, 0x8d8d8c01, 0xd5d564b1, 0x4e4ed29c, 0xa9a9e049, 0x6c6cb4d8, 0x5656faac, 0xf4f407f3, 0xeaea25cf, 0x6565afca, 0x7a7a8ef4, 0xaeaee947, 0x08081810, 0xbabad56f, 0x787888f0, 0x25256f4a, 0x2e2e725c, 0x1c1c2438, 0xa6a6f157, 0xb4b4c773, 0xc6c65197, 0xe8e823cb, 0xdddd7ca1, 0x74749ce8, 0x1f1f213e, 0x4b4bdd96, 0xbdbddc61, 0x8b8b860d, 0x8a8a850f, 0x707090e0, 0x3e3e427c, 0xb5b5c471, 0x6666aacc, 0x4848d890, 0x03030506, 0xf6f601f7, 0x0e0e121c, 0x6161a3c2, 0x35355f6a, 0x5757f9ae, 0xb9b9d069, 0x86869117, 0xc1c15899, 0x1d1d273a, 0x9e9eb927, 0xe1e138d9, 0xf8f813eb, 0x9898b32b, 0x11113322, 0x6969bbd2, 0xd9d970a9, 0x8e8e8907, 0x9494a733, 0x9b9bb62d, 0x1e1e223c, 0x87879215, 0xe9e920c9, 0xcece4987, 0x5555ffaa, 0x28287850, 0xdfdf7aa5, 0x8c8c8f03, 0xa1a1f859, 0x89898009, 0x0d0d171a, 0xbfbfda65, 0xe6e631d7, 0x4242c684, 0x6868b8d0, 0x4141c382, 0x9999b029, 0x2d2d775a, 0x0f0f111e, 0xb0b0cb7b, 0x5454fca8, 0xbbbbd66d, 0x16163a2c];\n\n  // Transformations for decryption\n  var T5 = [0x51f4a750, 0x7e416553, 0x1a17a4c3, 0x3a275e96, 0x3bab6bcb, 0x1f9d45f1, 0xacfa58ab, 0x4be30393, 0x2030fa55, 0xad766df6, 0x88cc7691, 0xf5024c25, 0x4fe5d7fc, 0xc52acbd7, 0x26354480, 0xb562a38f, 0xdeb15a49, 0x25ba1b67, 0x45ea0e98, 0x5dfec0e1, 0xc32f7502, 0x814cf012, 0x8d4697a3, 0x6bd3f9c6, 0x038f5fe7, 0x15929c95, 0xbf6d7aeb, 0x955259da, 0xd4be832d, 0x587421d3, 0x49e06929, 0x8ec9c844, 0x75c2896a, 0xf48e7978, 0x99583e6b, 0x27b971dd, 0xbee14fb6, 0xf088ad17, 0xc920ac66, 0x7dce3ab4, 0x63df4a18, 0xe51a3182, 0x97513360, 0x62537f45, 0xb16477e0, 0xbb6bae84, 0xfe81a01c, 0xf9082b94, 0x70486858, 0x8f45fd19, 0x94de6c87, 0x527bf8b7, 0xab73d323, 0x724b02e2, 0xe31f8f57, 0x6655ab2a, 0xb2eb2807, 0x2fb5c203, 0x86c57b9a, 0xd33708a5, 0x302887f2, 0x23bfa5b2, 0x02036aba, 0xed16825c, 0x8acf1c2b, 0xa779b492, 0xf307f2f0, 0x4e69e2a1, 0x65daf4cd, 0x0605bed5, 0xd134621f, 0xc4a6fe8a, 0x342e539d, 0xa2f355a0, 0x058ae132, 0xa4f6eb75, 0x0b83ec39, 0x4060efaa, 0x5e719f06, 0xbd6e1051, 0x3e218af9, 0x96dd063d, 0xdd3e05ae, 0x4de6bd46, 0x91548db5, 0x71c45d05, 0x0406d46f, 0x605015ff, 0x1998fb24, 0xd6bde997, 0x894043cc, 0x67d99e77, 0xb0e842bd, 0x07898b88, 0xe7195b38, 0x79c8eedb, 0xa17c0a47, 0x7c420fe9, 0xf8841ec9, 0x00000000, 0x09808683, 0x322bed48, 0x1e1170ac, 0x6c5a724e, 0xfd0efffb, 0x0f853856, 0x3daed51e, 0x362d3927, 0x0a0fd964, 0x685ca621, 0x9b5b54d1, 0x24362e3a, 0x0c0a67b1, 0x9357e70f, 0xb4ee96d2, 0x1b9b919e, 0x80c0c54f, 0x61dc20a2, 0x5a774b69, 0x1c121a16, 0xe293ba0a, 0xc0a02ae5, 0x3c22e043, 0x121b171d, 0x0e090d0b, 0xf28bc7ad, 0x2db6a8b9, 0x141ea9c8, 0x57f11985, 0xaf75074c, 0xee99ddbb, 0xa37f60fd, 0xf701269f, 0x5c72f5bc, 0x44663bc5, 0x5bfb7e34, 0x8b432976, 0xcb23c6dc, 0xb6edfc68, 0xb8e4f163, 0xd731dcca, 0x42638510, 0x13972240, 0x84c61120, 0x854a247d, 0xd2bb3df8, 0xaef93211, 0xc729a16d, 0x1d9e2f4b, 0xdcb230f3, 0x0d8652ec, 0x77c1e3d0, 0x2bb3166c, 0xa970b999, 0x119448fa, 0x47e96422, 0xa8fc8cc4, 0xa0f03f1a, 0x567d2cd8, 0x223390ef, 0x87494ec7, 0xd938d1c1, 0x8ccaa2fe, 0x98d40b36, 0xa6f581cf, 0xa57ade28, 0xdab78e26, 0x3fadbfa4, 0x2c3a9de4, 0x5078920d, 0x6a5fcc9b, 0x547e4662, 0xf68d13c2, 0x90d8b8e8, 0x2e39f75e, 0x82c3aff5, 0x9f5d80be, 0x69d0937c, 0x6fd52da9, 0xcf2512b3, 0xc8ac993b, 0x10187da7, 0xe89c636e, 0xdb3bbb7b, 0xcd267809, 0x6e5918f4, 0xec9ab701, 0x834f9aa8, 0xe6956e65, 0xaaffe67e, 0x21bccf08, 0xef15e8e6, 0xbae79bd9, 0x4a6f36ce, 0xea9f09d4, 0x29b07cd6, 0x31a4b2af, 0x2a3f2331, 0xc6a59430, 0x35a266c0, 0x744ebc37, 0xfc82caa6, 0xe090d0b0, 0x33a7d815, 0xf104984a, 0x41ecdaf7, 0x7fcd500e, 0x1791f62f, 0x764dd68d, 0x43efb04d, 0xccaa4d54, 0xe49604df, 0x9ed1b5e3, 0x4c6a881b, 0xc12c1fb8, 0x4665517f, 0x9d5eea04, 0x018c355d, 0xfa877473, 0xfb0b412e, 0xb3671d5a, 0x92dbd252, 0xe9105633, 0x6dd64713, 0x9ad7618c, 0x37a10c7a, 0x59f8148e, 0xeb133c89, 0xcea927ee, 0xb761c935, 0xe11ce5ed, 0x7a47b13c, 0x9cd2df59, 0x55f2733f, 0x1814ce79, 0x73c737bf, 0x53f7cdea, 0x5ffdaa5b, 0xdf3d6f14, 0x7844db86, 0xcaaff381, 0xb968c43e, 0x3824342c, 0xc2a3405f, 0x161dc372, 0xbce2250c, 0x283c498b, 0xff0d9541, 0x39a80171, 0x080cb3de, 0xd8b4e49c, 0x6456c190, 0x7bcb8461, 0xd532b670, 0x486c5c74, 0xd0b85742];\n  var T6 = [0x5051f4a7, 0x537e4165, 0xc31a17a4, 0x963a275e, 0xcb3bab6b, 0xf11f9d45, 0xabacfa58, 0x934be303, 0x552030fa, 0xf6ad766d, 0x9188cc76, 0x25f5024c, 0xfc4fe5d7, 0xd7c52acb, 0x80263544, 0x8fb562a3, 0x49deb15a, 0x6725ba1b, 0x9845ea0e, 0xe15dfec0, 0x02c32f75, 0x12814cf0, 0xa38d4697, 0xc66bd3f9, 0xe7038f5f, 0x9515929c, 0xebbf6d7a, 0xda955259, 0x2dd4be83, 0xd3587421, 0x2949e069, 0x448ec9c8, 0x6a75c289, 0x78f48e79, 0x6b99583e, 0xdd27b971, 0xb6bee14f, 0x17f088ad, 0x66c920ac, 0xb47dce3a, 0x1863df4a, 0x82e51a31, 0x60975133, 0x4562537f, 0xe0b16477, 0x84bb6bae, 0x1cfe81a0, 0x94f9082b, 0x58704868, 0x198f45fd, 0x8794de6c, 0xb7527bf8, 0x23ab73d3, 0xe2724b02, 0x57e31f8f, 0x2a6655ab, 0x07b2eb28, 0x032fb5c2, 0x9a86c57b, 0xa5d33708, 0xf2302887, 0xb223bfa5, 0xba02036a, 0x5ced1682, 0x2b8acf1c, 0x92a779b4, 0xf0f307f2, 0xa14e69e2, 0xcd65daf4, 0xd50605be, 0x1fd13462, 0x8ac4a6fe, 0x9d342e53, 0xa0a2f355, 0x32058ae1, 0x75a4f6eb, 0x390b83ec, 0xaa4060ef, 0x065e719f, 0x51bd6e10, 0xf93e218a, 0x3d96dd06, 0xaedd3e05, 0x464de6bd, 0xb591548d, 0x0571c45d, 0x6f0406d4, 0xff605015, 0x241998fb, 0x97d6bde9, 0xcc894043, 0x7767d99e, 0xbdb0e842, 0x8807898b, 0x38e7195b, 0xdb79c8ee, 0x47a17c0a, 0xe97c420f, 0xc9f8841e, 0x00000000, 0x83098086, 0x48322bed, 0xac1e1170, 0x4e6c5a72, 0xfbfd0eff, 0x560f8538, 0x1e3daed5, 0x27362d39, 0x640a0fd9, 0x21685ca6, 0xd19b5b54, 0x3a24362e, 0xb10c0a67, 0x0f9357e7, 0xd2b4ee96, 0x9e1b9b91, 0x4f80c0c5, 0xa261dc20, 0x695a774b, 0x161c121a, 0x0ae293ba, 0xe5c0a02a, 0x433c22e0, 0x1d121b17, 0x0b0e090d, 0xadf28bc7, 0xb92db6a8, 0xc8141ea9, 0x8557f119, 0x4caf7507, 0xbbee99dd, 0xfda37f60, 0x9ff70126, 0xbc5c72f5, 0xc544663b, 0x345bfb7e, 0x768b4329, 0xdccb23c6, 0x68b6edfc, 0x63b8e4f1, 0xcad731dc, 0x10426385, 0x40139722, 0x2084c611, 0x7d854a24, 0xf8d2bb3d, 0x11aef932, 0x6dc729a1, 0x4b1d9e2f, 0xf3dcb230, 0xec0d8652, 0xd077c1e3, 0x6c2bb316, 0x99a970b9, 0xfa119448, 0x2247e964, 0xc4a8fc8c, 0x1aa0f03f, 0xd8567d2c, 0xef223390, 0xc787494e, 0xc1d938d1, 0xfe8ccaa2, 0x3698d40b, 0xcfa6f581, 0x28a57ade, 0x26dab78e, 0xa43fadbf, 0xe42c3a9d, 0x0d507892, 0x9b6a5fcc, 0x62547e46, 0xc2f68d13, 0xe890d8b8, 0x5e2e39f7, 0xf582c3af, 0xbe9f5d80, 0x7c69d093, 0xa96fd52d, 0xb3cf2512, 0x3bc8ac99, 0xa710187d, 0x6ee89c63, 0x7bdb3bbb, 0x09cd2678, 0xf46e5918, 0x01ec9ab7, 0xa8834f9a, 0x65e6956e, 0x7eaaffe6, 0x0821bccf, 0xe6ef15e8, 0xd9bae79b, 0xce4a6f36, 0xd4ea9f09, 0xd629b07c, 0xaf31a4b2, 0x312a3f23, 0x30c6a594, 0xc035a266, 0x37744ebc, 0xa6fc82ca, 0xb0e090d0, 0x1533a7d8, 0x4af10498, 0xf741ecda, 0x0e7fcd50, 0x2f1791f6, 0x8d764dd6, 0x4d43efb0, 0x54ccaa4d, 0xdfe49604, 0xe39ed1b5, 0x1b4c6a88, 0xb8c12c1f, 0x7f466551, 0x049d5eea, 0x5d018c35, 0x73fa8774, 0x2efb0b41, 0x5ab3671d, 0x5292dbd2, 0x33e91056, 0x136dd647, 0x8c9ad761, 0x7a37a10c, 0x8e59f814, 0x89eb133c, 0xeecea927, 0x35b761c9, 0xede11ce5, 0x3c7a47b1, 0x599cd2df, 0x3f55f273, 0x791814ce, 0xbf73c737, 0xea53f7cd, 0x5b5ffdaa, 0x14df3d6f, 0x867844db, 0x81caaff3, 0x3eb968c4, 0x2c382434, 0x5fc2a340, 0x72161dc3, 0x0cbce225, 0x8b283c49, 0x41ff0d95, 0x7139a801, 0xde080cb3, 0x9cd8b4e4, 0x906456c1, 0x617bcb84, 0x70d532b6, 0x74486c5c, 0x42d0b857];\n  var T7 = [0xa75051f4, 0x65537e41, 0xa4c31a17, 0x5e963a27, 0x6bcb3bab, 0x45f11f9d, 0x58abacfa, 0x03934be3, 0xfa552030, 0x6df6ad76, 0x769188cc, 0x4c25f502, 0xd7fc4fe5, 0xcbd7c52a, 0x44802635, 0xa38fb562, 0x5a49deb1, 0x1b6725ba, 0x0e9845ea, 0xc0e15dfe, 0x7502c32f, 0xf012814c, 0x97a38d46, 0xf9c66bd3, 0x5fe7038f, 0x9c951592, 0x7aebbf6d, 0x59da9552, 0x832dd4be, 0x21d35874, 0x692949e0, 0xc8448ec9, 0x896a75c2, 0x7978f48e, 0x3e6b9958, 0x71dd27b9, 0x4fb6bee1, 0xad17f088, 0xac66c920, 0x3ab47dce, 0x4a1863df, 0x3182e51a, 0x33609751, 0x7f456253, 0x77e0b164, 0xae84bb6b, 0xa01cfe81, 0x2b94f908, 0x68587048, 0xfd198f45, 0x6c8794de, 0xf8b7527b, 0xd323ab73, 0x02e2724b, 0x8f57e31f, 0xab2a6655, 0x2807b2eb, 0xc2032fb5, 0x7b9a86c5, 0x08a5d337, 0x87f23028, 0xa5b223bf, 0x6aba0203, 0x825ced16, 0x1c2b8acf, 0xb492a779, 0xf2f0f307, 0xe2a14e69, 0xf4cd65da, 0xbed50605, 0x621fd134, 0xfe8ac4a6, 0x539d342e, 0x55a0a2f3, 0xe132058a, 0xeb75a4f6, 0xec390b83, 0xefaa4060, 0x9f065e71, 0x1051bd6e, 0x8af93e21, 0x063d96dd, 0x05aedd3e, 0xbd464de6, 0x8db59154, 0x5d0571c4, 0xd46f0406, 0x15ff6050, 0xfb241998, 0xe997d6bd, 0x43cc8940, 0x9e7767d9, 0x42bdb0e8, 0x8b880789, 0x5b38e719, 0xeedb79c8, 0x0a47a17c, 0x0fe97c42, 0x1ec9f884, 0x00000000, 0x86830980, 0xed48322b, 0x70ac1e11, 0x724e6c5a, 0xfffbfd0e, 0x38560f85, 0xd51e3dae, 0x3927362d, 0xd9640a0f, 0xa621685c, 0x54d19b5b, 0x2e3a2436, 0x67b10c0a, 0xe70f9357, 0x96d2b4ee, 0x919e1b9b, 0xc54f80c0, 0x20a261dc, 0x4b695a77, 0x1a161c12, 0xba0ae293, 0x2ae5c0a0, 0xe0433c22, 0x171d121b, 0x0d0b0e09, 0xc7adf28b, 0xa8b92db6, 0xa9c8141e, 0x198557f1, 0x074caf75, 0xddbbee99, 0x60fda37f, 0x269ff701, 0xf5bc5c72, 0x3bc54466, 0x7e345bfb, 0x29768b43, 0xc6dccb23, 0xfc68b6ed, 0xf163b8e4, 0xdccad731, 0x85104263, 0x22401397, 0x112084c6, 0x247d854a, 0x3df8d2bb, 0x3211aef9, 0xa16dc729, 0x2f4b1d9e, 0x30f3dcb2, 0x52ec0d86, 0xe3d077c1, 0x166c2bb3, 0xb999a970, 0x48fa1194, 0x642247e9, 0x8cc4a8fc, 0x3f1aa0f0, 0x2cd8567d, 0x90ef2233, 0x4ec78749, 0xd1c1d938, 0xa2fe8cca, 0x0b3698d4, 0x81cfa6f5, 0xde28a57a, 0x8e26dab7, 0xbfa43fad, 0x9de42c3a, 0x920d5078, 0xcc9b6a5f, 0x4662547e, 0x13c2f68d, 0xb8e890d8, 0xf75e2e39, 0xaff582c3, 0x80be9f5d, 0x937c69d0, 0x2da96fd5, 0x12b3cf25, 0x993bc8ac, 0x7da71018, 0x636ee89c, 0xbb7bdb3b, 0x7809cd26, 0x18f46e59, 0xb701ec9a, 0x9aa8834f, 0x6e65e695, 0xe67eaaff, 0xcf0821bc, 0xe8e6ef15, 0x9bd9bae7, 0x36ce4a6f, 0x09d4ea9f, 0x7cd629b0, 0xb2af31a4, 0x23312a3f, 0x9430c6a5, 0x66c035a2, 0xbc37744e, 0xcaa6fc82, 0xd0b0e090, 0xd81533a7, 0x984af104, 0xdaf741ec, 0x500e7fcd, 0xf62f1791, 0xd68d764d, 0xb04d43ef, 0x4d54ccaa, 0x04dfe496, 0xb5e39ed1, 0x881b4c6a, 0x1fb8c12c, 0x517f4665, 0xea049d5e, 0x355d018c, 0x7473fa87, 0x412efb0b, 0x1d5ab367, 0xd25292db, 0x5633e910, 0x47136dd6, 0x618c9ad7, 0x0c7a37a1, 0x148e59f8, 0x3c89eb13, 0x27eecea9, 0xc935b761, 0xe5ede11c, 0xb13c7a47, 0xdf599cd2, 0x733f55f2, 0xce791814, 0x37bf73c7, 0xcdea53f7, 0xaa5b5ffd, 0x6f14df3d, 0xdb867844, 0xf381caaf, 0xc43eb968, 0x342c3824, 0x405fc2a3, 0xc372161d, 0x250cbce2, 0x498b283c, 0x9541ff0d, 0x017139a8, 0xb3de080c, 0xe49cd8b4, 0xc1906456, 0x84617bcb, 0xb670d532, 0x5c74486c, 0x5742d0b8];\n  var T8 = [0xf4a75051, 0x4165537e, 0x17a4c31a, 0x275e963a, 0xab6bcb3b, 0x9d45f11f, 0xfa58abac, 0xe303934b, 0x30fa5520, 0x766df6ad, 0xcc769188, 0x024c25f5, 0xe5d7fc4f, 0x2acbd7c5, 0x35448026, 0x62a38fb5, 0xb15a49de, 0xba1b6725, 0xea0e9845, 0xfec0e15d, 0x2f7502c3, 0x4cf01281, 0x4697a38d, 0xd3f9c66b, 0x8f5fe703, 0x929c9515, 0x6d7aebbf, 0x5259da95, 0xbe832dd4, 0x7421d358, 0xe0692949, 0xc9c8448e, 0xc2896a75, 0x8e7978f4, 0x583e6b99, 0xb971dd27, 0xe14fb6be, 0x88ad17f0, 0x20ac66c9, 0xce3ab47d, 0xdf4a1863, 0x1a3182e5, 0x51336097, 0x537f4562, 0x6477e0b1, 0x6bae84bb, 0x81a01cfe, 0x082b94f9, 0x48685870, 0x45fd198f, 0xde6c8794, 0x7bf8b752, 0x73d323ab, 0x4b02e272, 0x1f8f57e3, 0x55ab2a66, 0xeb2807b2, 0xb5c2032f, 0xc57b9a86, 0x3708a5d3, 0x2887f230, 0xbfa5b223, 0x036aba02, 0x16825ced, 0xcf1c2b8a, 0x79b492a7, 0x07f2f0f3, 0x69e2a14e, 0xdaf4cd65, 0x05bed506, 0x34621fd1, 0xa6fe8ac4, 0x2e539d34, 0xf355a0a2, 0x8ae13205, 0xf6eb75a4, 0x83ec390b, 0x60efaa40, 0x719f065e, 0x6e1051bd, 0x218af93e, 0xdd063d96, 0x3e05aedd, 0xe6bd464d, 0x548db591, 0xc45d0571, 0x06d46f04, 0x5015ff60, 0x98fb2419, 0xbde997d6, 0x4043cc89, 0xd99e7767, 0xe842bdb0, 0x898b8807, 0x195b38e7, 0xc8eedb79, 0x7c0a47a1, 0x420fe97c, 0x841ec9f8, 0x00000000, 0x80868309, 0x2bed4832, 0x1170ac1e, 0x5a724e6c, 0x0efffbfd, 0x8538560f, 0xaed51e3d, 0x2d392736, 0x0fd9640a, 0x5ca62168, 0x5b54d19b, 0x362e3a24, 0x0a67b10c, 0x57e70f93, 0xee96d2b4, 0x9b919e1b, 0xc0c54f80, 0xdc20a261, 0x774b695a, 0x121a161c, 0x93ba0ae2, 0xa02ae5c0, 0x22e0433c, 0x1b171d12, 0x090d0b0e, 0x8bc7adf2, 0xb6a8b92d, 0x1ea9c814, 0xf1198557, 0x75074caf, 0x99ddbbee, 0x7f60fda3, 0x01269ff7, 0x72f5bc5c, 0x663bc544, 0xfb7e345b, 0x4329768b, 0x23c6dccb, 0xedfc68b6, 0xe4f163b8, 0x31dccad7, 0x63851042, 0x97224013, 0xc6112084, 0x4a247d85, 0xbb3df8d2, 0xf93211ae, 0x29a16dc7, 0x9e2f4b1d, 0xb230f3dc, 0x8652ec0d, 0xc1e3d077, 0xb3166c2b, 0x70b999a9, 0x9448fa11, 0xe9642247, 0xfc8cc4a8, 0xf03f1aa0, 0x7d2cd856, 0x3390ef22, 0x494ec787, 0x38d1c1d9, 0xcaa2fe8c, 0xd40b3698, 0xf581cfa6, 0x7ade28a5, 0xb78e26da, 0xadbfa43f, 0x3a9de42c, 0x78920d50, 0x5fcc9b6a, 0x7e466254, 0x8d13c2f6, 0xd8b8e890, 0x39f75e2e, 0xc3aff582, 0x5d80be9f, 0xd0937c69, 0xd52da96f, 0x2512b3cf, 0xac993bc8, 0x187da710, 0x9c636ee8, 0x3bbb7bdb, 0x267809cd, 0x5918f46e, 0x9ab701ec, 0x4f9aa883, 0x956e65e6, 0xffe67eaa, 0xbccf0821, 0x15e8e6ef, 0xe79bd9ba, 0x6f36ce4a, 0x9f09d4ea, 0xb07cd629, 0xa4b2af31, 0x3f23312a, 0xa59430c6, 0xa266c035, 0x4ebc3774, 0x82caa6fc, 0x90d0b0e0, 0xa7d81533, 0x04984af1, 0xecdaf741, 0xcd500e7f, 0x91f62f17, 0x4dd68d76, 0xefb04d43, 0xaa4d54cc, 0x9604dfe4, 0xd1b5e39e, 0x6a881b4c, 0x2c1fb8c1, 0x65517f46, 0x5eea049d, 0x8c355d01, 0x877473fa, 0x0b412efb, 0x671d5ab3, 0xdbd25292, 0x105633e9, 0xd647136d, 0xd7618c9a, 0xa10c7a37, 0xf8148e59, 0x133c89eb, 0xa927eece, 0x61c935b7, 0x1ce5ede1, 0x47b13c7a, 0xd2df599c, 0xf2733f55, 0x14ce7918, 0xc737bf73, 0xf7cdea53, 0xfdaa5b5f, 0x3d6f14df, 0x44db8678, 0xaff381ca, 0x68c43eb9, 0x24342c38, 0xa3405fc2, 0x1dc37216, 0xe2250cbc, 0x3c498b28, 0x0d9541ff, 0xa8017139, 0x0cb3de08, 0xb4e49cd8, 0x56c19064, 0xcb84617b, 0x32b670d5, 0x6c5c7448, 0xb85742d0];\n\n  // Transformations for decryption key expansion\n  var U1 = [0x00000000, 0x0e090d0b, 0x1c121a16, 0x121b171d, 0x3824342c, 0x362d3927, 0x24362e3a, 0x2a3f2331, 0x70486858, 0x7e416553, 0x6c5a724e, 0x62537f45, 0x486c5c74, 0x4665517f, 0x547e4662, 0x5a774b69, 0xe090d0b0, 0xee99ddbb, 0xfc82caa6, 0xf28bc7ad, 0xd8b4e49c, 0xd6bde997, 0xc4a6fe8a, 0xcaaff381, 0x90d8b8e8, 0x9ed1b5e3, 0x8ccaa2fe, 0x82c3aff5, 0xa8fc8cc4, 0xa6f581cf, 0xb4ee96d2, 0xbae79bd9, 0xdb3bbb7b, 0xd532b670, 0xc729a16d, 0xc920ac66, 0xe31f8f57, 0xed16825c, 0xff0d9541, 0xf104984a, 0xab73d323, 0xa57ade28, 0xb761c935, 0xb968c43e, 0x9357e70f, 0x9d5eea04, 0x8f45fd19, 0x814cf012, 0x3bab6bcb, 0x35a266c0, 0x27b971dd, 0x29b07cd6, 0x038f5fe7, 0x0d8652ec, 0x1f9d45f1, 0x119448fa, 0x4be30393, 0x45ea0e98, 0x57f11985, 0x59f8148e, 0x73c737bf, 0x7dce3ab4, 0x6fd52da9, 0x61dc20a2, 0xad766df6, 0xa37f60fd, 0xb16477e0, 0xbf6d7aeb, 0x955259da, 0x9b5b54d1, 0x894043cc, 0x87494ec7, 0xdd3e05ae, 0xd33708a5, 0xc12c1fb8, 0xcf2512b3, 0xe51a3182, 0xeb133c89, 0xf9082b94, 0xf701269f, 0x4de6bd46, 0x43efb04d, 0x51f4a750, 0x5ffdaa5b, 0x75c2896a, 0x7bcb8461, 0x69d0937c, 0x67d99e77, 0x3daed51e, 0x33a7d815, 0x21bccf08, 0x2fb5c203, 0x058ae132, 0x0b83ec39, 0x1998fb24, 0x1791f62f, 0x764dd68d, 0x7844db86, 0x6a5fcc9b, 0x6456c190, 0x4e69e2a1, 0x4060efaa, 0x527bf8b7, 0x5c72f5bc, 0x0605bed5, 0x080cb3de, 0x1a17a4c3, 0x141ea9c8, 0x3e218af9, 0x302887f2, 0x223390ef, 0x2c3a9de4, 0x96dd063d, 0x98d40b36, 0x8acf1c2b, 0x84c61120, 0xaef93211, 0xa0f03f1a, 0xb2eb2807, 0xbce2250c, 0xe6956e65, 0xe89c636e, 0xfa877473, 0xf48e7978, 0xdeb15a49, 0xd0b85742, 0xc2a3405f, 0xccaa4d54, 0x41ecdaf7, 0x4fe5d7fc, 0x5dfec0e1, 0x53f7cdea, 0x79c8eedb, 0x77c1e3d0, 0x65daf4cd, 0x6bd3f9c6, 0x31a4b2af, 0x3fadbfa4, 0x2db6a8b9, 0x23bfa5b2, 0x09808683, 0x07898b88, 0x15929c95, 0x1b9b919e, 0xa17c0a47, 0xaf75074c, 0xbd6e1051, 0xb3671d5a, 0x99583e6b, 0x97513360, 0x854a247d, 0x8b432976, 0xd134621f, 0xdf3d6f14, 0xcd267809, 0xc32f7502, 0xe9105633, 0xe7195b38, 0xf5024c25, 0xfb0b412e, 0x9ad7618c, 0x94de6c87, 0x86c57b9a, 0x88cc7691, 0xa2f355a0, 0xacfa58ab, 0xbee14fb6, 0xb0e842bd, 0xea9f09d4, 0xe49604df, 0xf68d13c2, 0xf8841ec9, 0xd2bb3df8, 0xdcb230f3, 0xcea927ee, 0xc0a02ae5, 0x7a47b13c, 0x744ebc37, 0x6655ab2a, 0x685ca621, 0x42638510, 0x4c6a881b, 0x5e719f06, 0x5078920d, 0x0a0fd964, 0x0406d46f, 0x161dc372, 0x1814ce79, 0x322bed48, 0x3c22e043, 0x2e39f75e, 0x2030fa55, 0xec9ab701, 0xe293ba0a, 0xf088ad17, 0xfe81a01c, 0xd4be832d, 0xdab78e26, 0xc8ac993b, 0xc6a59430, 0x9cd2df59, 0x92dbd252, 0x80c0c54f, 0x8ec9c844, 0xa4f6eb75, 0xaaffe67e, 0xb8e4f163, 0xb6edfc68, 0x0c0a67b1, 0x02036aba, 0x10187da7, 0x1e1170ac, 0x342e539d, 0x3a275e96, 0x283c498b, 0x26354480, 0x7c420fe9, 0x724b02e2, 0x605015ff, 0x6e5918f4, 0x44663bc5, 0x4a6f36ce, 0x587421d3, 0x567d2cd8, 0x37a10c7a, 0x39a80171, 0x2bb3166c, 0x25ba1b67, 0x0f853856, 0x018c355d, 0x13972240, 0x1d9e2f4b, 0x47e96422, 0x49e06929, 0x5bfb7e34, 0x55f2733f, 0x7fcd500e, 0x71c45d05, 0x63df4a18, 0x6dd64713, 0xd731dcca, 0xd938d1c1, 0xcb23c6dc, 0xc52acbd7, 0xef15e8e6, 0xe11ce5ed, 0xf307f2f0, 0xfd0efffb, 0xa779b492, 0xa970b999, 0xbb6bae84, 0xb562a38f, 0x9f5d80be, 0x91548db5, 0x834f9aa8, 0x8d4697a3];\n  var U2 = [0x00000000, 0x0b0e090d, 0x161c121a, 0x1d121b17, 0x2c382434, 0x27362d39, 0x3a24362e, 0x312a3f23, 0x58704868, 0x537e4165, 0x4e6c5a72, 0x4562537f, 0x74486c5c, 0x7f466551, 0x62547e46, 0x695a774b, 0xb0e090d0, 0xbbee99dd, 0xa6fc82ca, 0xadf28bc7, 0x9cd8b4e4, 0x97d6bde9, 0x8ac4a6fe, 0x81caaff3, 0xe890d8b8, 0xe39ed1b5, 0xfe8ccaa2, 0xf582c3af, 0xc4a8fc8c, 0xcfa6f581, 0xd2b4ee96, 0xd9bae79b, 0x7bdb3bbb, 0x70d532b6, 0x6dc729a1, 0x66c920ac, 0x57e31f8f, 0x5ced1682, 0x41ff0d95, 0x4af10498, 0x23ab73d3, 0x28a57ade, 0x35b761c9, 0x3eb968c4, 0x0f9357e7, 0x049d5eea, 0x198f45fd, 0x12814cf0, 0xcb3bab6b, 0xc035a266, 0xdd27b971, 0xd629b07c, 0xe7038f5f, 0xec0d8652, 0xf11f9d45, 0xfa119448, 0x934be303, 0x9845ea0e, 0x8557f119, 0x8e59f814, 0xbf73c737, 0xb47dce3a, 0xa96fd52d, 0xa261dc20, 0xf6ad766d, 0xfda37f60, 0xe0b16477, 0xebbf6d7a, 0xda955259, 0xd19b5b54, 0xcc894043, 0xc787494e, 0xaedd3e05, 0xa5d33708, 0xb8c12c1f, 0xb3cf2512, 0x82e51a31, 0x89eb133c, 0x94f9082b, 0x9ff70126, 0x464de6bd, 0x4d43efb0, 0x5051f4a7, 0x5b5ffdaa, 0x6a75c289, 0x617bcb84, 0x7c69d093, 0x7767d99e, 0x1e3daed5, 0x1533a7d8, 0x0821bccf, 0x032fb5c2, 0x32058ae1, 0x390b83ec, 0x241998fb, 0x2f1791f6, 0x8d764dd6, 0x867844db, 0x9b6a5fcc, 0x906456c1, 0xa14e69e2, 0xaa4060ef, 0xb7527bf8, 0xbc5c72f5, 0xd50605be, 0xde080cb3, 0xc31a17a4, 0xc8141ea9, 0xf93e218a, 0xf2302887, 0xef223390, 0xe42c3a9d, 0x3d96dd06, 0x3698d40b, 0x2b8acf1c, 0x2084c611, 0x11aef932, 0x1aa0f03f, 0x07b2eb28, 0x0cbce225, 0x65e6956e, 0x6ee89c63, 0x73fa8774, 0x78f48e79, 0x49deb15a, 0x42d0b857, 0x5fc2a340, 0x54ccaa4d, 0xf741ecda, 0xfc4fe5d7, 0xe15dfec0, 0xea53f7cd, 0xdb79c8ee, 0xd077c1e3, 0xcd65daf4, 0xc66bd3f9, 0xaf31a4b2, 0xa43fadbf, 0xb92db6a8, 0xb223bfa5, 0x83098086, 0x8807898b, 0x9515929c, 0x9e1b9b91, 0x47a17c0a, 0x4caf7507, 0x51bd6e10, 0x5ab3671d, 0x6b99583e, 0x60975133, 0x7d854a24, 0x768b4329, 0x1fd13462, 0x14df3d6f, 0x09cd2678, 0x02c32f75, 0x33e91056, 0x38e7195b, 0x25f5024c, 0x2efb0b41, 0x8c9ad761, 0x8794de6c, 0x9a86c57b, 0x9188cc76, 0xa0a2f355, 0xabacfa58, 0xb6bee14f, 0xbdb0e842, 0xd4ea9f09, 0xdfe49604, 0xc2f68d13, 0xc9f8841e, 0xf8d2bb3d, 0xf3dcb230, 0xeecea927, 0xe5c0a02a, 0x3c7a47b1, 0x37744ebc, 0x2a6655ab, 0x21685ca6, 0x10426385, 0x1b4c6a88, 0x065e719f, 0x0d507892, 0x640a0fd9, 0x6f0406d4, 0x72161dc3, 0x791814ce, 0x48322bed, 0x433c22e0, 0x5e2e39f7, 0x552030fa, 0x01ec9ab7, 0x0ae293ba, 0x17f088ad, 0x1cfe81a0, 0x2dd4be83, 0x26dab78e, 0x3bc8ac99, 0x30c6a594, 0x599cd2df, 0x5292dbd2, 0x4f80c0c5, 0x448ec9c8, 0x75a4f6eb, 0x7eaaffe6, 0x63b8e4f1, 0x68b6edfc, 0xb10c0a67, 0xba02036a, 0xa710187d, 0xac1e1170, 0x9d342e53, 0x963a275e, 0x8b283c49, 0x80263544, 0xe97c420f, 0xe2724b02, 0xff605015, 0xf46e5918, 0xc544663b, 0xce4a6f36, 0xd3587421, 0xd8567d2c, 0x7a37a10c, 0x7139a801, 0x6c2bb316, 0x6725ba1b, 0x560f8538, 0x5d018c35, 0x40139722, 0x4b1d9e2f, 0x2247e964, 0x2949e069, 0x345bfb7e, 0x3f55f273, 0x0e7fcd50, 0x0571c45d, 0x1863df4a, 0x136dd647, 0xcad731dc, 0xc1d938d1, 0xdccb23c6, 0xd7c52acb, 0xe6ef15e8, 0xede11ce5, 0xf0f307f2, 0xfbfd0eff, 0x92a779b4, 0x99a970b9, 0x84bb6bae, 0x8fb562a3, 0xbe9f5d80, 0xb591548d, 0xa8834f9a, 0xa38d4697];\n  var U3 = [0x00000000, 0x0d0b0e09, 0x1a161c12, 0x171d121b, 0x342c3824, 0x3927362d, 0x2e3a2436, 0x23312a3f, 0x68587048, 0x65537e41, 0x724e6c5a, 0x7f456253, 0x5c74486c, 0x517f4665, 0x4662547e, 0x4b695a77, 0xd0b0e090, 0xddbbee99, 0xcaa6fc82, 0xc7adf28b, 0xe49cd8b4, 0xe997d6bd, 0xfe8ac4a6, 0xf381caaf, 0xb8e890d8, 0xb5e39ed1, 0xa2fe8cca, 0xaff582c3, 0x8cc4a8fc, 0x81cfa6f5, 0x96d2b4ee, 0x9bd9bae7, 0xbb7bdb3b, 0xb670d532, 0xa16dc729, 0xac66c920, 0x8f57e31f, 0x825ced16, 0x9541ff0d, 0x984af104, 0xd323ab73, 0xde28a57a, 0xc935b761, 0xc43eb968, 0xe70f9357, 0xea049d5e, 0xfd198f45, 0xf012814c, 0x6bcb3bab, 0x66c035a2, 0x71dd27b9, 0x7cd629b0, 0x5fe7038f, 0x52ec0d86, 0x45f11f9d, 0x48fa1194, 0x03934be3, 0x0e9845ea, 0x198557f1, 0x148e59f8, 0x37bf73c7, 0x3ab47dce, 0x2da96fd5, 0x20a261dc, 0x6df6ad76, 0x60fda37f, 0x77e0b164, 0x7aebbf6d, 0x59da9552, 0x54d19b5b, 0x43cc8940, 0x4ec78749, 0x05aedd3e, 0x08a5d337, 0x1fb8c12c, 0x12b3cf25, 0x3182e51a, 0x3c89eb13, 0x2b94f908, 0x269ff701, 0xbd464de6, 0xb04d43ef, 0xa75051f4, 0xaa5b5ffd, 0x896a75c2, 0x84617bcb, 0x937c69d0, 0x9e7767d9, 0xd51e3dae, 0xd81533a7, 0xcf0821bc, 0xc2032fb5, 0xe132058a, 0xec390b83, 0xfb241998, 0xf62f1791, 0xd68d764d, 0xdb867844, 0xcc9b6a5f, 0xc1906456, 0xe2a14e69, 0xefaa4060, 0xf8b7527b, 0xf5bc5c72, 0xbed50605, 0xb3de080c, 0xa4c31a17, 0xa9c8141e, 0x8af93e21, 0x87f23028, 0x90ef2233, 0x9de42c3a, 0x063d96dd, 0x0b3698d4, 0x1c2b8acf, 0x112084c6, 0x3211aef9, 0x3f1aa0f0, 0x2807b2eb, 0x250cbce2, 0x6e65e695, 0x636ee89c, 0x7473fa87, 0x7978f48e, 0x5a49deb1, 0x5742d0b8, 0x405fc2a3, 0x4d54ccaa, 0xdaf741ec, 0xd7fc4fe5, 0xc0e15dfe, 0xcdea53f7, 0xeedb79c8, 0xe3d077c1, 0xf4cd65da, 0xf9c66bd3, 0xb2af31a4, 0xbfa43fad, 0xa8b92db6, 0xa5b223bf, 0x86830980, 0x8b880789, 0x9c951592, 0x919e1b9b, 0x0a47a17c, 0x074caf75, 0x1051bd6e, 0x1d5ab367, 0x3e6b9958, 0x33609751, 0x247d854a, 0x29768b43, 0x621fd134, 0x6f14df3d, 0x7809cd26, 0x7502c32f, 0x5633e910, 0x5b38e719, 0x4c25f502, 0x412efb0b, 0x618c9ad7, 0x6c8794de, 0x7b9a86c5, 0x769188cc, 0x55a0a2f3, 0x58abacfa, 0x4fb6bee1, 0x42bdb0e8, 0x09d4ea9f, 0x04dfe496, 0x13c2f68d, 0x1ec9f884, 0x3df8d2bb, 0x30f3dcb2, 0x27eecea9, 0x2ae5c0a0, 0xb13c7a47, 0xbc37744e, 0xab2a6655, 0xa621685c, 0x85104263, 0x881b4c6a, 0x9f065e71, 0x920d5078, 0xd9640a0f, 0xd46f0406, 0xc372161d, 0xce791814, 0xed48322b, 0xe0433c22, 0xf75e2e39, 0xfa552030, 0xb701ec9a, 0xba0ae293, 0xad17f088, 0xa01cfe81, 0x832dd4be, 0x8e26dab7, 0x993bc8ac, 0x9430c6a5, 0xdf599cd2, 0xd25292db, 0xc54f80c0, 0xc8448ec9, 0xeb75a4f6, 0xe67eaaff, 0xf163b8e4, 0xfc68b6ed, 0x67b10c0a, 0x6aba0203, 0x7da71018, 0x70ac1e11, 0x539d342e, 0x5e963a27, 0x498b283c, 0x44802635, 0x0fe97c42, 0x02e2724b, 0x15ff6050, 0x18f46e59, 0x3bc54466, 0x36ce4a6f, 0x21d35874, 0x2cd8567d, 0x0c7a37a1, 0x017139a8, 0x166c2bb3, 0x1b6725ba, 0x38560f85, 0x355d018c, 0x22401397, 0x2f4b1d9e, 0x642247e9, 0x692949e0, 0x7e345bfb, 0x733f55f2, 0x500e7fcd, 0x5d0571c4, 0x4a1863df, 0x47136dd6, 0xdccad731, 0xd1c1d938, 0xc6dccb23, 0xcbd7c52a, 0xe8e6ef15, 0xe5ede11c, 0xf2f0f307, 0xfffbfd0e, 0xb492a779, 0xb999a970, 0xae84bb6b, 0xa38fb562, 0x80be9f5d, 0x8db59154, 0x9aa8834f, 0x97a38d46];\n  var U4 = [0x00000000, 0x090d0b0e, 0x121a161c, 0x1b171d12, 0x24342c38, 0x2d392736, 0x362e3a24, 0x3f23312a, 0x48685870, 0x4165537e, 0x5a724e6c, 0x537f4562, 0x6c5c7448, 0x65517f46, 0x7e466254, 0x774b695a, 0x90d0b0e0, 0x99ddbbee, 0x82caa6fc, 0x8bc7adf2, 0xb4e49cd8, 0xbde997d6, 0xa6fe8ac4, 0xaff381ca, 0xd8b8e890, 0xd1b5e39e, 0xcaa2fe8c, 0xc3aff582, 0xfc8cc4a8, 0xf581cfa6, 0xee96d2b4, 0xe79bd9ba, 0x3bbb7bdb, 0x32b670d5, 0x29a16dc7, 0x20ac66c9, 0x1f8f57e3, 0x16825ced, 0x0d9541ff, 0x04984af1, 0x73d323ab, 0x7ade28a5, 0x61c935b7, 0x68c43eb9, 0x57e70f93, 0x5eea049d, 0x45fd198f, 0x4cf01281, 0xab6bcb3b, 0xa266c035, 0xb971dd27, 0xb07cd629, 0x8f5fe703, 0x8652ec0d, 0x9d45f11f, 0x9448fa11, 0xe303934b, 0xea0e9845, 0xf1198557, 0xf8148e59, 0xc737bf73, 0xce3ab47d, 0xd52da96f, 0xdc20a261, 0x766df6ad, 0x7f60fda3, 0x6477e0b1, 0x6d7aebbf, 0x5259da95, 0x5b54d19b, 0x4043cc89, 0x494ec787, 0x3e05aedd, 0x3708a5d3, 0x2c1fb8c1, 0x2512b3cf, 0x1a3182e5, 0x133c89eb, 0x082b94f9, 0x01269ff7, 0xe6bd464d, 0xefb04d43, 0xf4a75051, 0xfdaa5b5f, 0xc2896a75, 0xcb84617b, 0xd0937c69, 0xd99e7767, 0xaed51e3d, 0xa7d81533, 0xbccf0821, 0xb5c2032f, 0x8ae13205, 0x83ec390b, 0x98fb2419, 0x91f62f17, 0x4dd68d76, 0x44db8678, 0x5fcc9b6a, 0x56c19064, 0x69e2a14e, 0x60efaa40, 0x7bf8b752, 0x72f5bc5c, 0x05bed506, 0x0cb3de08, 0x17a4c31a, 0x1ea9c814, 0x218af93e, 0x2887f230, 0x3390ef22, 0x3a9de42c, 0xdd063d96, 0xd40b3698, 0xcf1c2b8a, 0xc6112084, 0xf93211ae, 0xf03f1aa0, 0xeb2807b2, 0xe2250cbc, 0x956e65e6, 0x9c636ee8, 0x877473fa, 0x8e7978f4, 0xb15a49de, 0xb85742d0, 0xa3405fc2, 0xaa4d54cc, 0xecdaf741, 0xe5d7fc4f, 0xfec0e15d, 0xf7cdea53, 0xc8eedb79, 0xc1e3d077, 0xdaf4cd65, 0xd3f9c66b, 0xa4b2af31, 0xadbfa43f, 0xb6a8b92d, 0xbfa5b223, 0x80868309, 0x898b8807, 0x929c9515, 0x9b919e1b, 0x7c0a47a1, 0x75074caf, 0x6e1051bd, 0x671d5ab3, 0x583e6b99, 0x51336097, 0x4a247d85, 0x4329768b, 0x34621fd1, 0x3d6f14df, 0x267809cd, 0x2f7502c3, 0x105633e9, 0x195b38e7, 0x024c25f5, 0x0b412efb, 0xd7618c9a, 0xde6c8794, 0xc57b9a86, 0xcc769188, 0xf355a0a2, 0xfa58abac, 0xe14fb6be, 0xe842bdb0, 0x9f09d4ea, 0x9604dfe4, 0x8d13c2f6, 0x841ec9f8, 0xbb3df8d2, 0xb230f3dc, 0xa927eece, 0xa02ae5c0, 0x47b13c7a, 0x4ebc3774, 0x55ab2a66, 0x5ca62168, 0x63851042, 0x6a881b4c, 0x719f065e, 0x78920d50, 0x0fd9640a, 0x06d46f04, 0x1dc37216, 0x14ce7918, 0x2bed4832, 0x22e0433c, 0x39f75e2e, 0x30fa5520, 0x9ab701ec, 0x93ba0ae2, 0x88ad17f0, 0x81a01cfe, 0xbe832dd4, 0xb78e26da, 0xac993bc8, 0xa59430c6, 0xd2df599c, 0xdbd25292, 0xc0c54f80, 0xc9c8448e, 0xf6eb75a4, 0xffe67eaa, 0xe4f163b8, 0xedfc68b6, 0x0a67b10c, 0x036aba02, 0x187da710, 0x1170ac1e, 0x2e539d34, 0x275e963a, 0x3c498b28, 0x35448026, 0x420fe97c, 0x4b02e272, 0x5015ff60, 0x5918f46e, 0x663bc544, 0x6f36ce4a, 0x7421d358, 0x7d2cd856, 0xa10c7a37, 0xa8017139, 0xb3166c2b, 0xba1b6725, 0x8538560f, 0x8c355d01, 0x97224013, 0x9e2f4b1d, 0xe9642247, 0xe0692949, 0xfb7e345b, 0xf2733f55, 0xcd500e7f, 0xc45d0571, 0xdf4a1863, 0xd647136d, 0x31dccad7, 0x38d1c1d9, 0x23c6dccb, 0x2acbd7c5, 0x15e8e6ef, 0x1ce5ede1, 0x07f2f0f3, 0x0efffbfd, 0x79b492a7, 0x70b999a9, 0x6bae84bb, 0x62a38fb5, 0x5d80be9f, 0x548db591, 0x4f9aa883, 0x4697a38d];\n\n  function convertToInt32(bytes) {\n    var result = [];\n    for (var i = 0; i < bytes.length; i += 4) {\n      result.push(\n        (bytes[i    ] << 24) |\n        (bytes[i + 1] << 16) |\n        (bytes[i + 2] <<  8) |\n        bytes[i + 3]\n      );\n    }\n    return result;\n  }\n\n  var AES = function(key) {\n    if (!(this instanceof AES)) {\n      throw Error('AES must be instanitated with `new`');\n    }\n\n    Object.defineProperty(this, 'key', {\n      value: coerceArray(key, true)\n    });\n\n    this._prepare();\n  }\n\n\n  AES.prototype._prepare = function() {\n\n    var rounds = numberOfRounds[this.key.length];\n    if (rounds == null) {\n      throw new Error('invalid key size (must be 16, 24 or 32 bytes)');\n    }\n\n    // encryption round keys\n    this._Ke = [];\n\n    // decryption round keys\n    this._Kd = [];\n\n    for (var i = 0; i <= rounds; i++) {\n      this._Ke.push([0, 0, 0, 0]);\n      this._Kd.push([0, 0, 0, 0]);\n    }\n\n    var roundKeyCount = (rounds + 1) * 4;\n    var KC = this.key.length / 4;\n\n    // convert the key into ints\n    var tk = convertToInt32(this.key);\n\n    // copy values into round key arrays\n    var index;\n    for (var i = 0; i < KC; i++) {\n      index = i >> 2;\n      this._Ke[index][i % 4] = tk[i];\n      this._Kd[rounds - index][i % 4] = tk[i];\n    }\n\n    // key expansion (fips-197 section 5.2)\n    var rconpointer = 0;\n    var t = KC, tt;\n    while (t < roundKeyCount) {\n      tt = tk[KC - 1];\n      tk[0] ^= ((S[(tt >> 16) & 0xFF] << 24) ^\n        (S[(tt >>  8) & 0xFF] << 16) ^\n        (S[ tt        & 0xFF] <<  8) ^\n        S[(tt >> 24) & 0xFF]        ^\n        (rcon[rconpointer] << 24));\n      rconpointer += 1;\n\n      // key expansion (for non-256 bit)\n      if (KC != 8) {\n        for (var i = 1; i < KC; i++) {\n          tk[i] ^= tk[i - 1];\n        }\n\n        // key expansion for 256-bit keys is \"slightly different\" (fips-197)\n      } else {\n        for (var i = 1; i < (KC / 2); i++) {\n          tk[i] ^= tk[i - 1];\n        }\n        tt = tk[(KC / 2) - 1];\n\n        tk[KC / 2] ^= (S[ tt        & 0xFF]        ^\n          (S[(tt >>  8) & 0xFF] <<  8) ^\n          (S[(tt >> 16) & 0xFF] << 16) ^\n          (S[(tt >> 24) & 0xFF] << 24));\n\n        for (var i = (KC / 2) + 1; i < KC; i++) {\n          tk[i] ^= tk[i - 1];\n        }\n      }\n\n      // copy values into round key arrays\n      var i = 0, r, c;\n      while (i < KC && t < roundKeyCount) {\n        r = t >> 2;\n        c = t % 4;\n        this._Ke[r][c] = tk[i];\n        this._Kd[rounds - r][c] = tk[i++];\n        t++;\n      }\n    }\n\n    // inverse-cipher-ify the decryption round key (fips-197 section 5.3)\n    for (var r = 1; r < rounds; r++) {\n      for (var c = 0; c < 4; c++) {\n        tt = this._Kd[r][c];\n        this._Kd[r][c] = (U1[(tt >> 24) & 0xFF] ^\n          U2[(tt >> 16) & 0xFF] ^\n          U3[(tt >>  8) & 0xFF] ^\n          U4[ tt        & 0xFF]);\n      }\n    }\n  }\n\n  AES.prototype.encrypt = function(plaintext) {\n    if (plaintext.length != 16) {\n      throw new Error('invalid plaintext size (must be 16 bytes)');\n    }\n\n    var rounds = this._Ke.length - 1;\n    var a = [0, 0, 0, 0];\n\n    // convert plaintext to (ints ^ key)\n    var t = convertToInt32(plaintext);\n    for (var i = 0; i < 4; i++) {\n      t[i] ^= this._Ke[0][i];\n    }\n\n    // apply round transforms\n    for (var r = 1; r < rounds; r++) {\n      for (var i = 0; i < 4; i++) {\n        a[i] = (T1[(t[ i         ] >> 24) & 0xff] ^\n          T2[(t[(i + 1) % 4] >> 16) & 0xff] ^\n          T3[(t[(i + 2) % 4] >>  8) & 0xff] ^\n          T4[ t[(i + 3) % 4]        & 0xff] ^\n          this._Ke[r][i]);\n      }\n      t = a.slice();\n    }\n\n    // the last round is special\n    var result = createArray(16), tt;\n    for (var i = 0; i < 4; i++) {\n      tt = this._Ke[rounds][i];\n      result[4 * i    ] = (S[(t[ i         ] >> 24) & 0xff] ^ (tt >> 24)) & 0xff;\n      result[4 * i + 1] = (S[(t[(i + 1) % 4] >> 16) & 0xff] ^ (tt >> 16)) & 0xff;\n      result[4 * i + 2] = (S[(t[(i + 2) % 4] >>  8) & 0xff] ^ (tt >>  8)) & 0xff;\n      result[4 * i + 3] = (S[ t[(i + 3) % 4]        & 0xff] ^  tt       ) & 0xff;\n    }\n\n    return result;\n  }\n\n  AES.prototype.decrypt = function(ciphertext) {\n    if (ciphertext.length != 16) {\n      throw new Error('invalid ciphertext size (must be 16 bytes)');\n    }\n\n    var rounds = this._Kd.length - 1;\n    var a = [0, 0, 0, 0];\n\n    // convert plaintext to (ints ^ key)\n    var t = convertToInt32(ciphertext);\n    for (var i = 0; i < 4; i++) {\n      t[i] ^= this._Kd[0][i];\n    }\n\n    // apply round transforms\n    for (var r = 1; r < rounds; r++) {\n      for (var i = 0; i < 4; i++) {\n        a[i] = (T5[(t[ i          ] >> 24) & 0xff] ^\n          T6[(t[(i + 3) % 4] >> 16) & 0xff] ^\n          T7[(t[(i + 2) % 4] >>  8) & 0xff] ^\n          T8[ t[(i + 1) % 4]        & 0xff] ^\n          this._Kd[r][i]);\n      }\n      t = a.slice();\n    }\n\n    // the last round is special\n    var result = createArray(16), tt;\n    for (var i = 0; i < 4; i++) {\n      tt = this._Kd[rounds][i];\n      result[4 * i    ] = (Si[(t[ i         ] >> 24) & 0xff] ^ (tt >> 24)) & 0xff;\n      result[4 * i + 1] = (Si[(t[(i + 3) % 4] >> 16) & 0xff] ^ (tt >> 16)) & 0xff;\n      result[4 * i + 2] = (Si[(t[(i + 2) % 4] >>  8) & 0xff] ^ (tt >>  8)) & 0xff;\n      result[4 * i + 3] = (Si[ t[(i + 1) % 4]        & 0xff] ^  tt       ) & 0xff;\n    }\n\n    return result;\n  }\n\n\n  /**\n   *  Mode Of Operation - Electonic Codebook (ECB)\n   */\n  var ModeOfOperationECB = function(key) {\n    if (!(this instanceof ModeOfOperationECB)) {\n      throw Error('AES must be instanitated with `new`');\n    }\n\n    this.description = \"Electronic Code Block\";\n    this.name = \"ecb\";\n\n    this._aes = new AES(key);\n  }\n\n  ModeOfOperationECB.prototype.encrypt = function(plaintext) {\n    plaintext = coerceArray(plaintext);\n\n    if ((plaintext.length % 16) !== 0) {\n      throw new Error('invalid plaintext size (must be multiple of 16 bytes)');\n    }\n\n    var ciphertext = createArray(plaintext.length);\n    var block = createArray(16);\n\n    for (var i = 0; i < plaintext.length; i += 16) {\n      copyArray(plaintext, block, 0, i, i + 16);\n      block = this._aes.encrypt(block);\n      copyArray(block, ciphertext, i);\n    }\n\n    return ciphertext;\n  }\n\n  ModeOfOperationECB.prototype.decrypt = function(ciphertext) {\n    ciphertext = coerceArray(ciphertext);\n\n    if ((ciphertext.length % 16) !== 0) {\n      throw new Error('invalid ciphertext size (must be multiple of 16 bytes)');\n    }\n\n    var plaintext = createArray(ciphertext.length);\n    var block = createArray(16);\n\n    for (var i = 0; i < ciphertext.length; i += 16) {\n      copyArray(ciphertext, block, 0, i, i + 16);\n      block = this._aes.decrypt(block);\n      copyArray(block, plaintext, i);\n    }\n\n    return plaintext;\n  }\n\n\n  /**\n   *  Mode Of Operation - Cipher Block Chaining (CBC)\n   */\n  var ModeOfOperationCBC = function(key, iv) {\n    if (!(this instanceof ModeOfOperationCBC)) {\n      throw Error('AES must be instanitated with `new`');\n    }\n\n    this.description = \"Cipher Block Chaining\";\n    this.name = \"cbc\";\n\n    if (!iv) {\n      iv = createArray(16);\n\n    } else if (iv.length != 16) {\n      throw new Error('invalid initialation vector size (must be 16 bytes)');\n    }\n\n    this._lastCipherblock = coerceArray(iv, true);\n\n    this._aes = new AES(key);\n  }\n\n  ModeOfOperationCBC.prototype.encrypt = function(plaintext) {\n    plaintext = coerceArray(plaintext);\n\n    if ((plaintext.length % 16) !== 0) {\n      throw new Error('invalid plaintext size (must be multiple of 16 bytes)');\n    }\n\n    var ciphertext = createArray(plaintext.length);\n    var block = createArray(16);\n\n    for (var i = 0; i < plaintext.length; i += 16) {\n      copyArray(plaintext, block, 0, i, i + 16);\n\n      for (var j = 0; j < 16; j++) {\n        block[j] ^= this._lastCipherblock[j];\n      }\n\n      this._lastCipherblock = this._aes.encrypt(block);\n      copyArray(this._lastCipherblock, ciphertext, i);\n    }\n\n    return ciphertext;\n  }\n\n  ModeOfOperationCBC.prototype.decrypt = function(ciphertext) {\n    ciphertext = coerceArray(ciphertext);\n\n    if ((ciphertext.length % 16) !== 0) {\n      throw new Error('invalid ciphertext size (must be multiple of 16 bytes)');\n    }\n\n    var plaintext = createArray(ciphertext.length);\n    var block = createArray(16);\n\n    for (var i = 0; i < ciphertext.length; i += 16) {\n      copyArray(ciphertext, block, 0, i, i + 16);\n      block = this._aes.decrypt(block);\n\n      for (var j = 0; j < 16; j++) {\n        plaintext[i + j] = block[j] ^ this._lastCipherblock[j];\n      }\n\n      copyArray(ciphertext, this._lastCipherblock, 0, i, i + 16);\n    }\n\n    return plaintext;\n  }\n\n\n  /**\n   *  Mode Of Operation - Cipher Feedback (CFB)\n   */\n  var ModeOfOperationCFB = function(key, iv, segmentSize) {\n    if (!(this instanceof ModeOfOperationCFB)) {\n      throw Error('AES must be instanitated with `new`');\n    }\n\n    this.description = \"Cipher Feedback\";\n    this.name = \"cfb\";\n\n    if (!iv) {\n      iv = createArray(16);\n\n    } else if (iv.length != 16) {\n      throw new Error('invalid initialation vector size (must be 16 size)');\n    }\n\n    if (!segmentSize) { segmentSize = 1; }\n\n    this.segmentSize = segmentSize;\n\n    this._shiftRegister = coerceArray(iv, true);\n\n    this._aes = new AES(key);\n  }\n\n  ModeOfOperationCFB.prototype.encrypt = function(plaintext) {\n    if ((plaintext.length % this.segmentSize) != 0) {\n      throw new Error('invalid plaintext size (must be segmentSize bytes)');\n    }\n\n    var encrypted = coerceArray(plaintext, true);\n\n    var xorSegment;\n    for (var i = 0; i < encrypted.length; i += this.segmentSize) {\n      xorSegment = this._aes.encrypt(this._shiftRegister);\n      for (var j = 0; j < this.segmentSize; j++) {\n        encrypted[i + j] ^= xorSegment[j];\n      }\n\n      // Shift the register\n      copyArray(this._shiftRegister, this._shiftRegister, 0, this.segmentSize);\n      copyArray(encrypted, this._shiftRegister, 16 - this.segmentSize, i, i + this.segmentSize);\n    }\n\n    return encrypted;\n  }\n\n  ModeOfOperationCFB.prototype.decrypt = function(ciphertext) {\n    if ((ciphertext.length % this.segmentSize) != 0) {\n      throw new Error('invalid ciphertext size (must be segmentSize bytes)');\n    }\n\n    var plaintext = coerceArray(ciphertext, true);\n\n    var xorSegment;\n    for (var i = 0; i < plaintext.length; i += this.segmentSize) {\n      xorSegment = this._aes.encrypt(this._shiftRegister);\n\n      for (var j = 0; j < this.segmentSize; j++) {\n        plaintext[i + j] ^= xorSegment[j];\n      }\n\n      // Shift the register\n      copyArray(this._shiftRegister, this._shiftRegister, 0, this.segmentSize);\n      copyArray(ciphertext, this._shiftRegister, 16 - this.segmentSize, i, i + this.segmentSize);\n    }\n\n    return plaintext;\n  }\n\n  /**\n   *  Mode Of Operation - Output Feedback (OFB)\n   */\n  var ModeOfOperationOFB = function(key, iv) {\n    if (!(this instanceof ModeOfOperationOFB)) {\n      throw Error('AES must be instanitated with `new`');\n    }\n\n    this.description = \"Output Feedback\";\n    this.name = \"ofb\";\n\n    if (!iv) {\n      iv = createArray(16);\n\n    } else if (iv.length != 16) {\n      throw new Error('invalid initialation vector size (must be 16 bytes)');\n    }\n\n    this._lastPrecipher = coerceArray(iv, true);\n    this._lastPrecipherIndex = 16;\n\n    this._aes = new AES(key);\n  }\n\n  ModeOfOperationOFB.prototype.encrypt = function(plaintext) {\n    var encrypted = coerceArray(plaintext, true);\n\n    for (var i = 0; i < encrypted.length; i++) {\n      if (this._lastPrecipherIndex === 16) {\n        this._lastPrecipher = this._aes.encrypt(this._lastPrecipher);\n        this._lastPrecipherIndex = 0;\n      }\n      encrypted[i] ^= this._lastPrecipher[this._lastPrecipherIndex++];\n    }\n\n    return encrypted;\n  }\n\n  // Decryption is symetric\n  ModeOfOperationOFB.prototype.decrypt = ModeOfOperationOFB.prototype.encrypt;\n\n\n  /**\n   *  Counter object for CTR common mode of operation\n   */\n  var Counter = function(initialValue) {\n    if (!(this instanceof Counter)) {\n      throw Error('Counter must be instanitated with `new`');\n    }\n\n    // We allow 0, but anything false-ish uses the default 1\n    if (initialValue !== 0 && !initialValue) { initialValue = 1; }\n\n    if (typeof(initialValue) === 'number') {\n      this._counter = createArray(16);\n      this.setValue(initialValue);\n\n    } else {\n      this.setBytes(initialValue);\n    }\n  }\n\n  Counter.prototype.setValue = function(value) {\n    if (typeof(value) !== 'number' || parseInt(value) != value) {\n      throw new Error('invalid counter value (must be an integer)');\n    }\n\n    // We cannot safely handle numbers beyond the safe range for integers\n    if (value > Number.MAX_SAFE_INTEGER) {\n      throw new Error('integer value out of safe range');\n    }\n\n    for (var index = 15; index >= 0; --index) {\n      this._counter[index] = value % 256;\n      value = parseInt(value / 256);\n    }\n  }\n\n  Counter.prototype.setBytes = function(bytes) {\n    bytes = coerceArray(bytes, true);\n\n    if (bytes.length != 16) {\n      throw new Error('invalid counter bytes size (must be 16 bytes)');\n    }\n\n    this._counter = bytes;\n  };\n\n  Counter.prototype.increment = function() {\n    for (var i = 15; i >= 0; i--) {\n      if (this._counter[i] === 255) {\n        this._counter[i] = 0;\n      } else {\n        this._counter[i]++;\n        break;\n      }\n    }\n  }\n\n\n  /**\n   *  Mode Of Operation - Counter (CTR)\n   */\n  var ModeOfOperationCTR = function(key, counter) {\n    if (!(this instanceof ModeOfOperationCTR)) {\n      throw Error('AES must be instanitated with `new`');\n    }\n\n    this.description = \"Counter\";\n    this.name = \"ctr\";\n\n    if (!(counter instanceof Counter)) {\n      counter = new Counter(counter)\n    }\n\n    this._counter = counter;\n\n    this._remainingCounter = null;\n    this._remainingCounterIndex = 16;\n\n    this._aes = new AES(key);\n  }\n\n  ModeOfOperationCTR.prototype.encrypt = function(plaintext) {\n    var encrypted = coerceArray(plaintext, true);\n\n    for (var i = 0; i < encrypted.length; i++) {\n      if (this._remainingCounterIndex === 16) {\n        this._remainingCounter = this._aes.encrypt(this._counter._counter);\n        this._remainingCounterIndex = 0;\n        this._counter.increment();\n      }\n      encrypted[i] ^= this._remainingCounter[this._remainingCounterIndex++];\n    }\n\n    return encrypted;\n  }\n\n  // Decryption is symetric\n  ModeOfOperationCTR.prototype.decrypt = ModeOfOperationCTR.prototype.encrypt;\n\n\n  ///////////////////////\n  // Padding\n\n  // See:https://tools.ietf.org/html/rfc2315\n  function pkcs7pad(data) {\n    data = coerceArray(data, true);\n    var padder = 16 - (data.length % 16);\n    var result = createArray(data.length + padder);\n    copyArray(data, result);\n    for (var i = data.length; i < result.length; i++) {\n      result[i] = padder;\n    }\n    return result;\n  }\n\n  function pkcs7strip(data) {\n    data = coerceArray(data, true);\n    if (data.length < 16) { throw new Error('PKCS#7 invalid length'); }\n\n    var padder = data[data.length - 1];\n    if (padder > 16) { throw new Error('PKCS#7 padding byte out of range'); }\n\n    var length = data.length - padder;\n    for (var i = 0; i < padder; i++) {\n      if (data[length + i] !== padder) {\n        throw new Error('PKCS#7 invalid padding byte');\n      }\n    }\n\n    var result = createArray(length);\n    copyArray(data, result, 0, 0, length);\n    return result;\n  }\n\n  ///////////////////////\n  // Exporting\n\n\n  // The block cipher\n  var aesjs = {\n    AES: AES,\n    Counter: Counter,\n\n    ModeOfOperation: {\n      ecb: ModeOfOperationECB,\n      cbc: ModeOfOperationCBC,\n      cfb: ModeOfOperationCFB,\n      ofb: ModeOfOperationOFB,\n      ctr: ModeOfOperationCTR\n    },\n\n    utils: {\n      hex: convertHex,\n      utf8: convertUtf8\n    },\n\n    padding: {\n      pkcs7: {\n        pad: pkcs7pad,\n        strip: pkcs7strip\n      }\n    },\n\n    _arrayTest: {\n      coerceArray: coerceArray,\n      createArray: createArray,\n      copyArray: copyArray,\n    }\n  };\n\n\n  // node.js\n  if (typeof exports !== 'undefined') {\n    module.exports = aesjs\n\n    // RequireJS/AMD\n    // http://www.requirejs.org/docs/api.html\n    // https://github.com/amdjs/amdjs-api/wiki/AMD\n  } else if (typeof(define) === 'function' && define.amd) {\n    define([], function() { return aesjs; });\n\n    // Web Browsers\n  } else {\n\n    // If there was an existing library at \"aesjs\" make sure it's still available\n    if (root.aesjs) {\n      aesjs._aesjs = root.aesjs;\n    }\n\n    root.aesjs = aesjs;\n  }\n\n\n})(this);\n","// Version 1.7.3\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n      (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.nobleEd25519 = {}));\n})(this, (function (exports) { 'use strict';\n\n  const _nodeResolve_empty = {};\n\n  const nodeCrypto = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    'default': _nodeResolve_empty\n  });\n\n  /*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */\n  const _0n = BigInt(0);\n  const _1n = BigInt(1);\n  const _2n = BigInt(2);\n  const _8n = BigInt(8);\n  const CU_O = BigInt('7237005577332262213973186563042994240857116359379907606001950938285454250989');\n  const CURVE = Object.freeze({\n    a: BigInt(-1),\n    d: BigInt('37095705934669439343138083508754565189542113879843219016388785533085940283555'),\n    P: BigInt('57896044618658097711785492504343953926634992332820282019728792003956564819949'),\n    l: CU_O,\n    n: CU_O,\n    h: BigInt(8),\n    Gx: BigInt('15112221349535400772501151409588531511454012693041857206046113283949847762202'),\n    Gy: BigInt('46316835694926478169428394003475163141307993866256225615783033603165251855960'),\n  });\n  const POW_2_256 = BigInt('0x10000000000000000000000000000000000000000000000000000000000000000');\n  const SQRT_M1 = BigInt('19681161376707505956807079304988542015446066515923890162744021073123829784752');\n  BigInt('6853475219497561581579357271197624642482790079785650197046958215289687604742');\n  const SQRT_AD_MINUS_ONE = BigInt('25063068953384623474111414158702152701244531502492656460079210482610430750235');\n  const INVSQRT_A_MINUS_D = BigInt('54469307008909316920995813868745141605393597292927456921205312896311721017578');\n  const ONE_MINUS_D_SQ = BigInt('1159843021668779879193775521855586647937357759715417654439879720876111806838');\n  const D_MINUS_ONE_SQ = BigInt('40440834346308536858101042469323190826248399146238708352240133220865137265952');\n  class ExtendedPoint {\n    constructor(x, y, z, t) {\n      this.x = x;\n      this.y = y;\n      this.z = z;\n      this.t = t;\n    }\n    static fromAffine(p) {\n      if (!(p instanceof Point)) {\n        throw new TypeError('ExtendedPoint#fromAffine: expected Point');\n      }\n      if (p.equals(Point.ZERO))\n        return ExtendedPoint.ZERO;\n      return new ExtendedPoint(p.x, p.y, _1n, mod(p.x * p.y));\n    }\n    static toAffineBatch(points) {\n      const toInv = invertBatch(points.map((p) => p.z));\n      return points.map((p, i) => p.toAffine(toInv[i]));\n    }\n    static normalizeZ(points) {\n      return this.toAffineBatch(points).map(this.fromAffine);\n    }\n    equals(other) {\n      assertExtPoint(other);\n      const { x: X1, y: Y1, z: Z1 } = this;\n      const { x: X2, y: Y2, z: Z2 } = other;\n      const X1Z2 = mod(X1 * Z2);\n      const X2Z1 = mod(X2 * Z1);\n      const Y1Z2 = mod(Y1 * Z2);\n      const Y2Z1 = mod(Y2 * Z1);\n      return X1Z2 === X2Z1 && Y1Z2 === Y2Z1;\n    }\n    negate() {\n      return new ExtendedPoint(mod(-this.x), this.y, this.z, mod(-this.t));\n    }\n    double() {\n      const { x: X1, y: Y1, z: Z1 } = this;\n      const { a } = CURVE;\n      const A = mod(X1 * X1);\n      const B = mod(Y1 * Y1);\n      const C = mod(_2n * mod(Z1 * Z1));\n      const D = mod(a * A);\n      const x1y1 = X1 + Y1;\n      const E = mod(mod(x1y1 * x1y1) - A - B);\n      const G = D + B;\n      const F = G - C;\n      const H = D - B;\n      const X3 = mod(E * F);\n      const Y3 = mod(G * H);\n      const T3 = mod(E * H);\n      const Z3 = mod(F * G);\n      return new ExtendedPoint(X3, Y3, Z3, T3);\n    }\n    add(other) {\n      assertExtPoint(other);\n      const { x: X1, y: Y1, z: Z1, t: T1 } = this;\n      const { x: X2, y: Y2, z: Z2, t: T2 } = other;\n      const A = mod((Y1 - X1) * (Y2 + X2));\n      const B = mod((Y1 + X1) * (Y2 - X2));\n      const F = mod(B - A);\n      if (F === _0n)\n        return this.double();\n      const C = mod(Z1 * _2n * T2);\n      const D = mod(T1 * _2n * Z2);\n      const E = D + C;\n      const G = B + A;\n      const H = D - C;\n      const X3 = mod(E * F);\n      const Y3 = mod(G * H);\n      const T3 = mod(E * H);\n      const Z3 = mod(F * G);\n      return new ExtendedPoint(X3, Y3, Z3, T3);\n    }\n    subtract(other) {\n      return this.add(other.negate());\n    }\n    precomputeWindow(W) {\n      const windows = 1 + 256 / W;\n      const points = [];\n      let p = this;\n      let base = p;\n      for (let window = 0; window < windows; window++) {\n        base = p;\n        points.push(base);\n        for (let i = 1; i < 2 ** (W - 1); i++) {\n          base = base.add(p);\n          points.push(base);\n        }\n        p = base.double();\n      }\n      return points;\n    }\n    wNAF(n, affinePoint) {\n      if (!affinePoint && this.equals(ExtendedPoint.BASE))\n        affinePoint = Point.BASE;\n      const W = (affinePoint && affinePoint._WINDOW_SIZE) || 1;\n      if (256 % W) {\n        throw new Error('Point#wNAF: Invalid precomputation window, must be power of 2');\n      }\n      let precomputes = affinePoint && pointPrecomputes.get(affinePoint);\n      if (!precomputes) {\n        precomputes = this.precomputeWindow(W);\n        if (affinePoint && W !== 1) {\n          precomputes = ExtendedPoint.normalizeZ(precomputes);\n          pointPrecomputes.set(affinePoint, precomputes);\n        }\n      }\n      let p = ExtendedPoint.ZERO;\n      let f = ExtendedPoint.BASE;\n      const windows = 1 + 256 / W;\n      const windowSize = 2 ** (W - 1);\n      const mask = BigInt(2 ** W - 1);\n      const maxNumber = 2 ** W;\n      const shiftBy = BigInt(W);\n      for (let window = 0; window < windows; window++) {\n        const offset = window * windowSize;\n        let wbits = Number(n & mask);\n        n >>= shiftBy;\n        if (wbits > windowSize) {\n          wbits -= maxNumber;\n          n += _1n;\n        }\n        const offset1 = offset;\n        const offset2 = offset + Math.abs(wbits) - 1;\n        const cond1 = window % 2 !== 0;\n        const cond2 = wbits < 0;\n        if (wbits === 0) {\n          f = f.add(constTimeNegate(cond1, precomputes[offset1]));\n        }\n        else {\n          p = p.add(constTimeNegate(cond2, precomputes[offset2]));\n        }\n      }\n      return ExtendedPoint.normalizeZ([p, f])[0];\n    }\n    multiply(scalar, affinePoint) {\n      return this.wNAF(normalizeScalar(scalar, CURVE.l), affinePoint);\n    }\n    multiplyUnsafe(scalar) {\n      let n = normalizeScalar(scalar, CURVE.l, false);\n      const G = ExtendedPoint.BASE;\n      const P0 = ExtendedPoint.ZERO;\n      if (n === _0n)\n        return P0;\n      if (this.equals(P0) || n === _1n)\n        return this;\n      if (this.equals(G))\n        return this.wNAF(n);\n      let p = P0;\n      let d = this;\n      while (n > _0n) {\n        if (n & _1n)\n          p = p.add(d);\n        d = d.double();\n        n >>= _1n;\n      }\n      return p;\n    }\n    isSmallOrder() {\n      return this.multiplyUnsafe(CURVE.h).equals(ExtendedPoint.ZERO);\n    }\n    isTorsionFree() {\n      let p = this.multiplyUnsafe(CURVE.l / _2n).double();\n      if (CURVE.l % _2n)\n        p = p.add(this);\n      return p.equals(ExtendedPoint.ZERO);\n    }\n    toAffine(invZ) {\n      const { x, y, z } = this;\n      const is0 = this.equals(ExtendedPoint.ZERO);\n      if (invZ == null)\n        invZ = is0 ? _8n : invert(z);\n      const ax = mod(x * invZ);\n      const ay = mod(y * invZ);\n      const zz = mod(z * invZ);\n      if (is0)\n        return Point.ZERO;\n      if (zz !== _1n)\n        throw new Error('invZ was invalid');\n      return new Point(ax, ay);\n    }\n    fromRistrettoBytes() {\n      legacyRist();\n    }\n    toRistrettoBytes() {\n      legacyRist();\n    }\n    fromRistrettoHash() {\n      legacyRist();\n    }\n  }\n  ExtendedPoint.BASE = new ExtendedPoint(CURVE.Gx, CURVE.Gy, _1n, mod(CURVE.Gx * CURVE.Gy));\n  ExtendedPoint.ZERO = new ExtendedPoint(_0n, _1n, _1n, _0n);\n  function constTimeNegate(condition, item) {\n    const neg = item.negate();\n    return condition ? neg : item;\n  }\n  function assertExtPoint(other) {\n    if (!(other instanceof ExtendedPoint))\n      throw new TypeError('ExtendedPoint expected');\n  }\n  function assertRstPoint(other) {\n    if (!(other instanceof RistrettoPoint))\n      throw new TypeError('RistrettoPoint expected');\n  }\n  function legacyRist() {\n    throw new Error('Legacy method: switch to RistrettoPoint');\n  }\n  class RistrettoPoint {\n    constructor(ep) {\n      this.ep = ep;\n    }\n    static calcElligatorRistrettoMap(r0) {\n      const { d } = CURVE;\n      const r = mod(SQRT_M1 * r0 * r0);\n      const Ns = mod((r + _1n) * ONE_MINUS_D_SQ);\n      let c = BigInt(-1);\n      const D = mod((c - d * r) * mod(r + d));\n      let { isValid: Ns_D_is_sq, value: s } = uvRatio(Ns, D);\n      let s_ = mod(s * r0);\n      if (!edIsNegative(s_))\n        s_ = mod(-s_);\n      if (!Ns_D_is_sq)\n        s = s_;\n      if (!Ns_D_is_sq)\n        c = r;\n      const Nt = mod(c * (r - _1n) * D_MINUS_ONE_SQ - D);\n      const s2 = s * s;\n      const W0 = mod((s + s) * D);\n      const W1 = mod(Nt * SQRT_AD_MINUS_ONE);\n      const W2 = mod(_1n - s2);\n      const W3 = mod(_1n + s2);\n      return new ExtendedPoint(mod(W0 * W3), mod(W2 * W1), mod(W1 * W3), mod(W0 * W2));\n    }\n    static hashToCurve(hex) {\n      hex = ensureBytes(hex, 64);\n      const r1 = bytes255ToNumberLE(hex.slice(0, 32));\n      const R1 = this.calcElligatorRistrettoMap(r1);\n      const r2 = bytes255ToNumberLE(hex.slice(32, 64));\n      const R2 = this.calcElligatorRistrettoMap(r2);\n      return new RistrettoPoint(R1.add(R2));\n    }\n    static fromHex(hex) {\n      hex = ensureBytes(hex, 32);\n      const { a, d } = CURVE;\n      const emsg = 'RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint';\n      const s = bytes255ToNumberLE(hex);\n      if (!equalBytes(numberTo32BytesLE(s), hex) || edIsNegative(s))\n        throw new Error(emsg);\n      const s2 = mod(s * s);\n      const u1 = mod(_1n + a * s2);\n      const u2 = mod(_1n - a * s2);\n      const u1_2 = mod(u1 * u1);\n      const u2_2 = mod(u2 * u2);\n      const v = mod(a * d * u1_2 - u2_2);\n      const { isValid, value: I } = invertSqrt(mod(v * u2_2));\n      const Dx = mod(I * u2);\n      const Dy = mod(I * Dx * v);\n      let x = mod((s + s) * Dx);\n      if (edIsNegative(x))\n        x = mod(-x);\n      const y = mod(u1 * Dy);\n      const t = mod(x * y);\n      if (!isValid || edIsNegative(t) || y === _0n)\n        throw new Error(emsg);\n      return new RistrettoPoint(new ExtendedPoint(x, y, _1n, t));\n    }\n    toRawBytes() {\n      let { x, y, z, t } = this.ep;\n      const u1 = mod(mod(z + y) * mod(z - y));\n      const u2 = mod(x * y);\n      const u2sq = mod(u2 * u2);\n      const { value: invsqrt } = invertSqrt(mod(u1 * u2sq));\n      const D1 = mod(invsqrt * u1);\n      const D2 = mod(invsqrt * u2);\n      const zInv = mod(D1 * D2 * t);\n      let D;\n      if (edIsNegative(t * zInv)) {\n        let _x = mod(y * SQRT_M1);\n        let _y = mod(x * SQRT_M1);\n        x = _x;\n        y = _y;\n        D = mod(D1 * INVSQRT_A_MINUS_D);\n      }\n      else {\n        D = D2;\n      }\n      if (edIsNegative(x * zInv))\n        y = mod(-y);\n      let s = mod((z - y) * D);\n      if (edIsNegative(s))\n        s = mod(-s);\n      return numberTo32BytesLE(s);\n    }\n    toHex() {\n      return bytesToHex(this.toRawBytes());\n    }\n    toString() {\n      return this.toHex();\n    }\n    equals(other) {\n      assertRstPoint(other);\n      const a = this.ep;\n      const b = other.ep;\n      const one = mod(a.x * b.y) === mod(a.y * b.x);\n      const two = mod(a.y * b.y) === mod(a.x * b.x);\n      return one || two;\n    }\n    add(other) {\n      assertRstPoint(other);\n      return new RistrettoPoint(this.ep.add(other.ep));\n    }\n    subtract(other) {\n      assertRstPoint(other);\n      return new RistrettoPoint(this.ep.subtract(other.ep));\n    }\n    multiply(scalar) {\n      return new RistrettoPoint(this.ep.multiply(scalar));\n    }\n    multiplyUnsafe(scalar) {\n      return new RistrettoPoint(this.ep.multiplyUnsafe(scalar));\n    }\n  }\n  RistrettoPoint.BASE = new RistrettoPoint(ExtendedPoint.BASE);\n  RistrettoPoint.ZERO = new RistrettoPoint(ExtendedPoint.ZERO);\n  const pointPrecomputes = new WeakMap();\n  class Point {\n    constructor(x, y) {\n      this.x = x;\n      this.y = y;\n    }\n    _setWindowSize(windowSize) {\n      this._WINDOW_SIZE = windowSize;\n      pointPrecomputes.delete(this);\n    }\n    static fromHex(hex, strict = true) {\n      const { d, P } = CURVE;\n      hex = ensureBytes(hex, 32);\n      const normed = hex.slice();\n      normed[31] = hex[31] & ~0x80;\n      const y = bytesToNumberLE(normed);\n      if (strict && y >= P)\n        throw new Error('Expected 0 < hex < P');\n      if (!strict && y >= POW_2_256)\n        throw new Error('Expected 0 < hex < 2**256');\n      const y2 = mod(y * y);\n      const u = mod(y2 - _1n);\n      const v = mod(d * y2 + _1n);\n      let { isValid, value: x } = uvRatio(u, v);\n      if (!isValid)\n        throw new Error('Point.fromHex: invalid y coordinate');\n      const isXOdd = (x & _1n) === _1n;\n      const isLastByteOdd = (hex[31] & 0x80) !== 0;\n      if (isLastByteOdd !== isXOdd) {\n        x = mod(-x);\n      }\n      return new Point(x, y);\n    }\n    static async fromPrivateKey(privateKey) {\n      return (await getExtendedPublicKey(privateKey)).point;\n    }\n    toRawBytes() {\n      const bytes = numberTo32BytesLE(this.y);\n      bytes[31] |= this.x & _1n ? 0x80 : 0;\n      return bytes;\n    }\n    toHex() {\n      return bytesToHex(this.toRawBytes());\n    }\n    toX25519() {\n      const { y } = this;\n      const u = mod((_1n + y) * invert(_1n - y));\n      return numberTo32BytesLE(u);\n    }\n    isTorsionFree() {\n      return ExtendedPoint.fromAffine(this).isTorsionFree();\n    }\n    equals(other) {\n      return this.x === other.x && this.y === other.y;\n    }\n    negate() {\n      return new Point(mod(-this.x), this.y);\n    }\n    add(other) {\n      return ExtendedPoint.fromAffine(this).add(ExtendedPoint.fromAffine(other)).toAffine();\n    }\n    subtract(other) {\n      return this.add(other.negate());\n    }\n    multiply(scalar) {\n      return ExtendedPoint.fromAffine(this).multiply(scalar, this).toAffine();\n    }\n  }\n  Point.BASE = new Point(CURVE.Gx, CURVE.Gy);\n  Point.ZERO = new Point(_0n, _1n);\n  class Signature {\n    constructor(r, s) {\n      this.r = r;\n      this.s = s;\n      this.assertValidity();\n    }\n    static fromHex(hex) {\n      const bytes = ensureBytes(hex, 64);\n      const r = Point.fromHex(bytes.slice(0, 32), false);\n      const s = bytesToNumberLE(bytes.slice(32, 64));\n      return new Signature(r, s);\n    }\n    assertValidity() {\n      const { r, s } = this;\n      if (!(r instanceof Point))\n        throw new Error('Expected Point instance');\n      normalizeScalar(s, CURVE.l, false);\n      return this;\n    }\n    toRawBytes() {\n      const u8 = new Uint8Array(64);\n      u8.set(this.r.toRawBytes());\n      u8.set(numberTo32BytesLE(this.s), 32);\n      return u8;\n    }\n    toHex() {\n      return bytesToHex(this.toRawBytes());\n    }\n  }\n  function concatBytes(...arrays) {\n    if (!arrays.every((a) => a instanceof Uint8Array))\n      throw new Error('Expected Uint8Array list');\n    if (arrays.length === 1)\n      return arrays[0];\n    const length = arrays.reduce((a, arr) => a + arr.length, 0);\n    const result = new Uint8Array(length);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n      const arr = arrays[i];\n      result.set(arr, pad);\n      pad += arr.length;\n    }\n    return result;\n  }\n  const hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n  function bytesToHex(uint8a) {\n    if (!(uint8a instanceof Uint8Array))\n      throw new Error('Uint8Array expected');\n    let hex = '';\n    for (let i = 0; i < uint8a.length; i++) {\n      hex += hexes[uint8a[i]];\n    }\n    return hex;\n  }\n  function hexToBytes(hex) {\n    if (typeof hex !== 'string') {\n      throw new TypeError('hexToBytes: expected string, got ' + typeof hex);\n    }\n    if (hex.length % 2)\n      throw new Error('hexToBytes: received invalid unpadded hex');\n    const array = new Uint8Array(hex.length / 2);\n    for (let i = 0; i < array.length; i++) {\n      const j = i * 2;\n      const hexByte = hex.slice(j, j + 2);\n      const byte = Number.parseInt(hexByte, 16);\n      if (Number.isNaN(byte) || byte < 0)\n        throw new Error('Invalid byte sequence');\n      array[i] = byte;\n    }\n    return array;\n  }\n  function numberTo32BytesBE(num) {\n    const length = 32;\n    const hex = num.toString(16).padStart(length * 2, '0');\n    return hexToBytes(hex);\n  }\n  function numberTo32BytesLE(num) {\n    return numberTo32BytesBE(num).reverse();\n  }\n  function edIsNegative(num) {\n    return (mod(num) & _1n) === _1n;\n  }\n  function bytesToNumberLE(uint8a) {\n    if (!(uint8a instanceof Uint8Array))\n      throw new Error('Expected Uint8Array');\n    return BigInt('0x' + bytesToHex(Uint8Array.from(uint8a).reverse()));\n  }\n  const MAX_255B = BigInt('0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff');\n  function bytes255ToNumberLE(bytes) {\n    return mod(bytesToNumberLE(bytes) & MAX_255B);\n  }\n  function mod(a, b = CURVE.P) {\n    const res = a % b;\n    return res >= _0n ? res : b + res;\n  }\n  function invert(number, modulo = CURVE.P) {\n    if (number === _0n || modulo <= _0n) {\n      throw new Error(`invert: expected positive integers, got n=${number} mod=${modulo}`);\n    }\n    let a = mod(number, modulo);\n    let b = modulo;\n    let x = _0n, u = _1n;\n    while (a !== _0n) {\n      const q = b / a;\n      const r = b % a;\n      const m = x - u * q;\n      b = a, a = r, x = u, u = m;\n    }\n    const gcd = b;\n    if (gcd !== _1n)\n      throw new Error('invert: does not exist');\n    return mod(x, modulo);\n  }\n  function invertBatch(nums, p = CURVE.P) {\n    const tmp = new Array(nums.length);\n    const lastMultiplied = nums.reduce((acc, num, i) => {\n      if (num === _0n)\n        return acc;\n      tmp[i] = acc;\n      return mod(acc * num, p);\n    }, _1n);\n    const inverted = invert(lastMultiplied, p);\n    nums.reduceRight((acc, num, i) => {\n      if (num === _0n)\n        return acc;\n      tmp[i] = mod(acc * tmp[i], p);\n      return mod(acc * num, p);\n    }, inverted);\n    return tmp;\n  }\n  function pow2(x, power) {\n    const { P } = CURVE;\n    let res = x;\n    while (power-- > _0n) {\n      res *= res;\n      res %= P;\n    }\n    return res;\n  }\n  function pow_2_252_3(x) {\n    const { P } = CURVE;\n    const _5n = BigInt(5);\n    const _10n = BigInt(10);\n    const _20n = BigInt(20);\n    const _40n = BigInt(40);\n    const _80n = BigInt(80);\n    const x2 = (x * x) % P;\n    const b2 = (x2 * x) % P;\n    const b4 = (pow2(b2, _2n) * b2) % P;\n    const b5 = (pow2(b4, _1n) * x) % P;\n    const b10 = (pow2(b5, _5n) * b5) % P;\n    const b20 = (pow2(b10, _10n) * b10) % P;\n    const b40 = (pow2(b20, _20n) * b20) % P;\n    const b80 = (pow2(b40, _40n) * b40) % P;\n    const b160 = (pow2(b80, _80n) * b80) % P;\n    const b240 = (pow2(b160, _80n) * b80) % P;\n    const b250 = (pow2(b240, _10n) * b10) % P;\n    const pow_p_5_8 = (pow2(b250, _2n) * x) % P;\n    return { pow_p_5_8, b2 };\n  }\n  function uvRatio(u, v) {\n    const v3 = mod(v * v * v);\n    const v7 = mod(v3 * v3 * v);\n    const pow = pow_2_252_3(u * v7).pow_p_5_8;\n    let x = mod(u * v3 * pow);\n    const vx2 = mod(v * x * x);\n    const root1 = x;\n    const root2 = mod(x * SQRT_M1);\n    const useRoot1 = vx2 === u;\n    const useRoot2 = vx2 === mod(-u);\n    const noRoot = vx2 === mod(-u * SQRT_M1);\n    if (useRoot1)\n      x = root1;\n    if (useRoot2 || noRoot)\n      x = root2;\n    if (edIsNegative(x))\n      x = mod(-x);\n    return { isValid: useRoot1 || useRoot2, value: x };\n  }\n  function invertSqrt(number) {\n    return uvRatio(_1n, number);\n  }\n  function modlLE(hash) {\n    return mod(bytesToNumberLE(hash), CURVE.l);\n  }\n  function equalBytes(b1, b2) {\n    if (b1.length !== b2.length) {\n      return false;\n    }\n    for (let i = 0; i < b1.length; i++) {\n      if (b1[i] !== b2[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n  function ensureBytes(hex, expectedLength) {\n    const bytes = hex instanceof Uint8Array ? Uint8Array.from(hex) : hexToBytes(hex);\n    if (typeof expectedLength === 'number' && bytes.length !== expectedLength)\n      throw new Error(`Expected ${expectedLength} bytes`);\n    return bytes;\n  }\n  function normalizeScalar(num, max, strict = true) {\n    if (!max)\n      throw new TypeError('Specify max value');\n    if (typeof num === 'number' && Number.isSafeInteger(num))\n      num = BigInt(num);\n    if (typeof num === 'bigint' && num < max) {\n      if (strict) {\n        if (_0n < num)\n          return num;\n      }\n      else {\n        if (_0n <= num)\n          return num;\n      }\n    }\n    throw new TypeError('Expected valid scalar: 0 < scalar < max');\n  }\n  function adjustBytes25519(bytes) {\n    bytes[0] &= 248;\n    bytes[31] &= 127;\n    bytes[31] |= 64;\n    return bytes;\n  }\n  function decodeScalar25519(n) {\n    return bytesToNumberLE(adjustBytes25519(ensureBytes(n, 32)));\n  }\n  function checkPrivateKey(key) {\n    key =\n      typeof key === 'bigint' || typeof key === 'number'\n        ? numberTo32BytesBE(normalizeScalar(key, POW_2_256))\n        : ensureBytes(key);\n    if (key.length !== 32)\n      throw new Error(`Expected 32 bytes`);\n    return key;\n  }\n  function getKeyFromHash(hashed) {\n    const head = adjustBytes25519(hashed.slice(0, 32));\n    const prefix = hashed.slice(32, 64);\n    const scalar = modlLE(head);\n    const point = Point.BASE.multiply(scalar);\n    const pointBytes = point.toRawBytes();\n    return { head, prefix, scalar, point, pointBytes };\n  }\n  let _sha512Sync;\n  function sha512s(...m) {\n    if (typeof _sha512Sync !== 'function')\n      throw new Error('utils.sha512Sync must be set to use sync methods');\n    return _sha512Sync(...m);\n  }\n  async function getExtendedPublicKey(key) {\n    return getKeyFromHash(await utils.sha512(checkPrivateKey(key)));\n  }\n  function getExtendedPublicKeySync(key) {\n    return getKeyFromHash(sha512s(checkPrivateKey(key)));\n  }\n  async function getPublicKey(privateKey) {\n    return (await getExtendedPublicKey(privateKey)).pointBytes;\n  }\n  function getPublicKeySync(privateKey) {\n    return getExtendedPublicKeySync(privateKey).pointBytes;\n  }\n  async function sign(message, privateKey) {\n    message = ensureBytes(message);\n    const { prefix, scalar, pointBytes } = await getExtendedPublicKey(privateKey);\n    const r = modlLE(await utils.sha512(prefix, message));\n    const R = Point.BASE.multiply(r);\n    const k = modlLE(await utils.sha512(R.toRawBytes(), pointBytes, message));\n    const s = mod(r + k * scalar, CURVE.l);\n    return new Signature(R, s).toRawBytes();\n  }\n  function signSync(message, privateKey) {\n    message = ensureBytes(message);\n    const { prefix, scalar, pointBytes } = getExtendedPublicKeySync(privateKey);\n    const r = modlLE(sha512s(prefix, message));\n    const R = Point.BASE.multiply(r);\n    const k = modlLE(sha512s(R.toRawBytes(), pointBytes, message));\n    const s = mod(r + k * scalar, CURVE.l);\n    return new Signature(R, s).toRawBytes();\n  }\n  function prepareVerification(sig, message, publicKey) {\n    message = ensureBytes(message);\n    if (!(publicKey instanceof Point))\n      publicKey = Point.fromHex(publicKey, false);\n    const { r, s } = sig instanceof Signature ? sig.assertValidity() : Signature.fromHex(sig);\n    const SB = ExtendedPoint.BASE.multiplyUnsafe(s);\n    return { r, s, SB, pub: publicKey, msg: message };\n  }\n  function finishVerification(publicKey, r, SB, hashed) {\n    const k = modlLE(hashed);\n    const kA = ExtendedPoint.fromAffine(publicKey).multiplyUnsafe(k);\n    const RkA = ExtendedPoint.fromAffine(r).add(kA);\n    return RkA.subtract(SB).multiplyUnsafe(CURVE.h).equals(ExtendedPoint.ZERO);\n  }\n  async function verify(sig, message, publicKey) {\n    const { r, SB, msg, pub } = prepareVerification(sig, message, publicKey);\n    const hashed = await utils.sha512(r.toRawBytes(), pub.toRawBytes(), msg);\n    return finishVerification(pub, r, SB, hashed);\n  }\n  function verifySync(sig, message, publicKey) {\n    const { r, SB, msg, pub } = prepareVerification(sig, message, publicKey);\n    const hashed = sha512s(r.toRawBytes(), pub.toRawBytes(), msg);\n    return finishVerification(pub, r, SB, hashed);\n  }\n  const sync = {\n    getExtendedPublicKey: getExtendedPublicKeySync,\n    getPublicKey: getPublicKeySync,\n    sign: signSync,\n    verify: verifySync,\n  };\n  async function getSharedSecret(privateKey, publicKey) {\n    const { head } = await getExtendedPublicKey(privateKey);\n    const u = Point.fromHex(publicKey).toX25519();\n    return curve25519.scalarMult(head, u);\n  }\n  Point.BASE._setWindowSize(8);\n  function cswap(swap, x_2, x_3) {\n    const dummy = mod(swap * (x_2 - x_3));\n    x_2 = mod(x_2 - dummy);\n    x_3 = mod(x_3 + dummy);\n    return [x_2, x_3];\n  }\n  function montgomeryLadder(pointU, scalar) {\n    const { P } = CURVE;\n    const u = normalizeScalar(pointU, P);\n    const k = normalizeScalar(scalar, P);\n    const a24 = BigInt(121665);\n    const x_1 = u;\n    let x_2 = _1n;\n    let z_2 = _0n;\n    let x_3 = u;\n    let z_3 = _1n;\n    let swap = _0n;\n    let sw;\n    for (let t = BigInt(255 - 1); t >= _0n; t--) {\n      const k_t = (k >> t) & _1n;\n      swap ^= k_t;\n      sw = cswap(swap, x_2, x_3);\n      x_2 = sw[0];\n      x_3 = sw[1];\n      sw = cswap(swap, z_2, z_3);\n      z_2 = sw[0];\n      z_3 = sw[1];\n      swap = k_t;\n      const A = x_2 + z_2;\n      const AA = mod(A * A);\n      const B = x_2 - z_2;\n      const BB = mod(B * B);\n      const E = AA - BB;\n      const C = x_3 + z_3;\n      const D = x_3 - z_3;\n      const DA = mod(D * A);\n      const CB = mod(C * B);\n      const dacb = DA + CB;\n      const da_cb = DA - CB;\n      x_3 = mod(dacb * dacb);\n      z_3 = mod(x_1 * mod(da_cb * da_cb));\n      x_2 = mod(AA * BB);\n      z_2 = mod(E * (AA + mod(a24 * E)));\n    }\n    sw = cswap(swap, x_2, x_3);\n    x_2 = sw[0];\n    x_3 = sw[1];\n    sw = cswap(swap, z_2, z_3);\n    z_2 = sw[0];\n    z_3 = sw[1];\n    const { pow_p_5_8, b2 } = pow_2_252_3(z_2);\n    const xp2 = mod(pow2(pow_p_5_8, BigInt(3)) * b2);\n    return mod(x_2 * xp2);\n  }\n  function encodeUCoordinate(u) {\n    return numberTo32BytesLE(mod(u, CURVE.P));\n  }\n  function decodeUCoordinate(uEnc) {\n    const u = ensureBytes(uEnc, 32);\n    u[31] &= 127;\n    return bytesToNumberLE(u);\n  }\n  const curve25519 = {\n    BASE_POINT_U: '0900000000000000000000000000000000000000000000000000000000000000',\n    scalarMult(privateKey, publicKey) {\n      const u = decodeUCoordinate(publicKey);\n      const p = decodeScalar25519(privateKey);\n      const pu = montgomeryLadder(u, p);\n      if (pu === _0n)\n        throw new Error('Invalid private or public key received');\n      return encodeUCoordinate(pu);\n    },\n    scalarMultBase(privateKey) {\n      return curve25519.scalarMult(privateKey, curve25519.BASE_POINT_U);\n    },\n  };\n  const crypto = {\n    node: nodeCrypto,\n    web: typeof self === 'object' && 'crypto' in self ? self.crypto : undefined,\n  };\n  const utils = {\n    bytesToHex,\n    hexToBytes,\n    concatBytes,\n    getExtendedPublicKey,\n    mod,\n    invert,\n    TORSION_SUBGROUP: [\n      '0100000000000000000000000000000000000000000000000000000000000000',\n      'c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a',\n      '0000000000000000000000000000000000000000000000000000000000000080',\n      '26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05',\n      'ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f',\n      '26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85',\n      '0000000000000000000000000000000000000000000000000000000000000000',\n      'c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa',\n    ],\n    hashToPrivateScalar: (hash) => {\n      hash = ensureBytes(hash);\n      if (hash.length < 40 || hash.length > 1024)\n        throw new Error('Expected 40-1024 bytes of private key as per FIPS 186');\n      return mod(bytesToNumberLE(hash), CURVE.l - _1n) + _1n;\n    },\n    randomBytes: (bytesLength = 32) => {\n      if (crypto.web) {\n        return crypto.web.getRandomValues(new Uint8Array(bytesLength));\n      }\n      else if (crypto.node) {\n        const { randomBytes } = crypto.node;\n        return new Uint8Array(randomBytes(bytesLength).buffer);\n      }\n      else {\n        throw new Error(\"The environment doesn't have randomBytes function\");\n      }\n    },\n    randomPrivateKey: () => {\n      return utils.randomBytes(32);\n    },\n    sha512: async (...messages) => {\n      const message = concatBytes(...messages);\n      if (crypto.web) {\n        const buffer = await crypto.web.subtle.digest('SHA-512', message.buffer);\n        return new Uint8Array(buffer);\n      }\n      else if (crypto.node) {\n        return Uint8Array.from(crypto.node.createHash('sha512').update(message).digest());\n      }\n      else {\n        throw new Error(\"The environment doesn't have sha512 function\");\n      }\n    },\n    precompute(windowSize = 8, point = Point.BASE) {\n      const cached = point.equals(Point.BASE) ? point : new Point(point.x, point.y);\n      cached._setWindowSize(windowSize);\n      cached.multiply(_2n);\n      return cached;\n    },\n    sha512Sync: undefined,\n  };\n  Object.defineProperties(utils, {\n    sha512Sync: {\n      configurable: false,\n      get() {\n        return _sha512Sync;\n      },\n      set(val) {\n        if (!_sha512Sync)\n          _sha512Sync = val;\n      },\n    },\n  });\n\n  exports.CURVE = CURVE;\n  exports.ExtendedPoint = ExtendedPoint;\n  exports.Point = Point;\n  exports.RistrettoPoint = RistrettoPoint;\n  exports.Signature = Signature;\n  exports.curve25519 = curve25519;\n  exports.getPublicKey = getPublicKey;\n  exports.getSharedSecret = getSharedSecret;\n  exports.sign = sign;\n  exports.sync = sync;\n  exports.utils = utils;\n  exports.verify = verify;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n","export class AssertionError extends Error {\n  constructor(\n    message: string,\n    // Any additional information for the error to help debug it. Don't put sensitive information here.\n    public metadata?: unknown,\n  ) {\n    super(message);\n  }\n}\n\nexport function assert(condition: boolean, message: string, metadata?: unknown) {\n  if (!condition) {\n    throw new AssertionError(message, metadata);\n  }\n}\n","import type { LangCode } from '../global/types';\nimport type { LangFn } from './langProvider';\n\nimport withCache from './withCache';\n\nexport const SECOND = 1000;\nexport const MINUTE = SECOND * 60;\nexport const HOUR = MINUTE * 60;\nexport const DAY = HOUR * 24;\n\nconst formatDayToStringWithCache = withCache((\n  langCode: LangCode,\n  dayStartAt: number,\n  noYear?: boolean,\n  monthFormat: 'short' | 'long' | 'numeric' | false = 'short',\n  noDay?: boolean,\n  withTime = false,\n) => {\n  return new Date(dayStartAt).toLocaleString(\n    langCode,\n    {\n      year: noYear ? undefined : 'numeric',\n      month: monthFormat || undefined,\n      day: noDay ? undefined : 'numeric',\n      hour: withTime ? 'numeric' : undefined,\n      minute: withTime ? 'numeric' : undefined,\n      hourCycle: 'h23',\n    },\n  );\n});\n\nexport function formatRelativeHumanDateTime(\n  langCode: LangCode = 'en',\n  time: number,\n) {\n  const total = time - Date.now();\n  const minutes = Math.floor((total / 1000 / 60) % 60);\n  const hours = Math.floor((total / (1000 * 3600)) % 24);\n  const days = Math.floor(total / 1000 / 3600 / 24);\n\n  const rtf = new Intl.RelativeTimeFormat(langCode, {\n    localeMatcher: 'best fit',\n    numeric: 'always',\n    style: 'long',\n  });\n\n  const result: string[] = [];\n\n  if (days > 0) {\n    const [daysPlural, daysValue] = rtf.formatToParts(days, 'day').reverse();\n    result.push(`${daysValue.value}${daysPlural.value}`);\n  }\n  if (hours > 0) {\n    const [hoursPlural, hoursValue] = rtf.formatToParts(hours, 'hour').reverse();\n    result.push(`${hoursValue.value}${hoursPlural.value}`);\n  }\n  if (minutes > 0) {\n    const [minutesPlural, minutesValue] = rtf.formatToParts(minutes, 'minute').reverse();\n    result.push(`${minutesValue.value}${minutesPlural.value}`);\n  }\n\n  return result.join(' ');\n}\n\nexport function formatHumanDay(lang: LangFn, datetime: string | number) {\n  if (isToday(datetime)) {\n    return lang('Today');\n  }\n\n  if (isYesterday(datetime)) {\n    return lang('Yesterday');\n  }\n\n  return formatFullDay(lang.code!, datetime);\n}\n\nexport function formatFullDay(langCode: LangCode, datetime: string | number | Date) {\n  const date = new Date(datetime);\n  const dayStartAt = getDayStartAt(date);\n  const today = getDayStart(new Date());\n  const noYear = date.getFullYear() === today.getFullYear();\n\n  return formatDayToStringWithCache(langCode, dayStartAt, noYear, 'long');\n}\n\nexport function formatShortDay(langCode: LangCode, datetime: string | number | Date, withTime = false, noYear = false) {\n  const date = new Date(datetime);\n  const dayStartAt = getDayStartAt(date);\n  const today = getDayStart(new Date());\n  const todayStartAt = getDayStartAt(today);\n  const noDate = withTime && dayStartAt === todayStartAt;\n  const targetAt = withTime ? getMinuteStart(date).getTime() : dayStartAt;\n\n  noYear ||= date.getFullYear() === today.getFullYear();\n\n  return formatDayToStringWithCache(langCode, targetAt, noYear, !noDate && 'short', noDate, withTime);\n}\n\nexport function formatTime(datetime: string | number) {\n  const date = new Date(datetime);\n\n  return `${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;\n}\n\nexport function getCountDaysToDate(datetime: string | number | Date) {\n  const today = new Date();\n  const date = datetime instanceof Date ? datetime\n    : new Date(datetime);\n\n  return Math.ceil((date.getTime() - today.getTime()) / DAY);\n}\n\nexport function getDayStart(datetime: number | Date) {\n  const date = new Date(datetime);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\nexport function getDayStartAt(datetime: number | Date) {\n  return getDayStart(datetime).getTime();\n}\n\nexport function getMinuteStart(datetime: number | Date) {\n  const date = new Date(datetime);\n  date.setSeconds(0, 0);\n  return date;\n}\n\nfunction isToday(datetime: string | number) {\n  return getDayStartAt(new Date()) === getDayStartAt(new Date(datetime));\n}\n\nfunction isYesterday(datetime: string | number) {\n  const yesterday = new Date();\n  yesterday.setDate(yesterday.getDate() - 1);\n\n  return getDayStartAt(yesterday) === getDayStartAt(new Date(datetime));\n}\n","import { IS_EXTENSION } from '../config';\n\nexport const IS_EXTENSION_PAGE_SCRIPT = IS_EXTENSION\n  // eslint-disable-next-line no-restricted-globals\n  && !['chrome-extension:', 'moz-extension:'].includes(self.location.protocol);\n","import {\n  BRILLIANT_API_BASE_URL, DEFAULT_ERROR_PAUSE, DEFAULT_RETRIES, DEFAULT_TIMEOUT,\n} from '../config';\nimport { ApiServerError } from '../api/errors';\nimport { logDebug } from './logs';\nimport { pause } from './schedulers';\n\ntype QueryParams = Record<string, string | number | boolean | string[]>;\n\nconst MAX_TIMEOUT = 30000; // 30 sec\n\nexport async function fetchJsonWithProxy(url: string | URL, data?: QueryParams, init?: RequestInit) {\n  try {\n    return await fetchJson(url, data, init);\n  } catch (err) {\n    if (err instanceof ApiServerError && (!err.statusCode || err.statusCode === 403)) {\n      return fetchJson(`${BRILLIANT_API_BASE_URL}/proxy/?url=${url.toString()}`, data, init);\n    }\n    throw err;\n  }\n}\n\nexport async function fetchJson(url: string | URL, data?: QueryParams, init?: RequestInit) {\n  const urlObject = new URL(url);\n  if (data) {\n    Object.entries(data).forEach(([key, value]) => {\n      if (value === undefined) {\n        return;\n      }\n\n      if (Array.isArray(value)) {\n        value.forEach((item) => {\n          urlObject.searchParams.append(key, item.toString());\n        });\n      } else {\n        urlObject.searchParams.set(key, value.toString());\n      }\n    });\n  }\n\n  const response = await fetchWithRetry(urlObject, init);\n\n  return response.json();\n}\n\nexport async function fetchWithRetry(url: string | URL, init?: RequestInit, options?: {\n  retries?: number;\n  timeouts?: number | number[];\n  shouldSkipRetryFn?: (message?: string, statusCode?: number) => boolean;\n}) {\n  const {\n    retries = DEFAULT_RETRIES,\n    timeouts = DEFAULT_TIMEOUT,\n    shouldSkipRetryFn = isNotTemporaryError,\n  } = options ?? {};\n\n  let message = 'Unknown error.';\n  let statusCode: number | undefined;\n\n  for (let i = 1; i <= retries; i++) {\n    try {\n      if (i > 1) {\n        logDebug(`Retry request #${i}:`, url.toString(), statusCode);\n      }\n\n      const timeout = Array.isArray(timeouts)\n        ? timeouts[i - 1] ?? timeouts[timeouts.length - 1]\n        : Math.min(timeouts * i, MAX_TIMEOUT);\n      const response = await fetchWithTimeout(url, init, timeout);\n      statusCode = response.status;\n\n      if (statusCode >= 400) {\n        const { error } = await response.json().catch(() => {});\n        throw new Error(error ?? `HTTP Error ${statusCode}`);\n      }\n\n      return response;\n    } catch (err: any) {\n      message = typeof err === 'string' ? err : err.message ?? message;\n\n      const shouldSkipRetry = shouldSkipRetryFn(message, statusCode);\n\n      if (shouldSkipRetry) {\n        throw new ApiServerError(message, statusCode);\n      }\n\n      if (i < retries) {\n        await pause(DEFAULT_ERROR_PAUSE * i);\n      }\n    }\n  }\n\n  throw new ApiServerError(message);\n}\n\nexport async function fetchWithTimeout(url: string | URL, init?: RequestInit, timeout = DEFAULT_TIMEOUT) {\n  const controller = new AbortController();\n  const id = setTimeout(() => {\n    controller.abort();\n  }, timeout);\n\n  try {\n    return await fetch(url, {\n      ...init,\n      signal: controller.signal,\n      cache: 'no-cache', // TODO Remove it after a few releases\n    });\n  } finally {\n    clearTimeout(id);\n  }\n}\n\nexport async function handleFetchErrors(response: Response, ignoreHttpCodes?: number[]) {\n  if (!response.ok && (!ignoreHttpCodes?.includes(response.status))) {\n    // eslint-disable-next-line prefer-const\n    let { error, errors } = await response.json().catch(() => undefined);\n    if (!error && errors && errors.length) {\n      error = errors[0]?.msg;\n    }\n\n    throw new ApiServerError(error ?? `HTTP Error ${response.status}`, response.status);\n  }\n  return response;\n}\n\nfunction isNotTemporaryError(message?: string, statusCode?: number) {\n  return statusCode && [400, 404].includes(statusCode);\n}\n","import { APP_ENV, DEBUG_ALERT_MSG } from '../config';\nimport { SECOND } from './dateFormat';\nimport { IS_EXTENSION_PAGE_SCRIPT } from './environment';\nimport { logDebugError } from './logs';\nimport { throttle } from './schedulers';\n\nconst shouldShowAlert = (APP_ENV === 'development' || APP_ENV === 'staging')\n  && typeof window === 'object'\n  && !IS_EXTENSION_PAGE_SCRIPT;\n\n// eslint-disable-next-line no-alert\nconst throttledAlert = throttle((message) => window.alert(message), 10 * SECOND);\n\n// eslint-disable-next-line no-restricted-globals\nself.addEventListener('error', handleErrorEvent);\n// eslint-disable-next-line no-restricted-globals\nself.addEventListener('unhandledrejection', handleErrorEvent);\n\nfunction handleErrorEvent(e: ErrorEvent | PromiseRejectionEvent) {\n  // https://stackoverflow.com/questions/49384120/resizeobserver-loop-limit-exceeded\n  if (e instanceof ErrorEvent && e.message === 'ResizeObserver loop limit exceeded') {\n    return;\n  }\n\n  e.preventDefault();\n\n  handleError(e instanceof ErrorEvent ? (e.error || e.message) : e.reason);\n}\n\nexport function handleError(err: Error | string) {\n  logDebugError('handleError', err);\n\n  const message = typeof err === 'string' ? err : err.message;\n  const stack = typeof err === 'object' ? err.stack : undefined;\n\n  if (message.endsWith('Failed to import rlottie-wasm.js')) {\n    return;\n  }\n\n  if (shouldShowAlert) {\n    throttledAlert(`${DEBUG_ALERT_MSG}\\n\\n${(message) || err}\\n${stack}`);\n  }\n}\n","import { DEBUG, DEBUG_API } from '../config';\nimport { AssertionError } from './assert';\nimport { omit } from './iteratees';\n\nexport interface Log {\n  message: string;\n  args: any[];\n  time: Date;\n  level: 'debug' | 'debugError';\n}\n\nconst MAX_LOG_LENGTH = 999;\nconst logs: Log[] = [];\n\nexport function errorReplacer(_: string, value: any) {\n  if (value instanceof Error) {\n    return {\n      name: value.name,\n      message: value.message,\n      stack: value.stack,\n      metadata: value instanceof AssertionError ? value.metadata : undefined,\n    };\n  }\n  return value;\n}\n\nexport function addLog(log: Omit<Log, 'time'>) {\n  if (logs.length > MAX_LOG_LENGTH) {\n    logs.shift();\n  }\n\n  logs.push({\n    ...log,\n    args: log.args.map((arg) => JSON.stringify(arg, errorReplacer)),\n    time: new Date(),\n  });\n}\n\nexport function getLogs() {\n  return logs;\n}\n\nexport function logActionHandling(name: string, payload?: any) {\n  if (!DEBUG_API) return;\n  if (name === 'apiUpdate') {\n    if (typeof payload?.type === 'string' && payload.type !== 'updatingStatus') {\n      logDebugApi(`Update: ${payload.type}`, omit(payload, ['type']));\n    }\n  } else {\n    logDebugApi(`Action: ${name}`, payload);\n  }\n}\n\nexport function logDebugError(message: string, ...args: any[]) {\n  addLog({ message, level: 'debugError', args });\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.error(`[DEBUG][${message}]`, ...args);\n  }\n}\n\nexport function logDebug(message: any, ...args: any[]) {\n  addLog({ message, level: 'debug', args });\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log(`[DEBUG] ${message}`, ...args);\n  }\n}\n\nexport function logDebugApi(message: any, obj1: any, obj2?: any) {\n  if (DEBUG_API) {\n    // eslint-disable-next-line no-console\n    console.debug(`[DEBUG] ${message}`);\n    // eslint-disable-next-line no-console\n    if (obj1) console.dir(obj1);\n    // eslint-disable-next-line no-console\n    if (obj2) console.dir(obj2);\n  }\n}\n\nexport function logSelfXssWarnings() {\n  const selfXssWarnings: AnyLiteral = {\n    en: 'WARNING! This console can be a way for bad people to take over your crypto wallet through something called '\n        + 'a Self-XSS attack. So, don\\'t put in or paste code you don\\'t understand. Stay safe!',\n    ru: '!             '\n        + '  Self-XSS.       ,    .  !',\n    es: 'ADVERTENCIA! Esta consola puede ser una forma en que las personas malintencionadas se apoderen de su '\n        + 'billetera de criptomonedas mediante un ataque llamado Self-XSS. Por lo tanto, '\n        + 'no introduzca ni pegue cdigo que no comprenda. Cudese!',\n    zh: 'Self-XSS',\n  };\n\n  const langCode = navigator.language.split('-')[0];\n  const text = selfXssWarnings[langCode] || selfXssWarnings.en;\n\n  // eslint-disable-next-line no-console\n  console.log('%c%s', 'color: red; background: yellow; font-size: 18px;', text);\n}\n","import { DEBUG_MORE } from '../config';\nimport { handleError } from './handleError';\n\nconst SAFE_EXEC_ENABLED = !DEBUG_MORE;\n\ntype SafeExecOptions = {\n  rescue?: (err: Error) => void;\n  always?: NoneToVoidFunction;\n  shouldIgnoreError?: boolean;\n};\n\nexport async function safeExecAsync<T extends AnyAsyncFunction>(\n  cb: T,\n  options?: SafeExecOptions,\n): Promise<ReturnType<T> | undefined> {\n  if (!SAFE_EXEC_ENABLED) {\n    return cb();\n  }\n\n  const { rescue, always, shouldIgnoreError } = options ?? {};\n\n  try {\n    return await cb();\n  } catch (err: any) {\n    rescue?.(err);\n    if (!shouldIgnoreError) {\n      handleError(err);\n    }\n    return undefined;\n  } finally {\n    always?.();\n  }\n}\n\nexport default function safeExec<T extends AnyFunction>(cb: T, options?: SafeExecOptions): ReturnType<T> | undefined {\n  if (!SAFE_EXEC_ENABLED) {\n    return cb();\n  }\n\n  const { rescue, always, shouldIgnoreError } = options ?? {};\n\n  try {\n    return cb();\n  } catch (err: any) {\n    rescue?.(err);\n    if (!shouldIgnoreError) {\n      handleError(err);\n    }\n    return undefined;\n  } finally {\n    always?.();\n  }\n}\n","export type Scheduler = typeof requestAnimationFrame | typeof onTickEnd;\n\nexport function debounce<F extends AnyToVoidFunction>(\n  fn: F,\n  ms: number,\n  shouldRunFirst = true,\n  shouldRunLast = true,\n) {\n  let waitingTimeout: number | undefined;\n\n  return (...args: Parameters<F>) => {\n    if (waitingTimeout) {\n      clearTimeout(waitingTimeout);\n      waitingTimeout = undefined;\n    } else if (shouldRunFirst) {\n      fn(...args);\n    }\n\n    // eslint-disable-next-line no-restricted-globals\n    waitingTimeout = self.setTimeout(() => {\n      if (shouldRunLast) {\n        fn(...args);\n      }\n\n      waitingTimeout = undefined;\n    }, ms);\n  };\n}\n\nexport function throttle<F extends AnyToVoidFunction>(\n  fn: F,\n  ms: number,\n  shouldRunFirst = true,\n) {\n  let interval: number | undefined;\n  let isPending: boolean;\n  let args: Parameters<F>;\n\n  return (..._args: Parameters<F>) => {\n    isPending = true;\n    args = _args;\n\n    if (!interval) {\n      if (shouldRunFirst) {\n        isPending = false;\n        fn(...args);\n      }\n\n      // eslint-disable-next-line no-restricted-globals\n      interval = self.setInterval(() => {\n        if (!isPending) {\n          // eslint-disable-next-line no-restricted-globals\n          self.clearInterval(interval!);\n          interval = undefined;\n          return;\n        }\n\n        isPending = false;\n        fn(...args);\n      }, ms);\n    }\n  };\n}\n\nexport function throttleWithTickEnd<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(onTickEnd, fn);\n}\n\nexport function throttleWith<F extends AnyToVoidFunction>(schedulerFn: Scheduler, fn: F) {\n  let waiting = false;\n  let args: Parameters<F>;\n\n  return (..._args: Parameters<F>) => {\n    args = _args;\n\n    if (!waiting) {\n      waiting = true;\n\n      schedulerFn(() => {\n        waiting = false;\n        fn(...args);\n      });\n    }\n  };\n}\n\nexport const pause = (ms: number) => new Promise<void>((resolve) => {\n  setTimeout(() => resolve(), ms);\n});\n\nexport function rafPromise() {\n  return new Promise<void>((resolve) => {\n    fastRaf(resolve);\n  });\n}\n\nconst FAST_RAF_TIMEOUT_FALLBACK_MS = 35; // < 30 FPS\n\nlet fastRafCallbacks: Set<NoneToVoidFunction> | undefined;\nlet fastRafFallbackCallbacks: Set<NoneToVoidFunction> | undefined;\nlet fastRafFallbackTimeout: number | undefined;\n\n// May result in an immediate execution if called from another RAF callback which was scheduled\n// (and therefore is executed) earlier than RAF callback scheduled by `fastRaf`\nexport function fastRaf(callback: NoneToVoidFunction, withTimeoutFallback = false) {\n  if (!fastRafCallbacks) {\n    fastRafCallbacks = new Set([callback]);\n\n    requestAnimationFrame(() => {\n      const currentCallbacks = fastRafCallbacks!;\n\n      fastRafCallbacks = undefined;\n      fastRafFallbackCallbacks = undefined;\n\n      if (fastRafFallbackTimeout) {\n        clearTimeout(fastRafFallbackTimeout);\n        fastRafFallbackTimeout = undefined;\n      }\n\n      currentCallbacks.forEach((cb) => cb());\n    });\n  } else {\n    fastRafCallbacks.add(callback);\n  }\n\n  if (withTimeoutFallback) {\n    if (!fastRafFallbackCallbacks) {\n      fastRafFallbackCallbacks = new Set([callback]);\n    } else {\n      fastRafFallbackCallbacks.add(callback);\n    }\n\n    if (!fastRafFallbackTimeout) {\n      fastRafFallbackTimeout = window.setTimeout(() => {\n        const currentTimeoutCallbacks = fastRafFallbackCallbacks!;\n\n        if (fastRafCallbacks) {\n          currentTimeoutCallbacks.forEach(fastRafCallbacks.delete, fastRafCallbacks);\n        }\n        fastRafFallbackCallbacks = undefined;\n\n        if (fastRafFallbackTimeout) {\n          clearTimeout(fastRafFallbackTimeout);\n          fastRafFallbackTimeout = undefined;\n        }\n\n        currentTimeoutCallbacks.forEach((cb) => cb());\n      }, FAST_RAF_TIMEOUT_FALLBACK_MS);\n    }\n  }\n}\n\nlet onTickEndCallbacks: NoneToVoidFunction[] | undefined;\n\nexport function onTickEnd(callback: NoneToVoidFunction) {\n  if (!onTickEndCallbacks) {\n    onTickEndCallbacks = [callback];\n\n    void Promise.resolve().then(() => {\n      const currentCallbacks = onTickEndCallbacks!;\n      onTickEndCallbacks = undefined;\n      currentCallbacks.forEach((cb) => cb());\n    });\n  } else {\n    onTickEndCallbacks.push(callback);\n  }\n}\n\nconst IDLE_TIMEOUT = 500;\n\nlet onIdleCallbacks: NoneToVoidFunction[] | undefined;\n\nexport function onIdle(callback: NoneToVoidFunction) {\n  // eslint-disable-next-line no-restricted-globals\n  if (!self.requestIdleCallback) {\n    onTickEnd(callback);\n    return;\n  }\n\n  if (!onIdleCallbacks) {\n    onIdleCallbacks = [callback];\n\n    requestIdleCallback((deadline) => {\n      const currentCallbacks = onIdleCallbacks!;\n      onIdleCallbacks = undefined;\n\n      while (currentCallbacks.length) {\n        const cb = currentCallbacks.shift()!;\n        cb();\n\n        if (!deadline.timeRemaining()) break;\n      }\n\n      if (currentCallbacks.length) {\n        if (onIdleCallbacks) {\n          // Prepend the remaining callbacks if the next pass is already planned\n          onIdleCallbacks = currentCallbacks.concat(onIdleCallbacks);\n        } else {\n          currentCallbacks.forEach(onIdle);\n        }\n      }\n    }, { timeout: IDLE_TIMEOUT });\n  } else {\n    onIdleCallbacks.push(callback);\n  }\n}\n\nlet beforeUnloadCallbacks: NoneToVoidFunction[] | undefined;\n\nexport function onBeforeUnload(callback: NoneToVoidFunction, isLast = false) {\n  if (!beforeUnloadCallbacks) {\n    beforeUnloadCallbacks = [];\n    // eslint-disable-next-line no-restricted-globals\n    self.addEventListener('beforeunload', () => {\n      beforeUnloadCallbacks!.forEach((cb) => cb());\n    });\n  }\n\n  if (isLast) {\n    beforeUnloadCallbacks.push(callback);\n  } else {\n    beforeUnloadCallbacks.unshift(callback);\n  }\n\n  return () => {\n    beforeUnloadCallbacks = beforeUnloadCallbacks!.filter((cb) => cb !== callback);\n  };\n}\n\nexport async function waitFor(cb: () => boolean, interval: number, attempts: number) {\n  let i = 0;\n  let result = cb();\n\n  while (!result && i < attempts) {\n    await pause(interval);\n\n    i++;\n    result = cb();\n  }\n\n  return result;\n}\n","const cache = new WeakMap<AnyFunction, Map<string, any>>();\n\nexport default function withCache<T extends AnyFunction>(fn: T) {\n  return (...args: Parameters<T>): ReturnType<T> => {\n    let fnCache = cache.get(fn);\n    const cacheKey = args.map(String).join('_');\n\n    if (fnCache) {\n      const cached = fnCache.get(cacheKey);\n      if (cached) {\n        return cached;\n      }\n    } else {\n      fnCache = new Map();\n      cache.set(fn, fnCache);\n    }\n\n    const newValue = fn(...args);\n\n    fnCache.set(cacheKey, newValue);\n\n    return newValue;\n  };\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [494,362,776], () => (__webpack_require__(31284)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".\" + {\"362\":\"1dbe55c972e9075fe06c\",\"494\":\"2a76b4246c2b484142fb\",\"776\":\"45feed3695ebbd842676\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t941: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkmytonwallet\"] = self[\"webpackChunkmytonwallet\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["deferred","next","JettonStakingOpCodes","GET_STATIC_DATA","REPORT_STATIC_DATA","GET_STORAGE_DATA","REPORT_STORAGE_DATA","EXCESSES","TRANSFER_JETTON","INTERNAL_TRANSFER","TRANSFER_NOTIFICATION","PROVIDE_WALLET_ADDRESS","TAKE_WALLET_ADDRESS","BURN_JETTON","STAKE_JETTONS","ADD_REWARDS","SEND_CLAIMED_REWARDS","SEND_UNSTAKED_JETTONS","APPROVE_STAKE","CANCEL_STAKE","ADD_REWARD_JETTONS","CLAIM_COMMISSIONS","REQUEST_UPDATE_REWARDS","CLAIM_REWARDS","RECEIVE_JETTONS","UNSTAKE_JETTONS","UNSTAKE_REQUEST","CANCEL_UNSTAKE_REQUEST","UPDATE_REWARDS","CONFIRM_TRANSFER","DEPLOY_NEW_POOL","SEND_COMMISSIONS","SET_CODE","CHANGE_CREATION_FEE","CHANGE_CONTENT","UPDATE_CODES","JettonStakingGas","MIN_RESERVE","DEPLOY_POOL","NOTIFICATION","JETTON_TRANSFER","BURN_JETTONS","CANCEL_UNSTAKE","SIMPLE_UPDATE_REQUEST","APPROVE_TRANSFER","SAVE_UPDATED_REWARDS","MIN_EXCESS","SEND_STAKED_JETTONS","Dividers","COMMISSION_DIVIDER","REWARDS_DIVIDER","DISTRIBUTION_SPEED_DIVIDER","BigInt","DISTRIBUTED_REWARDS_DIVIDER","ApiBaseError","Error","constructor","message","displayError","super","this","name","ApiUserRejectsError","arguments","length","undefined","ApiServerError","statusCode","ApiCommonError","ServerError","AbortOperationError","handleServerError","err","error","MAX_DP","NAME","INVALID","INVALID_DP","INVALID_RM","DIV_BY_ZERO","P","UNDEFINED","NUMERIC","round","x","sd","rm","more","xc","c","RM","e","unshift","pop","stringify","doExponential","isNonzero","s","join","n","charAt","slice","abs","cmp","y","isneg","yc","i","j","k","l","div","Big","a","b","dp","DP","bl","bt","ri","bz","ai","al","r","rl","q","qc","qi","p","push","shift","eq","gt","gte","lt","lte","minus","sub","t","xlty","plus","xe","ye","reverse","mod","ygtx","times","neg","add","pow","one","prec","sqrt","half","Math","toExponential","indexOf","mul","Array","toFixed","Symbol","for","toJSON","toString","NE","PE","toNumber","Number","strict","toPrecision","valueOf","_Big_","TypeError","String","nl","test","replace","search","substring","parse","prototype","roundDown","roundHalfUp","roundHalfEven","roundUp","ten","fromDecimal","value","decimals","TONCOIN","toDecimal","noFloor","toBig","randomBytes","size","self","crypto","getRandomValues","Uint8Array","BIGINT_PREFIX","bigintReviver","key","startsWith","bigintAbs","bigintDivideToNumber","num","ONE_TON","bigintMultiplyToNumber","callbackState","Map","parseAccountId","accountId","parts","split","id","network","buildAccountId","account","isMnemonicPrivateKey","mnemonic","PRIVATE_KEY_HEX_LENGTH","pathRegex","replaceDerive","val","derivePath","path","seed","offset","map","some","isNaN","isValidPath","chainCode","I","createHmac","update","Buffer","from","digest","getMasterKeyFromSeed","el","parseInt","reduce","parentKeys","segment","CKDPriv","_ref","index","indexBuffer","allocUnsafe","writeUInt32BE","data","concat","alloc","getDnsDomainZone","domain","zone","TON_DNS_ZONES","suffixes","baseFormat","isUnofficial","IS_CORE_WALLET","suffix","endsWith","base","buildCollectionByKey","collection","byKey","member","groupBy","groupKey","mapValues","callback","Object","keys","newByKey","pick","object","result","omit","stringKeys","Set","filter","has","omitUndefined","stringKey","compact","array","Boolean","range","start","end","arr","fromKeyValueArrays","values","acc","isArray","extractKey","DnsItem","address","init","createFromAddress","createFromConfig","config","code","workchain","beginCell","endCell","contractAddress","getDomain","provider","get","stack","readString","getTelemintDomain","getNftData","res","readBigNumber","collectionAddress","readAddress","owner","readAddressOpt","sha256","bytes","subtle","bytesToHex","hexToBytes","hex","base64ToBytes","base64","environment","setEnvironment","args","_self","isDappSupported","IS_EXTENSION","IS_CAPACITOR","isElectron","isSseSupported","isNativeBottomSheet","apiHeaders","origin","toncenterMainnetKey","ELECTRON_TONCENTER_MAINNET_KEY","TONCENTER_MAINNET_KEY","toncenterTestnetKey","ELECTRON_TONCENTER_TESTNET_KEY","TONCENTER_TESTNET_KEY","getEnvironment","TON_BIP39_PATH","TOKEN_TRANSFER_AMOUNT","TINY_TOKEN_TRANSFER_AMOUNT","TOKEN_TRANSFER_REAL_AMOUNT","TINY_TOKEN_TRANSFER_REAL_AMOUNT","TINIEST_TOKEN_TRANSFER_REAL_AMOUNT","TOKEN_TRANSFER_FORWARD_AMOUNT","CLAIM_MINTLESS_AMOUNT","NFT_TRANSFER_AMOUNT","NFT_TRANSFER_REAL_AMOUNT","NFT_TRANSFER_FORWARD_AMOUNT","NFT_PAYLOAD_SAFE_MARGIN","TON_GAS","stakeNominators","unstakeNominators","stakeLiquid","unstakeLiquid","stakeJettonsForward","stakeJettons","unstakeJettons","claimJettons","changeDns","STAKE_COMMENT","UNSTAKE_COMMENT","ATTEMPTS","DEFAULT_DECIMALS","DEFAULT_IS_BOUNCEABLE","FEE_FACTOR","ALL_WALLET_VERSIONS","OUR_FEE_PAYLOAD_BOC","Workchain","WORKCHAIN","BaseChain","TRANSFER_TIMEOUT_SEC","DEFAULT_MAX_MESSAGES","LEDGER_MAX_MESSAGES","W5_MAX_MESSAGES","OpCode","JettonOpCode","NftOpCode","LiquidStakingOpCode","JettonStakingOpCode","VestingV1OpCode","SingleNominatorOpCode","DnsOpCode","TeleitemOpCode","OtherOpCode","ContractType","DnsCategory","EXCESS_OP_CODES","Excesses","Ok","DNS_CATEGORY_HASH_MAP","dns_next_resolver","wallet","site","storage","KnownContracts","simpleR1","hash","type","Wallet","simpleR2","simpleR3","v2R1","v2R2","v3R1","v3R2","v4R1","v4R2","W5","highloadV2","nominatorPool","Staking","multisig","multisigV2","vesting","multisigNew","dedustPool","isSwapAllowed","dedustVaultNative","dedustVaultJetton","stonPtonWallet","stonRouter","stonRouterV2_1","stonPoolV2_1","stonRouterV2_2","stonPoolV2_2","stonPtonWalletV2","generateQueryId","randomNumber","randomBigInt","bigintRandom","TON_MAX_COMMENT_BYTES","clientByNetwork","walletClassMap","WalletContractV1R1","WalletContractV1R2","WalletContractV1R3","WalletContractV2R1","WalletContractV2R2","WalletContractV3R1","WalletContractV3R2","WalletContractV4","WalletContractV5R1","getTonClient","mainnet","TonClient","endpoint","TONCENTER_MAINNET_URL","timeout","DEFAULT_TIMEOUT","apiKey","headers","testnet","TONCENTER_TESTNET_URL","getTonWalletContract","publicKeyHex","version","walletClass","publicKey","create","resolveTokenWalletAddress","withCacheAsync","async","tokenAddress","minter","open","JettonMinter","Address","toBase64Address","getWalletAddress","resolveTokenAddress","tokenWalletAddress","tokenWallet","JettonWallet","getWalletData","getWalletPublicKey","callGetMethod","padStart","logDebugError","getJettonPoolStakeWallet","poolAddress","period","tonClient","pool","StakingPool","walletAddress","StakeWallet","oneCellFromBoc","Cell","fromBoc","isBounceable","urlSafe","bounceable","testOnly","toRawAddress","toRawString","buildTokenTransferBody","params","queryId","tokenAmount","toAddress","responseAddress","forwardAmount","customPayload","forwardPayload","builder","Builder","storeUint","Transfer","storeCoins","storeAddress","storeMaybeRef","packBytesAsSnake","availableBits","storeBit","storeBuffer","storeRef","commentToBytes","comment","buffer","startBuffer","Comment","set","maxBytes","packBytesAsSnakeCell","_headCell","bytesPerCell","headCell","ceil","cellOffset","cellLength","min","cellBuffer","byteOffset","nextHeadCell","EMPTY","packBytesAsSnakeForEncryptedData","subarray","buildLiquidStakingDepositBody","Deposit","asCell","getTokenBalance","getJettonBalance","parseAddress","isRaw","parseRaw","isValid","isFriendly","parseFriendly","isUserFriendly","getIsRawAddress","buildJettonUnstakePayload","jettonsToUnstake","forceUnstake","buildJettonClaimPayload","poolWallets","rewardsToClaim","Dictionary","empty","Keys","Values","Bool","poolWallet","storeDict","unpackDicts","obj","isSimpleObject","getPrototypeOf","connector","StorageType","generateUniqueId","Date","now","random","ConnectorClass","target","onUpdate","channel","shouldUseJson","targetOrigin","_defineProperty","destroy","_len","_key","postMessage","request","messageData","requestStates","requestStatesByCallback","messageId","payload","requestState","promise","Promise","resolve","reject","assign","withCallback","catch","finally","delete","cancelCallback","progressCallback","isCanceled","onMessage","JSON","response","_requestState$callbac","call","callbackArgs","_data$error","_data$error2","rawData","callWindow","methodName","cache","getItem","force","isAndroidApp","setItem","removeItem","clear","getKeys","chrome","local","_await$storage$get","remove","bind","getAll","setMany","getMany","store","idb","INDEXED_DB_NAME","INDEXED_DB_STORE_NAME","items","entries","withPromise","fn","localStorage","extensionStorage","capacitorStorage","MIN_ACCOUNT_NUMBER","IndexedDb","LocalStorage","ExtensionLocal","CapacitorStorage","loginResolve","loginPromise","activeAccountId","getActiveAccountId","setActiveAccountId","getNewAccountId","ids","getAccountIds","max","fetchStoredAddress","chain","fetchStoredAccount","fetchStoredTonWallet","ton","fetchStoredTronWallet","tron","getAccountValue","fetchStoredAccounts","updateStoredAccount","partial","setAccountValue","updateStoredTonWallet","_await$storage$getIte","removeAccountValue","removedValue","restData","removeNetworkAccountsValue","getCurrentNetwork","getCurrentAccountId","PBKDF2_IMPORT_KEY_ARGS","PBKDF2_DERIVE_KEY_ARGS","iterations","PBKDF2_DERIVE_KEY_TYPE","validateBip39Mnemonic","bip39","encryptMnemonic","password","plaintext","salt","keyMaterial","importKey","TextEncoder","encode","deriveKey","iv","ptUint8","ctBuffer","encrypt","ctArray","ctBase64","btoa","fromCharCode","ivHex","decryptMnemonic","encrypted","includes","pwUtf8","pwHash","match","byte","alg","ctStr","atob","ctUint8","ch","charCodeAt","plainBuffer","decrypt","TextDecoder","decode","decryptMnemonicLegacy","saltHex","encryptedData","getMnemonic","mnemonicEncrypted","decryptedMnemonic","DebugError","console","tryMigratingMnemonicEncryption","compareActivities","isAsc","timestamp","parseTxId","txId","subId","buildLocalTxId","buildTxId","getActivityTokenSlugs","activity","kind","slug","to","withCache","fromRight","FILLER","MAX_LIMIT","EVENTS_LIMIT","apiByNetwork","getApi","Api","HttpClient","baseUrl","TONAPIIO_MAINNET_URL","baseApiParams","customFetch","fetchWithRetry","TONAPIIO_TESTNET_URL","fetchJettonBalances","accounts","getAccountJettonsBalances","supported_extensions","balances","fetchNftItems","addresses","nft","getNftItemsByAddresses","account_ids","nft_items","toMilliseconds","seconds","toSeconds","ms","floor","IPFS_GATEWAY_BASE_URL","fetchJsonMetadata","url","fixIpfsUrl","reserveUrl","BRILLIANT_API_BASE_URL","fetchJson","fetch","ok","status","json","hasOwnProperty","RE_SYMBOL_WITH_COMBINING_MARKS","RE_LINEBREAK_COMBINING_MARKS","RE_SPACE_CHARS","RE_FAKE_DOTS","RE_EMPTY_CHARS","checkLNPRegex","characters","alphabetMap","confusablesMap","alts","char","cleanText","str","checkLNP","newStr","clean","BAD_REQUEST_CODE","callBackendPost","options","authToken","isAllowBadRequest","method","shouldRetry","retries","timeouts","URL","getBackendHeaders","body","shouldSkipRetryFn","handleFetchErrors","callBackendGet","APP_VERSION","APP_ENV","knownAddresses","scamMarkers","trustedSites","trustedCollections","tryUpdateKnownAddresses","RegExp","getKnownAddresses","getKnownAddressInfo","checkIsTrustedCollection","checkHasScamLink","text","matches","matchAll","RE_LINK_TEMPLATE","_match$groups","host","groups","toLowerCase","IGNORED_DEXIE_ERRORS","tryDbQuery","cb","DbRepository","table","all","toArray","find","where","put","item","bulkPut","deleteWhere","ApiDb","Dexie","stores","nfts","sseConnections","tokens","apiDb","nftRepository","tokenRepository","stakingCommonCache","accountCache","pricesCache","baseCurrency","DEFAULT_PRICE_CURRENCY","bySlug","getAccountCache","_accountCache","updateAccountCache","getStakingCommonCache","getPricesCache","tokensCache","TOKEN_INFO","addTokens","shouldForceSend","newTokens","token","mergedToken","mergeTokenWithCache","sendUpdateTokens","getTokensCache","getTokenBySlug","getTokenByAddress","buildTokenSlug","prices","_prices$bySlug$token$","quote","price","priceUsd","percentChange24h","fromEntries","ADDRESS_BOOK_CHUNK_SIZE","VERSION_MAP","fixAddressFormat","callToncenterV3","address_book","OFFCHAIN_CONTENT_PREFIX","dictSnakeBufferValue","sliceToVal","v","isFirst","loadUint","loadBuffer","remainingBits","remainingRefs","loadRef","beginParse","serialize","jettonOnChainMetadataSpec","uri","description","image","symbol","custom_payload_api_uri","fetchJettonOffchainMetadata","parsePayloadBase64","_await$parsePayloadSl","Slice","BitReader","BitString","dataToSlice","shouldLoadItems","transactionDebug","opCode","readSnakeBytes","Encrypted","encryptedComment","loadUintBig","_forwardPayload","amount","loadCoins","destination","loadAddress","responseDestination","loadMaybeAddress","loadMaybeRef","forwardPayloadOpCode","storeBits","loadBits","forEach","forwardPayloadSlice","toBoc","TransferOwnership","_nft","newOwner","readForwardPayloadCell","readComment","asSlice","rawNft","parseTonapiioNft","nftAddress","nftName","OwnershipAssigned","prevOwner","Burn","addressObj","isLiquidUnstakeRequest","LIQUID_JETTON","DistributedAsset","Withdrawal","appId","AddWhitelist","Withdraw","ChangeValidator","Vote","votingAddress","expirationDate","vote","loadBit","needConfirmation","ChangeRecord","_Object$entries$find","category","_ref2","contract","resolver","isTelemint","getDnsItemDomain","dataSlice","endParse","dataAddress","flags","record","TokenBridgePaySwap","swapId","isForce","loadBoolean","DEBUG","_opCode","debugTxString","opCodeHex","parsePayloadSlice","_forwardPayload2","buildMtwCardsNftMetadata","metadata","mtwCardType","mtwCardTextType","_metadata$attributes$","_metadata$attributes$2","_metadata$attributes$3","imageUrl","mtwCardId","attributes","attribute","trait_type","trim","mtwCardBorderShineType","isEmptyObject","rawMetadata","previews","sale","trust","render_type","renderType","lottie","hasScamLink","isWhitelisted","isScam","isHidden","imageFromPreview","resolution","isFragmentGift","NFT_FRAGMENT_GIFT_IMAGE_URL_PREFIX","MTW_CARDS_COLLECTION","fragmentUrl","NFT_FRAGMENT_GIFT_IMAGE_TO_URL_REGEX","ownerAddress","thumbnail","isOnSale","collectionName","isOnFragment","NFT_FRAGMENT_COLLECTIONS","TME_RENEW_HASH_SUFFIX","fetchActions","limit","toTimestamp","fromTimestamp","shouldIncludeFrom","shouldIncludeTo","includeTypes","excludeTypes","actions","rawActions","addressBook","start_utime","end_utime","sort","action_type","exclude_action_type","action","activities","parseAction","buildActionActivityId","partialTx","externalMsgHash","trace_external_hash","fee","parseTonTransfer","parseCallContract","parseContractDeploy","parseNftTransfer","parseNftMint","parseJettonTransfer","parseJettonMint","parseJettonBurn","parseStakeDeposit","parseStakeWithdrawal","parseStakeWithdrawalRequest","parseJettonSwap","parseDns","parseAuctionBid","details","partialExtended","fromAddress","source","user_friendly","normalizedAddress","isIncoming","amount_1","getAssetSlug","asset_1","lp_tokens_minted","amount_2","asset_2","parseLiquidityDeposit","additionalId","parseLiquidityWithdraw","_activity$nft","_activity$shouldLoadD","shouldHide","shouldLoadDetails","isEncrypted","opcode","OurFee","UnstakeRequest","ClaimRewards","is_encrypted_comment","forward_payload","sender","receiver","asset","BURN_ADDRESS","MYCOIN_STAKING_POOL","receiver_jetton_wallet","owner_jetton_wallet","nft_item_index","nft_item","rawNftAddress","nft_collection","rawCollectionAddress","new_owner","old_owner","oldOwner","parseToncenterNft","fromBase64","safeExec","stake_holder","LIQUID_POOL","payout_nft","_parseToncenterJetton","_parseToncenterJetton2","endUtime","success","isSuccess","dex_incoming_transfer","fromAmount","fromAsset","dex_outgoing_transfer","toAmount","toAsset","decimalsFrom","parseToncenterJetton","decimalsTo","fromTokenAddress","toTokenAddress","STON_PTON_ADDRESS","networkFee","swapFee","ourFee","hashes","sum_type","sumType","bidder","auction","rawAddress","metadataMap","_extra$domain","_getDnsDomainZone","_image","_extra$_image_medium2","nftMetadata","extractMetadata","extra","collectionMetadata","domainZone","_extra$_image_medium","DNS_IMAGE_GEN_URL","_image_medium","fixedImage","jettonMetadata","_data$token_info","is_indexed","token_info","tokenInfo","start_lt","action_id","trace_id","fetchTransactions","transactions","rawTransactions","rawTx","parseRawTransaction","flat","total_fees","totalFees","compute_ph","exit_code","exitCode","in_msg","out_msgs","inMsgHash","msgs","oneMsgFee","msg","fwd_fee","fwdFee","msgHash","tx","isAddressInitialized","walletOrAddress","getWalletInfo","isInitialized","isActiveSmartContract","isWallet","publicKeyToAddress","walletVersion","buildWallet","client","WalletClass","account_state","accountState","seqno","balance","last_transaction_id","lastTxId","getContractInfo","getAddressInfo","state","codeHashOld","contractInfo","info","codeHash","getAccountBalance","getWalletBalance","getWalletSeqno","pickBestWallet","allWallets","getWalletVersionInfos","defaultWallet","DEFAULT_WALLET_VERSION","withBiggestBalance","best","current","_best$balance","withLastTx","predicate","cursor","findLast","v4Wallet","_ref3","walletInfos","states","wallets","addressByRaw","toUpperCase","getWalletStates","wallet_type","last_transaction_hash","getWalletInfos","_walletInfos$item$add","getWalletVersions","getWalletStateInit","storedWallet","getTonWallet","storeWritable","storeStateInit","pickWalletByAddress","w","tonWallet","resolveWalletVersion","_ref4","generateMnemonic","tonWebMnemonic","validateMnemonic","privateKeyHexToKeyPair","privateKeyHex","nacl","keyPair","fromSeed","fetchPrivateKey","secretKey","privateKey","fetchKeyPair","_account","bip39MnemonicToKeyPair","rawSign","dataHex","detached","getWalletFromBip39Mnemonic","getWalletFromKeys","getWalletFromMnemonic","getWalletFromPrivateKey","hexSeed","HDKey","importNewWalletVersion","newAddress","newAccountId","newAccount","ledger","driver","getChainConfig","CHAIN_CONFIG","getDieselTokenAmount","diesel","_diesel$amount","nativeToken","ed25519","require","aesjs","getAesCbcState","ModeOfOperation","cbc","combineSecrets","hmacAlgo","hmacKey","signature","sign","hmacSha512","encryptMessageComment","myPublicKey","theirPublicKey","myPrivateKey","senderAddress","commentBytes","encryptedBytes","sharedSecret","getSharedSecret","prefix","dataLength","prefixLength","minPadding","getRandomPrefix","combined","msgKey","cbcStateSecret","encryptDataWithPrefix","encryptDataImpl","prefixedEncrypted","encryptData","decryptMessageComment","decryptedBytes","decryptedData","gotMsgKey","doDecrypt","decryptDataImpl","decryptData","DIESEL_URL","sendExternal","gaslessType","neededInit","isContractDeployed","ext","external","cell","storeMessage","isW5Gasless","bodyMessageHash","boc","paymentLink","isAddition","dieselW5SendRequest","dieselSendBoc","sendFile","Deferred","resolved","byId","byAddress","waitAndCreatePendingTransfer","prevPending","pendingTransfer","getPendingTransfer","DAYS_IN_YEAR","FIRST_TRANSACTIONS_LIMIT","Opcodes","action_send_msg","action_set_code","action_extended_set_data","action_extended_add_extension","action_extended_remove_extension","action_extended_set_signature_auth_allowed","auth_extension","auth_signed","auth_signed_internal","ActionSendMsg","mode","outMsg","tag","SendMode","IGNORE_ERRORS","storeMessageRelaxed","packActionsListOut","rest","storeSlice","packActionsListExtended","outActions","areDeepEqual","value1","value2","type1","isArray1","array1","array2","every","member1","object1","object2","keys1","keys2","key1","key2","migrationEnsurePromise","currentOnUpdate","updateActivityMetadata","isNftTransfer","hasScamMarkers","sm","hasScamInComment","RE_TG_BOT_MENTION","isAlive","_onUpdate","isUpdaterAlive","isAccountActive","buildOldAccountId","iosBackupAndMigrateKeychainMode","backupKey","assert","backupValue","shouldRewrite","GET_TRANSACTIONS_LIMIT","checkHasTransaction","fetchActivitySlice","tokenSlug","fetchActivityDetails","traceId","actionId","startLt","parseActionActivitySubId","parsedTrace","trace","include_actions","traces","fetchTrace","byHash","totalSent","totalReceived","totalNetworkFee","byTransactionIndex","isWalletTransactionFound","processTrace","traceDetail","_index","tx_hash","txs","inputTxs","sent","received","child","children","in_msg_hash","fetchAndParseTrace","actionHashes","elem","intersection","realFee","asset_in","asset_out","ourFeeAction","_action","tokenIn","setSwapDetails","setTransactionDetails","logDebug","returned","change","parseSmartContractAddressImpl","prefix0","prefix1","byte0","byte1","hashPart","parseNextResolverRecord","parseStorageBagIdRecord","dnsResolveImpl","dnsAddress","rawDomainBytes","oneStep","len","domainCell","categoryBN","categoryBytes","categoryHashHex","categoryToBigInt","resultLen","readNumber","readCell","DnsNextResolver","parseSmartContractAddressRecord","Site","parseAdnlAddressRecord","parseSiteRecord","BagId","nextAddress","resolveAddress","resolvedAddress","zoneMatch","rootDnsAddress","part","rawDomain","domainToBytes","dnsResolve","_err$message","resolveAddressByDomain","chunks","chunkSize","chunk","fetchAddressBook","known","normalizeAddress","_domain","getAccountTokenBalances","getTokenBalances","balanceRaw","jetton","wallet_address","buildTokenByMetadata","jettonWallet","parseTokenBalance","insertMintlessPayload","transfer","customPayloadApiUrl","parsedPayload","mintlessTokenBalance","isMintlessClaimed","stateInit","getMintlessParams","newPayload","isBase64Payload","buildTokenTransfer","shouldSkipMintless","isTokenWalletDeployed","toncoinAmount","realAmount","getToncoinAmountForTransfer","calculateTokenBalanceWithMintless","runMethod","readBoolean","checkMintlessTokenWalletIsClaimed","fetchJsonWithProxy","fetchMintlessTokenWalletData","isExpired","compressed_info","expired_at","getTime","custom_payload","state_init","fetchToken","content","getJettonData","getJettonMinterData","contentUri","dict","loadDict","_dict$get","sha256Key","parseJettonOnchainMetadata","fetchJettonMetadata","image_data","imageData","willClaimMintless","TON_USDT_SLUG","isTiny","WAIT_TRANSFER_TIMEOUT","WAIT_PAUSE","MAX_BALANCE_WITH_CHECK_DIESEL","PENDING_DIESEL_TIMEOUT","DIESEL_NOT_AVAILABLE","nativeAmount","remainingFee","checkTransactionDraft","shouldEncrypt","isBase64Data","stateInitString","allowGasless","checkToAddress","ApiTransactionDraftError","StateInitWithoutBin","InvalidStateInit","isToAddressNew","InactiveContract","InvalidAmount","WalletNotInitialized","isWalletInitialized","toncoinBalance","tokenTransfer","realToncoinAmount","isFullTonTransfer","transaction","signTransaction","isFullBalance","blockchainFee","calculateFee","safeBlockchainFee","isEnoughBalance","canTransferGasfully","getDiesel","tokenBalance","InsufficientBalance","DomainNotResolved","addressName","isMemoRequired","isTestOnly","InvalidToAddress","isUrlSafe","InvalidAddressFormat","submitTransfer","stringToPayload","ApiTransactionError","retrySendBoc","resolveTransactionError","submitTransferWithDiesel","dieselAmount","isGaslessWithStars","messages","DIESEL_ADDRESS","submitMultiTransfer","isGasless","withW5Gasless","parseBase64","toPublicKey","IncorrectDeviceTime","UnsuccesfulTransfer","expireAt","loadStateInit","sendMode","CARRY_ALL_REMAINING_BALANCE","PAY_GAS_SEPARATELY","createTransfer","internal","bounce","getAccountNewestActionId","fetchNewestActionId","checkMultiTransactionDraft","withDiesel","withEmulation","totalAmount","_result$emulation$tot","_result$emulation","isMainnet","signMultiTransaction","emulation","safeExecAsync","externalMessage","buildExternalBoc","ignore_chksig","include_code_data","with_actions","fetchEmulateTrace","emulateTrace","parseTransaction","totalFee","sum","parseEmulation","clearedMessages","_ref5","hasPayload","preparedMessages","actionsList","createBody","toExternalMessage","waitUntil","walletInfo","pause","source_fees","fees","estimateExternalMessageFee","initCode","initData","ignoreSignature","in_fwd_fee","storage_fee","gas_fee","sendSignedMessage","pendingTransferId","sendSignedMessages","attempts","firstBoc","attempt","msgHashes","_pendingTransfer","successNumber","decryptComment","fetchEstimateDiesel","_ref6","_toncoinBalance","_tokenBalance","storedTonWallet","isGaslessEnabled","isStarsEnabled","isStars","DEFAULT_FEE","getDieselToncoinFee","toncoinNeeded","rawDiesel","isW5","estimateDiesel","accountAddress","getTokenBalanceWithMintless","canPayDiesel","isAwaitingNotExpiredPrevious","pendingCreatedAt","getAccountNfts","rawNfts","getAccountNftItems","indirect_ownership","fetchAccountNfts","checkNftOwnership","getNftItemByAddress","fetchNftByAddress","getNftUpdates","fromSec","_events$0$timestamp","_events$","events","getAccountEvents","start_date","fetchAccountEvents","updates","event","isPurchase","NftPurchase","NftItemTransfer","recipient","buyer","newOwnerAddress","checkNftTransferDraft","NFT_BATCH_SIZE","buildNftTransferMessage","transactionResult","batchFee","calculateNftTransferFee","submitNftTransfers","NOTCOIN_VOUCHERS_ADDRESS","NOTCOIN_EXCHANGERS","buildNftTransferPayload","nftIndex","first4Bits","readUint8","NOTCOIN_FORWARD_TON_AMOUNT","buildNotcoinVoucherExchange","totalNftCount","estimatedBatchSize","estimatedBatchBlockchainFee","amountPerNft","remainingBatchSize","NominatorPool","getListNominators","readTuple","tupleItems","tuple","TupleReader","pendingDepositAmount","withdrawRequested","clientId","getClientId","referrer","checkStakeDraft","stakePayload","checkUnstakeDraft","commonData","liquid","currentRate","buildLiquidStakingWithdraw","stakeWalletAddress","submitStake","stakedAt","submitUnstake","instantAvailable","ApiLiquidUnstakeMode","Default","BestRate","waitTillRoundEnd","fillOrKill","buildLiquidStakingWithdrawCustomPayload","buildLiquidStakingWithdrawBody","Instant","getStakingStates","backendState","loyaltyType","shouldUseNominators","backendType","promises","buildLiquidState","poolConfig","jettonPools","buildJettonState","_currentNominator$pen","_currentNominator","_currentNominator$wit","_currentNominator2","apy","nominatorsPool","isPrevRoundUnlocked","prevRound","unlock","currentNominator","nominators","addressObject","equals","annualYield","yieldType","isUnstakeRequested","buildNominatorsState","_accountCache$stakedA","_backendState$stakedA","getLiquidStakingTokenBalance","unstakeAmount","_nft$name","billAmount","liquidAvailable","VALIDATION_PERIOD_MS","available","liquidApy","loyaltyApy","unstakeRequestAmount","poolData","getStorageData","tvl","rewardJettons","rewardsDeposits","dailyReward","startTime","endTime","distributionSpeed","apr","calcJettonStakingApr","periodConfig","periods","stakeWallet","walletData","unclaimedRewards","poolWalletAddress","rewards","getAvailableRewards","jettonBalance","getBackendStakingState","stakingState","totalProfit","STAKING_POOLS","poolPart","isKnownStakingPool","fetchBackendStakingState","submitStakingClaim","packPayloadToBoc","storeStringTail","checkApiAvailability","getMasterchainInfo","isNftTransferPayload","isTokenTransferPayload","FEE_ADDRESSES","SWAP_FEE_ADDRESS","MAX_NETWORK_FEE","validateDexSwapTransfers","transfers","condition","originalAssert","mainTransfer","feeTransfer","maxAmount","_request$ourFee","_request$dieselFee","dieselFee","maxTonAmount","feePayload","tokenFeeAmount","feeDestination","deferreds","isFocused","pauseOrFocus","msWhenNotFocused","then","setIsAppFocused","_isFocused","d","convertToDbEntity","_nft$collectionAddres","swapItemToActivity","swap","backendId","getSwapItemSlug","cex","_getTokenByAddress$sl","_getTokenByAddress","patchSwapItem","swapVersion","SWAP_API_VERSION","swapReplaceCexActivities","isToNow","_getTokenBySlug$token","firstTimestamp","lastTimestamp","fromTime","toTime","swaps","swapGetHistory","isCex","allSwapHashes","txCallbacks","callbacks","removeCallback","runCallbacks","addCallback","hasCallbacks","createCallbackManager","updateTokenHashes","tokensToFetch","option","tokensByAddress","getAccountStates","code_hash","fetchVestings","isTestnet","BALANCE_BASED_INTERVAL","BALANCE_BASED_INTERVAL_WHEN_NOT_FOCUSED","DOUBLE_CHECK_TOKENS_PAUSE","DOUBLE_CHECK_ACTIVITIES_PAUSE","NFT_FULL_INTERVAL","STAKING_INTERVAL","STAKING_INTERVAL_WHEN_NOT_FOCUSED","VERSIONS_INTERVAL","VERSIONS_INTERVAL_WHEN_NOT_FOCUSED","VESTING_INTERVAL","VESTING_INTERVAL_WHEN_NOT_FOCUSED","BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL","BALANCE_NOT_ACTIVE_ACCOUNTS_INTERVAL_WHEN_NOT_FOCUSED","lastBalanceCache","setupPolling","newestActivityTimestamp","nftUpdates","doubleCheckTokensTime","doubleCheckActivitiesTime","nftFromSec","lastNftFullUpdate","updateBalance","newBalances","changedSlugs","isToncoinBalanceChanged","updateNfts","nftResult","logAndRescue","throwErrorIfUpdaterNotAlive","dbNft","processNftUpdates","dbNfts","updateAccountNfts","updateTokenBalances","tokenBalances","updateActivities","loadNewActivities","tokenSlugs","mainActivities","SWAP_CROSSCHAIN_SLUGS","loadInitialActivities","_lastBalanceCache$acc","isUpdating","setupBalanceBasedPolling","isLedger","publicKeyBytes","versions","LEDGER_WALLET_VERSIONS","POPULAR_WALLET_VERSIONS","lastResult","versionInfos","versionInfo","filteredVersions","currentVersion","setupWalletVersionsPolling","lastStates","common","setupStakingPolling","lastVestingInfo","vestingInfo","setupVestingPolling","setupInactiveAccountsBalancePolling","addressToAccountsMap","localOnUpdate","updateAddressToAccountsMap","accountsById","balancePollingAccount","_ref7","_lastBalanceCache$acc2","parametersByNetwork","chainConfig","getTronClient","TronWeb","fullHost","apiUrl","getChainParameters","chainParameters","trx","energyUnitFee","param","bandwidthUnitFee","getTokenTransactionSlice","TRX","queryParams","getTrxTransactions","min_timestamp","max_timestamp","_rawData$contract$0$p","raw_data","txID","energy_fee","energyFee","net_fee","netFee","block_timestamp","parameter","fromHex","owner_address","to_address","parseRawTrxTransaction","getTrc20Transactions","contract_address","transaction_id","parseRawTrc20Transaction","getAllTransactionSlice","mainChunk","prevChunk","trxChunk","tokenChunks","mergeTransactions","trxTxs","tokenTxs","tokenTxById","trxTxsCleared","tokenTx","tronWeb","getBalance","getTrc20Balance","functions","parameters","issuerAddress","transactionBuilder","triggerSmartContract","_isConstant","constant_result","callContract","BALANCE_INTERVAL","BALANCE_INTERVAL_WHEN_NOT_FOCUSED","newestActivityTimestamps","usdtAddress","usdtSlug","slugs","accountLastBalances","trxBalance","usdtBalance","_transactions$","_transactions$0$times","_transactions$2","TRON_GAS","transferTrc20Estimated","ONE_TRX","SIGNATURE_SIZE","isAddress","bandwidth","getBandwidth","energy_required","energyRequired","estimateEnergy","estimateTrc20TransferFee","sendTrx","getAccount","raw_data_hex","byteLength","fromMnemonic","feeLimit","buildTrc20Transfer","signedTx","sendRawTransaction","sendTransaction","hexToString","isConnected","hooks","callHook","hook","_hooks$name2","activeDappByAccountId","resolvePromise","initDapps","activateDapp","oldAccountId","findActiveDappAccount","getActiveDapp","deactivateDapp","deactivateAccountDapp","deactivateAllDapps","getDapp","_await$getAccountValu","addDapp","dapp","dapps","getDappsByOrigin","deleteDapp","dontNotifyDapp","isDappActive","deleteAllDapps","origins","getDapps","getDappsState","removeAccountDapps","removeAllDapps","removeNetworkDapps","loadExploreSites","isLandscape","getBaseCurrency","setBaseCurrency","currency","preloadPromise","resolveDataPreloadPromise","waitDataPreload","chains","fetchTokenBalances","fetchTokenBalancesByAddress","getAmountForTokenTransfer","initTransactions","fetchAllActivitySlice","tronTokenSlugs","tonActivities","mergeActivitiesToMaxTime","shouldCreateLocalActivity","localActivity","createLocalTransaction","isExternal","waitAndCreateTonPendingTransfer","sendSignedTransferMessage","cancelPendingTransfer","_getPendingTransfer","localTransaction","_params$txId","restParams","buildLocalTransaction","fetchTonActivityDetails","initStaking","getStakingHistory","tryUpdateStakingCommonData","setStakingCommonCache","SIGN_MESSAGE","getBackendAuthToken","accountWallet","fetchAccountConfigForDebugPurposesOnly","stateVersion","mnemonicsEncrypted","ping","updateAccountMemoryCache","getMoonpayOnrampUrl","theme","initSwap","swapBuildTransfer","swapBuild","transferList","shouldTryDiesel","errorToString","swapSubmit","historyItem","_account$ton$authToke","fetchSwaps","results","allSettled","swapGetHistoryItem","nonExistentIds","reason","swapEstimate","isMsgHashMode","swapGetAssets","swapGetTonCurrencies","swapGetPairs","symbolOrTokenAddress","swapCexEstimate","swapCexValidateAddress","swapCexCreateTransaction","swapCexSubmit","transferOptions","BACKEND_INTERVAL","LONG_BACKEND_INTERVAL","INCORRECT_TIME_DIFF","ACCOUNT_CONFIG_INTERVAL","ACCOUNT_CONFIG_INTERVAL_INTERVAL_WHEN_NOT_FOCUSED","initPolling","tryUpdatePrices","tryUpdateTokens","tryUpdateSwapTokens","tryUpdateConfig","setupBackendPolling","setupLongBackendPolling","IS_AIR_APP","pricesData","isFirstRun","loadTokensCache","minterAddress","assets","_prices$bySlug$asset$","_prices$bySlug$asset$2","blockchain","isLimited","isCopyStorageEnabled","supportAccountsCount","serverUtc","country","countryCode","isUpdateRequired","isAppUpdateRequired","localUtc","setupAccountConfigPolling","partialAccount","accountConfig","initAccounts","activateAccount","prevAccountId","isFirstLogin","activeDappOrigin","onActiveDappAccountUpdated","newestTonTimestamps","pickChainTimestamps","nativeSlug","newBySlug","deactivateAllAccounts","deactivateCurrentAccount","fetchTonWallet","fetchLedgerAccount","IS_BIP39_MNEMONIC_ENABLED","createWallet","importMnemonic","isPrivateKey","isBip39Mnemonic","isTonMnemonic","tonAddress","tronAddress","tronWallet","secondNetworkAccount","createAccountWithSecondNetwork","secondNetwork","secondAccountId","addressByChain","importLedgerWallet","deviceId","deviceName","storeHardwareAccount","removeNetworkAccounts","resetAccounts","removeAccount","nextAccountId","changePassword","oldPassword","encryptedMnemonic","createDappPromise","promiseId","resolveDappPromise","fetchTonPrivateKey","fetchMnemonic","getMnemonicWordList","default","verifyPassword","_await$getAccountWith","getAccountWithMnemonic","confirmDappRequest","dappPromises","confirmDappRequestConnect","cancelDappRequest","fetchAddress","fetchNfts","totalRealFee","realFeePerNft","CONNECT_EVENT_ERROR_CODES","SEND_TRANSACTION_ERROR_CODES","SIGN_DATA_ERROR_CODES","tonConnectGetDeviceInfo","maxMessages","platform","getPlatform","appName","APP_NAME","appVersion","packageJson","maxProtocolVersion","TONCONNECT_PROTOCOL_VERSION","features","_navigator","userAgent","navigator","userAgentData","devicePlatform","IS_TELEGRAM_APP","TonConnectError","ManifestContentError","MANIFEST_CONTENT_ERROR","UnknownError","BadRequestError","UnknownAppError","MAX_SINGLE_AMOUNT_AS_FEE","MAX_TOTAL_AMOUNT_AS_FEE","URL_MAX_LENGTH","isValidString","maxLength","isValidUrl","getTransferActualToAddress","isTransferPayloadDangerous","shouldShowTransferAmountAsFee","BLANK_GIF_DATA_URL","resolveInit","initPromise","onPopupUpdate","initTonConnect","_onPopupUpdate","connect","openExtensionPopup","connectionType","isSse","dappMetadata","fetchDappMetadata","manifestUrl","validateRequest","addressItem","proofItem","proof","errors","getCurrentAccountOrFail","connectedAt","sse","sseOptions","identifier","permissions","promiseResult","deviceInfo","getMaxMessages","buildTonAddressReplyItem","proofReplyItem","timestampBuffer","writeBigInt64LE","domainBuffer","domainLengthBuffer","writeInt32LE","addressWorkchainBuffer","writeInt32BE","workChain","addressBuffer","messageBuffer","bufferToSign","buildTonProofReplyItem","signTonProof","device","formatConnectError","reconnect","updateDapp","disconnect","txPayload","dappNetworkRaw","dappNetwork","CHAIN","MAINNET","validUntil","valid_until","vestingAddress","ownerPublicKey","_info$contractInfo","checkIsHisVestingWallet","WrongAddress","WrongNetwork","checkResult","checkTransactionMessages","transactionsForRequest","_checkResult$emulatio","_emulationResult$fee","_emulationResult$rece","rawAmount","rawPayload","emulationResult","isDangerous","displayedToAddress","displayedAmount","fullFee","totalAmountAsFee","showDappTransferAmountsAsFee","prepareTransactionForRequest","signedTransfers","submitResult","PartialTransactionFailure","UNKNOWN_ERROR","errorMessage","apiErrors","USER_REJECTS_ERROR","Unexpected","signData","METHOD_NOT_SUPPORTED","deactivate","TESTNET","walletStateInit","idx","crc32","lengthBytes","iconUrl","safeIconUrl","skipConnection","getCurrentAccountIdOrFail","lastAccountId","lastConnectedAccountId","byOrigin","findLastConnectedAccount","BRIDGE_URL","TTL_SEC","NONCE_SIZE","MAX_CONFIRM_DURATION","sseEventSource","delayedReturnParams","sseDapps","startSseConnection","isFromInAppBrowser","searchParams","ret","appClientId","shouldOpenUrl","connectRequest","decodeURIComponent","secretKeyArray","publicKeyArray","lastOutputId","tonConnect","sendMessage","resetupSseConnection","lastEventId","dappsState","_dapp$sse","clientIds","close","EventSource","openEventSource","onopen","onerror","onmessage","encryptedMessage","sseDapp","fullBuffer","nonce","decrypted","jsonText","decryptMessage","setSseLastEventId","toId","topic","encryptMessage","sendRawMessage","fetchPriceHistory","subscribeNotifications","props","unsubscribeNotifications","connectUpdater","worker","createConnector","handleMessage","addEventListener","removeEventListener","WINDOW_PROVIDER_CHANNEL","methods","currentStorage","words","isTonProxyEnabled","isTonMagicEnabled","settings","secondAddress","newAccountById","migrateCoreWallet","idbVersion","idbStorage","idbData","MAIN_ACCOUNT_ID","field","raw","oldItem","newItem","prevValue","newValue","accountDapps","byAccountId","internalAccountId","accountData","parsed","mainnetAccountId","testnetAccountId","publicKeys","oldAddress","_dapp$sse2","isIosKeychainModeMigrated","isIosApp","oldAccountById","mnemonicById","oldAccount","_ledger$index","migrations","migrateStorage","_currentOnUpdate","startStorageMigration","tonConnectSse","_referrer","saveReferrer","_hooks$name","addHooks","onDappDisconnected","onDappsChanged","api","sendToOrigin","transferables","_e$error","_e$error2","_e$reason","_e$reason2","handleErrors","_message$data","_api$init","lastArg","ArrayBuffer","ImageBitmap","arrayBuffer","createPostMessageInterface","tonConnectApi","process","DEBUG_MORE","env","IS_OPERA_EXTENSION","DEBUG_ALERT_MSG","cmcSlug","MYCOIN","isMemoSupported","isDnsSupported","addressRegex","addressPrefixRegex","TRC20_USDT_MAINNET_SLUG","TRC20_USDT_TESTNET_SLUG","TRC20_USDT","TON_USDT","toncoin","DEFAULT_RETRIES","DEFAULT_ERROR_PAUSE","checkInt","checkInts","arrayish","coerceArray","arg","copy","createArray","copyArray","sourceArray","targetArray","targetStart","sourceStart","sourceEnd","Hex","convertUtf8","toBytes","encodeURI","substr","fromBytes","convertHex","numberOfRounds","rcon","S","Si","T1","T2","T3","T4","T5","T6","T7","T8","U1","U2","U3","U4","convertToInt32","AES","defineProperty","_prepare","rounds","_Ke","_Kd","roundKeyCount","KC","tk","tt","rconpointer","ciphertext","ModeOfOperationECB","_aes","block","ModeOfOperationCBC","_lastCipherblock","ModeOfOperationCFB","segmentSize","_shiftRegister","xorSegment","ModeOfOperationOFB","_lastPrecipher","_lastPrecipherIndex","Counter","initialValue","_counter","setValue","setBytes","MAX_SAFE_INTEGER","increment","ModeOfOperationCTR","counter","_remainingCounter","_remainingCounterIndex","ecb","cfb","ofb","ctr","utils","utf8","padding","pkcs7","pad","padder","strip","_arrayTest","module","exports","nodeCrypto","freeze","__proto__","_0n","_1n","_2n","_8n","CU_O","CURVE","h","Gx","Gy","POW_2_256","SQRT_M1","SQRT_AD_MINUS_ONE","INVSQRT_A_MINUS_D","ONE_MINUS_D_SQ","D_MINUS_ONE_SQ","ExtendedPoint","z","fromAffine","Point","ZERO","toAffineBatch","points","toInv","nums","tmp","inverted","invert","reduceRight","invertBatch","toAffine","normalizeZ","other","assertExtPoint","X1","Y1","Z1","X2","Y2","Z2","X1Z2","X2Z1","Y1Z2","Y2Z1","negate","double","A","B","C","D","x1y1","E","G","F","H","X3","Y3","Z3","subtract","precomputeWindow","W","windows","window","wNAF","affinePoint","BASE","_WINDOW_SIZE","precomputes","pointPrecomputes","f","windowSize","mask","maxNumber","shiftBy","wbits","offset1","offset2","cond1","cond2","constTimeNegate","multiply","scalar","normalizeScalar","multiplyUnsafe","P0","isSmallOrder","isTorsionFree","invZ","is0","ax","ay","zz","fromRistrettoBytes","legacyRist","toRistrettoBytes","fromRistrettoHash","assertRstPoint","RistrettoPoint","ep","calcElligatorRistrettoMap","r0","Ns","Ns_D_is_sq","uvRatio","s_","edIsNegative","Nt","s2","W0","W1","W2","W3","hashToCurve","r1","bytes255ToNumberLE","ensureBytes","R1","r2","R2","emsg","b1","b2","equalBytes","numberTo32BytesLE","u1","u2","u1_2","u2_2","invertSqrt","Dx","Dy","toRawBytes","u2sq","invsqrt","D1","D2","zInv","_x","_y","toHex","two","WeakMap","_setWindowSize","normed","bytesToNumberLE","y2","u","isXOdd","fromPrivateKey","getExtendedPublicKey","point","toX25519","Signature","assertValidity","u8","concatBytes","arrays","hexes","uint8a","hexByte","numberTo32BytesBE","MAX_255B","number","modulo","m","pow2","power","pow_2_252_3","_5n","_10n","_20n","_40n","_80n","b4","b5","b10","b20","b40","b80","b160","b240","b250","pow_p_5_8","v3","v7","vx2","root1","root2","useRoot1","useRoot2","noRoot","modlLE","expectedLength","isSafeInteger","adjustBytes25519","checkPrivateKey","getKeyFromHash","hashed","head","pointBytes","_sha512Sync","sha512s","sha512","getExtendedPublicKeySync","prepareVerification","sig","SB","pub","finishVerification","kA","sync","getPublicKey","R","verify","cswap","x_2","x_3","dummy","curve25519","BASE_POINT_U","scalarMult","pu","pointU","a24","x_1","sw","z_2","z_3","k_t","AA","BB","DA","CB","dacb","da_cb","xp2","montgomeryLadder","uEnc","decodeUCoordinate","scalarMultBase","node","web","TORSION_SUBGROUP","hashToPrivateScalar","bytesLength","randomPrivateKey","createHash","precompute","cached","sha512Sync","defineProperties","configurable","factory","AssertionError","SECOND","langCode","dayStartAt","noYear","monthFormat","noDay","withTime","toLocaleString","year","month","day","hour","minute","hourCycle","IS_EXTENSION_PAGE_SCRIPT","location","protocol","MAX_TIMEOUT","urlObject","append","isNotTemporaryError","_timeouts","fetchWithTimeout","controller","AbortController","setTimeout","abort","signal","clearTimeout","ignoreHttpCodes","_error","_errors$","shouldShowAlert","throttledAlert","throttle","alert","handleErrorEvent","ErrorEvent","preventDefault","handleError","MAX_LOG_LENGTH","logs","errorReplacer","_","addLog","log","time","getLogs","level","_len2","_key2","SAFE_EXEC_ENABLED","rescue","always","shouldIgnoreError","interval","isPending","shouldRunFirst","_args","setInterval","clearInterval","fnCache","cacheKey","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","__webpack_exports__","O","chunkIds","priority","notFulfilled","Infinity","fulfilled","splice","getter","__esModule","definition","o","enumerable","chunkId","miniCssF","g","globalThis","Function","prop","toStringTag","scriptUrl","importScripts","document","currentScript","tagName","src","scripts","getElementsByTagName","installedChunks","chunkLoadingGlobal","parentChunkLoadingFunction","moreModules","runtime"],"sourceRoot":""}